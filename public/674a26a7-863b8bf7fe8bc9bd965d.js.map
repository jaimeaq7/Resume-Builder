{"version":3,"sources":["webpack://resume-builder/./node_modules/xlsx/xlsx.mjs"],"names":["XLSX","current_codepage","current_ansi","VALID_ANSI","CS2CP","set_ansi","cp","indexOf","set_cp","reset_cp","char_codes","data","o","i","len","length","charCodeAt","utf16beread","String","fromCharCode","join","$cptable","debom","c1","c2","utf16leread","slice","_getchar","x","_getansi","set_cptable","cptable","utils","decode","cpdoit","Base64_map","Base64_encode","input","c3","e1","e2","e3","e4","isNaN","charAt","Base64_decode","replace","has_buf","Buffer","process","versions","node","Buffer_from","nbfs","from","e","buf","enc","bind","new_raw_buf","alloc","Uint8Array","Array","new_unsafe_buf","allocUnsafe","s2a","s","split","map","s2ab","ArrayBuffer","view","a2s","isArray","c","ab2a","Error","bconcat","bufs","concat","isBuffer","maxlen","set","apply","call","chr0","chr1","_strrev","pad0","v","d","t","fill","pad_","rpad_","p2_32","Math","pow","pad0r","round","pad0r1","pad0r2","SSF_isgeneral","days","months","table_fmt","SSF_default_map","SSF_default_str","SSF_frac","D","mixed","sgn","B","P_2","P_1","P","Q_2","Q_1","Q","A","floor","q","SSF_parse_date_code","opts","b2","date","time","dow","dout","out","T","u","y","m","H","M","S","abs","date1904","Date","setDate","getDate","getFullYear","getMonth","getDay","SSF_fix_hijri","SSFbasedate","SSFdnthresh","getTime","SSFbase1904","datenum_local","epoch","getTimezoneOffset","SSF_strip_decimal","SSF_general_num","V","log","LOG10E","toPrecision","w","toFixed","toExponential","SSF_small_exp","substr","SSF_large_exp","SSF_normalize_exp","toUpperCase","SSF_general","toString","SSF_format","SSF_write_date","type","fmt","val","ss0","ss","tt","outl","commaify","j","pct1","write_num_exp","idx","match","period","ee","fakee","$$","$1","$2","$3","frac1","dec1","closeparen","phone","hashq","str","cc","rnd","dd","dec","_frac","write_num_flt","ffmt","write_num","write_num_cm","sfmt","mul","write_num_pct","r","ri","ff","aval","sign","den","parseInt","rr","base","myn","myd","write_num_f1","carry","oa","min","max","lres","rres","flr","write_num_exp2","write_num_int","write_num_cm2","write_num_pct2","write_num_f2","lastIndexOf","SSF_abstime","fmt_is_date","cfregex2","chkcond","thresh","parseFloat","choose_fmt","f","in_str","SSF_split_fmt","l","lat","m1","m2","dateNF","table","flen","dt","lst","hr","toLowerCase","ssm","bt","jj","nstr","myv","ostr","vv","decpt","lasti","retval","eval_fmt","SSF_load","undefined","SSF_load_table","tbl","make_ssf","SSF","format","load","_table","load_table","parse_date_code","is_date","get_table","SSFImplicit","dateNFregex","CRC32","version","T0","n","Int32Array","signed_crc_table","TT","subarray","slice_by_16_tables","T1","T2","T3","T4","T5","T6","T7","T8","T9","Ta","Tb","Tc","Td","Te","Tf","bstr","seed","C","L","CFB","fs","exports","dirname","p","filename","write_dos_date","hms","getHours","getMinutes","getSeconds","write_shift","ymd","parse_extra_field","blob","prep_blob","flags","read_shift","sz","tgt","mtime","atime","ctime","mt","get_fs","parse","file","options","parse_zip","root","di","row","test","mboundary","boundary","FileIndex","FullPaths","init_cfb","start_di","fcnt","line","parse_mime","parse_mad","mver","nmfs","difat_sec_cnt","dir_start","minifat_start","difat_start","ssz","fat_addrs","mv","chk","HEADER_SIGNATURE","check_get_mver","header","shift","check_shifts","dir_cnt","sectors","nsectors","ceil","sectorify","sleuth_fat","sector_list","sl","chkd","buf_chain","modulus","k","seen","push","addr","__readInt32LE","nodes","__toBuffer","make_sector_list","name","ENDOFCHAIN","Paths","files","mini","minifat_store","pl","sector","namelen","__utf16le","color","R","clsid","state","start","size","ct","read_date","storage","get_sector_list","content","get_mfat_entry","read_directory","FI","FP","dad","build_full_paths","raw","entry","payload","MSSZ","new_buf","cnt","offset","__readUInt32LE","cfb","CLSID","nm","find","rebuild_cfb","seed_cfb","gc","_file","pop","now","fullPaths","Object","create","HEADER_CLSID","sort","Z","namecmp","elt","_write","_opts","fileType","fp","fi","ca","cstr","dispcnt","csl","qp","get_content_type","write_quoted_printable","write_base64_76","write_mad","cdirs","method","compression","start_cd","crcs","sz_cd","namebuf","outbuf","_deflateRawSync","write_zip","mini_size","fat_size","mfat_cnt","fat_base","fat_cnt","difat_cnt","HEADER_SIG","chainit","consts","DIFSECT","FATSECT","_nm","copy","_zlib","MAXREGSECT","FREESECT","HEADER_MINOR_VERSION","MAXREGSID","NOSTREAM","EntryTypes","deflateRawSync","_deflate","CLEN_ORDER","LEN_LN","DST_LN","use_typed_arrays","bitswap8","bit_swap_n","b","rev","read_bits_2","bl","h","read_bits_3","read_bits_5","read_bits_7","read_bits_n","write_bits_3","write_bits_1","write_bits_8","write_bits_16","realloc","a","zero_fill_array","build_tree","clens","cmap","MAX","ccode","bl_count","Uint16Array","ctree","cleni","fix_lmap","fix_dmap","dlens","_deflateRaw","DST_LN_RE","LEN_LN_RE","boff","write_stored","addrs","hash","mlen","len_eb","dst_eb","write_huff_fixed","off","dyn_lmap","dyn_dmap","dyn_cmap","dyn_len_1","dyn_len_2","dyn","_HLIT","_HDIST","_HCLEN","read_bits_4","next_code","hcodes","h1","h2","_inflate","usz","woff","OL","max_len_1","max_len_2","bits","code","dst","inflate","warn_or_throw","wrn","msg","console","error","csz","efsz","fcsz","EF","parse_local_file","meth","setMilliseconds","setFullYear","setMonth","setHours","setMinutes","setSeconds","parse_dos_date","_csz","_usz","ef","InflRaw","InflateRaw","_processChunk","_finishFlushFlag","bytesRead","_inflateRawSync","cfb_add","unsafe","ContentTypeMap","ctype","ext","text","encoded","si","end","tmp","fdata","fname","cte","trim","oi","parse_quoted_printable","fpath","cfb_gc","path","UCFullPaths","UCPaths","UCPath","read","readFileSync","read_file","write","writeFileSync","writeFile","cfb_new","cfb_del","splice","cfb_mov","old_name","new_name","ReadShift","CheckField","use_zlib","zlib","message","_inflateRaw","_fs","set_fs","blobify","a2u","write_dl","Deno","TextEncoder","encode","utf8write","IE_SaveFile","Blob","navigator","msSaveBlob","saveAs","URL","document","createElement","createObjectURL","url","chrome","downloads","download","revokeObjectURL","setTimeout","href","body","appendChild","click","removeChild","$","File","Folder","open","encoding","close","keys","ks","o2","prototype","hasOwnProperty","evert_key","obj","key","K","evert","evert_num","basedate","datenum","refdate","dnthresh","refoffset","numdate","setTime","parse_isodur","sec","good_pd_date_1","good_pd_date","good_pd","parseDate","fixdate","cc2str","arr","debomit","TextDecoder","dup","JSON","stringify","fuzzynum","Number","isFinite","NaN","wt","lower_months","fuzzydate","getYear","lower","split_regex","safe_split_regex","re","def","getdatastr","asNodeBuffer","asBinary","_data","getContent","getdatabin","safegetzipfile","zip","g","getzipfile","getzipdata","safe","getzipstr","getzipbin","zipentries","zip_add_file","res","widx","ridx","utf8decode","zip_new","zip_read","resolve_path","result","target","step","XML_HEADER","attregexg","tagregex1","tagregex","nsregex","nsregex2","parsexmltag","tag","skip_root","skip_LC","z","eq","quot","strip_ns","encodings","rencoding","unescapexml","encregex","coderegex","decregex","charegex","escapexml","escapexmltag","htmlcharegex","escapehtml","xlml_fixstr","entregex","entrepl","parsexmlbool","value","utf8reada","orig","utf8readb","ww","utf8readc","utf8corpus","utf8read","matchtag","mtcache","RegExp","htmldecode","entities","vtregex","vt_cache","vtvregex","vtmregex","parseVector","matches","baseType","WTF","forEach","wtregex","writetag","wxt_helper","writextag","write_w3cdtf","toISOString","xlml_normalize","xlmlregex","XMLNS","XMLNS_main","XLMLNS","___toBuffer","___utf16le","__readUInt16LE","___hexlify","__hexlify","___utf8","__readUInt8","__utf8","___lpstr","__lpstr","___cpstr","__cpstr","___lpwstr","__lpwstr","___lpp4","__lpp4","___8lpp4","__8lpp4","___double","Infinity","read_double_le","__double","is_buf","readUInt32LE","readDoubleLE","__readInt16LE","__readInt32BE","oI","oR","loc","oo","this","lens","__writeUInt16LE","WriteShift","cppayload","__writeUInt32LE","bs","av","LN2","write_double_le","__writeInt32LE","hexstr","fld","pos","parsenoop","recordhopper","cb","tmpbyte","cntbyte","RT","XLSBRecordEnum","buf_array","blksz","newblk","curbuf","endbuf","next","_bufs","write_record","ba","shift_cell_xls","cell","cRel","rRel","biff","shift_range_xls","range","encode_cell_xls","encode_cell","fix_row","encode_range_xls","encode_row","encode_col","decode_row","rowstr","decode_col","colstr","col","decode_cell","decode_range","encode_range","cs","ce","safe_decode_range","safe_format_cell","XF","numFmtId","format_cell","BErr","sheet_to_workbook","sheet","sheets","SheetNames","Sheets","sheet_add_aoa","_ws","dense","ws","_R","_C","origin","_origin","_range","__R","__C","nullError","sheetStubs","cellDates","cell_ref","aoa_to_sheet","write_UInt32LE","parse_XLWideString","cchCharacters","write_XLWideString","_null","parse_StrRun","ich","ifnt","parse_RichStr","rgsStrRun","dwSizeStrRun","parse_BrtCommentText","write_BrtCommentText","run","write_StrRun","parse_XLSBCell","iStyleRef","write_XLSBCell","parse_XLSBShortCell","write_XLSBShortCell","parse_XLSBCodeName","write_XLSBCodeName","parse_XLNullableWideString","write_XLNullableWideString","parse_XLNameWideString","parse_RelID","write_RelID","parse_RkNumber","fX100","fInt","RK","write_RkNumber","d100","parse_RfX","parse_UncheckedRfX","write_UncheckedRfX","parse_Xnum","write_Xnum","write_BrtColor","auto","index","theme","nTS","tint","rgb","parse_ClipboardFormatOrString","VT_STRING","VT_CUSTOM","DocSummaryPIDDSI","SummaryPIDSI","CountryEnum","XLSFillPattern","rgbify","XLSIcv","RBErr","ct2type","CT_LIST","workbooks","xlsx","xlsm","xlsb","xlam","xltx","strs","comments","charts","dialogs","macros","metadata","styles","write_ct","type2ct","evert_arr","f1","bookType","f2","f3","RELS","WB","SHEET","HLINK","VML","XPATH","XMISS","XLINK","CXML","CXMLP","CMNT","CORE_PROPS","EXT_PROPS","CUST_PROPS","SST","STY","THEME","CHART","CHARTEX","CS","WS","DS","MS","IMG","DRAW","XLMETA","TCMNT","PEOPLE","VBA","get_rels_path","parse_rels","currentFilePath","rels","rel","Type","Target","Id","TargetMode","canonictarget","write_rels","rid","add_rels","rId","relobj","targetmode","write_rdf_type","write_meta_ods","CORE_PROPS_REGEX","parse_core_props","cur","cp_doit","write_core_props","Props","CreatedDate","ModifiedDate","PseudoPropsPairs","load_props_pairs","HP","TOP","props","hp","parts","Worksheets","NamedRanges","DefinedNames","Chartsheets","ChartNames","write_ext_props","W","Application","custregex","write_cust_props","pid","write_vt","evert_XLMLDPM","XLMLDocPropsMap","Title","Subject","Author","Keywords","Comments","LastAuthor","RevNumber","LastPrinted","Category","Manager","Company","AppVersion","ContentStatus","Identifier","Language","xlml_set_prop","parse_FILETIME","dwLowDateTime","dwHighDateTime","parse_lpstr","pad","parse_lpwstr","parse_VtStringBase","stringType","parse_VtString","parse_VtHeadingPair","headingString","parse_TypedPropertyValue","parse_dictionary","CodePage","dict","parse_BLOB","bytes","ret","Size","parse_ClipboardData","parse_VtUnalignedString","cElements","parse_VtVecHeadingPairValue","parse_VtVecLpwstrValue","parse_VtVecUnalignedLpstrValue","write_TypedPropertyValue","write_FILETIME","parse_PropertySet","PIDSI","start_addr","NumProps","Dictionary","DictObj","PropID","Offset","PropH","fail","piddsi","oldpos","parsebool","XLSPSSkip","guess_property_type","write_PropertySet","entries","RE","hdr","piao","prop","pr","pio","unshift","pinfo","parse_PropertySetStream","NumSets","FMTID0","FMTID1","Offset0","Offset1","SystemIdentifier","PSet1","PSet0","rval","FMTID","write_PropertySetStream","entries2","clsid2","ps0","ps1","parsenoop2","writebool","parseuint16","writeuint16","parseuint16a","parslurp","write_Bes","parse_ShortXLUnicodeString","cch","parse_XLUnicodeRichExtendedString","cbExtRst","fExtSt","fRichSt","width","cRun","write_XLUnicodeRichExtendedString","xlstr","otext","parse_XLUnicodeStringNoCch","parse_XLUnicodeString","parse_XLUnicodeString2","write_XLUnicodeString","parse_HyperlinkMoniker","extra","parse_URLMoniker","cAnti","preamble","ansiPath","parse_FileMoniker","parse_HyperlinkString","write_HyperlinkString","write_Hyperlink","hl","hashidx","F","Pretarget","parse_LongRGBA","parse_LongRGB","parse_XLSCell","ixfe","write_XLSCell","parse_XTI","parse_RkRec","parse_Ref8U","rwFirst","rwLast","write_Ref8U","parse_RefU","parse_Ref","parse_FtCmo","ot","id","parse_FtSkip","FtTab","cf","fSharedNote","parse_BOF","BIFFVer","write_BOF","wb","write_BoundSheet8","hs","parse_DefaultRowHeight","miyRw","Unsynced","DyZero","ExAsc","ExDsc","write_Format","b5","parse_BIFF2Format","parse_Dimensions","write_XF","ixfeP","style","parse_BoolErr","parse_Bes","parse_XLHeaderFooter","parse_ExternName","fBuiltIn","fWantAdvise","fWantPict","fOle","fOleLink","fIcon","sbcch","udfName","parse_AddinUdf","Name","XLSLblBuiltIn","parse_Lbl","chKey","cce","itab","npflen","rgce","rgcb","parse_Rgce","parse_RgbExtra","parse_NameParsedFormula","parse_ExternSheet","parse_BIFF5ExternSheet","parse_Array","ref","parse_ArrayParsedFormula","parse_BIFF5OT","cchName","write_HLink","O","write_HLinkTooltip","Tooltip","parse_ColInfo","cellStyles","colFirst","colLast","coldx","level","parse_Blank","parse_Scl","parse_String","DBF_SUPPORTED_VERSIONS","DBF","dbf_codepage_map","dbf_reverse_map","dbf_to_sheet","ft","memo","vfp","l7","nrow","fpos","rlen","current_cp","codepage","fields","field","hend","sheetRows","dbf_to_aoa","wch","_RLEN","to_workbook","to_sheet","from_sheet","aoa","sheet_to_json","headers","cols","hcnt","coltypes","colwidths","coldecimals","guess","_guess","hf","_f","hb","rout","_n","_s","SYLK","sylk_escapes","AA","BA","CA","DA","HA","JA","AE","BE","CE","HE","AI","BI","CI","HI","AO","BO","CO","DO","HO","AU","BU","CU","HU","Aa","Ba","Ca","Da","Ha","Ja","Ae","Be","Ce","He","Ai","Bi","Ci","Hi","Ao","Bo","Co","Do","Ho","Au","Bu","Cu","Hu","KC","Kc","DN","Dn","Hy","sylk_char_regex","sylk_char_fn","_","decode_sylk_char","newcc","sylk_to_aoa_str","records","rj","formats","next_cell_format","sht","rowinfo","colinfo","cw","Mval","rstr","record","C_seen_K","C_seen_X","C_seen_S","C_seen_E","formula","rc_to_a1","shrbase","shift_formula_str","F_seen","hidden","process_col","hpt","hpx","pt2px","sylk_to_sheet","aoasht","sylk_to_aoa","write_ws_cell_sylk","a1_to_rc","RS","rec","wpx","width2px","px2char","rows","px2pt","write_ws_rows_sylk","coord","DIF","dif_to_aoa_str","dif_to_sheet","dif_to_aoa","push_field","topic","push_value","ETH","eth_to_sheet","eth_to_aoa","sep","meta","sheet_to_eth_data","PRN","set_text_arr","guess_seps","guess_sep_weights","guess_sep","instr","dsv_to_sheet_str","FS","sepcc","startcc","_re","finish_cell","Y","datestr","timestr","dateNF_fix","cellText","cellNF","outer","prn_to_sheet_str","lines","prn_to_aoa_str","prn_to_sheet","firstbyte","WK_","lotushopper","Enum","WK1Enum","lotus_to_workbook_buf","next_n","sidx","snames","realnames","refguess","vers","qpro","tmpcell","WK3Enum","osheets","rnames","parse_cell","parse_LABEL","write_LABEL","write_INTEGER","write_NUMBER","wk1_parse_rc","FuncTab","BinOpTab","parse_cell_3","write_LABEL_16","wsidx","parse_NUMBER_17","v1","v2","write_NUMBER_17","log2","parse_NUMBER_27","parse_SHEETNAMECS","write_XFORMAT_SHEETNAME","argc","argL","argR","args","wk1_fmla_to_csf","sheet_to_wk1","write_biff_rec","write_RANGE","max_R","book_to_wk3","wscnt","write_BOF_WK3","parse_rs","tregex","rpregex","parse_r","rpr","font","pass","shadow","outline","strike","uval","family","valign","parse_rpr","rregex","rend","rs","filter","rs_to_html","nlregex","r_to_html","terms","intro","outro","align","parse_rpr2","sitregex","sirregex","sirphregex","parse_si","html","cellHTML","sstr0","sstr1","sstr2","straywsregex","write_sst_xml","sst","bookSST","xmlns","count","Count","uniqueCount","Unique","sitag","write_BrtSSTItem","write_sst_bin","write_BrtBeginSst","_JS2ANSI","parse_CRYPTOVersion","Major","Minor","parse_DataSpaceMapEntry","comps","parse_Primary","U","parse_TransformInfoHeader","ename","cmode","parse_EncryptionHeader","Flags","AlgID","valid","AlgIDHash","KeySize","ProviderType","CSPName","parse_EncryptionVerifier","Salt","Verifier","VerifierHash","parse_EncInfoStd","parse_EncInfoExt","parse_EncInfoAgl","KeyData","xml","encryptedHmacKey","encryptedHmacValue","encs","uri","crypto_CreatePasswordVerifier_Method1","Password","PasswordArray","PasswordDecoded","crypto_CreateXorArray_Method1","PadArray","InitialCode","XorMatrix","XorRor","byte1","byte2","Byte","password","Temp","PasswordLastChar","PadIndex","XorKey","CurrentElement","Char","CreateXorKey_Method1","Index","ObfuscationArray","crypto_MakeXorDecryptor","XorArrayIndex","XorArray","Data","Value","crypto_DecryptData_Method1","parse_FilePassHeader","Info","EncryptionVersionInfo","EncryptedVerifier","EncryptedVerifierHash","parse_RC4Header","EncryptionHeader","EncryptionVerifier","parse_RC4CryptoHeader","RTF","rtf_to_sheet","rtf_to_sheet_str","rowtf","rtfre","last_index","exec","lastIndex","rgb2Hex","rgb_tint","hex","hsl","G","H6","L2","rgb2HSL","X","h6","hsl2RGB","MDW","px","char2width","chr","cycle_width","collw","find_mdw_colw","delta","_MDW","coll","customWidth","pt","XLMLPatternTypeMap","cellXF_uint","cellXF_bool","parse_sty_xml","numFmtRegex","cellXfRegex","fillsRegex","fontsRegex","bordersRegex","themes","NumberFmt","formatCode","parse_numFmts","Fonts","bold","italic","underline","condense","extend","vertAlign","scheme","indexed","icv","themeElements","clrScheme","parse_fonts","Fills","patternType","bgColor","fgColor","parse_fills","Borders","border","diagonalUp","diagonalDown","parse_borders","xf","CellXf","alignment","vertical","horizontal","textRotation","indent","wrapText","parse_cellXfs","write_sty_xml","NF","write_numFmts","cellXfs","write_cellXfs","write_BrtFmt","write_BrtFont","grbit","write_FontFlags","sss","charset","rev_XLSBFillPTNames","XLSBFillPTNames","parse_BrtFill","write_BrtFill","fls","write_BrtXF","write_Blxf","parse_BrtBorder","write_BORDERS_bin","write_STYLES_bin","xfId","builtinId","write_TABLESTYLES_bin","defTableStyle","defPivotStyle","write_BrtBeginTableStyles","write_sty_bin","write_FMTS_bin","write_FONTS_bin","write_FILLS_bin","fontId","fillId","borderId","write_CELLSTYLEXFS_bin","write_CELLXFS_bin","write_DXFS_bin","XLSXThemeClrScheme","parse_clrScheme","lastClr","parse_fontScheme","parse_fmtScheme","clrsregex","fntsregex","fmtsregex","themeltregex","parse_theme_xml","write_theme","parse_themeElements","Themes","themeXLSX","parse_FullColorExt","xclrType","nTintShade","xclrValue","parse_IcvXF","parse_ColorTheme","parse_ExtProp","extType","parse_XFExtGradient","write_xlmeta_bin","write_BrtBeginEsfmd","cm","write_BrtBeginEsmdb","mdb","write_BrtMdb","write_xlmeta_xml","_shapeid","write_comments_vml","csize","bbox","joinstyle","gradientshapeok","coordsize","fillopts","angle","fillparm","fillxml","fillcolor","strokecolor","on","sheet_insert_comments","threaded","people","comment","author","write_comments_xml","iauthor","ID","lastauthor","ts","write_tcmnt_xml","carr","rootid","tcopts","tcid","parentId","personId","parse_BrtCommentAuthor","write_comments_bin","write_BrtCommentAuthor","write_BrtBeginComment","VBAFMTS","rcregex","rcbase","rcfunc","fstr","crefregex","$0","$4","$5","shift_formula_xlsx","_xlfn","parseread1","parse_ColRelU","parse_RgceArea","parse_RgceArea_BIFF2","parse_RgceLoc","parse_RgceLoc_BIFF2","parse_RgceElfLoc","fQuoted","parse_PtgAttrBaxcel","bitSemi","parse_PtgAttrSpaceType","parse_SerAr","parse_PtgExtraMem","parse_PtgExtraArray","parse_PtgElfLoc","parse_PtgElfNoop","parse_PtgElfLel","PtgListRT","PtgTypes","iftab","FtabArgc","Ftab","cparams","tab","parsetab","Cetab","nameindex","rl","parse_RgceLocRel_BIFF2","cl","parse_RgceLocRel","area","parse_RgceAreaRel","ixti","parse_PtgNameX_BIFF5","PtgDupes","Ptg18","coltype","rt","Ptg19","bitIf","bitGoto","ptgs","stringify_array","PtgBinOp","PtgAdd","PtgConcat","PtgDiv","PtgEq","PtgGe","PtgGt","PtgLe","PtgLt","PtgMul","PtgNe","PtgPower","PtgSub","get_ixti_raw","supbooks","XTI","SID","get_ixti","ixtiraw","sname","formula_quote_sheet_name","stringify_formula","stack","nameidx","last_sp","sp","fflen","func","lbl","names","xlfn","externbook","bookidx","ixtidata","lp","rp","sharedf","parsedf","fnd","arrayf","_left","parse_SharedParsedFormula","parse_Formula","parse_FormulaValue","cbf","parse_XLSCellParsedFormula","shared","write_Formula","os","o1","write_FormulaValue","o3","bf","parse_XLSBParsedFormula","parse_XLSBArrayParsedFormula","parse_XLSBCellParsedFormula","parse_XLSBNameParsedFormula","parse_XLSBSharedParsedFormula","ods_to_csf_formula","ods_to_csf_3D","_ssfopts","browser_has_Map","Map","get_sst_id","has","revarr","get","col_obj_w","outlineLevel","default_margins","margins","mode","defs","left","right","top","bottom","footer","get_cell_style","revssf","ssf","applyNumberFormat","safe_format","fmtid","fillid","raw_rgb","check_ws","mergecregex","sheetdataregex","hlinkregex","dimregex","colregex","afregex","marginregex","sheetprregex","sheetprregex2","svsregex","parse_ws_xml","data1","data2","mtch","sheetPr","parse_ws_xml_sheetpr","parse_ws_xml_sheetpr2","parse_ws_xml_dim","svs","Views","sviewregex","zoomScale","zoom","rightToLeft","RTL","parse_ws_xml_sheetviews","columns","seencol","coli","colm","colM","parse_ws_xml_cols","parse_ws_xml_data","afilter","parse_ws_xml_autofilter","merges","_merge","hlink","location","Rel","tooltip","rng","parse_ws_xml_hlinks","margin","tmpref","codeName","CodeName","sheetprot_deffalse","sheetprot_deftrue","write_ws_xml_cell","oldt","oldv","Strings","revStrings","cellregex","rowregex","isregex","refregex","match_v","match_f","sdata","sstr","ftag","cells","cref","tagr","tagc","do_format","rowobj","rowrite","marr","marrlen","xlen","rstarti","outa","ht","rslice","cellFormula","___f","_tag","xlmeta","Cell","_r","write_ws_xml","rdata","_drawing","needed","vbaraw","cname","Workbook","outlineprops","summaryBelow","summaryRight","above","write_ws_xml_sheetpr","sview","workbookViewId","write_ws_xml_sheetviews","sheetFormat","defaultRowHeight","baseColWidth","outlineLevelRow","write_ws_xml_cols","params","height","_cell","customHeight","write_ws_xml_data","write_ws_xml_protection","Names","Sheet","Ref","write_ws_xml_autofilter","write_ws_xml_merges","relc","ignoreEC","numberStoredAsText","sqref","write_row_header","ncolspan","lcs","caddr","first","last","write_BrtRowHdr","parse_BrtWsDim","write_BrtWsDim","parse_BrtShortReal","parse_BrtMergeCell","write_BrtMergeCell","BrtMarginKeys","write_ws_bin_cell","last_seen","ncell","write_BrtShortIsst","write_BrtCellIsst","write_BrtShortSt","write_BrtCellSt","write_BrtShortRk","write_BrtCellRk","write_BrtShortReal","write_BrtCellReal","write_BrtShortBool","write_BrtCellBool","write_BrtShortError","write_BrtCellError","write_BrtShortBlank","write_BrtCellBlank","write_MERGECELLS","write_COLINFOS","write_BrtColInfo","write_IGNOREECS","write_HLINKS","locidx","write_BrtHLink","write_WSVIEWS2","write_BrtBeginWsView","write_SHEETPROTECT","write_ws_bin","write_BrtWsProp","cap","write_CELLTABLE","write_AUTOFILTER","write_LEGACYDRAWING","parse_chart","csheet","nc","cache","num","nf","parse_Cache","WBPropsDef","WBViewDef","SheetDef","CalcPrDef","push_defaults_array","defaults","push_defaults","parse_wb_defaults","WBProps","CalcPr","WBView","badchars","check_ws_name","_good","check_wb","N","codes","cn","wbnsregex","write_wb_xml","write_names","workbookPr","Hidden","sheetId","Comment","localSheetId","parse_BrtFRTArchID$","ArchID","write_BOOKVIEWS","vistab","write_wb_bin","write_BrtFileVersion","filterPrivacy","write_BrtWbProp","iTabID","strRelID","write_BrtBundleSh","write_BUNDLESHS","parse_wb","Ptg","parse_wb_bin","dname","dnstart","parse_wb_xml","parse_ws","ai","af","vm","RR","aii","_d","relId","rfx","parse_ws_bin","parse_cs","parse_cs_bin","parse_cs_xml","parse_sty","parse_sty_bin","parse_sst","parse_sst_bin","parse_sst_xml","parse_cmnt","authors","parse_comments_bin","commentList","authtag","cmnttag","authorId","guid","textMatch","parse_comments_xml","parse_cc","parse_cc_bin","parse_cc_xml","parse_xlink","parse_xlink_bin","parse_xlmeta","Types","metatype","parse_xlmeta_bin","lastmeta","offsets","parse_xlmeta_xml","write_ws","write_cmnt","XLMLFormatMap","attregexg2","attregex2","xlml_parsexmltag","words","xlml_parsexmltagobj","xlml_set_custprop","Custprops","oval","safe_format_xlml","process_style_xlml","stag","Interior","I","Pattern","parse_xlml_data","csty","sid","StyleID","interiors","Parent","UTC","Formula","ArrayRange","xlml_clean_comment","parse_xlml_xml","Rn","opening","ishtml","_o","html_to_sheet","book_append_sheet","html_to_workbook","sheetnames","cursheet","sheetname","dtag","didx","fidx","pidx","cstys","wsprops","raw_Rn3","HRef","HRefScreenTip","MergeAcross","MergeDown","cma","cmd","AutoFitHeight","Height","Format","ssfidx","Width","_col","Span","_NamedRange","_DefinedName","RefersTo","AutoFilter","Range","parse_fods","Margin","pagemargins","Top","Left","Right","Bottom","bookSheets","bookProps","parse_xlml","fix_read_opts","write_props_xlml","xlml_write_docprops","BLACKLIST","xlml_write_custprops","write_name_xlml","write_ws_xlml_cell","attr","mi","_v","write_ws_xlml_row","write_ws_xlml","write_ws_xlml_names","skip","write_ws_xlml_table","objects","scenarios","selectLockedCells","selectUnlockedCells","write_ws_xlml_wsopts","write_xlml","write_sty_xlml","write_names_xlml","parse_compobj","AnsiUserType","AnsiClipboardFormat","parse_ClipboardFormatOrAnsiString","Reserved1","UnicodeClipboardFormat","parse_ClipboardFormatOrUnicodeString","Reserved2","CONTINUE_RT","slurp","RecordType","insitu","nextrt","XLSRecordEnum","ll","safe_format_xf","make_cell","parse_workbook","lastcell","cmnt","rngC","rngR","temp_val","country","Directory","last_formula","cur_sheet","Preamble","last_cell","XFs","palette","get_rgb","addcell","file_depth","xfd","icvFore","icvBack","process_cell_style","afi","rrtabid","lastuser","winlocked","wtf","last_lbl","last_RT","BIFF2Fmt","BIFF2FmtTable","FilterDatabases","seen_codepage","Date1904","WriteProtect","cpval","CalcRefMode","FullCalc","fDialog","fBelow","fRight","ExternCount","tmpri","biffguess","fakebs8","rknum","rkrec","_fr","_fc","_fe","_arraystart","isst","_j","_ixfe","b4idx","b2idx","cmo","lastobj","TxO","ImData","noteobj","xfe","Encryption","Metadata","Country","PSCLSID","parse_xlscfb","CompObj","WorkbookP","bookVBA","newcfb","newpath","make_vba_xls","DSI","DocSummary","SI","Summary","HeadingPairs","TitlesOfParts","parse_xls_props","bookFiles","write_xlscfb","wbpath","write_biff_buf","Keys","DSEntries","SEntries","CEntries","DocSummaryRE","SummaryRE","CEntries2","write_xls_props","vba","fill_vba_xls","fBold","fItalic","fUnderline","fStrikeout","fOutline","fShadow","fCondense","fExtend","parse_FontFlags","bCharSet","xColorType","bR","bG","bB","parse_BrtColor","ixfeParent","ifmt","defaultThemeVersion","strName","autoCompressPictures","backupFile","checkCompatibility","hidePivotFieldList","promptedSolutions","publishItems","refreshAllConnections","saveExternalLinkValues","showBorderUnselectedTables","showInkAnnotation","showObjects","showPivotChartFilter","updateLinks","fAlwaysCalc","display","idObj","stAuthor","parse_NoteSh","verificationBytes","verifier","parse_XORObfuscation","dyHeight","fl","Pos","Dim","CurTab","FirstTab","Selected","TabRatio","UserName","fts","parse_BIFF5Obj","parse_FtArray","ccv","rw","rkrecs","lastcol","ixfes","fStyle","alc","fWrap","alcV","fJustLast","trot","cIndent","fShrinkToFit","iReadOrder","fAtrNum","fAtrFnt","fAtrAlc","fAtrBdr","fAtrPat","fAtrProt","dgLeft","dgRight","dgTop","dgBottom","icvLeft","icvRight","grbitDiag","icvTop","icvBottom","icvDiag","dgDiag","fsxButton","parse_CellStyleXF","cmcs","ucnt","extsst","dsst","ctab","virtPath","rgst","texts","accel","parse_ControlInfo","cchText","sVer","displayName","targetFrameName","moniker","oleMoniker","fileTime","Loc","parse_Hyperlink","xnum","cUse","wzTooltip","cxfs","crc","cexts","cchComment","themeXML","parse_frtHeader","env","lcb","write_BIFF2Cell","write_ws_biff2_cell","write_BIFF2NUM","write_BIFF2BERR","write_BIFF2LABEL","write_biff2_buf","write_ws_biff2","write_FONTS_biff8","write_Font","write_ws_cols_biff8","write_ColInfo","write_ws_biff8_cell","write_Number","write_BoolErr","write_LabelSst","b8","write_Label","write_ws_biff8","guts","_WB","_sheet","MAX_ROWS","write_Dimensions","write_Window2","write_MergeCells","HL","write_ws_biff8_hlinks","write_FEAT","write_biff8_global","_sheets","_wb","writezeroes","write_WriteAccess","write_RRTabId","safe1904","write_FMTS_biff8","write_CELLXFS_biff8","write_Country","write_biff_continue","write_SST","blen","fix_write_opts","write_biff8_buf","mtch2","hd","midx","colspan","rowspan","_t","make_html_row","editable","HTML_BEGIN","HTML_END","make_html_preamble","sheet_to_html","sheet_add_dom","or_R","or_C","getElementsByTagName","is_dom_element_hidden","elts","children","hasAttribute","getAttribute","innerHTML","Aelts","Aelti","parse_dom_table","element","get_computed_style","ownerDocument","defaultView","getComputedStyle","get_get_computed_style_function","getPropertyValue","number_formats_ods","day","month","year","hours","minutes","seconds","era","quarter","parse_content_xml","sheetag","rowtag","fixed","NFtag","ctag","textp","textpidx","textR","row_ol","number_format_map","mrange","rowpeat","colpeat","atag","_Ref","creator","creatoridx","isstub","intable","rptR","rpt","nrange","ptp","parse_ods","FEtag","parse_manifest","write_styles_ods","master_styles","write_content_ods","null_cell_xml","ods","ROWS","_Fref","text_p","_tgt","fods","cidx","colobj","write_automatic_styles_ods","write_ods","manifest","rdf","write_rdf","write_manifest","u8_to_dataview","array","DataView","buffer","byteOffset","byteLength","u8str","u8","stru8","u8concat","u8a","reduce","acc","popcnt","parse_varint49","ptr","varint","write_varint49","varint_to_i32","i32","parse_shallow","write_shallow","proto","item","mappa","parse_iwa_file","_a","messages","merge","write_iwa_file","ias","ia","midata","aipayload","mid","parse_snappy_chunk","chunks","decompress_iwa_file","compress_iwa_file","frame","parse_new_storage","rsst","dv","getUint32","data_offset","d128","ieee","exp","mantissa","readDecimal128LE","getFloat64","write_new_storage","writeDecimal128LE","setFloat64","setUint32","write_old_storage","parse_cell_storage","parse_old_storage","parse_TSP_Reference","parse_TST_TableDataList","pb","le","rtp","rtpref","mtype","tswpsa","parse_TST_Tile","_b","_c","_e","_g","_h","_i","_k","_l","_m","used_storage_u8","used_storage","wide_offsets","used_storage_offsets","getUint16","parse_TST_TileRowInfo","nrows","parse_TST_TableInfoArchive","tableref","store","tile","tl","_tile","parse_TST_TableModelArchive","parse_TN_DocumentArchive","root2","parse_TN_SheetArchive","parse_numbers_iwa","indices","packets","packet","docroot","iwam","write_tile_row","tri","last_offset","cell_storage","_dv","_last_offset","_cell_storage","celload","_celload","setUint16","fix_opts_func","safe_parse_sheet","relsPath","sheetRels","stype","dfile","drelsp","draw","parse_drawing","chartp","crelsp","parse_ds","tcomments","tidx","parse_tcmnt_xml","strip_front_slash","_zip","binname","dir","threadedcomments","links","coreprops","extprops","custprops","calcchains","drawings","TODO","ctext","Extension","ContentType","PartName","calcchain","parse_ct","parse_theme","link","propdata","parse_ext_props","toks","warn","parse_cust_props","deps","bookDeps","wbsheets","wbext","wbrelsi","wbrelsfile","wbrels","displayname","parse_people_xml","safe_parse_wbrels","nmode","wsloop","snjseen","snj","Deps","Styles","bin","parse_xlsxcfb","dsm","parse_DataSpaceMap","seds","parse_DataSpaceDefinition","einfo","parse_EncryptionInfo","decrypt_agile","decrypt_std76","numbers","trunc","dependents","packet2","x2","y2","indices_varint","ivi","some","mess","search","u8contains","xi","sheetrootref","cruidsref","oldbucket","_x","cruids","uuid","row_header_ref","base_bucket","_bucket","col_header_ref","sstref","sstroot","sentry","sx","sxi","sstdata","newsst","raw32","tileref","tileroot","tentry","tx","tiledata","rowload","R2","tilerow","raw3","write_numbers_iwa","foo","vbafmt","_sn","wsrels","need_vml","rId1","write_sst","write_wb","write_sty","write_xlmeta","write_zip_xlsxb","write_zip_xlsx","needtc","person","userId","providerId","write_people_xml","read_plaintext","main","read_prn","readSync","infile","read_binary","bstrify","ab","vu","read_cfb","OLD_WTF","read_wb_ID","read_zip","read_utf16","read_plaintext_raw","write_cfb_ctr","write_zip_denouement","oopts","ftype","generate","encrypt_agile","write_string_type","bom","write_binary_type","writeSyncXLSX","write_zip_typeXLSX","writeSync","write_stxt_type","sheet_to_txt","sheet_to_csv","write_cfb_type","write_zip_type","resolve_book_type","writeFileSyncXLSX","writeFileAsync","_cb","Function","make_json_row","defval","isempty","defineProperty","enumerable","__rowNum__","rawNumbers","outi","counter","header_cnt","skipHidden","blankrows","qreg","make_csv_row","txt","forceQuotes","endregex","strip","sheet_add_json","js","skipHeader","JS","ws_get_cell_stub","RC","book_new","roll","cell_set_hyperlink","_Readable","split_cell","json_to_sheet","table_to_sheet","table_to_book","sheet_to_formulae","cmds","sheet_to_row_object_array","sheet_get_cell","book_set_sheet_visibility","sh","vis","wb_sheet_idx","cell_set_number_format","cell_set_internal_link","cell_add_comment","sheet_set_array_formula","dynamic","rngstr","SHEET_VISIBLE","SHEET_HIDDEN","SHEET_VERY_HIDDEN","__stream","to_json","stream","objectMode","_read","to_html","to_csv","BOM","set_readable"],"mappings":"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gBACL,IAAK,cACL,IAAK,eACL,IAAK,kBACL,IAAK,oBACL,IAAK,kBACL,IAAK,iBACL,IAAK,UACL,IAAK,YACL,IAAK,YACL,IAAK,aACL,IAAK,cACL,IAAK,UACL,IAAK,SACL,IAAK,cACL,IAAK,UACL,IAAK,oBACL,IAAK,kBACL,IAAK,QACL,IAAK,aACL,IAAK,YACL,IAAK,cACL,IAAK,mBACL,IAAK,oBACL,IAAK,cACL,IAAK,cACL,IAAK,mBACL,IAAK,eACL,IAAK,aACL,IAAK,eACL,IAAK,gBACL,IAAK,aACL,IAAK,cACL,IAAK,cACL,IAAK,iBACL,IAAK,YACL,IAAK,cACL,IAAK,eACL,IAAK,aACL,IAAK,aACL,IAAK,gBACL,IAAK,eACL,IAAK,kBACL,IAAK,gBACL,IAAK,qBACL,IAAK,WACL,IAAK,OACL,IAAK,gBACL,IAAK,kBACL,IAAK,aACL,IAAK,aACL,IAAK,eACL,IAAK,iBACL,IAAK,cACL,IAAK,iBACL,IAAK,qBACL,IAAK,YACL,IAAK,oBACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,WACL,IAAK,eACL,IAAK,gBACL,IAAK,gBACL,IAAK,mBACL,IAAK,iBACL,IAAK,eACL,IAAK,cACL,IAAK,YACL,IAAK,kBACL,IAAK,oBACL,IAAK,iBACL,IAAK,YACL,IAAK,aACL,IAAK,oBACL,IAAK,aACL,IAAK,eACL,IAAK,iBACL,IAAK,kBACL,IAAK,eACL,IAAK,gBACL,IAAK,gBACL,IAAK,qBACL,IAAK,mBACL,IAAK,qBACL,IAAK,yBACL,IAAK,cACL,IAAK,aACL,IAAK,mBACL,IAAK,sBACL,IAAK,eACL,IAAK,eACL,IAAK,gBACL,IAAK,cACL,IAAK,kBACL,IAAK,cACL,IAAK,gBACL,IAAK,kBACL,IAAK,2BACL,IAAK,eACL,IAAK,iBACL,IAAK,aACL,IAAK,iBACL,IAAK,YACL,IAAK,mBACL,IAAK,cACL,IAAK,wBACL,IAAK,kBACL,IAAK,qBACL,IAAK,kBACL,IAAK,kBACL,IAAK,kBACL,IAAK,qBACL,IAAK,aACL,IAAK,iBACL,IAAK,eACL,IAAK,mBACL,IAAK,aACL,IAAK,eACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,kBACL,IAAK,kBACL,IAAK,gBACL,IAAK,iBACL,IAAK,uBACL,IAAK,0BACL,IAAK,iBACL,IAAK,eACL,IAAK,YACL,IAAK,cACL,IAAK,aACL,IAAK,iBACL,IAAK,kBACL,IAAK,kBACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,qBACL,IAAK,cACL,IAAK,mBACL,IAAK,uBACL,IAAK,mBACL,IAAK,kBACL,IAAK,mBACL,IAAK,cACL,IAAK,iBACL,IAAK,kBACL,IAAK,eACL,IAAK,eACL,IAAK,oBACL,IAAK,sBACL,IAAK,sBACL,IAAK,mBACL,IAAK,qBACL,IAAK,qBACL,IAAK,gBACL,IAAK,aACL,IAAK,YACL,IAAK,cACL,IAAK,mBACL,IAAK,gBACL,IAAK,wBACL,IAAK,qBACL,IAAK,SACL,IAAK,kBACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,mBACL,IAAK,mBACL,IAAK,oBACL,IAAK,eACL,IAAK,oBACL,IAAK,uBACL,IAAK,cACL,IAAK,WACL,IAAK,WACL,IAAK,aACL,IAAK,aACL,IAAK,eACL,IAAK,eACL,IAAK,cACL,IAAK,qBACL,IAAK,yBACL,IAAK,mBACL,IAAK,WACL,IAAK,iBACL,IAAK,iBACL,IAAK,eACL,IAAK,YACL,IAAK,mBACL,IAAK,mBACL,IAAK,iBACL,IAAK,kBACL,IAAK,oBACL,IAAK,mBACL,IAAK,cACL,IAAK,gBACL,IAAK,WACL,IAAK,YACL,IAAK,cACL,IAAK,cACL,IAAK,mBACL,IAAK,oBACL,IAAK,iBACL,IAAK,YACL,IAAK,SACL,IAAK,SACL,IAAK,gBACL,IAAK,mBACL,IAAK,iBACL,IAAK,WACL,IAAK,gBACL,IAAK,gBACL,IAAK,cACL,IAAK,iBACL,IAAK,iBACL,IAAK,oBACL,IAAK,sBACL,IAAK,aACL,IAAK,cACL,IAAK,cACL,IAAK,oBACL,IAAK,eACL,IAAK,gBACL,IAAK,qBAEHJ,GAAO,CACT,EAAG,QACH,EAAG,KACH,EAAG,OACH,EAAG,UACH,EAAG,MACH,EAAG,UACH,EAAG,MACH,EAAG,MACH,EAAG,MACH,EAAG,SACH,GAAI,KACJ,GAAI,MACJ,GAAI,QACJ,GAAI,SACJ,GAAI,QACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,OACJ,GAAI,KACJ,GAAI,OACJ,GAAI,MACJ,GAAI,KACJ,GAAI,QACJ,GAAI,MACJ,GAAI,MACJ,GAAI,OACJ,GAAI,QACJ,GAAI,SACJ,GAAI,QACJ,GAAI,OACJ,GAAI,MACJ,GAAI,MACJ,GAAI,QACJ,GAAI,OACJ,GAAI,QACJ,GAAI,MACJ,GAAI,KACJ,GAAI,MACJ,GAAI,MACJ,GAAI,SACJ,GAAI,OACJ,GAAI,WACJ,GAAI,OACJ,GAAI,OACJ,GAAI,SACJ,GAAI,MACJ,GAAI,OACJ,GAAI,OACJ,GAAI,SACJ,GAAI,QACJ,GAAI,SACJ,GAAI,SACJ,GAAI,OACJ,GAAI,OACJ,GAAI,SACJ,GAAI,KACJ,GAAI,KACJ,GAAI,OACJ,GAAI,MACJ,GAAI,OACJ,GAAI,OACJ,GAAI,MACJ,GAAI,OACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,GAAI,MACJ,GAAI,QACJ,GAAI,OACJ,GAAI,UACJ,GAAI,OACJ,GAAI,SACJ,GAAI,SACJ,GAAI,MACJ,GAAI,QACJ,GAAI,OACJ,GAAI,UACJ,GAAI,SACJ,GAAI,SACJ,GAAI,SACJ,GAAI,WACJ,GAAI,SACJ,GAAI,YACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,GAAI,OACJ,GAAI,WACJ,GAAI,SACJ,GAAI,QACJ,GAAI,UACJ,GAAI,SACJ,GAAI,YACJ,GAAI,cACJ,GAAI,YACJ,GAAI,SACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,IAAK,SACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,cACL,IAAK,WACL,IAAK,YACL,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,UACL,IAAK,aACL,IAAK,OACL,IAAK,QACL,IAAK,YACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,IACL,IAAK,IACL,IAAK,QACL,IAAK,SACL,IAAK,QACL,IAAK,UACL,IAAK,QACL,IAAK,WACL,IAAK,SACL,IAAK,OACL,IAAK,YACL,IAAK,YACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,WACL,IAAK,OACL,IAAK,UACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,gBACL,IAAK,iBACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,iBACL,IAAK,aACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,aACL,IAAK,MACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,WACL,IAAK,UACL,IAAK,OACL,IAAK,UACL,IAAK,YACL,IAAK,UACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,OACL,IAAK,WACL,IAAK,gBACL,IAAK,aACL,IAAK,eACL,IAAK,WACL,IAAK,YACL,IAAK,WACL,IAAK,OACL,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,YACL,IAAK,UACL,IAAK,aACL,IAAK,aACL,IAAK,WACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,YACL,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,MACL,IAAK,OACL,IAAK,UACL,IAAK,SACL,IAAK,WACL,IAAK,SACL,IAAK,aACL,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,gBACL,IAAK,WACL,IAAK,aACL,IAAK,cACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,WACL,IAAK,OACL,IAAK,QACL,IAAK,aACL,IAAK,KACL,IAAK,QACL,IAAK,SACL,IAAK,YACL,IAAK,cACL,IAAK,iBACL,IAAK,OACL,IAAK,gBACL,IAAK,WACL,IAAK,cACL,IAAK,WACL,IAAK,iBACL,IAAK,aACL,IAAK,YACL,IAAK,eACL,IAAK,eACL,IAAK,cACL,IAAK,aACL,IAAK,cACL,IAAK,eACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,UACL,IAAK,YACL,IAAK,UACL,IAAK,SACL,IAAK,SACL,IAAK,aACL,IAAK,YACL,IAAK,OACL,IAAK,YACL,IAAK,QACL,IAAK,OACL,IAAK,SACL,IAAK,YACL,IAAK,QACL,IAAK,YACL,IAAK,WACL,IAAK,UACL,IAAK,cACL,IAAK,cACL,IAAK,SACL,IAAK,eACL,IAAK,WACL,IAAK,YACL,IAAK,UACL,IAAK,WACL,IAAK,cACL,IAAK,MACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,SACL,IAAK,QACL,IAAK,WACL,IAAK,QACL,IAAK,YACL,IAAK,UACL,IAAK,MACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,WACL,IAAK,aACL,IAAK,cACL,IAAK,OACL,IAAK,WACL,IAAK,OACL,IAAK,gBACL,IAAK,YACL,IAAK,cACL,IAAK,QACL,IAAK,iBACL,IAAK,kBACL,IAAK,kBACL,IAAK,iBACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,UACL,IAAK,aACL,IAAK,eACL,IAAK,oBACL,IAAK,QACL,IAAK,UACL,IAAK,aACL,IAAK,eACL,IAAK,QACL,IAAK,cACL,IAAK,cACL,IAAK,WACL,IAAK,eACL,IAAK,YACL,IAAK,WACL,IAAK,WACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,WACL,IAAK,gBACL,IAAK,YACL,IAAK,kBACL,IAAK,eACL,IAAK,gBACL,IAAK,mBACL,IAAK,cACL,IAAK,gBACL,IAAK,cACL,IAAK,WACL,IAAK,MACL,IAAK,YACL,IAAK,aACL,IAAK,qBACL,IAAK,mBACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,UACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,aACL,IAAK,cACL,IAAK,YACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,YACL,IAAK,YACL,IAAK,aACL,IAAK,SACL,IAAK,WACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,QACL,IAAK,SACL,IAAK,MACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,OACL,IAAK,OACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,WACL,IAAK,OACL,IAAK,YACL,IAAK,YACL,IAAK,UACL,IAAK,aACL,IAAK,aACL,IAAK,QACL,IAAK,QACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,YACL,IAAK,WACL,IAAK,aACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,cACL,IAAK,UACL,IAAK,YACL,IAAK,WACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,UACL,IAAK,cACL,IAAK,MACL,IAAK,cACL,IAAK,MACL,IAAK,aACL,IAAK,gBACL,IAAK,UACL,IAAK,eACL,IAAK,UACL,IAAK,WACL,IAAK,SACL,IAAK,YACL,IAAK,cAEHD,GAAW,CACb,EAAG,EACH,EAAG,EACH,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,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EAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEF,EAGA,IAEE,CAEAA,EAAG,GAIL,IAEE,CAEAA,GAAI,GAIN,IAEE,CAEAA,EAAG,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CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEF,EAGA,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEF,EAGA,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAEAA,EAAG,GAIL,KAEE,CAEAA,GAAI,GAIN,KAEE,CAE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","file":"674a26a7-863b8bf7fe8bc9bd965d.js","sourcesContent":["/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */\n\n/* vim: set ts=2: */\n\n/*exported XLSX */\n\n/*global process:false, Buffer:false, ArrayBuffer:false, DataView:false, Deno:false */\nvar XLSX = {};\nXLSX.version = '0.18.5';\nvar current_codepage = 1200,\n    current_ansi = 1252;\nvar VALID_ANSI = [874, 932, 936, 949, 950, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 10000];\n/* ECMA-376 Part I 18.4.1 charset to codepage mapping */\n\nvar CS2CP = {\n  /*::[*/\n  0\n  /*::]*/\n  : 1252,\n\n  /* ANSI */\n\n  /*::[*/\n  1\n  /*::]*/\n  : 65001,\n\n  /* DEFAULT */\n\n  /*::[*/\n  2\n  /*::]*/\n  : 65001,\n\n  /* SYMBOL */\n\n  /*::[*/\n  77\n  /*::]*/\n  : 10000,\n\n  /* MAC */\n\n  /*::[*/\n  128\n  /*::]*/\n  : 932,\n\n  /* SHIFTJIS */\n\n  /*::[*/\n  129\n  /*::]*/\n  : 949,\n\n  /* HANGUL */\n\n  /*::[*/\n  130\n  /*::]*/\n  : 1361,\n\n  /* JOHAB */\n\n  /*::[*/\n  134\n  /*::]*/\n  : 936,\n\n  /* GB2312 */\n\n  /*::[*/\n  136\n  /*::]*/\n  : 950,\n\n  /* CHINESEBIG5 */\n\n  /*::[*/\n  161\n  /*::]*/\n  : 1253,\n\n  /* GREEK */\n\n  /*::[*/\n  162\n  /*::]*/\n  : 1254,\n\n  /* TURKISH */\n\n  /*::[*/\n  163\n  /*::]*/\n  : 1258,\n\n  /* VIETNAMESE */\n\n  /*::[*/\n  177\n  /*::]*/\n  : 1255,\n\n  /* HEBREW */\n\n  /*::[*/\n  178\n  /*::]*/\n  : 1256,\n\n  /* ARABIC */\n\n  /*::[*/\n  186\n  /*::]*/\n  : 1257,\n\n  /* BALTIC */\n\n  /*::[*/\n  204\n  /*::]*/\n  : 1251,\n\n  /* RUSSIAN */\n\n  /*::[*/\n  222\n  /*::]*/\n  : 874,\n\n  /* THAI */\n\n  /*::[*/\n  238\n  /*::]*/\n  : 1250,\n\n  /* EASTEUROPE */\n\n  /*::[*/\n  255\n  /*::]*/\n  : 1252,\n\n  /* OEM */\n\n  /*::[*/\n  69\n  /*::]*/\n  : 6969\n  /* MISC */\n\n}\n/*:any*/\n;\n\nvar set_ansi = function (cp\n/*:number*/\n) {\n  if (VALID_ANSI.indexOf(cp) == -1) return;\n  current_ansi = CS2CP[0] = cp;\n};\n\nfunction reset_ansi() {\n  set_ansi(1252);\n}\n\nvar set_cp = function (cp\n/*:number*/\n) {\n  current_codepage = cp;\n  set_ansi(cp);\n};\n\nfunction reset_cp() {\n  set_cp(1200);\n  reset_ansi();\n}\n\nfunction char_codes(data\n/*:string*/\n)\n/*:Array<number>*/\n{\n  var o\n  /*:Array<number>*/\n  = [];\n\n  for (var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i);\n\n  return o;\n}\n\nfunction utf16leread(data\n/*:string*/\n)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < data.length >> 1; ++i) o[i] = String.fromCharCode(data.charCodeAt(2 * i) + (data.charCodeAt(2 * i + 1) << 8));\n\n  return o.join(\"\");\n}\n\nfunction utf16beread(data\n/*:string*/\n)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < data.length >> 1; ++i) o[i] = String.fromCharCode(data.charCodeAt(2 * i + 1) + (data.charCodeAt(2 * i) << 8));\n\n  return o.join(\"\");\n}\n\nvar debom = function (data\n/*:string*/\n)\n/*:string*/\n{\n  var c1 = data.charCodeAt(0),\n      c2 = data.charCodeAt(1);\n  if (c1 == 0xFF && c2 == 0xFE) return utf16leread(data.slice(2));\n  if (c1 == 0xFE && c2 == 0xFF) return utf16beread(data.slice(2));\n  if (c1 == 0xFEFF) return data.slice(1);\n  return data;\n};\n\nvar _getchar = function _gc1(x\n/*:number*/\n)\n/*:string*/\n{\n  return String.fromCharCode(x);\n};\n\nvar _getansi = function _ga1(x\n/*:number*/\n)\n/*:string*/\n{\n  return String.fromCharCode(x);\n};\n\nvar $cptable;\n\nfunction set_cptable(cptable) {\n  $cptable = cptable;\n\n  set_cp = function (cp\n  /*:number*/\n  ) {\n    current_codepage = cp;\n    set_ansi(cp);\n  };\n\n  debom = function (data\n  /*:string*/\n  ) {\n    if (data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) {\n      return $cptable.utils.decode(1200, char_codes(data.slice(2)));\n    }\n\n    return data;\n  };\n\n  _getchar = function _gc2(x\n  /*:number*/\n  )\n  /*:string*/\n  {\n    if (current_codepage === 1200) return String.fromCharCode(x);\n    return $cptable.utils.decode(current_codepage, [x & 255, x >> 8])[0];\n  };\n\n  _getansi = function _ga2(x\n  /*:number*/\n  )\n  /*:string*/\n  {\n    return $cptable.utils.decode(current_ansi, [x])[0];\n  };\n\n  cpdoit();\n}\n\nexport { set_cptable };\nvar DENSE = null;\nvar DIF_XL = true;\nvar Base64_map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\nfunction Base64_encode(input) {\n  var o = \"\";\n  var c1 = 0,\n      c2 = 0,\n      c3 = 0,\n      e1 = 0,\n      e2 = 0,\n      e3 = 0,\n      e4 = 0;\n\n  for (var i = 0; i < input.length;) {\n    c1 = input.charCodeAt(i++);\n    e1 = c1 >> 2;\n    c2 = input.charCodeAt(i++);\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input.charCodeAt(i++);\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n\n  return o;\n}\n\nfunction Base64_decode(input) {\n  var o = \"\";\n  var c1 = 0,\n      c2 = 0,\n      c3 = 0,\n      e1 = 0,\n      e2 = 0,\n      e3 = 0,\n      e4 = 0;\n  input = input.replace(/[^\\w\\+\\/\\=]/g, \"\");\n\n  for (var i = 0; i < input.length;) {\n    e1 = Base64_map.indexOf(input.charAt(i++));\n    e2 = Base64_map.indexOf(input.charAt(i++));\n    c1 = e1 << 2 | e2 >> 4;\n    o += String.fromCharCode(c1);\n    e3 = Base64_map.indexOf(input.charAt(i++));\n    c2 = (e2 & 15) << 4 | e3 >> 2;\n\n    if (e3 !== 64) {\n      o += String.fromCharCode(c2);\n    }\n\n    e4 = Base64_map.indexOf(input.charAt(i++));\n    c3 = (e3 & 3) << 6 | e4;\n\n    if (e4 !== 64) {\n      o += String.fromCharCode(c3);\n    }\n  }\n\n  return o;\n}\n\nvar has_buf = /*#__PURE__*/function () {\n  return typeof Buffer !== 'undefined' && typeof process !== 'undefined' && typeof process.versions !== 'undefined' && !!process.versions.node;\n}();\n\nvar Buffer_from = /*#__PURE__*/function () {\n  if (typeof Buffer !== 'undefined') {\n    var nbfs = !Buffer.from;\n    if (!nbfs) try {\n      Buffer.from(\"foo\", \"utf8\");\n    } catch (e) {\n      nbfs = true;\n    }\n    return nbfs ? function (buf, enc) {\n      return enc ? new Buffer(buf, enc) : new Buffer(buf);\n    } : Buffer.from.bind(Buffer);\n  }\n\n  return function () {};\n}();\n\nfunction new_raw_buf(len\n/*:number*/\n) {\n  /* jshint -W056 */\n  if (has_buf) return Buffer.alloc ? Buffer.alloc(len) : new Buffer(len);\n  return typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n  /* jshint +W056 */\n}\n\nfunction new_unsafe_buf(len\n/*:number*/\n) {\n  /* jshint -W056 */\n  if (has_buf) return Buffer.allocUnsafe ? Buffer.allocUnsafe(len) : new Buffer(len);\n  return typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n  /* jshint +W056 */\n}\n\nvar s2a = function s2a(s\n/*:string*/\n)\n/*:any*/\n{\n  if (has_buf) return Buffer_from(s, \"binary\");\n  return s.split(\"\").map(function (x\n  /*:string*/\n  )\n  /*:number*/\n  {\n    return x.charCodeAt(0) & 0xff;\n  });\n};\n\nfunction s2ab(s\n/*:string*/\n)\n/*:any*/\n{\n  if (typeof ArrayBuffer === 'undefined') return s2a(s);\n  var buf = new ArrayBuffer(s.length),\n      view = new Uint8Array(buf);\n\n  for (var i = 0; i != s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n\n  return buf;\n}\n\nfunction a2s(data\n/*:any*/\n)\n/*:string*/\n{\n  if (Array.isArray(data)) return data.map(function (c) {\n    return String.fromCharCode(c);\n  }).join(\"\");\n  var o\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < data.length; ++i) o[i] = String.fromCharCode(data[i]);\n\n  return o.join(\"\");\n}\n\nfunction a2u(data\n/*:Array<number>*/\n)\n/*:Uint8Array*/\n{\n  if (typeof Uint8Array === 'undefined') throw new Error(\"Unsupported\");\n  return new Uint8Array(data);\n}\n\nfunction ab2a(data\n/*:ArrayBuffer|Uint8Array*/\n)\n/*:Array<number>*/\n{\n  if (typeof ArrayBuffer == 'undefined') throw new Error(\"Unsupported\");\n  if (data instanceof ArrayBuffer) return ab2a(new Uint8Array(data));\n  /*:: if(data instanceof ArrayBuffer) throw new Error(\"unreachable\"); */\n\n  var o = new Array(data.length);\n\n  for (var i = 0; i < data.length; ++i) o[i] = data[i];\n\n  return o;\n}\n\nvar bconcat = has_buf ? function (bufs) {\n  return Buffer.concat(bufs.map(function (buf) {\n    return Buffer.isBuffer(buf) ? buf : Buffer_from(buf);\n  }));\n} : function (bufs) {\n  if (typeof Uint8Array !== \"undefined\") {\n    var i = 0,\n        maxlen = 0;\n\n    for (i = 0; i < bufs.length; ++i) maxlen += bufs[i].length;\n\n    var o = new Uint8Array(maxlen);\n    var len = 0;\n\n    for (i = 0, maxlen = 0; i < bufs.length; maxlen += len, ++i) {\n      len = bufs[i].length;\n      if (bufs[i] instanceof Uint8Array) o.set(bufs[i], maxlen);else if (typeof bufs[i] == \"string\") {\n        throw \"wtf\";\n      } else o.set(new Uint8Array(bufs[i]), maxlen);\n    }\n\n    return o;\n  }\n\n  return [].concat.apply([], bufs.map(function (buf) {\n    return Array.isArray(buf) ? buf : [].slice.call(buf);\n  }));\n};\n\nfunction utf8decode(content\n/*:string*/\n) {\n  var out = [],\n      widx = 0,\n      L = content.length + 250;\n  var o = new_raw_buf(content.length + 255);\n\n  for (var ridx = 0; ridx < content.length; ++ridx) {\n    var c = content.charCodeAt(ridx);\n    if (c < 0x80) o[widx++] = c;else if (c < 0x800) {\n      o[widx++] = 192 | c >> 6 & 31;\n      o[widx++] = 128 | c & 63;\n    } else if (c >= 0xD800 && c < 0xE000) {\n      c = (c & 1023) + 64;\n      var d = content.charCodeAt(++ridx) & 1023;\n      o[widx++] = 240 | c >> 8 & 7;\n      o[widx++] = 128 | c >> 2 & 63;\n      o[widx++] = 128 | d >> 6 & 15 | (c & 3) << 4;\n      o[widx++] = 128 | d & 63;\n    } else {\n      o[widx++] = 224 | c >> 12 & 15;\n      o[widx++] = 128 | c >> 6 & 63;\n      o[widx++] = 128 | c & 63;\n    }\n\n    if (widx > L) {\n      out.push(o.slice(0, widx));\n      widx = 0;\n      o = new_raw_buf(65535);\n      L = 65530;\n    }\n  }\n\n  out.push(o.slice(0, widx));\n  return bconcat(out);\n}\n\nvar chr0 = /\\u0000/g,\n    chr1 = /[\\u0001-\\u0006]/g;\n/*::\ndeclare type Block = any;\ndeclare type BufArray = {\n\tnewblk(sz:number):Block;\n\tnext(sz:number):Block;\n\tend():any;\n\tpush(buf:Block):void;\n};\n\ntype RecordHopperCB = {(d:any, Rn:string, RT:number):?boolean;};\n\ntype EvertType = {[string]:string};\ntype EvertNumType = {[string]:number};\ntype EvertArrType = {[string]:Array<string>};\n\ntype StringConv = {(string):string};\n\n*/\n\n/* ssf.js (C) 2013-present SheetJS -- http://sheetjs.com */\n\n/*jshint -W041 */\n\nfunction _strrev(x\n/*:string*/\n)\n/*:string*/\n{\n  var o = \"\",\n      i = x.length - 1;\n\n  while (i >= 0) o += x.charAt(i--);\n\n  return o;\n}\n\nfunction pad0(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + v;\n  return t.length >= d ? t : fill('0', d - t.length) + t;\n}\n\nfunction pad_(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + v;\n  return t.length >= d ? t : fill(' ', d - t.length) + t;\n}\n\nfunction rpad_(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + v;\n  return t.length >= d ? t : t + fill(' ', d - t.length);\n}\n\nfunction pad0r1(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + Math.round(v);\n  return t.length >= d ? t : fill('0', d - t.length) + t;\n}\n\nfunction pad0r2(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var t = \"\" + v;\n  return t.length >= d ? t : fill('0', d - t.length) + t;\n}\n\nvar p2_32 = /*#__PURE__*/Math.pow(2, 32);\n\nfunction pad0r(v\n/*:any*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  if (v > p2_32 || v < -p2_32) return pad0r1(v, d);\n  var i = Math.round(v);\n  return pad0r2(i, d);\n}\n/* yes, in 2022 this is still faster than string compare */\n\n\nfunction SSF_isgeneral(s\n/*:string*/\n, i\n/*:?number*/\n)\n/*:boolean*/\n{\n  i = i || 0;\n  return s.length >= 7 + i && (s.charCodeAt(i) | 32) === 103 && (s.charCodeAt(i + 1) | 32) === 101 && (s.charCodeAt(i + 2) | 32) === 110 && (s.charCodeAt(i + 3) | 32) === 101 && (s.charCodeAt(i + 4) | 32) === 114 && (s.charCodeAt(i + 5) | 32) === 97 && (s.charCodeAt(i + 6) | 32) === 108;\n}\n\nvar days\n/*:Array<Array<string> >*/\n= [['Sun', 'Sunday'], ['Mon', 'Monday'], ['Tue', 'Tuesday'], ['Wed', 'Wednesday'], ['Thu', 'Thursday'], ['Fri', 'Friday'], ['Sat', 'Saturday']];\nvar months\n/*:Array<Array<string> >*/\n= [['J', 'Jan', 'January'], ['F', 'Feb', 'February'], ['M', 'Mar', 'March'], ['A', 'Apr', 'April'], ['M', 'May', 'May'], ['J', 'Jun', 'June'], ['J', 'Jul', 'July'], ['A', 'Aug', 'August'], ['S', 'Sep', 'September'], ['O', 'Oct', 'October'], ['N', 'Nov', 'November'], ['D', 'Dec', 'December']];\n\nfunction SSF_init_table(t\n/*:any*/\n) {\n  if (!t) t = {};\n  t[0] = 'General';\n  t[1] = '0';\n  t[2] = '0.00';\n  t[3] = '#,##0';\n  t[4] = '#,##0.00';\n  t[9] = '0%';\n  t[10] = '0.00%';\n  t[11] = '0.00E+00';\n  t[12] = '# ?/?';\n  t[13] = '# ??/??';\n  t[14] = 'm/d/yy';\n  t[15] = 'd-mmm-yy';\n  t[16] = 'd-mmm';\n  t[17] = 'mmm-yy';\n  t[18] = 'h:mm AM/PM';\n  t[19] = 'h:mm:ss AM/PM';\n  t[20] = 'h:mm';\n  t[21] = 'h:mm:ss';\n  t[22] = 'm/d/yy h:mm';\n  t[37] = '#,##0 ;(#,##0)';\n  t[38] = '#,##0 ;[Red](#,##0)';\n  t[39] = '#,##0.00;(#,##0.00)';\n  t[40] = '#,##0.00;[Red](#,##0.00)';\n  t[45] = 'mm:ss';\n  t[46] = '[h]:mm:ss';\n  t[47] = 'mmss.0';\n  t[48] = '##0.0E+0';\n  t[49] = '@';\n  t[56] = '\"/ \"hh\"\"mm\"\"ss\" \"';\n  return t;\n}\n/* repeated to satiate webpack */\n\n\nvar table_fmt = {\n  0: 'General',\n  1: '0',\n  2: '0.00',\n  3: '#,##0',\n  4: '#,##0.00',\n  9: '0%',\n  10: '0.00%',\n  11: '0.00E+00',\n  12: '# ?/?',\n  13: '# ??/??',\n  14: 'm/d/yy',\n  15: 'd-mmm-yy',\n  16: 'd-mmm',\n  17: 'mmm-yy',\n  18: 'h:mm AM/PM',\n  19: 'h:mm:ss AM/PM',\n  20: 'h:mm',\n  21: 'h:mm:ss',\n  22: 'm/d/yy h:mm',\n  37: '#,##0 ;(#,##0)',\n  38: '#,##0 ;[Red](#,##0)',\n  39: '#,##0.00;(#,##0.00)',\n  40: '#,##0.00;[Red](#,##0.00)',\n  45: 'mm:ss',\n  46: '[h]:mm:ss',\n  47: 'mmss.0',\n  48: '##0.0E+0',\n  49: '@',\n  56: '\"/ \"hh\"\"mm\"\"ss\" \"'\n};\n/* Defaults determined by systematically testing in Excel 2019 */\n\n/* These formats appear to default to other formats in the table */\n\nvar SSF_default_map = {\n  5: 37,\n  6: 38,\n  7: 39,\n  8: 40,\n  //  5 -> 37 ...  8 -> 40\n  23: 0,\n  24: 0,\n  25: 0,\n  26: 0,\n  // 23 ->  0 ... 26 ->  0\n  27: 14,\n  28: 14,\n  29: 14,\n  30: 14,\n  31: 14,\n  // 27 -> 14 ... 31 -> 14\n  50: 14,\n  51: 14,\n  52: 14,\n  53: 14,\n  54: 14,\n  // 50 -> 14 ... 58 -> 14\n  55: 14,\n  56: 14,\n  57: 14,\n  58: 14,\n  59: 1,\n  60: 2,\n  61: 3,\n  62: 4,\n  // 59 ->  1 ... 62 ->  4\n  67: 9,\n  68: 10,\n  // 67 ->  9 ... 68 -> 10\n  69: 12,\n  70: 13,\n  71: 14,\n  // 69 -> 12 ... 71 -> 14\n  72: 14,\n  73: 15,\n  74: 16,\n  75: 17,\n  // 72 -> 14 ... 75 -> 17\n  76: 20,\n  77: 21,\n  78: 22,\n  // 76 -> 20 ... 78 -> 22\n  79: 45,\n  80: 46,\n  81: 47,\n  // 79 -> 45 ... 81 -> 47\n  82: 0 // 82 ->  0 ... 65536 -> 0 (omitted)\n\n};\n/* These formats technically refer to Accounting formats with no equivalent */\n\nvar SSF_default_str = {\n  //  5 -- Currency,   0 decimal, black negative\n  5: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n  63: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n  //  6 -- Currency,   0 decimal, red   negative\n  6: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n  64: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n  //  7 -- Currency,   2 decimal, black negative\n  7: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n  65: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n  //  8 -- Currency,   2 decimal, red   negative\n  8: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n  66: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n  // 41 -- Accounting, 0 decimal, No Symbol\n  41: '_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',\n  // 42 -- Accounting, 0 decimal, $  Symbol\n  42: '_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',\n  // 43 -- Accounting, 2 decimal, No Symbol\n  43: '_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',\n  // 44 -- Accounting, 2 decimal, $  Symbol\n  44: '_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)'\n};\n\nfunction SSF_frac(x\n/*:number*/\n, D\n/*:number*/\n, mixed\n/*:?boolean*/\n)\n/*:Array<number>*/\n{\n  var sgn = x < 0 ? -1 : 1;\n  var B = x * sgn;\n  var P_2 = 0,\n      P_1 = 1,\n      P = 0;\n  var Q_2 = 1,\n      Q_1 = 0,\n      Q = 0;\n  var A = Math.floor(B);\n\n  while (Q_1 < D) {\n    A = Math.floor(B);\n    P = A * P_1 + P_2;\n    Q = A * Q_1 + Q_2;\n    if (B - A < 0.00000005) break;\n    B = 1 / (B - A);\n    P_2 = P_1;\n    P_1 = P;\n    Q_2 = Q_1;\n    Q_1 = Q;\n  }\n\n  if (Q > D) {\n    if (Q_1 > D) {\n      Q = Q_2;\n      P = P_2;\n    } else {\n      Q = Q_1;\n      P = P_1;\n    }\n  }\n\n  if (!mixed) return [0, sgn * P, Q];\n  var q = Math.floor(sgn * P / Q);\n  return [q, sgn * P - q * Q, Q];\n}\n\nfunction SSF_parse_date_code(v\n/*:number*/\n, opts\n/*:?any*/\n, b2\n/*:?boolean*/\n) {\n  if (v > 2958465 || v < 0) return null;\n  var date = v | 0,\n      time = Math.floor(86400 * (v - date)),\n      dow = 0;\n  var dout = [];\n  var out = {\n    D: date,\n    T: time,\n    u: 86400 * (v - date) - time,\n    y: 0,\n    m: 0,\n    d: 0,\n    H: 0,\n    M: 0,\n    S: 0,\n    q: 0\n  };\n  if (Math.abs(out.u) < 1e-6) out.u = 0;\n  if (opts && opts.date1904) date += 1462;\n\n  if (out.u > 0.9999) {\n    out.u = 0;\n\n    if (++time == 86400) {\n      out.T = time = 0;\n      ++date;\n      ++out.D;\n    }\n  }\n\n  if (date === 60) {\n    dout = b2 ? [1317, 10, 29] : [1900, 2, 29];\n    dow = 3;\n  } else if (date === 0) {\n    dout = b2 ? [1317, 8, 29] : [1900, 1, 0];\n    dow = 6;\n  } else {\n    if (date > 60) --date;\n    /* 1 = Jan 1 1900 in Gregorian */\n\n    var d = new Date(1900, 0, 1);\n    d.setDate(d.getDate() + date - 1);\n    dout = [d.getFullYear(), d.getMonth() + 1, d.getDate()];\n    dow = d.getDay();\n    if (date < 60) dow = (dow + 6) % 7;\n    if (b2) dow = SSF_fix_hijri(d, dout);\n  }\n\n  out.y = dout[0];\n  out.m = dout[1];\n  out.d = dout[2];\n  out.S = time % 60;\n  time = Math.floor(time / 60);\n  out.M = time % 60;\n  time = Math.floor(time / 60);\n  out.H = time;\n  out.q = dow;\n  return out;\n}\n\nvar SSFbasedate = /*#__PURE__*/new Date(1899, 11, 31, 0, 0, 0);\nvar SSFdnthresh = /*#__PURE__*/SSFbasedate.getTime();\nvar SSFbase1904 = /*#__PURE__*/new Date(1900, 2, 1, 0, 0, 0);\n\nfunction datenum_local(v\n/*:Date*/\n, date1904\n/*:?boolean*/\n)\n/*:number*/\n{\n  var epoch = /*#__PURE__*/v.getTime();\n  if (date1904) epoch -= 1461 * 24 * 60 * 60 * 1000;else if (v >= SSFbase1904) epoch += 24 * 60 * 60 * 1000;\n  return (epoch - (SSFdnthresh + ( /*#__PURE__*/v.getTimezoneOffset() - /*#__PURE__*/SSFbasedate.getTimezoneOffset()) * 60000)) / (24 * 60 * 60 * 1000);\n}\n/* ECMA-376 18.8.30 numFmt*/\n\n/* Note: `toPrecision` uses standard form when prec > E and E >= -6 */\n\n/* exponent >= -9 and <= 9 */\n\n\nfunction SSF_strip_decimal(o\n/*:string*/\n)\n/*:string*/\n{\n  return o.indexOf(\".\") == -1 ? o : o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)$/, \"$1\");\n}\n/* General Exponential always shows 2 digits exp and trims the mantissa */\n\n\nfunction SSF_normalize_exp(o\n/*:string*/\n)\n/*:string*/\n{\n  if (o.indexOf(\"E\") == -1) return o;\n  return o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)[Ee]/, \"$1E\").replace(/(E[+-])(\\d)$/, \"$10$2\");\n}\n/* exponent >= -9 and <= 9 */\n\n\nfunction SSF_small_exp(v\n/*:number*/\n)\n/*:string*/\n{\n  var w = v < 0 ? 12 : 11;\n  var o = SSF_strip_decimal(v.toFixed(12));\n  if (o.length <= w) return o;\n  o = v.toPrecision(10);\n  if (o.length <= w) return o;\n  return v.toExponential(5);\n}\n/* exponent >= 11 or <= -10 likely exponential */\n\n\nfunction SSF_large_exp(v\n/*:number*/\n)\n/*:string*/\n{\n  var o = SSF_strip_decimal(v.toFixed(11));\n  return o.length > (v < 0 ? 12 : 11) || o === \"0\" || o === \"-0\" ? v.toPrecision(6) : o;\n}\n\nfunction SSF_general_num(v\n/*:number*/\n)\n/*:string*/\n{\n  var V = Math.floor(Math.log(Math.abs(v)) * Math.LOG10E),\n      o;\n  if (V >= -4 && V <= -1) o = v.toPrecision(10 + V);else if (Math.abs(V) <= 9) o = SSF_small_exp(v);else if (V === 10) o = v.toFixed(10).substr(0, 12);else o = SSF_large_exp(v);\n  return SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()));\n}\n/*\n\t\"General\" rules:\n\t- text is passed through (\"@\")\n\t- booleans are rendered as TRUE/FALSE\n\t- \"up to 11 characters\" displayed for numbers\n\t- Default date format (code 14) used for Dates\n\n\tThe longest 32-bit integer text is \"-2147483648\", exactly 11 chars\n\tTODO: technically the display depends on the width of the cell\n*/\n\n\nfunction SSF_general(v\n/*:any*/\n, opts\n/*:any*/\n) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? \"TRUE\" : \"FALSE\";\n\n    case 'number':\n      return (v | 0) === v ? v.toString(10) : SSF_general_num(v);\n\n    case 'undefined':\n      return \"\";\n\n    case 'object':\n      if (v == null) return \"\";\n      if (v instanceof Date) return SSF_format(14, datenum_local(v, opts && opts.date1904), opts);\n  }\n\n  throw new Error(\"unsupported value in General format: \" + v);\n}\n\nfunction SSF_fix_hijri(date\n/*:Date*/\n, o\n/*:[number, number, number]*/\n) {\n  /* TODO: properly adjust y/m/d and  */\n  o[0] -= 581;\n  var dow = date.getDay();\n  if (date < 60) dow = (dow + 6) % 7;\n  return dow;\n} //var THAI_DIGITS = \"\\u0E50\\u0E51\\u0E52\\u0E53\\u0E54\\u0E55\\u0E56\\u0E57\\u0E58\\u0E59\".split(\"\");\n\n\nfunction SSF_write_date(type\n/*:number*/\n, fmt\n/*:string*/\n, val, ss0\n/*:?number*/\n)\n/*:string*/\n{\n  var o = \"\",\n      ss = 0,\n      tt = 0,\n      y = val.y,\n      out,\n      outl = 0;\n\n  switch (type) {\n    case 98:\n      /* 'b' buddhist year */\n      y = val.y + 543;\n\n    /* falls through */\n\n    case 121:\n      /* 'y' year */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = y % 100;\n          outl = 2;\n          break;\n\n        default:\n          out = y % 10000;\n          outl = 4;\n          break;\n      }\n\n      break;\n\n    case 109:\n      /* 'm' month */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = val.m;\n          outl = fmt.length;\n          break;\n\n        case 3:\n          return months[val.m - 1][1];\n\n        case 5:\n          return months[val.m - 1][0];\n\n        default:\n          return months[val.m - 1][2];\n      }\n\n      break;\n\n    case 100:\n      /* 'd' day */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = val.d;\n          outl = fmt.length;\n          break;\n\n        case 3:\n          return days[val.q][0];\n\n        default:\n          return days[val.q][1];\n      }\n\n      break;\n\n    case 104:\n      /* 'h' 12-hour */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = 1 + (val.H + 11) % 12;\n          outl = fmt.length;\n          break;\n\n        default:\n          throw 'bad hour format: ' + fmt;\n      }\n\n      break;\n\n    case 72:\n      /* 'H' 24-hour */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = val.H;\n          outl = fmt.length;\n          break;\n\n        default:\n          throw 'bad hour format: ' + fmt;\n      }\n\n      break;\n\n    case 77:\n      /* 'M' minutes */\n      switch (fmt.length) {\n        case 1:\n        case 2:\n          out = val.M;\n          outl = fmt.length;\n          break;\n\n        default:\n          throw 'bad minute format: ' + fmt;\n      }\n\n      break;\n\n    case 115:\n      /* 's' seconds */\n      if (fmt != 's' && fmt != 'ss' && fmt != '.0' && fmt != '.00' && fmt != '.000') throw 'bad second format: ' + fmt;\n      if (val.u === 0 && (fmt == \"s\" || fmt == \"ss\")) return pad0(val.S, fmt.length);\n      /*::if(!ss0) ss0 = 0; */\n\n      if (ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;else tt = ss0 === 1 ? 10 : 1;\n      ss = Math.round(tt * (val.S + val.u));\n      if (ss >= 60 * tt) ss = 0;\n      if (fmt === 's') return ss === 0 ? \"0\" : \"\" + ss / tt;\n      o = pad0(ss, 2 + ss0);\n      if (fmt === 'ss') return o.substr(0, 2);\n      return \".\" + o.substr(2, fmt.length - 1);\n\n    case 90:\n      /* 'Z' absolute time */\n      switch (fmt) {\n        case '[h]':\n        case '[hh]':\n          out = val.D * 24 + val.H;\n          break;\n\n        case '[m]':\n        case '[mm]':\n          out = (val.D * 24 + val.H) * 60 + val.M;\n          break;\n\n        case '[s]':\n        case '[ss]':\n          out = ((val.D * 24 + val.H) * 60 + val.M) * 60 + Math.round(val.S + val.u);\n          break;\n\n        default:\n          throw 'bad abstime format: ' + fmt;\n      }\n\n      outl = fmt.length === 3 ? 1 : 2;\n      break;\n\n    case 101:\n      /* 'e' era */\n      out = y;\n      outl = 1;\n      break;\n  }\n\n  var outstr = outl > 0 ? pad0(out, outl) : \"\";\n  return outstr;\n}\n/*jshint -W086 */\n\n/*jshint +W086 */\n\n\nfunction commaify(s\n/*:string*/\n)\n/*:string*/\n{\n  var w = 3;\n  if (s.length <= w) return s;\n  var j = s.length % w,\n      o = s.substr(0, j);\n\n  for (; j != s.length; j += w) o += (o.length > 0 ? \",\" : \"\") + s.substr(j, w);\n\n  return o;\n}\n\nvar pct1 = /%/g;\n\nfunction write_num_pct(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var sfmt = fmt.replace(pct1, \"\"),\n      mul = fmt.length - sfmt.length;\n  return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n}\n\nfunction write_num_cm(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var idx = fmt.length - 1;\n\n  while (fmt.charCodeAt(idx - 1) === 44) --idx;\n\n  return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n}\n\nfunction write_num_exp(fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var o\n  /*:string*/\n  ;\n  var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\n  if (fmt.match(/^#+0.0E\\+0$/)) {\n    if (val == 0) return \"0.0E+0\";else if (val < 0) return \"-\" + write_num_exp(fmt, -val);\n    var period = fmt.indexOf(\".\");\n    if (period === -1) period = fmt.indexOf('E');\n    var ee = Math.floor(Math.log(val) * Math.LOG10E) % period;\n    if (ee < 0) ee += period;\n    o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n\n    if (o.indexOf(\"e\") === -1) {\n      var fakee = Math.floor(Math.log(val) * Math.LOG10E);\n      if (o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n\n      while (o.substr(0, 2) === \"0.\") {\n        o = o.charAt(0) + o.substr(2, period) + \".\" + o.substr(2 + period);\n        o = o.replace(/^0+([1-9])/, \"$1\").replace(/^0+\\./, \"0.\");\n      }\n\n      o = o.replace(/\\+-/, \"-\");\n    }\n\n    o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n      return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n    });\n  } else o = val.toExponential(idx);\n\n  if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o.charAt(o.length - 1);\n  if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n  return o.replace(\"e\", \"E\");\n}\n\nvar frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\n\nfunction write_num_f1(r\n/*:Array<string>*/\n, aval\n/*:number*/\n, sign\n/*:string*/\n)\n/*:string*/\n{\n  var den = parseInt(r[4], 10),\n      rr = Math.round(aval * den),\n      base = Math.floor(rr / den);\n  var myn = rr - base * den,\n      myd = den;\n  return sign + (base === 0 ? \"\" : \"\" + base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn, r[1].length) + r[2] + \"/\" + r[3] + pad0(myd, r[4].length));\n}\n\nfunction write_num_f2(r\n/*:Array<string>*/\n, aval\n/*:number*/\n, sign\n/*:string*/\n)\n/*:string*/\n{\n  return sign + (aval === 0 ? \"\" : \"\" + aval) + fill(\" \", r[1].length + 2 + r[4].length);\n}\n\nvar dec1 = /^#*0*\\.([0#]+)/;\nvar closeparen = /\\).*[0#]/;\nvar phone = /\\(###\\) ###\\\\?-####/;\n\nfunction hashq(str\n/*:string*/\n)\n/*:string*/\n{\n  var o = \"\",\n      cc;\n\n  for (var i = 0; i != str.length; ++i) switch (cc = str.charCodeAt(i)) {\n    case 35:\n      break;\n\n    case 63:\n      o += \" \";\n      break;\n\n    case 48:\n      o += \"0\";\n      break;\n\n    default:\n      o += String.fromCharCode(cc);\n  }\n\n  return o;\n}\n\nfunction rnd(val\n/*:number*/\n, d\n/*:number*/\n)\n/*:string*/\n{\n  var dd = Math.pow(10, d);\n  return \"\" + Math.round(val * dd) / dd;\n}\n\nfunction dec(val\n/*:number*/\n, d\n/*:number*/\n)\n/*:number*/\n{\n  var _frac = val - Math.floor(val),\n      dd = Math.pow(10, d);\n\n  if (d < ('' + Math.round(_frac * dd)).length) return 0;\n  return Math.round(_frac * dd);\n}\n\nfunction carry(val\n/*:number*/\n, d\n/*:number*/\n)\n/*:number*/\n{\n  if (d < ('' + Math.round((val - Math.floor(val)) * Math.pow(10, d))).length) {\n    return 1;\n  }\n\n  return 0;\n}\n\nfunction flr(val\n/*:number*/\n)\n/*:string*/\n{\n  if (val < 2147483647 && val > -2147483648) return \"\" + (val >= 0 ? val | 0 : val - 1 | 0);\n  return \"\" + Math.floor(val);\n}\n\nfunction write_num_flt(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n    var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n    if (val >= 0) return write_num_flt('n', ffmt, val);\n    return '(' + write_num_flt('n', ffmt, -val) + ')';\n  }\n\n  if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n  if (fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n  if (fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n  if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_flt(type, fmt.substr(fmt.charAt(1) == ' ' ? 2 : 1), val);\n  var o;\n  var r\n  /*:?Array<string>*/\n  ,\n      ri,\n      ff,\n      aval = Math.abs(val),\n      sign = val < 0 ? \"-\" : \"\";\n  if (fmt.match(/^00+$/)) return sign + pad0r(aval, fmt.length);\n\n  if (fmt.match(/^[#?]+$/)) {\n    o = pad0r(val, 0);\n    if (o === \"0\") o = \"\";\n    return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n  }\n\n  if (r = fmt.match(frac1)) return write_num_f1(r, aval, sign);\n  if (fmt.match(/^#+0+$/)) return sign + pad0r(aval, fmt.length - fmt.indexOf(\"0\"));\n\n  if (r = fmt.match(dec1)) {\n    o = rnd(val, r[1].length).replace(/^([^\\.]+)$/, \"$1.\" + hashq(r[1])).replace(/\\.$/, \".\" + hashq(r[1])).replace(/\\.(\\d*)$/, function ($$, $1) {\n      return \".\" + $1 + fill(\"0\", hashq(\n      /*::(*/\n      r\n      /*::||[\"\"])*/\n      [1]).length - $1.length);\n    });\n    return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n  }\n\n  fmt = fmt.replace(/^#+([0.])/, \"$1\");\n\n  if (r = fmt.match(/^(0*)\\.(#*)$/)) {\n    return sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n  }\n\n  if (r = fmt.match(/^#{1,3},##0(\\.?)$/)) return sign + commaify(pad0r(aval, 0));\n\n  if (r = fmt.match(/^#,##0\\.([#0]*0)$/)) {\n    return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\" + (Math.floor(val) + carry(val, r[1].length))) + \".\" + pad0(dec(val, r[1].length), r[1].length);\n  }\n\n  if (r = fmt.match(/^#,#*,#0/)) return write_num_flt(type, fmt.replace(/^#,#*,/, \"\"), val);\n\n  if (r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) {\n    o = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n    ri = 0;\n    return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n      return ri < o.length ? o.charAt(ri++) : x === '0' ? '0' : \"\";\n    }));\n  }\n\n  if (fmt.match(phone)) {\n    o = write_num_flt(type, \"##########\", val);\n    return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n  }\n\n  var oa = \"\";\n\n  if (r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n    ri = Math.min(\n    /*::String(*/\n    r[4]\n    /*::)*/\n    .length, 7);\n    ff = SSF_frac(aval, Math.pow(10, ri) - 1, false);\n    o = \"\" + sign;\n    oa = write_num(\"n\",\n    /*::String(*/\n    r[1]\n    /*::)*/\n    , ff[1]);\n    if (oa.charAt(oa.length - 1) == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n    o += oa +\n    /*::String(*/\n    r[2]\n    /*::)*/\n    + \"/\" +\n    /*::String(*/\n    r[3]\n    /*::)*/\n    ;\n    oa = rpad_(ff[2], ri);\n    if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n    o += oa;\n    return o;\n  }\n\n  if (r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n    ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n    ff = SSF_frac(aval, Math.pow(10, ri) - 1, true);\n    return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n  }\n\n  if (r = fmt.match(/^[#0?]+$/)) {\n    o = pad0r(val, 0);\n    if (fmt.length <= o.length) return o;\n    return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n  }\n\n  if (r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) {\n    o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n    ri = o.indexOf(\".\");\n    var lres = fmt.indexOf(\".\") - ri,\n        rres = fmt.length - o.length - lres;\n    return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n  }\n\n  if (r = fmt.match(/^00,000\\.([#0]*0)$/)) {\n    ri = dec(val, r[1].length);\n    return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n      return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n    }) + \".\" + pad0(ri, r[1].length);\n  }\n\n  switch (fmt) {\n    case \"###,##0.00\":\n      return write_num_flt(type, \"#,##0.00\", val);\n\n    case \"###,###\":\n    case \"##,###\":\n    case \"#,###\":\n      var x = commaify(pad0r(aval, 0));\n      return x !== \"0\" ? sign + x : \"\";\n\n    case \"###,###.00\":\n      return write_num_flt(type, \"###,##0.00\", val).replace(/^0\\./, \".\");\n\n    case \"#,###.00\":\n      return write_num_flt(type, \"#,##0.00\", val).replace(/^0\\./, \".\");\n\n    default:\n  }\n\n  throw new Error(\"unsupported format |\" + fmt + \"|\");\n}\n\nfunction write_num_cm2(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var idx = fmt.length - 1;\n\n  while (fmt.charCodeAt(idx - 1) === 44) --idx;\n\n  return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n}\n\nfunction write_num_pct2(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var sfmt = fmt.replace(pct1, \"\"),\n      mul = fmt.length - sfmt.length;\n  return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n}\n\nfunction write_num_exp2(fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  var o\n  /*:string*/\n  ;\n  var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\n  if (fmt.match(/^#+0.0E\\+0$/)) {\n    if (val == 0) return \"0.0E+0\";else if (val < 0) return \"-\" + write_num_exp2(fmt, -val);\n    var period = fmt.indexOf(\".\");\n    if (period === -1) period = fmt.indexOf('E');\n    var ee = Math.floor(Math.log(val) * Math.LOG10E) % period;\n    if (ee < 0) ee += period;\n    o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n\n    if (!o.match(/[Ee]/)) {\n      var fakee = Math.floor(Math.log(val) * Math.LOG10E);\n      if (o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n      o = o.replace(/\\+-/, \"-\");\n    }\n\n    o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n      return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n    });\n  } else o = val.toExponential(idx);\n\n  if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o.charAt(o.length - 1);\n  if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n  return o.replace(\"e\", \"E\");\n}\n\nfunction write_num_int(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n    var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n    if (val >= 0) return write_num_int('n', ffmt, val);\n    return '(' + write_num_int('n', ffmt, -val) + ')';\n  }\n\n  if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n  if (fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n  if (fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n  if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_int(type, fmt.substr(fmt.charAt(1) == ' ' ? 2 : 1), val);\n  var o;\n  var r\n  /*:?Array<string>*/\n  ,\n      ri,\n      ff,\n      aval = Math.abs(val),\n      sign = val < 0 ? \"-\" : \"\";\n  if (fmt.match(/^00+$/)) return sign + pad0(aval, fmt.length);\n\n  if (fmt.match(/^[#?]+$/)) {\n    o = \"\" + val;\n    if (val === 0) o = \"\";\n    return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n  }\n\n  if (r = fmt.match(frac1)) return write_num_f2(r, aval, sign);\n  if (fmt.match(/^#+0+$/)) return sign + pad0(aval, fmt.length - fmt.indexOf(\"0\"));\n\n  if (r = fmt.match(dec1)) {\n    /*:: if(!Array.isArray(r)) throw new Error(\"unreachable\"); */\n    o = (\"\" + val).replace(/^([^\\.]+)$/, \"$1.\" + hashq(r[1])).replace(/\\.$/, \".\" + hashq(r[1]));\n    o = o.replace(/\\.(\\d*)$/, function ($$, $1) {\n      /*:: if(!Array.isArray(r)) throw new Error(\"unreachable\"); */\n      return \".\" + $1 + fill(\"0\", hashq(r[1]).length - $1.length);\n    });\n    return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n  }\n\n  fmt = fmt.replace(/^#+([0.])/, \"$1\");\n\n  if (r = fmt.match(/^(0*)\\.(#*)$/)) {\n    return sign + (\"\" + aval).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n  }\n\n  if (r = fmt.match(/^#{1,3},##0(\\.?)$/)) return sign + commaify(\"\" + aval);\n\n  if (r = fmt.match(/^#,##0\\.([#0]*0)$/)) {\n    return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val) + \".\" + fill('0', r[1].length);\n  }\n\n  if (r = fmt.match(/^#,#*,#0/)) return write_num_int(type, fmt.replace(/^#,#*,/, \"\"), val);\n\n  if (r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) {\n    o = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n    ri = 0;\n    return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n      return ri < o.length ? o.charAt(ri++) : x === '0' ? '0' : \"\";\n    }));\n  }\n\n  if (fmt.match(phone)) {\n    o = write_num_int(type, \"##########\", val);\n    return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n  }\n\n  var oa = \"\";\n\n  if (r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n    ri = Math.min(\n    /*::String(*/\n    r[4]\n    /*::)*/\n    .length, 7);\n    ff = SSF_frac(aval, Math.pow(10, ri) - 1, false);\n    o = \"\" + sign;\n    oa = write_num(\"n\",\n    /*::String(*/\n    r[1]\n    /*::)*/\n    , ff[1]);\n    if (oa.charAt(oa.length - 1) == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n    o += oa +\n    /*::String(*/\n    r[2]\n    /*::)*/\n    + \"/\" +\n    /*::String(*/\n    r[3]\n    /*::)*/\n    ;\n    oa = rpad_(ff[2], ri);\n    if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n    o += oa;\n    return o;\n  }\n\n  if (r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) {\n    ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n    ff = SSF_frac(aval, Math.pow(10, ri) - 1, true);\n    return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n  }\n\n  if (r = fmt.match(/^[#0?]+$/)) {\n    o = \"\" + val;\n    if (fmt.length <= o.length) return o;\n    return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n  }\n\n  if (r = fmt.match(/^([#0]+)\\.([#0]+)$/)) {\n    o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n    ri = o.indexOf(\".\");\n    var lres = fmt.indexOf(\".\") - ri,\n        rres = fmt.length - o.length - lres;\n    return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n  }\n\n  if (r = fmt.match(/^00,000\\.([#0]*0)$/)) {\n    return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n      return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n    }) + \".\" + pad0(0, r[1].length);\n  }\n\n  switch (fmt) {\n    case \"###,###\":\n    case \"##,###\":\n    case \"#,###\":\n      var x = commaify(\"\" + aval);\n      return x !== \"0\" ? sign + x : \"\";\n\n    default:\n      if (fmt.match(/\\.[0#?]*$/)) return write_num_int(type, fmt.slice(0, fmt.lastIndexOf(\".\")), val) + hashq(fmt.slice(fmt.lastIndexOf(\".\")));\n  }\n\n  throw new Error(\"unsupported format |\" + fmt + \"|\");\n}\n\nfunction write_num(type\n/*:string*/\n, fmt\n/*:string*/\n, val\n/*:number*/\n)\n/*:string*/\n{\n  return (val | 0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n}\n\nfunction SSF_split_fmt(fmt\n/*:string*/\n)\n/*:Array<string>*/\n{\n  var out\n  /*:Array<string>*/\n  = [];\n  var in_str = false\n  /*, cc*/\n  ;\n\n  for (var i = 0, j = 0; i < fmt.length; ++i) switch (\n  /*cc=*/\n  fmt.charCodeAt(i)) {\n    case 34:\n      /* '\"' */\n      in_str = !in_str;\n      break;\n\n    case 95:\n    case 42:\n    case 92:\n      /* '_' '*' '\\\\' */\n      ++i;\n      break;\n\n    case 59:\n      /* ';' */\n      out[out.length] = fmt.substr(j, i - j);\n      j = i + 1;\n  }\n\n  out[out.length] = fmt.substr(j);\n  if (in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n  return out;\n}\n\nvar SSF_abstime = /\\[[HhMmSs\\u0E0A\\u0E19\\u0E17]*\\]/;\n\nfunction fmt_is_date(fmt\n/*:string*/\n)\n/*:boolean*/\n{\n  var i = 0,\n\n  /*cc = 0,*/\n  c = \"\",\n      o = \"\";\n\n  while (i < fmt.length) {\n    switch (c = fmt.charAt(i)) {\n      case 'G':\n        if (SSF_isgeneral(fmt, i)) i += 6;\n        i++;\n        break;\n\n      case '\"':\n        for (;\n        /*cc=*/\n        fmt.charCodeAt(++i) !== 34 && i < fmt.length;) {\n          /*empty*/\n        }\n\n        ++i;\n        break;\n\n      case '\\\\':\n        i += 2;\n        break;\n\n      case '_':\n        i += 2;\n        break;\n\n      case '@':\n        ++i;\n        break;\n\n      case 'B':\n      case 'b':\n        if (fmt.charAt(i + 1) === \"1\" || fmt.charAt(i + 1) === \"2\") return true;\n\n      /* falls through */\n\n      case 'M':\n      case 'D':\n      case 'Y':\n      case 'H':\n      case 'S':\n      case 'E':\n      /* falls through */\n\n      case 'm':\n      case 'd':\n      case 'y':\n      case 'h':\n      case 's':\n      case 'e':\n      case 'g':\n        return true;\n\n      case 'A':\n      case 'a':\n      case '':\n        if (fmt.substr(i, 3).toUpperCase() === \"A/P\") return true;\n        if (fmt.substr(i, 5).toUpperCase() === \"AM/PM\") return true;\n        if (fmt.substr(i, 5).toUpperCase() === \"/\") return true;\n        ++i;\n        break;\n\n      case '[':\n        o = c;\n\n        while (fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\n        if (o.match(SSF_abstime)) return true;\n        break;\n\n      case '.':\n      /* falls through */\n\n      case '0':\n      case '#':\n        while (i < fmt.length && (\"0#?.,E+-%\".indexOf(c = fmt.charAt(++i)) > -1 || c == '\\\\' && fmt.charAt(i + 1) == \"-\" && \"0#\".indexOf(fmt.charAt(i + 2)) > -1)) {\n          /* empty */\n        }\n\n        break;\n\n      case '?':\n        while (fmt.charAt(++i) === c) {\n          /* empty */\n        }\n\n        break;\n\n      case '*':\n        ++i;\n        if (fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i;\n        break;\n\n      case '(':\n      case ')':\n        ++i;\n        break;\n\n      case '1':\n      case '2':\n      case '3':\n      case '4':\n      case '5':\n      case '6':\n      case '7':\n      case '8':\n      case '9':\n        while (i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) {\n          /* empty */\n        }\n\n        break;\n\n      case ' ':\n        ++i;\n        break;\n\n      default:\n        ++i;\n        break;\n    }\n  }\n\n  return false;\n}\n\nfunction eval_fmt(fmt\n/*:string*/\n, v\n/*:any*/\n, opts\n/*:any*/\n, flen\n/*:number*/\n) {\n  var out = [],\n      o = \"\",\n      i = 0,\n      c = \"\",\n      lst = 't',\n      dt,\n      j,\n      cc;\n  var hr = 'H';\n  /* Tokenize */\n\n  while (i < fmt.length) {\n    switch (c = fmt.charAt(i)) {\n      case 'G':\n        /* General */\n        if (!SSF_isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n        out[out.length] = {\n          t: 'G',\n          v: 'General'\n        };\n        i += 7;\n        break;\n\n      case '\"':\n        /* Literal text */\n        for (o = \"\"; (cc = fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n\n        out[out.length] = {\n          t: 't',\n          v: o\n        };\n        ++i;\n        break;\n\n      case '\\\\':\n        var w = fmt.charAt(++i),\n            t = w === \"(\" || w === \")\" ? w : 't';\n        out[out.length] = {\n          t: t,\n          v: w\n        };\n        ++i;\n        break;\n\n      case '_':\n        out[out.length] = {\n          t: 't',\n          v: \" \"\n        };\n        i += 2;\n        break;\n\n      case '@':\n        /* Text Placeholder */\n        out[out.length] = {\n          t: 'T',\n          v: v\n        };\n        ++i;\n        break;\n\n      case 'B':\n      case 'b':\n        if (fmt.charAt(i + 1) === \"1\" || fmt.charAt(i + 1) === \"2\") {\n          if (dt == null) {\n            dt = SSF_parse_date_code(v, opts, fmt.charAt(i + 1) === \"2\");\n            if (dt == null) return \"\";\n          }\n\n          out[out.length] = {\n            t: 'X',\n            v: fmt.substr(i, 2)\n          };\n          lst = c;\n          i += 2;\n          break;\n        }\n\n      /* falls through */\n\n      case 'M':\n      case 'D':\n      case 'Y':\n      case 'H':\n      case 'S':\n      case 'E':\n        c = c.toLowerCase();\n\n      /* falls through */\n\n      case 'm':\n      case 'd':\n      case 'y':\n      case 'h':\n      case 's':\n      case 'e':\n      case 'g':\n        if (v < 0) return \"\";\n\n        if (dt == null) {\n          dt = SSF_parse_date_code(v, opts);\n          if (dt == null) return \"\";\n        }\n\n        o = c;\n\n        while (++i < fmt.length && fmt.charAt(i).toLowerCase() === c) o += c;\n\n        if (c === 'm' && lst.toLowerCase() === 'h') c = 'M';\n        if (c === 'h') c = hr;\n        out[out.length] = {\n          t: c,\n          v: o\n        };\n        lst = c;\n        break;\n\n      case 'A':\n      case 'a':\n      case '':\n        var q = {\n          t: c,\n          v: c\n        };\n        if (dt == null) dt = SSF_parse_date_code(v, opts);\n\n        if (fmt.substr(i, 3).toUpperCase() === \"A/P\") {\n          if (dt != null) q.v = dt.H >= 12 ? \"P\" : \"A\";\n          q.t = 'T';\n          hr = 'h';\n          i += 3;\n        } else if (fmt.substr(i, 5).toUpperCase() === \"AM/PM\") {\n          if (dt != null) q.v = dt.H >= 12 ? \"PM\" : \"AM\";\n          q.t = 'T';\n          i += 5;\n          hr = 'h';\n        } else if (fmt.substr(i, 5).toUpperCase() === \"/\") {\n          if (dt != null) q.v = dt.H >= 12 ? \"\" : \"\";\n          q.t = 'T';\n          i += 5;\n          hr = 'h';\n        } else {\n          q.t = \"t\";\n          ++i;\n        }\n\n        if (dt == null && q.t === 'T') return \"\";\n        out[out.length] = q;\n        lst = c;\n        break;\n\n      case '[':\n        o = c;\n\n        while (fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\n        if (o.slice(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\n        if (o.match(SSF_abstime)) {\n          if (dt == null) {\n            dt = SSF_parse_date_code(v, opts);\n            if (dt == null) return \"\";\n          }\n\n          out[out.length] = {\n            t: 'Z',\n            v: o.toLowerCase()\n          };\n          lst = o.charAt(1);\n        } else if (o.indexOf(\"$\") > -1) {\n          o = (o.match(/\\$([^-\\[\\]]*)/) || [])[1] || \"$\";\n          if (!fmt_is_date(fmt)) out[out.length] = {\n            t: 't',\n            v: o\n          };\n        }\n\n        break;\n\n      /* Numbers */\n\n      case '.':\n        if (dt != null) {\n          o = c;\n\n          while (++i < fmt.length && (c = fmt.charAt(i)) === \"0\") o += c;\n\n          out[out.length] = {\n            t: 's',\n            v: o\n          };\n          break;\n        }\n\n      /* falls through */\n\n      case '0':\n      case '#':\n        o = c;\n\n        while (++i < fmt.length && \"0#?.,E+-%\".indexOf(c = fmt.charAt(i)) > -1) o += c;\n\n        out[out.length] = {\n          t: 'n',\n          v: o\n        };\n        break;\n\n      case '?':\n        o = c;\n\n        while (fmt.charAt(++i) === c) o += c;\n\n        out[out.length] = {\n          t: c,\n          v: o\n        };\n        lst = c;\n        break;\n\n      case '*':\n        ++i;\n        if (fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i;\n        break;\n      // **\n\n      case '(':\n      case ')':\n        out[out.length] = {\n          t: flen === 1 ? 't' : c,\n          v: c\n        };\n        ++i;\n        break;\n\n      case '1':\n      case '2':\n      case '3':\n      case '4':\n      case '5':\n      case '6':\n      case '7':\n      case '8':\n      case '9':\n        o = c;\n\n        while (i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) o += fmt.charAt(i);\n\n        out[out.length] = {\n          t: 'D',\n          v: o\n        };\n        break;\n\n      case ' ':\n        out[out.length] = {\n          t: c,\n          v: c\n        };\n        ++i;\n        break;\n\n      case '$':\n        out[out.length] = {\n          t: 't',\n          v: '$'\n        };\n        ++i;\n        break;\n\n      default:\n        if (\",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n        out[out.length] = {\n          t: 't',\n          v: c\n        };\n        ++i;\n        break;\n    }\n  }\n  /* Scan for date/time parts */\n\n\n  var bt = 0,\n      ss0 = 0,\n      ssm;\n\n  for (i = out.length - 1, lst = 't'; i >= 0; --i) {\n    switch (out[i].t) {\n      case 'h':\n      case 'H':\n        out[i].t = hr;\n        lst = 'h';\n        if (bt < 1) bt = 1;\n        break;\n\n      case 's':\n        if (ssm = out[i].v.match(/\\.0+$/)) ss0 = Math.max(ss0, ssm[0].length - 1);\n        if (bt < 3) bt = 3;\n\n      /* falls through */\n\n      case 'd':\n      case 'y':\n      case 'M':\n      case 'e':\n        lst = out[i].t;\n        break;\n\n      case 'm':\n        if (lst === 's') {\n          out[i].t = 'M';\n          if (bt < 2) bt = 2;\n        }\n\n        break;\n\n      case 'X':\n        /*if(out[i].v === \"B2\");*/\n        break;\n\n      case 'Z':\n        if (bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n        if (bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n        if (bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n    }\n  }\n  /* time rounding depends on presence of minute / second / usec fields */\n\n\n  switch (bt) {\n    case 0:\n      break;\n\n    case 1:\n      /*::if(!dt) break;*/\n      if (dt.u >= 0.5) {\n        dt.u = 0;\n        ++dt.S;\n      }\n\n      if (dt.S >= 60) {\n        dt.S = 0;\n        ++dt.M;\n      }\n\n      if (dt.M >= 60) {\n        dt.M = 0;\n        ++dt.H;\n      }\n\n      break;\n\n    case 2:\n      /*::if(!dt) break;*/\n      if (dt.u >= 0.5) {\n        dt.u = 0;\n        ++dt.S;\n      }\n\n      if (dt.S >= 60) {\n        dt.S = 0;\n        ++dt.M;\n      }\n\n      break;\n  }\n  /* replace fields */\n\n\n  var nstr = \"\",\n      jj;\n\n  for (i = 0; i < out.length; ++i) {\n    switch (out[i].t) {\n      case 't':\n      case 'T':\n      case ' ':\n      case 'D':\n        break;\n\n      case 'X':\n        out[i].v = \"\";\n        out[i].t = \";\";\n        break;\n\n      case 'd':\n      case 'm':\n      case 'y':\n      case 'h':\n      case 'H':\n      case 'M':\n      case 's':\n      case 'e':\n      case 'b':\n      case 'Z':\n        /*::if(!dt) throw \"unreachable\"; */\n        out[i].v = SSF_write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n        out[i].t = 't';\n        break;\n\n      case 'n':\n      case '?':\n        jj = i + 1;\n\n        while (out[jj] != null && ((c = out[jj].t) === \"?\" || c === \"D\" || (c === \" \" || c === \"t\") && out[jj + 1] != null && (out[jj + 1].t === '?' || out[jj + 1].t === \"t\" && out[jj + 1].v === '/') || out[i].t === '(' && (c === ' ' || c === 'n' || c === ')') || c === 't' && (out[jj].v === '/' || out[jj].v === ' ' && out[jj + 1] != null && out[jj + 1].t == '?'))) {\n          out[i].v += out[jj].v;\n          out[jj] = {\n            v: \"\",\n            t: \";\"\n          };\n          ++jj;\n        }\n\n        nstr += out[i].v;\n        i = jj - 1;\n        break;\n\n      case 'G':\n        out[i].t = 't';\n        out[i].v = SSF_general(v, opts);\n        break;\n    }\n  }\n\n  var vv = \"\",\n      myv,\n      ostr;\n\n  if (nstr.length > 0) {\n    if (nstr.charCodeAt(0) == 40)\n      /* '(' */\n      {\n        myv = v < 0 && nstr.charCodeAt(0) === 45 ? -v : v;\n        ostr = write_num('n', nstr, myv);\n      } else {\n      myv = v < 0 && flen > 1 ? -v : v;\n      ostr = write_num('n', nstr, myv);\n\n      if (myv < 0 && out[0] && out[0].t == 't') {\n        ostr = ostr.substr(1);\n        out[0].v = \"-\" + out[0].v;\n      }\n    }\n\n    jj = ostr.length - 1;\n    var decpt = out.length;\n\n    for (i = 0; i < out.length; ++i) if (out[i] != null && out[i].t != 't' && out[i].v.indexOf(\".\") > -1) {\n      decpt = i;\n      break;\n    }\n\n    var lasti = out.length;\n\n    if (decpt === out.length && ostr.indexOf(\"E\") === -1) {\n      for (i = out.length - 1; i >= 0; --i) {\n        if (out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\n        if (jj >= out[i].v.length - 1) {\n          jj -= out[i].v.length;\n          out[i].v = ostr.substr(jj + 1, out[i].v.length);\n        } else if (jj < 0) out[i].v = \"\";else {\n          out[i].v = ostr.substr(0, jj + 1);\n          jj = -1;\n        }\n\n        out[i].t = 't';\n        lasti = i;\n      }\n\n      if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n    } else if (decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n      jj = ostr.indexOf(\".\") - 1;\n\n      for (i = decpt; i >= 0; --i) {\n        if (out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n        j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") - 1 : out[i].v.length - 1;\n        vv = out[i].v.substr(j + 1);\n\n        for (; j >= 0; --j) {\n          if (jj >= 0 && (out[i].v.charAt(j) === \"0\" || out[i].v.charAt(j) === \"#\")) vv = ostr.charAt(jj--) + vv;\n        }\n\n        out[i].v = vv;\n        out[i].t = 't';\n        lasti = i;\n      }\n\n      if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n      jj = ostr.indexOf(\".\") + 1;\n\n      for (i = decpt; i < out.length; ++i) {\n        if (out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt) continue;\n        j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") + 1 : 0;\n        vv = out[i].v.substr(0, j);\n\n        for (; j < out[i].v.length; ++j) {\n          if (jj < ostr.length) vv += ostr.charAt(jj++);\n        }\n\n        out[i].v = vv;\n        out[i].t = 't';\n        lasti = i;\n      }\n    }\n  }\n\n  for (i = 0; i < out.length; ++i) if (out[i] != null && 'n?'.indexOf(out[i].t) > -1) {\n    myv = flen > 1 && v < 0 && i > 0 && out[i - 1].v === \"-\" ? -v : v;\n    out[i].v = write_num(out[i].t, out[i].v, myv);\n    out[i].t = 't';\n  }\n\n  var retval = \"\";\n\n  for (i = 0; i !== out.length; ++i) if (out[i] != null) retval += out[i].v;\n\n  return retval;\n}\n\nvar cfregex2 = /\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;\n\nfunction chkcond(v, rr) {\n  if (rr == null) return false;\n  var thresh = parseFloat(rr[2]);\n\n  switch (rr[1]) {\n    case \"=\":\n      if (v == thresh) return true;\n      break;\n\n    case \">\":\n      if (v > thresh) return true;\n      break;\n\n    case \"<\":\n      if (v < thresh) return true;\n      break;\n\n    case \"<>\":\n      if (v != thresh) return true;\n      break;\n\n    case \">=\":\n      if (v >= thresh) return true;\n      break;\n\n    case \"<=\":\n      if (v <= thresh) return true;\n      break;\n  }\n\n  return false;\n}\n\nfunction choose_fmt(f\n/*:string*/\n, v\n/*:any*/\n) {\n  var fmt = SSF_split_fmt(f);\n  var l = fmt.length,\n      lat = fmt[l - 1].indexOf(\"@\");\n  if (l < 4 && lat > -1) --l;\n  if (fmt.length > 4) throw new Error(\"cannot find right format for |\" + fmt.join(\"|\") + \"|\");\n  if (typeof v !== \"number\") return [4, fmt.length === 4 || lat > -1 ? fmt[fmt.length - 1] : \"@\"];\n\n  switch (fmt.length) {\n    case 1:\n      fmt = lat > -1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"];\n      break;\n\n    case 2:\n      fmt = lat > -1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"];\n      break;\n\n    case 3:\n      fmt = lat > -1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"];\n      break;\n\n    case 4:\n      break;\n  }\n\n  var ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n  if (fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\n  if (fmt[0].match(/\\[[=<>]/) != null || fmt[1].match(/\\[[=<>]/) != null) {\n    var m1 = fmt[0].match(cfregex2);\n    var m2 = fmt[1].match(cfregex2);\n    return chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n  }\n\n  return [l, ff];\n}\n\nfunction SSF_format(fmt\n/*:string|number*/\n, v\n/*:any*/\n, o\n/*:?any*/\n) {\n  if (o == null) o = {};\n  var sfmt = \"\";\n\n  switch (typeof fmt) {\n    case \"string\":\n      if (fmt == \"m/d/yy\" && o.dateNF) sfmt = o.dateNF;else sfmt = fmt;\n      break;\n\n    case \"number\":\n      if (fmt == 14 && o.dateNF) sfmt = o.dateNF;else sfmt = (o.table != null ? o.table\n      /*:any*/\n      : table_fmt)[fmt];\n      if (sfmt == null) sfmt = o.table && o.table[SSF_default_map[fmt]] || table_fmt[SSF_default_map[fmt]];\n      if (sfmt == null) sfmt = SSF_default_str[fmt] || \"General\";\n      break;\n  }\n\n  if (SSF_isgeneral(sfmt, 0)) return SSF_general(v, o);\n  if (v instanceof Date) v = datenum_local(v, o.date1904);\n  var f = choose_fmt(sfmt, v);\n  if (SSF_isgeneral(f[1])) return SSF_general(v, o);\n  if (v === true) v = \"TRUE\";else if (v === false) v = \"FALSE\";else if (v === \"\" || v == null) return \"\";\n  return eval_fmt(f[1], v, o, f[0]);\n}\n\nfunction SSF_load(fmt\n/*:string*/\n, idx\n/*:?number*/\n)\n/*:number*/\n{\n  if (typeof idx != 'number') {\n    idx = +idx || -1;\n    /*::if(typeof idx != 'number') return 0x188; */\n\n    for (var i = 0; i < 0x0188; ++i) {\n      /*::if(typeof idx != 'number') return 0x188; */\n      if (table_fmt[i] == undefined) {\n        if (idx < 0) idx = i;\n        continue;\n      }\n\n      if (table_fmt[i] == fmt) {\n        idx = i;\n        break;\n      }\n    }\n    /*::if(typeof idx != 'number') return 0x188; */\n\n\n    if (idx < 0) idx = 0x187;\n  }\n  /*::if(typeof idx != 'number') return 0x188; */\n\n\n  table_fmt[idx] = fmt;\n  return idx;\n}\n\nfunction SSF_load_table(tbl\n/*:SSFTable*/\n)\n/*:void*/\n{\n  for (var i = 0; i != 0x0188; ++i) if (tbl[i] !== undefined) SSF_load(tbl[i], i);\n}\n\nfunction make_ssf() {\n  table_fmt = SSF_init_table();\n}\n\nvar SSF = {\n  format: SSF_format,\n  load: SSF_load,\n  _table: table_fmt,\n  load_table: SSF_load_table,\n  parse_date_code: SSF_parse_date_code,\n  is_date: fmt_is_date,\n  get_table: function get_table() {\n    return SSF._table = table_fmt;\n  }\n};\nvar SSFImplicit\n/*{[number]:string}*/\n= {\n  \"5\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n  \"6\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n  \"7\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n  \"8\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n  \"23\": 'General',\n  \"24\": 'General',\n  \"25\": 'General',\n  \"26\": 'General',\n  \"27\": 'm/d/yy',\n  \"28\": 'm/d/yy',\n  \"29\": 'm/d/yy',\n  \"30\": 'm/d/yy',\n  \"31\": 'm/d/yy',\n  \"32\": 'h:mm:ss',\n  \"33\": 'h:mm:ss',\n  \"34\": 'h:mm:ss',\n  \"35\": 'h:mm:ss',\n  \"36\": 'm/d/yy',\n  \"41\": '_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)',\n  \"42\": '_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)',\n  \"43\": '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)',\n  \"44\": '_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)',\n  \"50\": 'm/d/yy',\n  \"51\": 'm/d/yy',\n  \"52\": 'm/d/yy',\n  \"53\": 'm/d/yy',\n  \"54\": 'm/d/yy',\n  \"55\": 'm/d/yy',\n  \"56\": 'm/d/yy',\n  \"57\": 'm/d/yy',\n  \"58\": 'm/d/yy',\n  \"59\": '0',\n  \"60\": '0.00',\n  \"61\": '#,##0',\n  \"62\": '#,##0.00',\n  \"63\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n  \"64\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n  \"65\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n  \"66\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n  \"67\": '0%',\n  \"68\": '0.00%',\n  \"69\": '# ?/?',\n  \"70\": '# ??/??',\n  \"71\": 'm/d/yy',\n  \"72\": 'm/d/yy',\n  \"73\": 'd-mmm-yy',\n  \"74\": 'd-mmm',\n  \"75\": 'mmm-yy',\n  \"76\": 'h:mm',\n  \"77\": 'h:mm:ss',\n  \"78\": 'm/d/yy h:mm',\n  \"79\": 'mm:ss',\n  \"80\": '[h]:mm:ss',\n  \"81\": 'mmss.0'\n}\n/*:any*/\n;\n/* dateNF parse TODO: move to SSF */\n\nvar dateNFregex = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;\n\nfunction dateNF_regex(dateNF\n/*:string|number*/\n)\n/*:RegExp*/\n{\n  var fmt = typeof dateNF == \"number\" ? table_fmt[dateNF] : dateNF;\n  fmt = fmt.replace(dateNFregex, \"(\\\\d+)\");\n  return new RegExp(\"^\" + fmt + \"$\");\n}\n\nfunction dateNF_fix(str\n/*:string*/\n, dateNF\n/*:string*/\n, match\n/*:Array<string>*/\n)\n/*:string*/\n{\n  var Y = -1,\n      m = -1,\n      d = -1,\n      H = -1,\n      M = -1,\n      S = -1;\n  (dateNF.match(dateNFregex) || []).forEach(function (n, i) {\n    var v = parseInt(match[i + 1], 10);\n\n    switch (n.toLowerCase().charAt(0)) {\n      case 'y':\n        Y = v;\n        break;\n\n      case 'd':\n        d = v;\n        break;\n\n      case 'h':\n        H = v;\n        break;\n\n      case 's':\n        S = v;\n        break;\n\n      case 'm':\n        if (H >= 0) M = v;else m = v;\n        break;\n    }\n  });\n\n  if (S >= 0 && M == -1 && m >= 0) {\n    M = m;\n    m = -1;\n  }\n\n  var datestr = (\"\" + (Y >= 0 ? Y : new Date().getFullYear())).slice(-4) + \"-\" + (\"00\" + (m >= 1 ? m : 1)).slice(-2) + \"-\" + (\"00\" + (d >= 1 ? d : 1)).slice(-2);\n  if (datestr.length == 7) datestr = \"0\" + datestr;\n  if (datestr.length == 8) datestr = \"20\" + datestr;\n  var timestr = (\"00\" + (H >= 0 ? H : 0)).slice(-2) + \":\" + (\"00\" + (M >= 0 ? M : 0)).slice(-2) + \":\" + (\"00\" + (S >= 0 ? S : 0)).slice(-2);\n  if (H == -1 && M == -1 && S == -1) return datestr;\n  if (Y == -1 && m == -1 && d == -1) return timestr;\n  return datestr + \"T\" + timestr;\n}\n/*::\ndeclare var ReadShift:any;\ndeclare var CheckField:any;\ndeclare var prep_blob:any;\ndeclare var __readUInt32LE:any;\ndeclare var __readInt32LE:any;\ndeclare var __toBuffer:any;\ndeclare var __utf16le:any;\ndeclare var bconcat:any;\ndeclare var s2a:any;\ndeclare var chr0:any;\ndeclare var chr1:any;\ndeclare var has_buf:boolean;\ndeclare var new_buf:any;\ndeclare var new_raw_buf:any;\ndeclare var new_unsafe_buf:any;\ndeclare var Buffer_from:any;\n*/\n\n/* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\n\n/* vim: set ts=2: */\n\n/*jshint eqnull:true */\n\n/*exported CFB */\n\n/*global Uint8Array:false, Uint16Array:false */\n\n/*::\ntype SectorEntry = {\n\tname?:string;\n\tnodes?:Array<number>;\n\tdata:RawBytes;\n};\ntype SectorList = {\n\t[k:string|number]:SectorEntry;\n\tname:?string;\n\tfat_addrs:Array<number>;\n\tssz:number;\n}\ntype CFBFiles = {[n:string]:CFBEntry};\n*/\n\n/* crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */\n\n/* vim: set ts=2: */\n\n/*exported CRC32 */\n\n\nvar CRC32 = /*#__PURE__*/function () {\n  var CRC32 = {};\n  CRC32.version = '1.2.0';\n  /* see perf/crc32table.js */\n\n  /*global Int32Array */\n\n  function signed_crc_table()\n  /*:any*/\n  {\n    var c = 0,\n        table\n    /*:Array<number>*/\n    = new Array(256);\n\n    for (var n = 0; n != 256; ++n) {\n      c = n;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      c = c & 1 ? -306674912 ^ c >>> 1 : c >>> 1;\n      table[n] = c;\n    }\n\n    return typeof Int32Array !== 'undefined' ? new Int32Array(table) : table;\n  }\n\n  var T0 = signed_crc_table();\n\n  function slice_by_16_tables(T) {\n    var c = 0,\n        v = 0,\n        n = 0,\n        table\n    /*:Array<number>*/\n    = typeof Int32Array !== 'undefined' ? new Int32Array(4096) : new Array(4096);\n\n    for (n = 0; n != 256; ++n) table[n] = T[n];\n\n    for (n = 0; n != 256; ++n) {\n      v = T[n];\n\n      for (c = 256 + n; c < 4096; c += 256) v = table[c] = v >>> 8 ^ T[v & 0xFF];\n    }\n\n    var out = [];\n\n    for (n = 1; n != 16; ++n) out[n - 1] = typeof Int32Array !== 'undefined' ? table.subarray(n * 256, n * 256 + 256) : table.slice(n * 256, n * 256 + 256);\n\n    return out;\n  }\n\n  var TT = slice_by_16_tables(T0);\n  var T1 = TT[0],\n      T2 = TT[1],\n      T3 = TT[2],\n      T4 = TT[3],\n      T5 = TT[4];\n  var T6 = TT[5],\n      T7 = TT[6],\n      T8 = TT[7],\n      T9 = TT[8],\n      Ta = TT[9];\n  var Tb = TT[10],\n      Tc = TT[11],\n      Td = TT[12],\n      Te = TT[13],\n      Tf = TT[14];\n\n  function crc32_bstr(bstr\n  /*:string*/\n  , seed\n  /*:number*/\n  )\n  /*:number*/\n  {\n    var C = seed\n    /*:: ? 0 : 0 */\n    ^ -1;\n\n    for (var i = 0, L = bstr.length; i < L;) C = C >>> 8 ^ T0[(C ^ bstr.charCodeAt(i++)) & 0xFF];\n\n    return ~C;\n  }\n\n  function crc32_buf(B\n  /*:Uint8Array|Array<number>*/\n  , seed\n  /*:number*/\n  )\n  /*:number*/\n  {\n    var C = seed\n    /*:: ? 0 : 0 */\n    ^ -1,\n        L = B.length - 15,\n        i = 0;\n\n    for (; i < L;) C = Tf[B[i++] ^ C & 255] ^ Te[B[i++] ^ C >> 8 & 255] ^ Td[B[i++] ^ C >> 16 & 255] ^ Tc[B[i++] ^ C >>> 24] ^ Tb[B[i++]] ^ Ta[B[i++]] ^ T9[B[i++]] ^ T8[B[i++]] ^ T7[B[i++]] ^ T6[B[i++]] ^ T5[B[i++]] ^ T4[B[i++]] ^ T3[B[i++]] ^ T2[B[i++]] ^ T1[B[i++]] ^ T0[B[i++]];\n\n    L += 15;\n\n    while (i < L) C = C >>> 8 ^ T0[(C ^ B[i++]) & 0xFF];\n\n    return ~C;\n  }\n\n  function crc32_str(str\n  /*:string*/\n  , seed\n  /*:number*/\n  )\n  /*:number*/\n  {\n    var C = seed ^ -1;\n\n    for (var i = 0, L = str.length, c = 0, d = 0; i < L;) {\n      c = str.charCodeAt(i++);\n\n      if (c < 0x80) {\n        C = C >>> 8 ^ T0[(C ^ c) & 0xFF];\n      } else if (c < 0x800) {\n        C = C >>> 8 ^ T0[(C ^ (192 | c >> 6 & 31)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | c & 63)) & 0xFF];\n      } else if (c >= 0xD800 && c < 0xE000) {\n        c = (c & 1023) + 64;\n        d = str.charCodeAt(i++) & 1023;\n        C = C >>> 8 ^ T0[(C ^ (240 | c >> 8 & 7)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | c >> 2 & 63)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | d >> 6 & 15 | (c & 3) << 4)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | d & 63)) & 0xFF];\n      } else {\n        C = C >>> 8 ^ T0[(C ^ (224 | c >> 12 & 15)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | c >> 6 & 63)) & 0xFF];\n        C = C >>> 8 ^ T0[(C ^ (128 | c & 63)) & 0xFF];\n      }\n    }\n\n    return ~C;\n  }\n\n  CRC32.table = T0;\n  CRC32.bstr = crc32_bstr;\n  CRC32.buf = crc32_buf;\n  CRC32.str = crc32_str;\n  return CRC32;\n}();\n/* [MS-CFB] v20171201 */\n\n\nvar CFB = /*#__PURE__*/function _CFB() {\n  var exports = {};\n  exports.version = '1.2.1';\n  /* [MS-CFB] 2.6.4 */\n\n  function namecmp(l\n  /*:string*/\n  , r\n  /*:string*/\n  )\n  /*:number*/\n  {\n    var L = l.split(\"/\"),\n        R = r.split(\"/\");\n\n    for (var i = 0, c = 0, Z = Math.min(L.length, R.length); i < Z; ++i) {\n      if (c = L[i].length - R[i].length) return c;\n      if (L[i] != R[i]) return L[i] < R[i] ? -1 : 1;\n    }\n\n    return L.length - R.length;\n  }\n\n  function dirname(p\n  /*:string*/\n  )\n  /*:string*/\n  {\n    if (p.charAt(p.length - 1) == \"/\") return p.slice(0, -1).indexOf(\"/\") === -1 ? p : dirname(p.slice(0, -1));\n    var c = p.lastIndexOf(\"/\");\n    return c === -1 ? p : p.slice(0, c + 1);\n  }\n\n  function filename(p\n  /*:string*/\n  )\n  /*:string*/\n  {\n    if (p.charAt(p.length - 1) == \"/\") return filename(p.slice(0, -1));\n    var c = p.lastIndexOf(\"/\");\n    return c === -1 ? p : p.slice(c + 1);\n  }\n  /* -------------------------------------------------------------------------- */\n\n  /* DOS Date format:\n     high|YYYYYYYm.mmmddddd.HHHHHMMM.MMMSSSSS|low\n     add 1980 to stored year\n     stored second should be doubled\n  */\n\n  /* write JS date to buf as a DOS date */\n\n\n  function write_dos_date(buf\n  /*:CFBlob*/\n  , date\n  /*:Date|string*/\n  ) {\n    if (typeof date === \"string\") date = new Date(date);\n    var hms\n    /*:number*/\n    = date.getHours();\n    hms = hms << 6 | date.getMinutes();\n    hms = hms << 5 | date.getSeconds() >>> 1;\n    buf.write_shift(2, hms);\n    var ymd\n    /*:number*/\n    = date.getFullYear() - 1980;\n    ymd = ymd << 4 | date.getMonth() + 1;\n    ymd = ymd << 5 | date.getDate();\n    buf.write_shift(2, ymd);\n  }\n  /* read four bytes from buf and interpret as a DOS date */\n\n\n  function parse_dos_date(buf\n  /*:CFBlob*/\n  )\n  /*:Date*/\n  {\n    var hms = buf.read_shift(2) & 0xFFFF;\n    var ymd = buf.read_shift(2) & 0xFFFF;\n    var val = new Date();\n    var d = ymd & 0x1F;\n    ymd >>>= 5;\n    var m = ymd & 0x0F;\n    ymd >>>= 4;\n    val.setMilliseconds(0);\n    val.setFullYear(ymd + 1980);\n    val.setMonth(m - 1);\n    val.setDate(d);\n    var S = hms & 0x1F;\n    hms >>>= 5;\n    var M = hms & 0x3F;\n    hms >>>= 6;\n    val.setHours(hms);\n    val.setMinutes(M);\n    val.setSeconds(S << 1);\n    return val;\n  }\n\n  function parse_extra_field(blob\n  /*:CFBlob*/\n  )\n  /*:any*/\n  {\n    prep_blob(blob, 0);\n    var o =\n    /*::(*/\n    {}\n    /*:: :any)*/\n    ;\n    var flags = 0;\n\n    while (blob.l <= blob.length - 4) {\n      var type = blob.read_shift(2);\n      var sz = blob.read_shift(2),\n          tgt = blob.l + sz;\n      var p = {};\n\n      switch (type) {\n        /* UNIX-style Timestamps */\n        case 0x5455:\n          {\n            flags = blob.read_shift(1);\n            if (flags & 1) p.mtime = blob.read_shift(4);\n            /* for some reason, CD flag corresponds to LFH */\n\n            if (sz > 5) {\n              if (flags & 2) p.atime = blob.read_shift(4);\n              if (flags & 4) p.ctime = blob.read_shift(4);\n            }\n\n            if (p.mtime) p.mt = new Date(p.mtime * 1000);\n          }\n          break;\n      }\n\n      blob.l = tgt;\n      o[type] = p;\n    }\n\n    return o;\n  }\n\n  var fs\n  /*:: = require('fs'); */\n  ;\n\n  function get_fs() {\n    return fs || (fs = {});\n  }\n\n  function parse(file\n  /*:RawBytes*/\n  , options\n  /*:CFBReadOpts*/\n  )\n  /*:CFBContainer*/\n  {\n    if (file[0] == 0x50 && file[1] == 0x4b) return parse_zip(file, options);\n    if ((file[0] | 0x20) == 0x6d && (file[1] | 0x20) == 0x69) return parse_mad(file, options);\n    if (file.length < 512) throw new Error(\"CFB file size \" + file.length + \" < 512\");\n    var mver = 3;\n    var ssz = 512;\n    var nmfs = 0; // number of mini FAT sectors\n\n    var difat_sec_cnt = 0;\n    var dir_start = 0;\n    var minifat_start = 0;\n    var difat_start = 0;\n    var fat_addrs\n    /*:Array<number>*/\n    = []; // locations of FAT sectors\n\n    /* [MS-CFB] 2.2 Compound File Header */\n\n    var blob\n    /*:CFBlob*/\n    =\n    /*::(*/\n    file.slice(0, 512)\n    /*:: :any)*/\n    ;\n    prep_blob(blob, 0);\n    /* major version */\n\n    var mv = check_get_mver(blob);\n    mver = mv[0];\n\n    switch (mver) {\n      case 3:\n        ssz = 512;\n        break;\n\n      case 4:\n        ssz = 4096;\n        break;\n\n      case 0:\n        if (mv[1] == 0) return parse_zip(file, options);\n\n      /* falls through */\n\n      default:\n        throw new Error(\"Major Version: Expected 3 or 4 saw \" + mver);\n    }\n    /* reprocess header */\n\n\n    if (ssz !== 512) {\n      blob =\n      /*::(*/\n      file.slice(0, ssz)\n      /*:: :any)*/\n      ;\n      prep_blob(blob, 28\n      /* blob.l */\n      );\n    }\n    /* Save header for final object */\n\n\n    var header\n    /*:RawBytes*/\n    = file.slice(0, ssz);\n    check_shifts(blob, mver); // Number of Directory Sectors\n\n    var dir_cnt\n    /*:number*/\n    = blob.read_shift(4, 'i');\n    if (mver === 3 && dir_cnt !== 0) throw new Error('# Directory Sectors: Expected 0 saw ' + dir_cnt); // Number of FAT Sectors\n\n    blob.l += 4; // First Directory Sector Location\n\n    dir_start = blob.read_shift(4, 'i'); // Transaction Signature\n\n    blob.l += 4; // Mini Stream Cutoff Size\n\n    blob.chk('00100000', 'Mini Stream Cutoff Size: '); // First Mini FAT Sector Location\n\n    minifat_start = blob.read_shift(4, 'i'); // Number of Mini FAT Sectors\n\n    nmfs = blob.read_shift(4, 'i'); // First DIFAT sector location\n\n    difat_start = blob.read_shift(4, 'i'); // Number of DIFAT Sectors\n\n    difat_sec_cnt = blob.read_shift(4, 'i'); // Grab FAT Sector Locations\n\n    for (var q = -1, j = 0; j < 109; ++j) {\n      /* 109 = (512 - blob.l)>>>2; */\n      q = blob.read_shift(4, 'i');\n      if (q < 0) break;\n      fat_addrs[j] = q;\n    }\n    /** Break the file up into sectors */\n\n\n    var sectors\n    /*:Array<RawBytes>*/\n    = sectorify(file, ssz);\n    sleuth_fat(difat_start, difat_sec_cnt, sectors, ssz, fat_addrs);\n    /** Chains */\n\n    var sector_list\n    /*:SectorList*/\n    = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n    sector_list[dir_start].name = \"!Directory\";\n    if (nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\n    sector_list[fat_addrs[0]].name = \"!FAT\";\n    sector_list.fat_addrs = fat_addrs;\n    sector_list.ssz = ssz;\n    /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n\n    var files\n    /*:CFBFiles*/\n    = {},\n        Paths\n    /*:Array<string>*/\n    = [],\n        FileIndex\n    /*:CFBFileIndex*/\n    = [],\n        FullPaths\n    /*:Array<string>*/\n    = [];\n    read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, minifat_start);\n    build_full_paths(FileIndex, FullPaths, Paths);\n    Paths.shift();\n    var o = {\n      FileIndex: FileIndex,\n      FullPaths: FullPaths\n    }; // $FlowIgnore\n\n    if (options && options.raw) o.raw = {\n      header: header,\n      sectors: sectors\n    };\n    return o;\n  } // parse\n\n  /* [MS-CFB] 2.2 Compound File Header -- read up to major version */\n\n\n  function check_get_mver(blob\n  /*:CFBlob*/\n  )\n  /*:[number, number]*/\n  {\n    if (blob[blob.l] == 0x50 && blob[blob.l + 1] == 0x4b) return [0, 0]; // header signature 8\n\n    blob.chk(HEADER_SIGNATURE, 'Header Signature: '); // clsid 16\n    //blob.chk(HEADER_CLSID, 'CLSID: ');\n\n    blob.l += 16; // minor version 2\n\n    var mver\n    /*:number*/\n    = blob.read_shift(2, 'u');\n    return [blob.read_shift(2, 'u'), mver];\n  }\n\n  function check_shifts(blob\n  /*:CFBlob*/\n  , mver\n  /*:number*/\n  )\n  /*:void*/\n  {\n    var shift = 0x09; // Byte Order\n    //blob.chk('feff', 'Byte Order: '); // note: some writers put 0xffff\n\n    blob.l += 2; // Sector Shift\n\n    switch (shift = blob.read_shift(2)) {\n      case 0x09:\n        if (mver != 3) throw new Error('Sector Shift: Expected 9 saw ' + shift);\n        break;\n\n      case 0x0c:\n        if (mver != 4) throw new Error('Sector Shift: Expected 12 saw ' + shift);\n        break;\n\n      default:\n        throw new Error('Sector Shift: Expected 9 or 12 saw ' + shift);\n    } // Mini Sector Shift\n\n\n    blob.chk('0600', 'Mini Sector Shift: '); // Reserved\n\n    blob.chk('000000000000', 'Reserved: ');\n  }\n  /** Break the file up into sectors */\n\n\n  function sectorify(file\n  /*:RawBytes*/\n  , ssz\n  /*:number*/\n  )\n  /*:Array<RawBytes>*/\n  {\n    var nsectors = Math.ceil(file.length / ssz) - 1;\n    var sectors\n    /*:Array<RawBytes>*/\n    = [];\n\n    for (var i = 1; i < nsectors; ++i) sectors[i - 1] = file.slice(i * ssz, (i + 1) * ssz);\n\n    sectors[nsectors - 1] = file.slice(nsectors * ssz);\n    return sectors;\n  }\n  /* [MS-CFB] 2.6.4 Red-Black Tree */\n\n\n  function build_full_paths(FI\n  /*:CFBFileIndex*/\n  , FP\n  /*:Array<string>*/\n  , Paths\n  /*:Array<string>*/\n  )\n  /*:void*/\n  {\n    var i = 0,\n        L = 0,\n        R = 0,\n        C = 0,\n        j = 0,\n        pl = Paths.length;\n    var dad\n    /*:Array<number>*/\n    = [],\n        q\n    /*:Array<number>*/\n    = [];\n\n    for (; i < pl; ++i) {\n      dad[i] = q[i] = i;\n      FP[i] = Paths[i];\n    }\n\n    for (; j < q.length; ++j) {\n      i = q[j];\n      L = FI[i].L;\n      R = FI[i].R;\n      C = FI[i].C;\n\n      if (dad[i] === i) {\n        if (L !== -1\n        /*NOSTREAM*/\n        && dad[L] !== L) dad[i] = dad[L];\n        if (R !== -1 && dad[R] !== R) dad[i] = dad[R];\n      }\n\n      if (C !== -1\n      /*NOSTREAM*/\n      ) dad[C] = i;\n\n      if (L !== -1 && i != dad[i]) {\n        dad[L] = dad[i];\n        if (q.lastIndexOf(L) < j) q.push(L);\n      }\n\n      if (R !== -1 && i != dad[i]) {\n        dad[R] = dad[i];\n        if (q.lastIndexOf(R) < j) q.push(R);\n      }\n    }\n\n    for (i = 1; i < pl; ++i) if (dad[i] === i) {\n      if (R !== -1\n      /*NOSTREAM*/\n      && dad[R] !== R) dad[i] = dad[R];else if (L !== -1 && dad[L] !== L) dad[i] = dad[L];\n    }\n\n    for (i = 1; i < pl; ++i) {\n      if (FI[i].type === 0\n      /* unknown */\n      ) continue;\n      j = i;\n      if (j != dad[j]) do {\n        j = dad[j];\n        FP[i] = FP[j] + \"/\" + FP[i];\n      } while (j !== 0 && -1 !== dad[j] && j != dad[j]);\n      dad[i] = -1;\n    }\n\n    FP[0] += \"/\";\n\n    for (i = 1; i < pl; ++i) {\n      if (FI[i].type !== 2\n      /* stream */\n      ) FP[i] += \"/\";\n    }\n  }\n\n  function get_mfat_entry(entry\n  /*:CFBEntry*/\n  , payload\n  /*:RawBytes*/\n  , mini\n  /*:?RawBytes*/\n  )\n  /*:CFBlob*/\n  {\n    var start = entry.start,\n        size = entry.size; //return (payload.slice(start*MSSZ, start*MSSZ + size)/*:any*/);\n\n    var o = [];\n    var idx = start;\n\n    while (mini && size > 0 && idx >= 0) {\n      o.push(payload.slice(idx * MSSZ, idx * MSSZ + MSSZ));\n      size -= MSSZ;\n      idx = __readInt32LE(mini, idx * 4);\n    }\n\n    if (o.length === 0) return new_buf(0)\n    /*:any*/\n    ;\n    return bconcat(o).slice(0, entry.size)\n    /*:any*/\n    ;\n  }\n  /** Chase down the rest of the DIFAT chain to build a comprehensive list\n      DIFAT chains by storing the next sector number as the last 32 bits */\n\n\n  function sleuth_fat(idx\n  /*:number*/\n  , cnt\n  /*:number*/\n  , sectors\n  /*:Array<RawBytes>*/\n  , ssz\n  /*:number*/\n  , fat_addrs)\n  /*:void*/\n  {\n    var q\n    /*:number*/\n    = ENDOFCHAIN;\n\n    if (idx === ENDOFCHAIN) {\n      if (cnt !== 0) throw new Error(\"DIFAT chain shorter than expected\");\n    } else if (idx !== -1\n    /*FREESECT*/\n    ) {\n      var sector = sectors[idx],\n          m = (ssz >>> 2) - 1;\n      if (!sector) return;\n\n      for (var i = 0; i < m; ++i) {\n        if ((q = __readInt32LE(sector, i * 4)) === ENDOFCHAIN) break;\n        fat_addrs.push(q);\n      }\n\n      sleuth_fat(__readInt32LE(sector, ssz - 4), cnt - 1, sectors, ssz, fat_addrs);\n    }\n  }\n  /** Follow the linked list of sectors for a given starting point */\n\n\n  function get_sector_list(sectors\n  /*:Array<RawBytes>*/\n  , start\n  /*:number*/\n  , fat_addrs\n  /*:Array<number>*/\n  , ssz\n  /*:number*/\n  , chkd\n  /*:?Array<boolean>*/\n  )\n  /*:SectorEntry*/\n  {\n    var buf\n    /*:Array<number>*/\n    = [],\n        buf_chain\n    /*:Array<any>*/\n    = [];\n    if (!chkd) chkd = [];\n    var modulus = ssz - 1,\n        j = 0,\n        jj = 0;\n\n    for (j = start; j >= 0;) {\n      chkd[j] = true;\n      buf[buf.length] = j;\n      buf_chain.push(sectors[j]);\n      var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n      jj = j * 4 & modulus;\n      if (ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \" + ssz);\n      if (!sectors[addr]) break;\n      j = __readInt32LE(sectors[addr], jj);\n    }\n\n    return {\n      nodes: buf,\n      data: __toBuffer([buf_chain])\n    };\n  }\n  /** Chase down the sector linked lists */\n\n\n  function make_sector_list(sectors\n  /*:Array<RawBytes>*/\n  , dir_start\n  /*:number*/\n  , fat_addrs\n  /*:Array<number>*/\n  , ssz\n  /*:number*/\n  )\n  /*:SectorList*/\n  {\n    var sl = sectors.length,\n        sector_list\n    /*:SectorList*/\n    = []\n    /*:any*/\n    ;\n    var chkd\n    /*:Array<boolean>*/\n    = [],\n        buf\n    /*:Array<number>*/\n    = [],\n        buf_chain\n    /*:Array<RawBytes>*/\n    = [];\n    var modulus = ssz - 1,\n        i = 0,\n        j = 0,\n        k = 0,\n        jj = 0;\n\n    for (i = 0; i < sl; ++i) {\n      buf = []\n      /*:Array<number>*/\n      ;\n      k = i + dir_start;\n      if (k >= sl) k -= sl;\n      if (chkd[k]) continue;\n      buf_chain = [];\n      var seen = [];\n\n      for (j = k; j >= 0;) {\n        seen[j] = true;\n        chkd[j] = true;\n        buf[buf.length] = j;\n        buf_chain.push(sectors[j]);\n        var addr\n        /*:number*/\n        = fat_addrs[Math.floor(j * 4 / ssz)];\n        jj = j * 4 & modulus;\n        if (ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \" + ssz);\n        if (!sectors[addr]) break;\n        j = __readInt32LE(sectors[addr], jj);\n        if (seen[j]) break;\n      }\n\n      sector_list[k] = {\n        nodes: buf,\n        data: __toBuffer([buf_chain])\n      }\n      /*:SectorEntry*/\n      ;\n    }\n\n    return sector_list;\n  }\n  /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n\n\n  function read_directory(dir_start\n  /*:number*/\n  , sector_list\n  /*:SectorList*/\n  , sectors\n  /*:Array<RawBytes>*/\n  , Paths\n  /*:Array<string>*/\n  , nmfs, files, FileIndex, mini) {\n    var minifat_store = 0,\n        pl = Paths.length ? 2 : 0;\n    var sector = sector_list[dir_start].data;\n    var i = 0,\n        namelen = 0,\n        name;\n\n    for (; i < sector.length; i += 128) {\n      var blob\n      /*:CFBlob*/\n      =\n      /*::(*/\n      sector.slice(i, i + 128)\n      /*:: :any)*/\n      ;\n      prep_blob(blob, 64);\n      namelen = blob.read_shift(2);\n      name = __utf16le(blob, 0, namelen - pl);\n      Paths.push(name);\n      var o\n      /*:CFBEntry*/\n      = {\n        name: name,\n        type: blob.read_shift(1),\n        color: blob.read_shift(1),\n        L: blob.read_shift(4, 'i'),\n        R: blob.read_shift(4, 'i'),\n        C: blob.read_shift(4, 'i'),\n        clsid: blob.read_shift(16),\n        state: blob.read_shift(4, 'i'),\n        start: 0,\n        size: 0\n      };\n      var ctime\n      /*:number*/\n      = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n      if (ctime !== 0) o.ct = read_date(blob, blob.l - 8);\n      var mtime\n      /*:number*/\n      = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n      if (mtime !== 0) o.mt = read_date(blob, blob.l - 8);\n      o.start = blob.read_shift(4, 'i');\n      o.size = blob.read_shift(4, 'i');\n\n      if (o.size < 0 && o.start < 0) {\n        o.size = o.type = 0;\n        o.start = ENDOFCHAIN;\n        o.name = \"\";\n      }\n\n      if (o.type === 5) {\n        /* root */\n        minifat_store = o.start;\n        if (nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n        /*minifat_size = o.size;*/\n      } else if (o.size >= 4096\n      /* MSCSZ */\n      ) {\n        o.storage = 'fat';\n        if (sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n        sector_list[o.start].name = o.name;\n        o.content = sector_list[o.start].data.slice(0, o.size)\n        /*:any*/\n        ;\n      } else {\n        o.storage = 'minifat';\n        if (o.size < 0) o.size = 0;else if (minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN && sector_list[minifat_store]) {\n          o.content = get_mfat_entry(o, sector_list[minifat_store].data, (sector_list[mini] || {}).data);\n        }\n      }\n\n      if (o.content) prep_blob(o.content, 0);\n      files[name] = o;\n      FileIndex.push(o);\n    }\n  }\n\n  function read_date(blob\n  /*:RawBytes|CFBlob*/\n  , offset\n  /*:number*/\n  )\n  /*:Date*/\n  {\n    return new Date((__readUInt32LE(blob, offset + 4) / 1e7 * Math.pow(2, 32) + __readUInt32LE(blob, offset) / 1e7 - 11644473600) * 1000);\n  }\n\n  function read_file(filename\n  /*:string*/\n  , options\n  /*:CFBReadOpts*/\n  ) {\n    get_fs();\n    return parse(fs.readFileSync(filename), options);\n  }\n\n  function read(blob\n  /*:RawBytes|string*/\n  , options\n  /*:CFBReadOpts*/\n  ) {\n    var type = options && options.type;\n\n    if (!type) {\n      if (has_buf && Buffer.isBuffer(blob)) type = \"buffer\";\n    }\n\n    switch (type || \"base64\") {\n      case \"file\":\n        /*:: if(typeof blob !== 'string') throw \"Must pass a filename when type='file'\"; */\n        return read_file(blob, options);\n\n      case \"base64\":\n        /*:: if(typeof blob !== 'string') throw \"Must pass a base64-encoded binary string when type='file'\"; */\n        return parse(s2a(Base64_decode(blob)), options);\n\n      case \"binary\":\n        /*:: if(typeof blob !== 'string') throw \"Must pass a binary string when type='file'\"; */\n        return parse(s2a(blob), options);\n    }\n\n    return parse(\n    /*::typeof blob == 'string' ? new Buffer(blob, 'utf-8') : */\n    blob, options);\n  }\n\n  function init_cfb(cfb\n  /*:CFBContainer*/\n  , opts\n  /*:?any*/\n  )\n  /*:void*/\n  {\n    var o = opts || {},\n        root = o.root || \"Root Entry\";\n    if (!cfb.FullPaths) cfb.FullPaths = [];\n    if (!cfb.FileIndex) cfb.FileIndex = [];\n    if (cfb.FullPaths.length !== cfb.FileIndex.length) throw new Error(\"inconsistent CFB structure\");\n\n    if (cfb.FullPaths.length === 0) {\n      cfb.FullPaths[0] = root + \"/\";\n      cfb.FileIndex[0] = {\n        name: root,\n        type: 5\n      }\n      /*:any*/\n      ;\n    }\n\n    if (o.CLSID) cfb.FileIndex[0].clsid = o.CLSID;\n    seed_cfb(cfb);\n  }\n\n  function seed_cfb(cfb\n  /*:CFBContainer*/\n  )\n  /*:void*/\n  {\n    var nm = \"\\u0001Sh33tJ5\";\n    if (CFB.find(cfb, \"/\" + nm)) return;\n    var p = new_buf(4);\n    p[0] = 55;\n    p[1] = p[3] = 50;\n    p[2] = 54;\n    cfb.FileIndex.push({\n      name: nm,\n      type: 2,\n      content: p,\n      size: 4,\n      L: 69,\n      R: 69,\n      C: 69\n    }\n    /*:any*/\n    );\n    cfb.FullPaths.push(cfb.FullPaths[0] + nm);\n    rebuild_cfb(cfb);\n  }\n\n  function rebuild_cfb(cfb\n  /*:CFBContainer*/\n  , f\n  /*:?boolean*/\n  )\n  /*:void*/\n  {\n    init_cfb(cfb);\n    var gc = false,\n        s = false;\n\n    for (var i = cfb.FullPaths.length - 1; i >= 0; --i) {\n      var _file = cfb.FileIndex[i];\n\n      switch (_file.type) {\n        case 0:\n          if (s) gc = true;else {\n            cfb.FileIndex.pop();\n            cfb.FullPaths.pop();\n          }\n          break;\n\n        case 1:\n        case 2:\n        case 5:\n          s = true;\n          if (isNaN(_file.R * _file.L * _file.C)) gc = true;\n          if (_file.R > -1 && _file.L > -1 && _file.R == _file.L) gc = true;\n          break;\n\n        default:\n          gc = true;\n          break;\n      }\n    }\n\n    if (!gc && !f) return;\n    var now = new Date(1987, 1, 19),\n        j = 0; // Track which names exist\n\n    var fullPaths = Object.create ? Object.create(null) : {};\n    var data\n    /*:Array<[string, CFBEntry]>*/\n    = [];\n\n    for (i = 0; i < cfb.FullPaths.length; ++i) {\n      fullPaths[cfb.FullPaths[i]] = true;\n      if (cfb.FileIndex[i].type === 0) continue;\n      data.push([cfb.FullPaths[i], cfb.FileIndex[i]]);\n    }\n\n    for (i = 0; i < data.length; ++i) {\n      var dad = dirname(data[i][0]);\n      s = fullPaths[dad];\n\n      if (!s) {\n        data.push([dad, {\n          name: filename(dad).replace(\"/\", \"\"),\n          type: 1,\n          clsid: HEADER_CLSID,\n          ct: now,\n          mt: now,\n          content: null\n        }\n        /*:any*/\n        ]); // Add name to set\n\n        fullPaths[dad] = true;\n      }\n    }\n\n    data.sort(function (x, y) {\n      return namecmp(x[0], y[0]);\n    });\n    cfb.FullPaths = [];\n    cfb.FileIndex = [];\n\n    for (i = 0; i < data.length; ++i) {\n      cfb.FullPaths[i] = data[i][0];\n      cfb.FileIndex[i] = data[i][1];\n    }\n\n    for (i = 0; i < data.length; ++i) {\n      var elt = cfb.FileIndex[i];\n      var nm = cfb.FullPaths[i];\n      elt.name = filename(nm).replace(\"/\", \"\");\n      elt.L = elt.R = elt.C = -(elt.color = 1);\n      elt.size = elt.content ? elt.content.length : 0;\n      elt.start = 0;\n      elt.clsid = elt.clsid || HEADER_CLSID;\n\n      if (i === 0) {\n        elt.C = data.length > 1 ? 1 : -1;\n        elt.size = 0;\n        elt.type = 5;\n      } else if (nm.slice(-1) == \"/\") {\n        for (j = i + 1; j < data.length; ++j) if (dirname(cfb.FullPaths[j]) == nm) break;\n\n        elt.C = j >= data.length ? -1 : j;\n\n        for (j = i + 1; j < data.length; ++j) if (dirname(cfb.FullPaths[j]) == dirname(nm)) break;\n\n        elt.R = j >= data.length ? -1 : j;\n        elt.type = 1;\n      } else {\n        if (dirname(cfb.FullPaths[i + 1] || \"\") == dirname(nm)) elt.R = i + 1;\n        elt.type = 2;\n      }\n    }\n  }\n\n  function _write(cfb\n  /*:CFBContainer*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:RawBytes|string*/\n  {\n    var _opts = options || {};\n    /* MAD is order-sensitive, skip rebuild and sort */\n\n\n    if (_opts.fileType == 'mad') return write_mad(cfb, _opts);\n    rebuild_cfb(cfb);\n\n    switch (_opts.fileType) {\n      case 'zip':\n        return write_zip(cfb, _opts);\n      //case 'mad': return write_mad(cfb, _opts);\n    }\n\n    var L = function (cfb\n    /*:CFBContainer*/\n    )\n    /*:Array<number>*/\n    {\n      var mini_size = 0,\n          fat_size = 0;\n\n      for (var i = 0; i < cfb.FileIndex.length; ++i) {\n        var file = cfb.FileIndex[i];\n        if (!file.content) continue;\n        /*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\n        var flen = file.content.length;\n\n        if (flen > 0) {\n          if (flen < 0x1000) mini_size += flen + 0x3F >> 6;else fat_size += flen + 0x01FF >> 9;\n        }\n      }\n\n      var dir_cnt = cfb.FullPaths.length + 3 >> 2;\n      var mini_cnt = mini_size + 7 >> 3;\n      var mfat_cnt = mini_size + 0x7F >> 7;\n      var fat_base = mini_cnt + fat_size + dir_cnt + mfat_cnt;\n      var fat_cnt = fat_base + 0x7F >> 7;\n      var difat_cnt = fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt - 109) / 0x7F);\n\n      while (fat_base + fat_cnt + difat_cnt + 0x7F >> 7 > fat_cnt) difat_cnt = ++fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt - 109) / 0x7F);\n\n      var L = [1, difat_cnt, fat_cnt, mfat_cnt, dir_cnt, fat_size, mini_size, 0];\n      cfb.FileIndex[0].size = mini_size << 6;\n      L[7] = (cfb.FileIndex[0].start = L[0] + L[1] + L[2] + L[3] + L[4] + L[5]) + (L[6] + 7 >> 3);\n      return L;\n    }(cfb);\n\n    var o = new_buf(L[7] << 9);\n    var i = 0,\n        T = 0;\n    {\n      for (i = 0; i < 8; ++i) o.write_shift(1, HEADER_SIG[i]);\n\n      for (i = 0; i < 8; ++i) o.write_shift(2, 0);\n\n      o.write_shift(2, 0x003E);\n      o.write_shift(2, 0x0003);\n      o.write_shift(2, 0xFFFE);\n      o.write_shift(2, 0x0009);\n      o.write_shift(2, 0x0006);\n\n      for (i = 0; i < 3; ++i) o.write_shift(2, 0);\n\n      o.write_shift(4, 0);\n      o.write_shift(4, L[2]);\n      o.write_shift(4, L[0] + L[1] + L[2] + L[3] - 1);\n      o.write_shift(4, 0);\n      o.write_shift(4, 1 << 12);\n      o.write_shift(4, L[3] ? L[0] + L[1] + L[2] - 1 : ENDOFCHAIN);\n      o.write_shift(4, L[3]);\n      o.write_shift(-4, L[1] ? L[0] - 1 : ENDOFCHAIN);\n      o.write_shift(4, L[1]);\n\n      for (i = 0; i < 109; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n    }\n\n    if (L[1]) {\n      for (T = 0; T < L[1]; ++T) {\n        for (; i < 236 + T * 127; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n\n        o.write_shift(-4, T === L[1] - 1 ? ENDOFCHAIN : T + 1);\n      }\n    }\n\n    var chainit = function (w\n    /*:number*/\n    )\n    /*:void*/\n    {\n      for (T += w; i < T - 1; ++i) o.write_shift(-4, i + 1);\n\n      if (w) {\n        ++i;\n        o.write_shift(-4, ENDOFCHAIN);\n      }\n    };\n\n    T = i = 0;\n\n    for (T += L[1]; i < T; ++i) o.write_shift(-4, consts.DIFSECT);\n\n    for (T += L[2]; i < T; ++i) o.write_shift(-4, consts.FATSECT);\n\n    chainit(L[3]);\n    chainit(L[4]);\n    var j\n    /*:number*/\n    = 0,\n        flen\n    /*:number*/\n    = 0;\n    var file\n    /*:CFBEntry*/\n    = cfb.FileIndex[0];\n\n    for (; j < cfb.FileIndex.length; ++j) {\n      file = cfb.FileIndex[j];\n      if (!file.content) continue;\n      /*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\n      flen = file.content.length;\n      if (flen < 0x1000) continue;\n      file.start = T;\n      chainit(flen + 0x01FF >> 9);\n    }\n\n    chainit(L[6] + 7 >> 3);\n\n    while (o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\n    T = i = 0;\n\n    for (j = 0; j < cfb.FileIndex.length; ++j) {\n      file = cfb.FileIndex[j];\n      if (!file.content) continue;\n      /*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\n      flen = file.content.length;\n      if (!flen || flen >= 0x1000) continue;\n      file.start = T;\n      chainit(flen + 0x3F >> 6);\n    }\n\n    while (o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\n    for (i = 0; i < L[4] << 2; ++i) {\n      var nm = cfb.FullPaths[i];\n\n      if (!nm || nm.length === 0) {\n        for (j = 0; j < 17; ++j) o.write_shift(4, 0);\n\n        for (j = 0; j < 3; ++j) o.write_shift(4, -1);\n\n        for (j = 0; j < 12; ++j) o.write_shift(4, 0);\n\n        continue;\n      }\n\n      file = cfb.FileIndex[i];\n      if (i === 0) file.start = file.size ? file.start - 1 : ENDOFCHAIN;\n\n      var _nm\n      /*:string*/\n      = i === 0 && _opts.root || file.name;\n\n      flen = 2 * (_nm.length + 1);\n      o.write_shift(64, _nm, \"utf16le\");\n      o.write_shift(2, flen);\n      o.write_shift(1, file.type);\n      o.write_shift(1, file.color);\n      o.write_shift(-4, file.L);\n      o.write_shift(-4, file.R);\n      o.write_shift(-4, file.C);\n      if (!file.clsid) for (j = 0; j < 4; ++j) o.write_shift(4, 0);else o.write_shift(16, file.clsid, \"hex\");\n      o.write_shift(4, file.state || 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, file.start);\n      o.write_shift(4, file.size);\n      o.write_shift(4, 0);\n    }\n\n    for (i = 1; i < cfb.FileIndex.length; ++i) {\n      file = cfb.FileIndex[i];\n      /*:: if(!file.content) throw new Error(\"unreachable\"); */\n\n      if (file.size >= 0x1000) {\n        o.l = file.start + 1 << 9;\n\n        if (has_buf && Buffer.isBuffer(file.content)) {\n          file.content.copy(o, o.l, 0, file.size); // o is a 0-filled Buffer so just set next offset\n\n          o.l += file.size + 511 & -512;\n        } else {\n          for (j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\n          for (; j & 0x1FF; ++j) o.write_shift(1, 0);\n        }\n      }\n    }\n\n    for (i = 1; i < cfb.FileIndex.length; ++i) {\n      file = cfb.FileIndex[i];\n      /*:: if(!file.content) throw new Error(\"unreachable\"); */\n\n      if (file.size > 0 && file.size < 0x1000) {\n        if (has_buf && Buffer.isBuffer(file.content)) {\n          file.content.copy(o, o.l, 0, file.size); // o is a 0-filled Buffer so just set next offset\n\n          o.l += file.size + 63 & -64;\n        } else {\n          for (j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\n          for (; j & 0x3F; ++j) o.write_shift(1, 0);\n        }\n      }\n    }\n\n    if (has_buf) {\n      o.l = o.length;\n    } else {\n      // When using Buffer, already 0-filled\n      while (o.l < o.length) o.write_shift(1, 0);\n    }\n\n    return o;\n  }\n  /* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\n\n\n  function find(cfb\n  /*:CFBContainer*/\n  , path\n  /*:string*/\n  )\n  /*:?CFBEntry*/\n  {\n    var UCFullPaths\n    /*:Array<string>*/\n    = cfb.FullPaths.map(function (x) {\n      return x.toUpperCase();\n    });\n    var UCPaths\n    /*:Array<string>*/\n    = UCFullPaths.map(function (x) {\n      var y = x.split(\"/\");\n      return y[y.length - (x.slice(-1) == \"/\" ? 2 : 1)];\n    });\n    var k\n    /*:boolean*/\n    = false;\n\n    if (path.charCodeAt(0) === 47\n    /* \"/\" */\n    ) {\n      k = true;\n      path = UCFullPaths[0].slice(0, -1) + path;\n    } else k = path.indexOf(\"/\") !== -1;\n\n    var UCPath\n    /*:string*/\n    = path.toUpperCase();\n    var w\n    /*:number*/\n    = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n    if (w !== -1) return cfb.FileIndex[w];\n    var m = !UCPath.match(chr1);\n    UCPath = UCPath.replace(chr0, '');\n    if (m) UCPath = UCPath.replace(chr1, '!');\n\n    for (w = 0; w < UCFullPaths.length; ++w) {\n      if ((m ? UCFullPaths[w].replace(chr1, '!') : UCFullPaths[w]).replace(chr0, '') == UCPath) return cfb.FileIndex[w];\n      if ((m ? UCPaths[w].replace(chr1, '!') : UCPaths[w]).replace(chr0, '') == UCPath) return cfb.FileIndex[w];\n    }\n\n    return null;\n  }\n  /** CFB Constants */\n\n\n  var MSSZ = 64;\n  /* Mini Sector Size = 1<<6 */\n  //var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n\n  /* 2.1 Compound File Sector Numbers and Types */\n\n  var ENDOFCHAIN = -2;\n  /* 2.2 Compound File Header */\n\n  var HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\n  var HEADER_SIG = [0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1];\n  var HEADER_CLSID = '00000000000000000000000000000000';\n  var consts = {\n    /* 2.1 Compund File Sector Numbers and Types */\n    MAXREGSECT: -6,\n    DIFSECT: -4,\n    FATSECT: -3,\n    ENDOFCHAIN: ENDOFCHAIN,\n    FREESECT: -1,\n\n    /* 2.2 Compound File Header */\n    HEADER_SIGNATURE: HEADER_SIGNATURE,\n    HEADER_MINOR_VERSION: '3e00',\n    MAXREGSID: -6,\n    NOSTREAM: -1,\n    HEADER_CLSID: HEADER_CLSID,\n\n    /* 2.6.1 Compound File Directory Entry */\n    EntryTypes: ['unknown', 'storage', 'stream', 'lockbytes', 'property', 'root']\n  };\n\n  function write_file(cfb\n  /*:CFBContainer*/\n  , filename\n  /*:string*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:void*/\n  {\n    get_fs();\n\n    var o = _write(cfb, options);\n    /*:: if(typeof Buffer == 'undefined' || !Buffer.isBuffer(o) || !(o instanceof Buffer)) throw new Error(\"unreachable\"); */\n\n\n    fs.writeFileSync(filename, o);\n  }\n\n  function a2s(o\n  /*:RawBytes*/\n  )\n  /*:string*/\n  {\n    var out = new Array(o.length);\n\n    for (var i = 0; i < o.length; ++i) out[i] = String.fromCharCode(o[i]);\n\n    return out.join(\"\");\n  }\n\n  function write(cfb\n  /*:CFBContainer*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:RawBytes|string*/\n  {\n    var o = _write(cfb, options);\n\n    switch (options && options.type || \"buffer\") {\n      case \"file\":\n        get_fs();\n        fs.writeFileSync(options.filename, o\n        /*:any*/\n        );\n        return o;\n\n      case \"binary\":\n        return typeof o == \"string\" ? o : a2s(o);\n\n      case \"base64\":\n        return Base64_encode(typeof o == \"string\" ? o : a2s(o));\n\n      case \"buffer\":\n        if (has_buf) return Buffer.isBuffer(o) ? o : Buffer_from(o);\n\n      /* falls through */\n\n      case \"array\":\n        return typeof o == \"string\" ? s2a(o) : o;\n    }\n\n    return o;\n  }\n  /* node < 8.1 zlib does not expose bytesRead, so default to pure JS */\n\n\n  var _zlib;\n\n  function use_zlib(zlib) {\n    try {\n      var InflateRaw = zlib.InflateRaw;\n      var InflRaw = new InflateRaw();\n\n      InflRaw._processChunk(new Uint8Array([3, 0]), InflRaw._finishFlushFlag);\n\n      if (InflRaw.bytesRead) _zlib = zlib;else throw new Error(\"zlib does not expose bytesRead\");\n    } catch (e) {\n      console.error(\"cannot use native zlib: \" + (e.message || e));\n    }\n  }\n\n  function _inflateRawSync(payload, usz) {\n    if (!_zlib) return _inflate(payload, usz);\n    var InflateRaw = _zlib.InflateRaw;\n    var InflRaw = new InflateRaw();\n\n    var out = InflRaw._processChunk(payload.slice(payload.l), InflRaw._finishFlushFlag);\n\n    payload.l += InflRaw.bytesRead;\n    return out;\n  }\n\n  function _deflateRawSync(payload) {\n    return _zlib ? _zlib.deflateRawSync(payload) : _deflate(payload);\n  }\n\n  var CLEN_ORDER = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];\n  /*  LEN_ID = [ 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285 ]; */\n\n  var LEN_LN = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258];\n  /*  DST_ID = [  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13,  14,  15,  16,  17,  18,  19,   20,   21,   22,   23,   24,   25,   26,    27,    28,    29 ]; */\n\n  var DST_LN = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577];\n\n  function bit_swap_8(n) {\n    var t = (n << 1 | n << 11) & 0x22110 | (n << 5 | n << 15) & 0x88440;\n    return (t >> 16 | t >> 8 | t) & 0xFF;\n  }\n\n  var use_typed_arrays = typeof Uint8Array !== 'undefined';\n  var bitswap8 = use_typed_arrays ? new Uint8Array(1 << 8) : [];\n\n  for (var q = 0; q < 1 << 8; ++q) bitswap8[q] = bit_swap_8(q);\n\n  function bit_swap_n(n, b) {\n    var rev = bitswap8[n & 0xFF];\n    if (b <= 8) return rev >>> 8 - b;\n    rev = rev << 8 | bitswap8[n >> 8 & 0xFF];\n    if (b <= 16) return rev >>> 16 - b;\n    rev = rev << 8 | bitswap8[n >> 16 & 0xFF];\n    return rev >>> 24 - b;\n  }\n  /* helpers for unaligned bit reads */\n\n\n  function read_bits_2(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 6 ? 0 : buf[h + 1] << 8)) >>> w & 0x03;\n  }\n\n  function read_bits_3(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 5 ? 0 : buf[h + 1] << 8)) >>> w & 0x07;\n  }\n\n  function read_bits_4(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 4 ? 0 : buf[h + 1] << 8)) >>> w & 0x0F;\n  }\n\n  function read_bits_5(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 3 ? 0 : buf[h + 1] << 8)) >>> w & 0x1F;\n  }\n\n  function read_bits_7(buf, bl) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    return (buf[h] | (w <= 1 ? 0 : buf[h + 1] << 8)) >>> w & 0x7F;\n  }\n  /* works up to n = 3 * 8 + 1 = 25 */\n\n\n  function read_bits_n(buf, bl, n) {\n    var w = bl & 7,\n        h = bl >>> 3,\n        f = (1 << n) - 1;\n    var v = buf[h] >>> w;\n    if (n < 8 - w) return v & f;\n    v |= buf[h + 1] << 8 - w;\n    if (n < 16 - w) return v & f;\n    v |= buf[h + 2] << 16 - w;\n    if (n < 24 - w) return v & f;\n    v |= buf[h + 3] << 24 - w;\n    return v & f;\n  }\n  /* helpers for unaligned bit writes */\n\n\n  function write_bits_3(buf, bl, v) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    if (w <= 5) buf[h] |= (v & 7) << w;else {\n      buf[h] |= v << w & 0xFF;\n      buf[h + 1] = (v & 7) >> 8 - w;\n    }\n    return bl + 3;\n  }\n\n  function write_bits_1(buf, bl, v) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    v = (v & 1) << w;\n    buf[h] |= v;\n    return bl + 1;\n  }\n\n  function write_bits_8(buf, bl, v) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    v <<= w;\n    buf[h] |= v & 0xFF;\n    v >>>= 8;\n    buf[h + 1] = v;\n    return bl + 8;\n  }\n\n  function write_bits_16(buf, bl, v) {\n    var w = bl & 7,\n        h = bl >>> 3;\n    v <<= w;\n    buf[h] |= v & 0xFF;\n    v >>>= 8;\n    buf[h + 1] = v & 0xFF;\n    buf[h + 2] = v >>> 8;\n    return bl + 16;\n  }\n  /* until ArrayBuffer#realloc is a thing, fake a realloc */\n\n\n  function realloc(b, sz\n  /*:number*/\n  ) {\n    var L = b.length,\n        M = 2 * L > sz ? 2 * L : sz + 5,\n        i = 0;\n    if (L >= sz) return b;\n\n    if (has_buf) {\n      var o = new_unsafe_buf(M); // $FlowIgnore\n\n      if (b.copy) b.copy(o);else for (; i < b.length; ++i) o[i] = b[i];\n      return o;\n    } else if (use_typed_arrays) {\n      var a = new Uint8Array(M);\n      if (a.set) a.set(b);else for (; i < L; ++i) a[i] = b[i];\n      return a;\n    }\n\n    b.length = M;\n    return b;\n  }\n  /* zero-filled arrays for older browsers */\n\n\n  function zero_fill_array(n) {\n    var o = new Array(n);\n\n    for (var i = 0; i < n; ++i) o[i] = 0;\n\n    return o;\n  }\n  /* build tree (used for literals and lengths) */\n\n\n  function build_tree(clens, cmap, MAX\n  /*:number*/\n  )\n  /*:number*/\n  {\n    var maxlen = 1,\n        w = 0,\n        i = 0,\n        j = 0,\n        ccode = 0,\n        L = clens.length;\n    var bl_count = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n\n    for (i = 0; i < 32; ++i) bl_count[i] = 0;\n\n    for (i = L; i < MAX; ++i) clens[i] = 0;\n\n    L = clens.length;\n    var ctree = use_typed_arrays ? new Uint16Array(L) : zero_fill_array(L); // []\n\n    /* build code tree */\n\n    for (i = 0; i < L; ++i) {\n      bl_count[w = clens[i]]++;\n      if (maxlen < w) maxlen = w;\n      ctree[i] = 0;\n    }\n\n    bl_count[0] = 0;\n\n    for (i = 1; i <= maxlen; ++i) bl_count[i + 16] = ccode = ccode + bl_count[i - 1] << 1;\n\n    for (i = 0; i < L; ++i) {\n      ccode = clens[i];\n      if (ccode != 0) ctree[i] = bl_count[ccode + 16]++;\n    }\n    /* cmap[maxlen + 4 bits] = (off&15) + (lit<<4) reverse mapping */\n\n\n    var cleni = 0;\n\n    for (i = 0; i < L; ++i) {\n      cleni = clens[i];\n\n      if (cleni != 0) {\n        ccode = bit_swap_n(ctree[i], maxlen) >> maxlen - cleni;\n\n        for (j = (1 << maxlen + 4 - cleni) - 1; j >= 0; --j) cmap[ccode | j << cleni] = cleni & 15 | i << 4;\n      }\n    }\n\n    return maxlen;\n  }\n  /* Fixed Huffman */\n\n\n  var fix_lmap = use_typed_arrays ? new Uint16Array(512) : zero_fill_array(512);\n  var fix_dmap = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n\n  if (!use_typed_arrays) {\n    for (var i = 0; i < 512; ++i) fix_lmap[i] = 0;\n\n    for (i = 0; i < 32; ++i) fix_dmap[i] = 0;\n  }\n\n  (function () {\n    var dlens\n    /*:Array<number>*/\n    = [];\n    var i = 0;\n\n    for (; i < 32; i++) dlens.push(5);\n\n    build_tree(dlens, fix_dmap, 32);\n    var clens\n    /*:Array<number>*/\n    = [];\n    i = 0;\n\n    for (; i <= 143; i++) clens.push(8);\n\n    for (; i <= 255; i++) clens.push(9);\n\n    for (; i <= 279; i++) clens.push(7);\n\n    for (; i <= 287; i++) clens.push(8);\n\n    build_tree(clens, fix_lmap, 288);\n  })();\n\n  var _deflateRaw = /*#__PURE__*/function _deflateRawIIFE() {\n    var DST_LN_RE = use_typed_arrays ? new Uint8Array(0x8000) : [];\n    var j = 0,\n        k = 0;\n\n    for (; j < DST_LN.length - 1; ++j) {\n      for (; k < DST_LN[j + 1]; ++k) DST_LN_RE[k] = j;\n    }\n\n    for (; k < 32768; ++k) DST_LN_RE[k] = 29;\n\n    var LEN_LN_RE = use_typed_arrays ? new Uint8Array(0x103) : [];\n\n    for (j = 0, k = 0; j < LEN_LN.length - 1; ++j) {\n      for (; k < LEN_LN[j + 1]; ++k) LEN_LN_RE[k] = j;\n    }\n\n    function write_stored(data, out) {\n      var boff = 0;\n\n      while (boff < data.length) {\n        var L = Math.min(0xFFFF, data.length - boff);\n        var h = boff + L == data.length;\n        out.write_shift(1, +h);\n        out.write_shift(2, L);\n        out.write_shift(2, ~L & 0xFFFF);\n\n        while (L-- > 0) out[out.l++] = data[boff++];\n      }\n\n      return out.l;\n    }\n    /* Fixed Huffman */\n\n\n    function write_huff_fixed(data, out) {\n      var bl = 0;\n      var boff = 0;\n      var addrs = use_typed_arrays ? new Uint16Array(0x8000) : [];\n\n      while (boff < data.length) {\n        var L =\n        /* data.length - boff; */\n        Math.min(0xFFFF, data.length - boff);\n        /* write a stored block for short data */\n\n        if (L < 10) {\n          bl = write_bits_3(out, bl, +!!(boff + L == data.length)); // jshint ignore:line\n\n          if (bl & 7) bl += 8 - (bl & 7);\n          out.l = bl / 8 | 0;\n          out.write_shift(2, L);\n          out.write_shift(2, ~L & 0xFFFF);\n\n          while (L-- > 0) out[out.l++] = data[boff++];\n\n          bl = out.l * 8;\n          continue;\n        }\n\n        bl = write_bits_3(out, bl, +!!(boff + L == data.length) + 2); // jshint ignore:line\n\n        var hash = 0;\n\n        while (L-- > 0) {\n          var d = data[boff];\n          hash = (hash << 5 ^ d) & 0x7FFF;\n          var match = -1,\n              mlen = 0;\n\n          if (match = addrs[hash]) {\n            match |= boff & ~0x7FFF;\n            if (match > boff) match -= 0x8000;\n            if (match < boff) while (data[match + mlen] == data[boff + mlen] && mlen < 250) ++mlen;\n          }\n\n          if (mlen > 2) {\n            /* Copy Token  */\n            d = LEN_LN_RE[mlen];\n            if (d <= 22) bl = write_bits_8(out, bl, bitswap8[d + 1] >> 1) - 1;else {\n              write_bits_8(out, bl, 3);\n              bl += 5;\n              write_bits_8(out, bl, bitswap8[d - 23] >> 5);\n              bl += 3;\n            }\n            var len_eb = d < 8 ? 0 : d - 4 >> 2;\n\n            if (len_eb > 0) {\n              write_bits_16(out, bl, mlen - LEN_LN[d]);\n              bl += len_eb;\n            }\n\n            d = DST_LN_RE[boff - match];\n            bl = write_bits_8(out, bl, bitswap8[d] >> 3);\n            bl -= 3;\n            var dst_eb = d < 4 ? 0 : d - 2 >> 1;\n\n            if (dst_eb > 0) {\n              write_bits_16(out, bl, boff - match - DST_LN[d]);\n              bl += dst_eb;\n            }\n\n            for (var q = 0; q < mlen; ++q) {\n              addrs[hash] = boff & 0x7FFF;\n              hash = (hash << 5 ^ data[boff]) & 0x7FFF;\n              ++boff;\n            }\n\n            L -= mlen - 1;\n          } else {\n            /* Literal Token */\n            if (d <= 143) d = d + 48;else bl = write_bits_1(out, bl, 1);\n            bl = write_bits_8(out, bl, bitswap8[d]);\n            addrs[hash] = boff & 0x7FFF;\n            ++boff;\n          }\n        }\n\n        bl = write_bits_8(out, bl, 0) - 1;\n      }\n\n      out.l = (bl + 7) / 8 | 0;\n      return out.l;\n    }\n\n    return function _deflateRaw(data, out) {\n      if (data.length < 8) return write_stored(data, out);\n      return write_huff_fixed(data, out);\n    };\n  }();\n\n  function _deflate(data) {\n    var buf = new_buf(50 + Math.floor(data.length * 1.1));\n\n    var off = _deflateRaw(data, buf);\n\n    return buf.slice(0, off);\n  }\n  /* modified inflate function also moves original read head */\n\n\n  var dyn_lmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\n  var dyn_dmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\n  var dyn_cmap = use_typed_arrays ? new Uint16Array(128) : zero_fill_array(128);\n  var dyn_len_1 = 1,\n      dyn_len_2 = 1;\n  /* 5.5.3 Expanding Huffman Codes */\n\n  function dyn(data, boff\n  /*:number*/\n  ) {\n    /* nomenclature from RFC1951 refers to bit values; these are offset by the implicit constant */\n    var _HLIT = read_bits_5(data, boff) + 257;\n\n    boff += 5;\n\n    var _HDIST = read_bits_5(data, boff) + 1;\n\n    boff += 5;\n\n    var _HCLEN = read_bits_4(data, boff) + 4;\n\n    boff += 4;\n    var w = 0;\n    /* grab and store code lengths */\n\n    var clens = use_typed_arrays ? new Uint8Array(19) : zero_fill_array(19);\n    var ctree = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n    var maxlen = 1;\n    var bl_count = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n    var next_code = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n    var L = clens.length;\n    /* 19 */\n\n    for (var i = 0; i < _HCLEN; ++i) {\n      clens[CLEN_ORDER[i]] = w = read_bits_3(data, boff);\n      if (maxlen < w) maxlen = w;\n      bl_count[w]++;\n      boff += 3;\n    }\n    /* build code tree */\n\n\n    var ccode = 0;\n    bl_count[0] = 0;\n\n    for (i = 1; i <= maxlen; ++i) next_code[i] = ccode = ccode + bl_count[i - 1] << 1;\n\n    for (i = 0; i < L; ++i) if ((ccode = clens[i]) != 0) ctree[i] = next_code[ccode]++;\n    /* cmap[7 bits from stream] = (off&7) + (lit<<3) */\n\n\n    var cleni = 0;\n\n    for (i = 0; i < L; ++i) {\n      cleni = clens[i];\n\n      if (cleni != 0) {\n        ccode = bitswap8[ctree[i]] >> 8 - cleni;\n\n        for (var j = (1 << 7 - cleni) - 1; j >= 0; --j) dyn_cmap[ccode | j << cleni] = cleni & 7 | i << 3;\n      }\n    }\n    /* read literal and dist codes at once */\n\n\n    var hcodes\n    /*:Array<number>*/\n    = [];\n    maxlen = 1;\n\n    for (; hcodes.length < _HLIT + _HDIST;) {\n      ccode = dyn_cmap[read_bits_7(data, boff)];\n      boff += ccode & 7;\n\n      switch (ccode >>>= 3) {\n        case 16:\n          w = 3 + read_bits_2(data, boff);\n          boff += 2;\n          ccode = hcodes[hcodes.length - 1];\n\n          while (w-- > 0) hcodes.push(ccode);\n\n          break;\n\n        case 17:\n          w = 3 + read_bits_3(data, boff);\n          boff += 3;\n\n          while (w-- > 0) hcodes.push(0);\n\n          break;\n\n        case 18:\n          w = 11 + read_bits_7(data, boff);\n          boff += 7;\n\n          while (w-- > 0) hcodes.push(0);\n\n          break;\n\n        default:\n          hcodes.push(ccode);\n          if (maxlen < ccode) maxlen = ccode;\n          break;\n      }\n    }\n    /* build literal / length trees */\n\n\n    var h1 = hcodes.slice(0, _HLIT),\n        h2 = hcodes.slice(_HLIT);\n\n    for (i = _HLIT; i < 286; ++i) h1[i] = 0;\n\n    for (i = _HDIST; i < 30; ++i) h2[i] = 0;\n\n    dyn_len_1 = build_tree(h1, dyn_lmap, 286);\n    dyn_len_2 = build_tree(h2, dyn_dmap, 30);\n    return boff;\n  }\n  /* return [ data, bytesRead ] */\n\n\n  function inflate(data, usz\n  /*:number*/\n  ) {\n    /* shortcircuit for empty buffer [0x03, 0x00] */\n    if (data[0] == 3 && !(data[1] & 0x3)) {\n      return [new_raw_buf(usz), 2];\n    }\n    /* bit offset */\n\n\n    var boff = 0;\n    /* header includes final bit and type bits */\n\n    var header = 0;\n    var outbuf = new_unsafe_buf(usz ? usz : 1 << 18);\n    var woff = 0;\n    var OL = outbuf.length >>> 0;\n    var max_len_1 = 0,\n        max_len_2 = 0;\n\n    while ((header & 1) == 0) {\n      header = read_bits_3(data, boff);\n      boff += 3;\n\n      if (header >>> 1 == 0) {\n        /* Stored block */\n        if (boff & 7) boff += 8 - (boff & 7);\n        /* 2 bytes sz, 2 bytes bit inverse */\n\n        var sz = data[boff >>> 3] | data[(boff >>> 3) + 1] << 8;\n        boff += 32;\n        /* push sz bytes */\n\n        if (sz > 0) {\n          if (!usz && OL < woff + sz) {\n            outbuf = realloc(outbuf, woff + sz);\n            OL = outbuf.length;\n          }\n\n          while (sz-- > 0) {\n            outbuf[woff++] = data[boff >>> 3];\n            boff += 8;\n          }\n        }\n\n        continue;\n      } else if (header >> 1 == 1) {\n        /* Fixed Huffman */\n        max_len_1 = 9;\n        max_len_2 = 5;\n      } else {\n        /* Dynamic Huffman */\n        boff = dyn(data, boff);\n        max_len_1 = dyn_len_1;\n        max_len_2 = dyn_len_2;\n      }\n\n      for (;;) {\n        // while(true) is apparently out of vogue in modern JS circles\n        if (!usz && OL < woff + 32767) {\n          outbuf = realloc(outbuf, woff + 32767);\n          OL = outbuf.length;\n        }\n        /* ingest code and move read head */\n\n\n        var bits = read_bits_n(data, boff, max_len_1);\n        var code = header >>> 1 == 1 ? fix_lmap[bits] : dyn_lmap[bits];\n        boff += code & 15;\n        code >>>= 4;\n        /* 0-255 are literals, 256 is end of block token, 257+ are copy tokens */\n\n        if ((code >>> 8 & 0xFF) === 0) outbuf[woff++] = code;else if (code == 256) break;else {\n          code -= 257;\n          var len_eb = code < 8 ? 0 : code - 4 >> 2;\n          if (len_eb > 5) len_eb = 0;\n          var tgt = woff + LEN_LN[code];\n          /* length extra bits */\n\n          if (len_eb > 0) {\n            tgt += read_bits_n(data, boff, len_eb);\n            boff += len_eb;\n          }\n          /* dist code */\n\n\n          bits = read_bits_n(data, boff, max_len_2);\n          code = header >>> 1 == 1 ? fix_dmap[bits] : dyn_dmap[bits];\n          boff += code & 15;\n          code >>>= 4;\n          var dst_eb = code < 4 ? 0 : code - 2 >> 1;\n          var dst = DST_LN[code];\n          /* dist extra bits */\n\n          if (dst_eb > 0) {\n            dst += read_bits_n(data, boff, dst_eb);\n            boff += dst_eb;\n          }\n          /* in the common case, manual byte copy is faster than TA set / Buffer copy */\n\n\n          if (!usz && OL < tgt) {\n            outbuf = realloc(outbuf, tgt + 100);\n            OL = outbuf.length;\n          }\n\n          while (woff < tgt) {\n            outbuf[woff] = outbuf[woff - dst];\n            ++woff;\n          }\n        }\n      }\n    }\n\n    if (usz) return [outbuf, boff + 7 >>> 3];\n    return [outbuf.slice(0, woff), boff + 7 >>> 3];\n  }\n\n  function _inflate(payload, usz) {\n    var data = payload.slice(payload.l || 0);\n    var out = inflate(data, usz);\n    payload.l += out[1];\n    return out[0];\n  }\n\n  function warn_or_throw(wrn, msg) {\n    if (wrn) {\n      if (typeof console !== 'undefined') console.error(msg);\n    } else throw new Error(msg);\n  }\n\n  function parse_zip(file\n  /*:RawBytes*/\n  , options\n  /*:CFBReadOpts*/\n  )\n  /*:CFBContainer*/\n  {\n    var blob\n    /*:CFBlob*/\n    =\n    /*::(*/\n    file\n    /*:: :any)*/\n    ;\n    prep_blob(blob, 0);\n    var FileIndex\n    /*:CFBFileIndex*/\n    = [],\n        FullPaths\n    /*:Array<string>*/\n    = [];\n    var o = {\n      FileIndex: FileIndex,\n      FullPaths: FullPaths\n    };\n    init_cfb(o, {\n      root: options.root\n    });\n    /* find end of central directory, start just after signature */\n\n    var i = blob.length - 4;\n\n    while ((blob[i] != 0x50 || blob[i + 1] != 0x4b || blob[i + 2] != 0x05 || blob[i + 3] != 0x06) && i >= 0) --i;\n\n    blob.l = i + 4;\n    /* parse end of central directory */\n\n    blob.l += 4;\n    var fcnt = blob.read_shift(2);\n    blob.l += 6;\n    var start_cd = blob.read_shift(4);\n    /* parse central directory */\n\n    blob.l = start_cd;\n\n    for (i = 0; i < fcnt; ++i) {\n      /* trust local file header instead of CD entry */\n      blob.l += 20;\n      var csz = blob.read_shift(4);\n      var usz = blob.read_shift(4);\n      var namelen = blob.read_shift(2);\n      var efsz = blob.read_shift(2);\n      var fcsz = blob.read_shift(2);\n      blob.l += 8;\n      var offset = blob.read_shift(4);\n      var EF = parse_extra_field(\n      /*::(*/\n      blob.slice(blob.l + namelen, blob.l + namelen + efsz)\n      /*:: :any)*/\n      );\n      blob.l += namelen + efsz + fcsz;\n      var L = blob.l;\n      blob.l = offset + 4;\n      parse_local_file(blob, csz, usz, o, EF);\n      blob.l = L;\n    }\n\n    return o;\n  }\n  /* head starts just after local file header signature */\n\n\n  function parse_local_file(blob\n  /*:CFBlob*/\n  , csz\n  /*:number*/\n  , usz\n  /*:number*/\n  , o\n  /*:CFBContainer*/\n  , EF) {\n    /* [local file header] */\n    blob.l += 2;\n    var flags = blob.read_shift(2);\n    var meth = blob.read_shift(2);\n    var date = parse_dos_date(blob);\n    if (flags & 0x2041) throw new Error(\"Unsupported ZIP encryption\");\n    var crc32 = blob.read_shift(4);\n\n    var _csz = blob.read_shift(4);\n\n    var _usz = blob.read_shift(4);\n\n    var namelen = blob.read_shift(2);\n    var efsz = blob.read_shift(2); // TODO: flags & (1<<11) // UTF8\n\n    var name = \"\";\n\n    for (var i = 0; i < namelen; ++i) name += String.fromCharCode(blob[blob.l++]);\n\n    if (efsz) {\n      var ef = parse_extra_field(\n      /*::(*/\n      blob.slice(blob.l, blob.l + efsz)\n      /*:: :any)*/\n      );\n      if ((ef[0x5455] || {}).mt) date = ef[0x5455].mt;\n      if (((EF || {})[0x5455] || {}).mt) date = EF[0x5455].mt;\n    }\n\n    blob.l += efsz;\n    /* [encryption header] */\n\n    /* [file data] */\n\n    var data = blob.slice(blob.l, blob.l + _csz);\n\n    switch (meth) {\n      case 8:\n        data = _inflateRawSync(blob, _usz);\n        break;\n\n      case 0:\n        break;\n      // TODO: scan for magic number\n\n      default:\n        throw new Error(\"Unsupported ZIP Compression method \" + meth);\n    }\n    /* [data descriptor] */\n\n\n    var wrn = false;\n\n    if (flags & 8) {\n      crc32 = blob.read_shift(4);\n\n      if (crc32 == 0x08074b50) {\n        crc32 = blob.read_shift(4);\n        wrn = true;\n      }\n\n      _csz = blob.read_shift(4);\n      _usz = blob.read_shift(4);\n    }\n\n    if (_csz != csz) warn_or_throw(wrn, \"Bad compressed size: \" + csz + \" != \" + _csz);\n    if (_usz != usz) warn_or_throw(wrn, \"Bad uncompressed size: \" + usz + \" != \" + _usz); //var _crc32 = CRC32.buf(data, 0);\n    //if((crc32>>0) != (_crc32>>0)) warn_or_throw(wrn, \"Bad CRC32 checksum: \" + crc32 + \" != \" + _crc32);\n\n    cfb_add(o, name, data, {\n      unsafe: true,\n      mt: date\n    });\n  }\n\n  function write_zip(cfb\n  /*:CFBContainer*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:RawBytes*/\n  {\n    var _opts = options || {};\n\n    var out = [],\n        cdirs = [];\n    var o\n    /*:CFBlob*/\n    = new_buf(1);\n    var method = _opts.compression ? 8 : 0,\n        flags = 0;\n    var desc = false;\n    if (desc) flags |= 8;\n    var i = 0,\n        j = 0;\n    var start_cd = 0,\n        fcnt = 0;\n    var root = cfb.FullPaths[0],\n        fp = root,\n        fi = cfb.FileIndex[0];\n    var crcs = [];\n    var sz_cd = 0;\n\n    for (i = 1; i < cfb.FullPaths.length; ++i) {\n      fp = cfb.FullPaths[i].slice(root.length);\n      fi = cfb.FileIndex[i];\n      if (!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n      var start = start_cd;\n      /* TODO: CP437 filename */\n\n      var namebuf = new_buf(fp.length);\n\n      for (j = 0; j < fp.length; ++j) namebuf.write_shift(1, fp.charCodeAt(j) & 0x7F);\n\n      namebuf = namebuf.slice(0, namebuf.l);\n      crcs[fcnt] = CRC32.buf(\n      /*::((*/\n      fi.content\n      /*::||[]):any)*/\n      , 0);\n      var outbuf = fi.content\n      /*::||[]*/\n      ;\n      if (method == 8) outbuf = _deflateRawSync(outbuf);\n      /* local file header */\n\n      o = new_buf(30);\n      o.write_shift(4, 0x04034b50);\n      o.write_shift(2, 20);\n      o.write_shift(2, flags);\n      o.write_shift(2, method);\n      /* TODO: last mod file time/date */\n\n      if (fi.mt) write_dos_date(o, fi.mt);else o.write_shift(4, 0);\n      o.write_shift(-4, flags & 8 ? 0 : crcs[fcnt]);\n      o.write_shift(4, flags & 8 ? 0 : outbuf.length);\n      o.write_shift(4, flags & 8 ? 0 :\n      /*::(*/\n      fi.content\n      /*::||[])*/\n      .length);\n      o.write_shift(2, namebuf.length);\n      o.write_shift(2, 0);\n      start_cd += o.length;\n      out.push(o);\n      start_cd += namebuf.length;\n      out.push(namebuf);\n      /* TODO: extra fields? */\n\n      /* TODO: encryption header ? */\n\n      start_cd += outbuf.length;\n      out.push(outbuf);\n      /* data descriptor */\n\n      if (flags & 8) {\n        o = new_buf(12);\n        o.write_shift(-4, crcs[fcnt]);\n        o.write_shift(4, outbuf.length);\n        o.write_shift(4,\n        /*::(*/\n        fi.content\n        /*::||[])*/\n        .length);\n        start_cd += o.l;\n        out.push(o);\n      }\n      /* central directory */\n\n\n      o = new_buf(46);\n      o.write_shift(4, 0x02014b50);\n      o.write_shift(2, 0);\n      o.write_shift(2, 20);\n      o.write_shift(2, flags);\n      o.write_shift(2, method);\n      o.write_shift(4, 0);\n      /* TODO: last mod file time/date */\n\n      o.write_shift(-4, crcs[fcnt]);\n      o.write_shift(4, outbuf.length);\n      o.write_shift(4,\n      /*::(*/\n      fi.content\n      /*::||[])*/\n      .length);\n      o.write_shift(2, namebuf.length);\n      o.write_shift(2, 0);\n      o.write_shift(2, 0);\n      o.write_shift(2, 0);\n      o.write_shift(2, 0);\n      o.write_shift(4, 0);\n      o.write_shift(4, start);\n      sz_cd += o.l;\n      cdirs.push(o);\n      sz_cd += namebuf.length;\n      cdirs.push(namebuf);\n      ++fcnt;\n    }\n    /* end of central directory */\n\n\n    o = new_buf(22);\n    o.write_shift(4, 0x06054b50);\n    o.write_shift(2, 0);\n    o.write_shift(2, 0);\n    o.write_shift(2, fcnt);\n    o.write_shift(2, fcnt);\n    o.write_shift(4, sz_cd);\n    o.write_shift(4, start_cd);\n    o.write_shift(2, 0);\n    return bconcat([bconcat(out\n    /*:any*/\n    ), bconcat(cdirs), o]\n    /*:any*/\n    );\n  }\n\n  var ContentTypeMap = {\n    \"htm\": \"text/html\",\n    \"xml\": \"text/xml\",\n    \"gif\": \"image/gif\",\n    \"jpg\": \"image/jpeg\",\n    \"png\": \"image/png\",\n    \"mso\": \"application/x-mso\",\n    \"thmx\": \"application/vnd.ms-officetheme\",\n    \"sh33tj5\": \"application/octet-stream\"\n  }\n  /*:any*/\n  ;\n\n  function get_content_type(fi\n  /*:CFBEntry*/\n  , fp\n  /*:string*/\n  )\n  /*:string*/\n  {\n    if (fi.ctype) return fi.ctype;\n    var ext = fi.name || \"\",\n        m = ext.match(/\\.([^\\.]+)$/);\n    if (m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\n    if (fp) {\n      m = (ext = fp).match(/[\\.\\\\]([^\\.\\\\])+$/);\n      if (m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n    }\n\n    return \"application/octet-stream\";\n  }\n  /* 76 character chunks TODO: intertwine encoding */\n\n\n  function write_base64_76(bstr\n  /*:string*/\n  )\n  /*:string*/\n  {\n    var data = Base64_encode(bstr);\n    var o = [];\n\n    for (var i = 0; i < data.length; i += 76) o.push(data.slice(i, i + 76));\n\n    return o.join(\"\\r\\n\") + \"\\r\\n\";\n  }\n  /*\n  Rules for QP:\n  \t- escape =## applies for all non-display characters and literal \"=\"\n  \t- space or tab at end of line must be encoded\n  \t- \\r\\n newlines can be preserved, but bare \\r and \\n must be escaped\n  \t- lines must not exceed 76 characters, use soft breaks =\\r\\n\n  \n  TODO: Some files from word appear to write line extensions with bare equals:\n  \n  ```\n  <table class=3DMsoTableGrid border=3D1 cellspacing=3D0 cellpadding=3D0 width=\n  =\"70%\"\n  ```\n  */\n\n\n  function write_quoted_printable(text\n  /*:string*/\n  )\n  /*:string*/\n  {\n    var encoded = text.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF=]/g, function (c) {\n      var w = c.charCodeAt(0).toString(16).toUpperCase();\n      return \"=\" + (w.length == 1 ? \"0\" + w : w);\n    });\n    encoded = encoded.replace(/ $/mg, \"=20\").replace(/\\t$/mg, \"=09\");\n    if (encoded.charAt(0) == \"\\n\") encoded = \"=0D\" + encoded.slice(1);\n    encoded = encoded.replace(/\\r(?!\\n)/mg, \"=0D\").replace(/\\n\\n/mg, \"\\n=0A\").replace(/([^\\r\\n])\\n/mg, \"$1=0A\");\n    var o\n    /*:Array<string>*/\n    = [],\n        split = encoded.split(\"\\r\\n\");\n\n    for (var si = 0; si < split.length; ++si) {\n      var str = split[si];\n\n      if (str.length == 0) {\n        o.push(\"\");\n        continue;\n      }\n\n      for (var i = 0; i < str.length;) {\n        var end = 76;\n        var tmp = str.slice(i, i + end);\n        if (tmp.charAt(end - 1) == \"=\") end--;else if (tmp.charAt(end - 2) == \"=\") end -= 2;else if (tmp.charAt(end - 3) == \"=\") end -= 3;\n        tmp = str.slice(i, i + end);\n        i += end;\n        if (i < str.length) tmp += \"=\";\n        o.push(tmp);\n      }\n    }\n\n    return o.join(\"\\r\\n\");\n  }\n\n  function parse_quoted_printable(data\n  /*:Array<string>*/\n  )\n  /*:RawBytes*/\n  {\n    var o = [];\n    /* unify long lines */\n\n    for (var di = 0; di < data.length; ++di) {\n      var line = data[di];\n\n      while (di <= data.length && line.charAt(line.length - 1) == \"=\") line = line.slice(0, line.length - 1) + data[++di];\n\n      o.push(line);\n    }\n    /* decode */\n\n\n    for (var oi = 0; oi < o.length; ++oi) o[oi] = o[oi].replace(/[=][0-9A-Fa-f]{2}/g, function ($$) {\n      return String.fromCharCode(parseInt($$.slice(1), 16));\n    });\n\n    return s2a(o.join(\"\\r\\n\"));\n  }\n\n  function parse_mime(cfb\n  /*:CFBContainer*/\n  , data\n  /*:Array<string>*/\n  , root\n  /*:string*/\n  )\n  /*:void*/\n  {\n    var fname = \"\",\n        cte = \"\",\n        ctype = \"\",\n        fdata;\n    var di = 0;\n\n    for (; di < 10; ++di) {\n      var line = data[di];\n      if (!line || line.match(/^\\s*$/)) break;\n      var m = line.match(/^(.*?):\\s*([^\\s].*)$/);\n      if (m) switch (m[1].toLowerCase()) {\n        case \"content-location\":\n          fname = m[2].trim();\n          break;\n\n        case \"content-type\":\n          ctype = m[2].trim();\n          break;\n\n        case \"content-transfer-encoding\":\n          cte = m[2].trim();\n          break;\n      }\n    }\n\n    ++di;\n\n    switch (cte.toLowerCase()) {\n      case 'base64':\n        fdata = s2a(Base64_decode(data.slice(di).join(\"\")));\n        break;\n\n      case 'quoted-printable':\n        fdata = parse_quoted_printable(data.slice(di));\n        break;\n\n      default:\n        throw new Error(\"Unsupported Content-Transfer-Encoding \" + cte);\n    }\n\n    var file = cfb_add(cfb, fname.slice(root.length), fdata, {\n      unsafe: true\n    });\n    if (ctype) file.ctype = ctype;\n  }\n\n  function parse_mad(file\n  /*:RawBytes*/\n  , options\n  /*:CFBReadOpts*/\n  )\n  /*:CFBContainer*/\n  {\n    if (a2s(file.slice(0, 13)).toLowerCase() != \"mime-version:\") throw new Error(\"Unsupported MAD header\");\n    var root = options && options.root || \"\"; // $FlowIgnore\n\n    var data = (has_buf && Buffer.isBuffer(file) ? file.toString(\"binary\") : a2s(file)).split(\"\\r\\n\");\n    var di = 0,\n        row = \"\";\n    /* if root is not specified, scan for the common prefix */\n\n    for (di = 0; di < data.length; ++di) {\n      row = data[di];\n      if (!/^Content-Location:/i.test(row)) continue;\n      row = row.slice(row.indexOf(\"file\"));\n      if (!root) root = row.slice(0, row.lastIndexOf(\"/\") + 1);\n      if (row.slice(0, root.length) == root) continue;\n\n      while (root.length > 0) {\n        root = root.slice(0, root.length - 1);\n        root = root.slice(0, root.lastIndexOf(\"/\") + 1);\n        if (row.slice(0, root.length) == root) break;\n      }\n    }\n\n    var mboundary = (data[1] || \"\").match(/boundary=\"(.*?)\"/);\n    if (!mboundary) throw new Error(\"MAD cannot find boundary\");\n    var boundary = \"--\" + (mboundary[1] || \"\");\n    var FileIndex\n    /*:CFBFileIndex*/\n    = [],\n        FullPaths\n    /*:Array<string>*/\n    = [];\n    var o = {\n      FileIndex: FileIndex,\n      FullPaths: FullPaths\n    };\n    init_cfb(o);\n    var start_di,\n        fcnt = 0;\n\n    for (di = 0; di < data.length; ++di) {\n      var line = data[di];\n      if (line !== boundary && line !== boundary + \"--\") continue;\n      if (fcnt++) parse_mime(o, data.slice(start_di, di), root);\n      start_di = di;\n    }\n\n    return o;\n  }\n\n  function write_mad(cfb\n  /*:CFBContainer*/\n  , options\n  /*:CFBWriteOpts*/\n  )\n  /*:string*/\n  {\n    var opts = options || {};\n    var boundary = opts.boundary || \"SheetJS\";\n    boundary = '------=' + boundary;\n    var out = ['MIME-Version: 1.0', 'Content-Type: multipart/related; boundary=\"' + boundary.slice(2) + '\"', '', '', ''];\n    var root = cfb.FullPaths[0],\n        fp = root,\n        fi = cfb.FileIndex[0];\n\n    for (var i = 1; i < cfb.FullPaths.length; ++i) {\n      fp = cfb.FullPaths[i].slice(root.length);\n      fi = cfb.FileIndex[i];\n      if (!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n      /* Normalize filename */\n\n      fp = fp.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF]/g, function (c) {\n        return \"_x\" + c.charCodeAt(0).toString(16) + \"_\";\n      }).replace(/[\\u0080-\\uFFFF]/g, function (u) {\n        return \"_u\" + u.charCodeAt(0).toString(16) + \"_\";\n      });\n      /* Extract content as binary string */\n\n      var ca = fi.content; // $FlowIgnore\n\n      var cstr = has_buf && Buffer.isBuffer(ca) ? ca.toString(\"binary\") : a2s(ca);\n      /* 4/5 of first 1024 chars ascii -> quoted printable, else base64 */\n\n      var dispcnt = 0,\n          L = Math.min(1024, cstr.length),\n          cc = 0;\n\n      for (var csl = 0; csl <= L; ++csl) if ((cc = cstr.charCodeAt(csl)) >= 0x20 && cc < 0x80) ++dispcnt;\n\n      var qp = dispcnt >= L * 4 / 5;\n      out.push(boundary);\n      out.push('Content-Location: ' + (opts.root || 'file:///C:/SheetJS/') + fp);\n      out.push('Content-Transfer-Encoding: ' + (qp ? 'quoted-printable' : 'base64'));\n      out.push('Content-Type: ' + get_content_type(fi, fp));\n      out.push('');\n      out.push(qp ? write_quoted_printable(cstr) : write_base64_76(cstr));\n    }\n\n    out.push(boundary + '--\\r\\n');\n    return out.join(\"\\r\\n\");\n  }\n\n  function cfb_new(opts\n  /*:?any*/\n  )\n  /*:CFBContainer*/\n  {\n    var o\n    /*:CFBContainer*/\n    = {}\n    /*:any*/\n    ;\n    init_cfb(o, opts);\n    return o;\n  }\n\n  function cfb_add(cfb\n  /*:CFBContainer*/\n  , name\n  /*:string*/\n  , content\n  /*:?RawBytes*/\n  , opts\n  /*:?any*/\n  )\n  /*:CFBEntry*/\n  {\n    var unsafe = opts && opts.unsafe;\n    if (!unsafe) init_cfb(cfb);\n    var file = !unsafe && CFB.find(cfb, name);\n\n    if (!file) {\n      var fpath\n      /*:string*/\n      = cfb.FullPaths[0];\n      if (name.slice(0, fpath.length) == fpath) fpath = name;else {\n        if (fpath.slice(-1) != \"/\") fpath += \"/\";\n        fpath = (fpath + name).replace(\"//\", \"/\");\n      }\n      file = {\n        name: filename(name),\n        type: 2\n      }\n      /*:any*/\n      ;\n      cfb.FileIndex.push(file);\n      cfb.FullPaths.push(fpath);\n      if (!unsafe) CFB.utils.cfb_gc(cfb);\n    }\n    /*:: if(!file) throw new Error(\"unreachable\"); */\n\n\n    file.content = content\n    /*:any*/\n    ;\n    file.size = content ? content.length : 0;\n\n    if (opts) {\n      if (opts.CLSID) file.clsid = opts.CLSID;\n      if (opts.mt) file.mt = opts.mt;\n      if (opts.ct) file.ct = opts.ct;\n    }\n\n    return file;\n  }\n\n  function cfb_del(cfb\n  /*:CFBContainer*/\n  , name\n  /*:string*/\n  )\n  /*:boolean*/\n  {\n    init_cfb(cfb);\n    var file = CFB.find(cfb, name);\n    if (file) for (var j = 0; j < cfb.FileIndex.length; ++j) if (cfb.FileIndex[j] == file) {\n      cfb.FileIndex.splice(j, 1);\n      cfb.FullPaths.splice(j, 1);\n      return true;\n    }\n    return false;\n  }\n\n  function cfb_mov(cfb\n  /*:CFBContainer*/\n  , old_name\n  /*:string*/\n  , new_name\n  /*:string*/\n  )\n  /*:boolean*/\n  {\n    init_cfb(cfb);\n    var file = CFB.find(cfb, old_name);\n    if (file) for (var j = 0; j < cfb.FileIndex.length; ++j) if (cfb.FileIndex[j] == file) {\n      cfb.FileIndex[j].name = filename(new_name);\n      cfb.FullPaths[j] = new_name;\n      return true;\n    }\n    return false;\n  }\n\n  function cfb_gc(cfb\n  /*:CFBContainer*/\n  )\n  /*:void*/\n  {\n    rebuild_cfb(cfb, true);\n  }\n\n  exports.find = find;\n  exports.read = read;\n  exports.parse = parse;\n  exports.write = write;\n  exports.writeFile = write_file;\n  exports.utils = {\n    cfb_new: cfb_new,\n    cfb_add: cfb_add,\n    cfb_del: cfb_del,\n    cfb_mov: cfb_mov,\n    cfb_gc: cfb_gc,\n    ReadShift: ReadShift,\n    CheckField: CheckField,\n    prep_blob: prep_blob,\n    bconcat: bconcat,\n    use_zlib: use_zlib,\n    _deflateRaw: _deflate,\n    _inflateRaw: _inflate,\n    consts: consts\n  };\n  return exports;\n}();\n\nlet _fs = void 0;\n\nfunction set_fs(fs) {\n  _fs = fs;\n}\n\nexport { set_fs };\n/* normalize data for blob ctor */\n\nfunction blobify(data) {\n  if (typeof data === \"string\") return s2ab(data);\n  if (Array.isArray(data)) return a2u(data);\n  return data;\n}\n/* write or download file */\n\n\nfunction write_dl(fname\n/*:string*/\n, payload\n/*:any*/\n, enc\n/*:?string*/\n) {\n  /*global IE_SaveFile, Blob, navigator, saveAs, document, File, chrome */\n  if (typeof _fs !== 'undefined' && _fs.writeFileSync) return enc ? _fs.writeFileSync(fname, payload, enc) : _fs.writeFileSync(fname, payload);\n\n  if (typeof Deno !== 'undefined') {\n    /* in this spot, it's safe to assume typed arrays and TextEncoder/TextDecoder exist */\n    if (enc && typeof payload == \"string\") switch (enc) {\n      case \"utf8\":\n        payload = new TextEncoder(enc).encode(payload);\n        break;\n\n      case \"binary\":\n        payload = s2ab(payload);\n        break;\n\n      /* TODO: binary equivalent */\n\n      default:\n        throw new Error(\"Unsupported encoding \" + enc);\n    }\n    return Deno.writeFileSync(fname, payload);\n  }\n\n  var data = enc == \"utf8\" ? utf8write(payload) : payload;\n  /*:: declare var IE_SaveFile: any; */\n\n  if (typeof IE_SaveFile !== 'undefined') return IE_SaveFile(data, fname);\n\n  if (typeof Blob !== 'undefined') {\n    var blob = new Blob([blobify(data)], {\n      type: \"application/octet-stream\"\n    });\n    /*:: declare var navigator: any; */\n\n    if (typeof navigator !== 'undefined' && navigator.msSaveBlob) return navigator.msSaveBlob(blob, fname);\n    /*:: declare var saveAs: any; */\n\n    if (typeof saveAs !== 'undefined') return saveAs(blob, fname);\n\n    if (typeof URL !== 'undefined' && typeof document !== 'undefined' && document.createElement && URL.createObjectURL) {\n      var url = URL.createObjectURL(blob);\n      /*:: declare var chrome: any; */\n\n      if (typeof chrome === 'object' && typeof (chrome.downloads || {}).download == \"function\") {\n        if (URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function () {\n          URL.revokeObjectURL(url);\n        }, 60000);\n        return chrome.downloads.download({\n          url: url,\n          filename: fname,\n          saveAs: true\n        });\n      }\n\n      var a = document.createElement(\"a\");\n\n      if (a.download != null) {\n        /*:: if(document.body == null) throw new Error(\"unreachable\"); */\n        a.download = fname;\n        a.href = url;\n        document.body.appendChild(a);\n        a.click();\n        /*:: if(document.body == null) throw new Error(\"unreachable\"); */\n\n        document.body.removeChild(a);\n        if (URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function () {\n          URL.revokeObjectURL(url);\n        }, 60000);\n        return url;\n      }\n    }\n  } // $FlowIgnore\n\n\n  if (typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try {\n    // extendscript\n    // $FlowIgnore\n    var out = File(fname);\n    out.open(\"w\");\n    out.encoding = \"binary\";\n    if (Array.isArray(payload)) payload = a2s(payload);\n    out.write(payload);\n    out.close();\n    return payload;\n  } catch (e) {\n    if (!e.message || !e.message.match(/onstruct/)) throw e;\n  }\n  throw new Error(\"cannot save file \" + fname);\n}\n/* read binary data from file */\n\n\nfunction read_binary(path\n/*:string*/\n) {\n  if (typeof _fs !== 'undefined') return _fs.readFileSync(path);\n  if (typeof Deno !== 'undefined') return Deno.readFileSync(path); // $FlowIgnore\n\n  if (typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try {\n    // extendscript\n    // $FlowIgnore\n    var infile = File(path);\n    infile.open(\"r\");\n    infile.encoding = \"binary\";\n    var data = infile.read();\n    infile.close();\n    return data;\n  } catch (e) {\n    if (!e.message || !e.message.match(/onstruct/)) throw e;\n  }\n  throw new Error(\"Cannot access file \" + path);\n}\n\nfunction keys(o\n/*:any*/\n)\n/*:Array<any>*/\n{\n  var ks = Object.keys(o),\n      o2 = [];\n\n  for (var i = 0; i < ks.length; ++i) if (Object.prototype.hasOwnProperty.call(o, ks[i])) o2.push(ks[i]);\n\n  return o2;\n}\n\nfunction evert_key(obj\n/*:any*/\n, key\n/*:string*/\n)\n/*:EvertType*/\n{\n  var o = []\n  /*:any*/\n  ,\n      K = keys(obj);\n\n  for (var i = 0; i !== K.length; ++i) if (o[obj[K[i]][key]] == null) o[obj[K[i]][key]] = K[i];\n\n  return o;\n}\n\nfunction evert(obj\n/*:any*/\n)\n/*:EvertType*/\n{\n  var o = []\n  /*:any*/\n  ,\n      K = keys(obj);\n\n  for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\n\n  return o;\n}\n\nfunction evert_num(obj\n/*:any*/\n)\n/*:EvertNumType*/\n{\n  var o = []\n  /*:any*/\n  ,\n      K = keys(obj);\n\n  for (var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i], 10);\n\n  return o;\n}\n\nfunction evert_arr(obj\n/*:any*/\n)\n/*:EvertArrType*/\n{\n  var o\n  /*:EvertArrType*/\n  = []\n  /*:any*/\n  ,\n      K = keys(obj);\n\n  for (var i = 0; i !== K.length; ++i) {\n    if (o[obj[K[i]]] == null) o[obj[K[i]]] = [];\n    o[obj[K[i]]].push(K[i]);\n  }\n\n  return o;\n}\n\nvar basedate = /*#__PURE__*/new Date(1899, 11, 30, 0, 0, 0); // 2209161600000\n\nfunction datenum(v\n/*:Date*/\n, date1904\n/*:?boolean*/\n)\n/*:number*/\n{\n  var epoch = /*#__PURE__*/v.getTime();\n  if (date1904) epoch -= 1462 * 24 * 60 * 60 * 1000;\n  var dnthresh = /*#__PURE__*/basedate.getTime() + ( /*#__PURE__*/v.getTimezoneOffset() - /*#__PURE__*/basedate.getTimezoneOffset()) * 60000;\n  return (epoch - dnthresh) / (24 * 60 * 60 * 1000);\n}\n\nvar refdate = /*#__PURE__*/new Date();\nvar dnthresh = /*#__PURE__*/basedate.getTime() + ( /*#__PURE__*/refdate.getTimezoneOffset() - /*#__PURE__*/basedate.getTimezoneOffset()) * 60000;\nvar refoffset = /*#__PURE__*/refdate.getTimezoneOffset();\n\nfunction numdate(v\n/*:number*/\n)\n/*:Date*/\n{\n  var out = new Date();\n  out.setTime(v * 24 * 60 * 60 * 1000 + dnthresh);\n\n  if (out.getTimezoneOffset() !== refoffset) {\n    out.setTime(out.getTime() + (out.getTimezoneOffset() - refoffset) * 60000);\n  }\n\n  return out;\n}\n/* ISO 8601 Duration */\n\n\nfunction parse_isodur(s) {\n  var sec = 0,\n      mt = 0,\n      time = false;\n  var m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\n  if (!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\n\n  for (var i = 1; i != m.length; ++i) {\n    if (!m[i]) continue;\n    mt = 1;\n    if (i > 3) time = true;\n\n    switch (m[i].slice(m[i].length - 1)) {\n      case 'Y':\n        throw new Error(\"Unsupported ISO Duration Field: \" + m[i].slice(m[i].length - 1));\n\n      case 'D':\n        mt *= 24;\n\n      /* falls through */\n\n      case 'H':\n        mt *= 60;\n\n      /* falls through */\n\n      case 'M':\n        if (!time) throw new Error(\"Unsupported ISO Duration Field: M\");else mt *= 60;\n\n      /* falls through */\n\n      case 'S':\n        break;\n    }\n\n    sec += mt * parseInt(m[i], 10);\n  }\n\n  return sec;\n}\n\nvar good_pd_date_1 = /*#__PURE__*/new Date('2017-02-19T19:06:09.000Z');\nvar good_pd_date = /*#__PURE__*/isNaN( /*#__PURE__*/good_pd_date_1.getFullYear()) ? /*#__PURE__*/new Date('2/19/17') : good_pd_date_1;\nvar good_pd = /*#__PURE__*/good_pd_date.getFullYear() == 2017;\n/* parses a date as a local date */\n\nfunction parseDate(str\n/*:string|Date*/\n, fixdate\n/*:?number*/\n)\n/*:Date*/\n{\n  var d = new Date(str);\n\n  if (good_pd) {\n    /*:: if(fixdate == null) fixdate = 0; */\n    if (fixdate > 0) d.setTime(d.getTime() + d.getTimezoneOffset() * 60 * 1000);else if (fixdate < 0) d.setTime(d.getTime() - d.getTimezoneOffset() * 60 * 1000);\n    return d;\n  }\n\n  if (str instanceof Date) return str;\n\n  if (good_pd_date.getFullYear() == 1917 && !isNaN(d.getFullYear())) {\n    var s = d.getFullYear();\n    if (str.indexOf(\"\" + s) > -1) return d;\n    d.setFullYear(d.getFullYear() + 100);\n    return d;\n  }\n\n  var n = str.match(/\\d+/g) || [\"2017\", \"2\", \"19\", \"0\", \"0\", \"0\"];\n  var out = new Date(+n[0], +n[1] - 1, +n[2], +n[3] || 0, +n[4] || 0, +n[5] || 0);\n  if (str.indexOf(\"Z\") > -1) out = new Date(out.getTime() - out.getTimezoneOffset() * 60 * 1000);\n  return out;\n}\n\nfunction cc2str(arr\n/*:Array<number>*/\n, debomit)\n/*:string*/\n{\n  if (has_buf && Buffer.isBuffer(arr)) {\n    if (debomit) {\n      if (arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(arr.slice(2).toString(\"utf16le\"));\n      if (arr[1] == 0xFE && arr[2] == 0xFF) return utf8write(utf16beread(arr.slice(2).toString(\"binary\")));\n    }\n\n    return arr.toString(\"binary\");\n  }\n\n  if (typeof TextDecoder !== \"undefined\") try {\n    if (debomit) {\n      if (arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(new TextDecoder(\"utf-16le\").decode(arr.slice(2)));\n      if (arr[0] == 0xFE && arr[1] == 0xFF) return utf8write(new TextDecoder(\"utf-16be\").decode(arr.slice(2)));\n    }\n\n    var rev = {\n      \"\\u20ac\": \"\\x80\",\n      \"\\u201a\": \"\\x82\",\n      \"\\u0192\": \"\\x83\",\n      \"\\u201e\": \"\\x84\",\n      \"\\u2026\": \"\\x85\",\n      \"\\u2020\": \"\\x86\",\n      \"\\u2021\": \"\\x87\",\n      \"\\u02c6\": \"\\x88\",\n      \"\\u2030\": \"\\x89\",\n      \"\\u0160\": \"\\x8a\",\n      \"\\u2039\": \"\\x8b\",\n      \"\\u0152\": \"\\x8c\",\n      \"\\u017d\": \"\\x8e\",\n      \"\\u2018\": \"\\x91\",\n      \"\\u2019\": \"\\x92\",\n      \"\\u201c\": \"\\x93\",\n      \"\\u201d\": \"\\x94\",\n      \"\\u2022\": \"\\x95\",\n      \"\\u2013\": \"\\x96\",\n      \"\\u2014\": \"\\x97\",\n      \"\\u02dc\": \"\\x98\",\n      \"\\u2122\": \"\\x99\",\n      \"\\u0161\": \"\\x9a\",\n      \"\\u203a\": \"\\x9b\",\n      \"\\u0153\": \"\\x9c\",\n      \"\\u017e\": \"\\x9e\",\n      \"\\u0178\": \"\\x9f\"\n    };\n    if (Array.isArray(arr)) arr = new Uint8Array(arr);\n    return new TextDecoder(\"latin1\").decode(arr).replace(/[]/g, function (c) {\n      return rev[c] || c;\n    });\n  } catch (e) {}\n  var o = [];\n\n  for (var i = 0; i != arr.length; ++i) o.push(String.fromCharCode(arr[i]));\n\n  return o.join(\"\");\n}\n\nfunction dup(o\n/*:any*/\n)\n/*:any*/\n{\n  if (typeof JSON != 'undefined' && !Array.isArray(o)) return JSON.parse(JSON.stringify(o));\n  if (typeof o != 'object' || o == null) return o;\n  if (o instanceof Date) return new Date(o.getTime());\n  var out = {};\n\n  for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) out[k] = dup(o[k]);\n\n  return out;\n}\n\nfunction fill(c\n/*:string*/\n, l\n/*:number*/\n)\n/*:string*/\n{\n  var o = \"\";\n\n  while (o.length < l) o += c;\n\n  return o;\n}\n/* TODO: stress test */\n\n\nfunction fuzzynum(s\n/*:string*/\n)\n/*:number*/\n{\n  var v\n  /*:number*/\n  = Number(s);\n  if (!isNaN(v)) return isFinite(v) ? v : NaN;\n  if (!/\\d/.test(s)) return v;\n  var wt = 1;\n  var ss = s.replace(/([\\d]),([\\d])/g, \"$1$2\").replace(/[$]/g, \"\").replace(/[%]/g, function () {\n    wt *= 100;\n    return \"\";\n  });\n  if (!isNaN(v = Number(ss))) return v / wt;\n  ss = ss.replace(/[(](.*)[)]/, function ($$, $1) {\n    wt = -wt;\n    return $1;\n  });\n  if (!isNaN(v = Number(ss))) return v / wt;\n  return v;\n}\n\nvar lower_months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\n\nfunction fuzzydate(s\n/*:string*/\n)\n/*:Date*/\n{\n  var o = new Date(s),\n      n = new Date(NaN);\n  var y = o.getYear(),\n      m = o.getMonth(),\n      d = o.getDate();\n  if (isNaN(d)) return n;\n  var lower = s.toLowerCase();\n\n  if (lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {\n    lower = lower.replace(/[^a-z]/g, \"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/, \"\");\n    if (lower.length > 3 && lower_months.indexOf(lower) == -1) return n;\n  } else if (lower.match(/[a-z]/)) return n;\n\n  if (y < 0 || y > 8099) return n;\n  if ((m > 0 || d > 1) && y != 101) return o;\n  if (s.match(/[^-0-9:,\\/\\\\]/)) return n;\n  return o;\n}\n\nvar split_regex = /*#__PURE__*/function () {\n  var safe_split_regex = \"abacaba\".split(/(:?b)/i).length == 5;\n  return function split_regex(str\n  /*:string*/\n  , re, def\n  /*:string*/\n  )\n  /*:Array<string>*/\n  {\n    if (safe_split_regex || typeof re == \"string\") return str.split(re);\n    var p = str.split(re),\n        o = [p[0]];\n\n    for (var i = 1; i < p.length; ++i) {\n      o.push(def);\n      o.push(p[i]);\n    }\n\n    return o;\n  };\n}();\n\nfunction getdatastr(data)\n/*:?string*/\n{\n  if (!data) return null;\n  if (data.content && data.type) return cc2str(data.content, true);\n  if (data.data) return debom(data.data);\n  if (data.asNodeBuffer && has_buf) return debom(data.asNodeBuffer().toString('binary'));\n  if (data.asBinary) return debom(data.asBinary());\n  if (data._data && data._data.getContent) return debom(cc2str(Array.prototype.slice.call(data._data.getContent(), 0)));\n  return null;\n}\n\nfunction getdatabin(data) {\n  if (!data) return null;\n  if (data.data) return char_codes(data.data);\n  if (data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n\n  if (data._data && data._data.getContent) {\n    var o = data._data.getContent();\n\n    if (typeof o == \"string\") return char_codes(o);\n    return Array.prototype.slice.call(o);\n  }\n\n  if (data.content && data.type) return data.content;\n  return null;\n}\n\nfunction getdata(data) {\n  return data && data.name.slice(-4) === \".bin\" ? getdatabin(data) : getdatastr(data);\n}\n/* Part 2 Section 10.1.2 \"Mapping Content Types\" Names are case-insensitive */\n\n/* OASIS does not comment on filename case sensitivity */\n\n\nfunction safegetzipfile(zip, file\n/*:string*/\n) {\n  var k = zip.FullPaths || keys(zip.files);\n  var f = file.toLowerCase().replace(/[\\/]/g, '\\\\'),\n      g = f.replace(/\\\\/g, '\\/');\n\n  for (var i = 0; i < k.length; ++i) {\n    var n = k[i].replace(/^Root Entry[\\/]/, \"\").toLowerCase();\n    if (f == n || g == n) return zip.files ? zip.files[k[i]] : zip.FileIndex[i];\n  }\n\n  return null;\n}\n\nfunction getzipfile(zip, file\n/*:string*/\n) {\n  var o = safegetzipfile(zip, file);\n  if (o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n  return o;\n}\n\nfunction getzipdata(zip, file\n/*:string*/\n, safe\n/*:?boolean*/\n)\n/*:any*/\n{\n  if (!safe) return getdata(getzipfile(zip, file));\n  if (!file) return null;\n\n  try {\n    return getzipdata(zip, file);\n  } catch (e) {\n    return null;\n  }\n}\n\nfunction getzipstr(zip, file\n/*:string*/\n, safe\n/*:?boolean*/\n)\n/*:?string*/\n{\n  if (!safe) return getdatastr(getzipfile(zip, file));\n  if (!file) return null;\n\n  try {\n    return getzipstr(zip, file);\n  } catch (e) {\n    return null;\n  }\n}\n\nfunction getzipbin(zip, file\n/*:string*/\n, safe\n/*:?boolean*/\n)\n/*:any*/\n{\n  if (!safe) return getdatabin(getzipfile(zip, file));\n  if (!file) return null;\n\n  try {\n    return getzipbin(zip, file);\n  } catch (e) {\n    return null;\n  }\n}\n\nfunction zipentries(zip) {\n  var k = zip.FullPaths || keys(zip.files),\n      o = [];\n\n  for (var i = 0; i < k.length; ++i) if (k[i].slice(-1) != '/') o.push(k[i].replace(/^Root Entry[\\/]/, \"\"));\n\n  return o.sort();\n}\n\nfunction zip_add_file(zip, path, content) {\n  if (zip.FullPaths) {\n    if (typeof content == \"string\") {\n      var res;\n      if (has_buf) res = Buffer_from(content);\n      /* TODO: investigate performance in Edge 13 */\n      //else if(typeof TextEncoder !== \"undefined\") res = new TextEncoder().encode(content);\n      else res = utf8decode(content);\n      return CFB.utils.cfb_add(zip, path, res);\n    }\n\n    CFB.utils.cfb_add(zip, path, content);\n  } else zip.file(path, content);\n}\n\nfunction zip_new() {\n  return CFB.utils.cfb_new();\n}\n\nfunction zip_read(d, o) {\n  switch (o.type) {\n    case \"base64\":\n      return CFB.read(d, {\n        type: \"base64\"\n      });\n\n    case \"binary\":\n      return CFB.read(d, {\n        type: \"binary\"\n      });\n\n    case \"buffer\":\n    case \"array\":\n      return CFB.read(d, {\n        type: \"buffer\"\n      });\n  }\n\n  throw new Error(\"Unrecognized type \" + o.type);\n}\n\nfunction resolve_path(path\n/*:string*/\n, base\n/*:string*/\n)\n/*:string*/\n{\n  if (path.charAt(0) == \"/\") return path.slice(1);\n  var result = base.split('/');\n  if (base.slice(-1) != \"/\") result.pop(); // folder path\n\n  var target = path.split('/');\n\n  while (target.length !== 0) {\n    var step = target.shift();\n    if (step === '..') result.pop();else if (step !== '.') result.push(step);\n  }\n\n  return result.join('/');\n}\n\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\nvar attregexg = /([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;\nvar tagregex1 = /<[\\/\\?]?[a-zA-Z0-9:_-]+(?:\\s+[^\"\\s?>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\">\\s=]+))*\\s*[\\/\\?]?>/mg,\n    tagregex2 = /<[^>]*>/g;\nvar tagregex = /*#__PURE__*/XML_HEADER.match(tagregex1) ? tagregex1 : tagregex2;\nvar nsregex = /<\\w*:/,\n    nsregex2 = /<(\\/?)\\w+:/;\n\nfunction parsexmltag(tag\n/*:string*/\n, skip_root\n/*:?boolean*/\n, skip_LC\n/*:?boolean*/\n)\n/*:any*/\n{\n  var z = {}\n  /*:any*/\n  ;\n  var eq = 0,\n      c = 0;\n\n  for (; eq !== tag.length; ++eq) if ((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\n  if (!skip_root) z[0] = tag.slice(0, eq);\n  if (eq === tag.length) return z;\n  var m = tag.match(attregexg),\n      j = 0,\n      v = \"\",\n      i = 0,\n      q = \"\",\n      cc = \"\",\n      quot = 1;\n  if (m) for (i = 0; i != m.length; ++i) {\n    cc = m[i];\n\n    for (c = 0; c != cc.length; ++c) if (cc.charCodeAt(c) === 61) break;\n\n    q = cc.slice(0, c).trim();\n\n    while (cc.charCodeAt(c + 1) == 32) ++c;\n\n    quot = (eq = cc.charCodeAt(c + 1)) == 34 || eq == 39 ? 1 : 0;\n    v = cc.slice(c + 1 + quot, cc.length - quot);\n\n    for (j = 0; j != q.length; ++j) if (q.charCodeAt(j) === 58) break;\n\n    if (j === q.length) {\n      if (q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\")); // from ods\n\n      z[q] = v;\n      if (!skip_LC) z[q.toLowerCase()] = v;\n    } else {\n      var k = (j === 5 && q.slice(0, 5) === \"xmlns\" ? \"xmlns\" : \"\") + q.slice(j + 1);\n      if (z[k] && q.slice(j - 3, j) == \"ext\") continue; // from ods\n\n      z[k] = v;\n      if (!skip_LC) z[k.toLowerCase()] = v;\n    }\n  }\n  return z;\n}\n\nfunction strip_ns(x\n/*:string*/\n)\n/*:string*/\n{\n  return x.replace(nsregex2, \"<$1\");\n}\n\nvar encodings = {\n  '&quot;': '\"',\n  '&apos;': \"'\",\n  '&gt;': '>',\n  '&lt;': '<',\n  '&amp;': '&'\n};\nvar rencoding = /*#__PURE__*/evert(encodings); //var rencstr = \"&<>'\\\"\".split(\"\");\n// TODO: CP remap (need to read file version to determine OS)\n\nvar unescapexml\n/*:StringConv*/\n= /*#__PURE__*/function () {\n  /* 22.4.2.4 bstr (Basic String) */\n  var encregex = /&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/ig,\n      coderegex = /_x([\\da-fA-F]{4})_/ig;\n  return function unescapexml(text\n  /*:string*/\n  )\n  /*:string*/\n  {\n    var s = text + '',\n        i = s.indexOf(\"<![CDATA[\");\n    if (i == -1) return s.replace(encregex, function ($$, $1) {\n      return encodings[$$] || String.fromCharCode(parseInt($1, $$.indexOf(\"x\") > -1 ? 16 : 10)) || $$;\n    }).replace(coderegex, function (m, c) {\n      return String.fromCharCode(parseInt(c, 16));\n    });\n    var j = s.indexOf(\"]]>\");\n    return unescapexml(s.slice(0, i)) + s.slice(i + 9, j) + unescapexml(s.slice(j + 3));\n  };\n}();\n\nvar decregex = /[&<>'\"]/g,\n    charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\n\nfunction escapexml(text\n/*:string*/\n)\n/*:string*/\n{\n  var s = text + '';\n  return s.replace(decregex, function (y) {\n    return rencoding[y];\n  }).replace(charegex, function (s) {\n    return \"_x\" + (\"000\" + s.charCodeAt(0).toString(16)).slice(-4) + \"_\";\n  });\n}\n\nfunction escapexmltag(text\n/*:string*/\n)\n/*:string*/\n{\n  return escapexml(text).replace(/ /g, \"_x0020_\");\n}\n\nvar htmlcharegex = /[\\u0000-\\u001f]/g;\n\nfunction escapehtml(text\n/*:string*/\n)\n/*:string*/\n{\n  var s = text + '';\n  return s.replace(decregex, function (y) {\n    return rencoding[y];\n  }).replace(/\\n/g, \"<br/>\").replace(htmlcharegex, function (s) {\n    return \"&#x\" + (\"000\" + s.charCodeAt(0).toString(16)).slice(-4) + \";\";\n  });\n}\n\nfunction escapexlml(text\n/*:string*/\n)\n/*:string*/\n{\n  var s = text + '';\n  return s.replace(decregex, function (y) {\n    return rencoding[y];\n  }).replace(htmlcharegex, function (s) {\n    return \"&#x\" + s.charCodeAt(0).toString(16).toUpperCase() + \";\";\n  });\n}\n/* TODO: handle codepages */\n\n\nvar xlml_fixstr\n/*:StringConv*/\n= /*#__PURE__*/function () {\n  var entregex = /&#(\\d+);/g;\n\n  function entrepl($$\n  /*:string*/\n  , $1\n  /*:string*/\n  )\n  /*:string*/\n  {\n    return String.fromCharCode(parseInt($1, 10));\n  }\n\n  return function xlml_fixstr(str\n  /*:string*/\n  )\n  /*:string*/\n  {\n    return str.replace(entregex, entrepl);\n  };\n}();\n\nfunction xlml_unfixstr(str\n/*:string*/\n)\n/*:string*/\n{\n  return str.replace(/(\\r\\n|[\\r\\n])/g, \"\\&#10;\");\n}\n\nfunction parsexmlbool(value\n/*:any*/\n)\n/*:boolean*/\n{\n  switch (value) {\n    case 1:\n    case true:\n    case '1':\n    case 'true':\n    case 'TRUE':\n      return true;\n\n    /* case '0': case 'false': case 'FALSE':*/\n\n    default:\n      return false;\n  }\n}\n\nfunction utf8reada(orig\n/*:string*/\n)\n/*:string*/\n{\n  var out = \"\",\n      i = 0,\n      c = 0,\n      d = 0,\n      e = 0,\n      f = 0,\n      w = 0;\n\n  while (i < orig.length) {\n    c = orig.charCodeAt(i++);\n\n    if (c < 128) {\n      out += String.fromCharCode(c);\n      continue;\n    }\n\n    d = orig.charCodeAt(i++);\n\n    if (c > 191 && c < 224) {\n      f = (c & 31) << 6;\n      f |= d & 63;\n      out += String.fromCharCode(f);\n      continue;\n    }\n\n    e = orig.charCodeAt(i++);\n\n    if (c < 240) {\n      out += String.fromCharCode((c & 15) << 12 | (d & 63) << 6 | e & 63);\n      continue;\n    }\n\n    f = orig.charCodeAt(i++);\n    w = ((c & 7) << 18 | (d & 63) << 12 | (e & 63) << 6 | f & 63) - 65536;\n    out += String.fromCharCode(0xD800 + (w >>> 10 & 1023));\n    out += String.fromCharCode(0xDC00 + (w & 1023));\n  }\n\n  return out;\n}\n\nfunction utf8readb(data) {\n  var out = new_raw_buf(2 * data.length),\n      w,\n      i,\n      j = 1,\n      k = 0,\n      ww = 0,\n      c;\n\n  for (i = 0; i < data.length; i += j) {\n    j = 1;\n    if ((c = data.charCodeAt(i)) < 128) w = c;else if (c < 224) {\n      w = (c & 31) * 64 + (data.charCodeAt(i + 1) & 63);\n      j = 2;\n    } else if (c < 240) {\n      w = (c & 15) * 4096 + (data.charCodeAt(i + 1) & 63) * 64 + (data.charCodeAt(i + 2) & 63);\n      j = 3;\n    } else {\n      j = 4;\n      w = (c & 7) * 262144 + (data.charCodeAt(i + 1) & 63) * 4096 + (data.charCodeAt(i + 2) & 63) * 64 + (data.charCodeAt(i + 3) & 63);\n      w -= 65536;\n      ww = 0xD800 + (w >>> 10 & 1023);\n      w = 0xDC00 + (w & 1023);\n    }\n\n    if (ww !== 0) {\n      out[k++] = ww & 255;\n      out[k++] = ww >>> 8;\n      ww = 0;\n    }\n\n    out[k++] = w % 256;\n    out[k++] = w >>> 8;\n  }\n\n  return out.slice(0, k).toString('ucs2');\n}\n\nfunction utf8readc(data) {\n  return Buffer_from(data, 'binary').toString('utf8');\n}\n\nvar utf8corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\nvar utf8read = has_buf && ( /*#__PURE__*/utf8readc(utf8corpus) == /*#__PURE__*/utf8reada(utf8corpus) && utf8readc || /*#__PURE__*/utf8readb(utf8corpus) == /*#__PURE__*/utf8reada(utf8corpus) && utf8readb) || utf8reada;\nvar utf8write\n/*:StringConv*/\n= has_buf ? function (data) {\n  return Buffer_from(data, 'utf8').toString(\"binary\");\n} : function (orig\n/*:string*/\n)\n/*:string*/\n{\n  var out\n  /*:Array<string>*/\n  = [],\n      i = 0,\n      c = 0,\n      d = 0;\n\n  while (i < orig.length) {\n    c = orig.charCodeAt(i++);\n\n    switch (true) {\n      case c < 128:\n        out.push(String.fromCharCode(c));\n        break;\n\n      case c < 2048:\n        out.push(String.fromCharCode(192 + (c >> 6)));\n        out.push(String.fromCharCode(128 + (c & 63)));\n        break;\n\n      case c >= 55296 && c < 57344:\n        c -= 55296;\n        d = orig.charCodeAt(i++) - 56320 + (c << 10);\n        out.push(String.fromCharCode(240 + (d >> 18 & 7)));\n        out.push(String.fromCharCode(144 + (d >> 12 & 63)));\n        out.push(String.fromCharCode(128 + (d >> 6 & 63)));\n        out.push(String.fromCharCode(128 + (d & 63)));\n        break;\n\n      default:\n        out.push(String.fromCharCode(224 + (c >> 12)));\n        out.push(String.fromCharCode(128 + (c >> 6 & 63)));\n        out.push(String.fromCharCode(128 + (c & 63)));\n    }\n  }\n\n  return out.join(\"\");\n}; // matches <foo>...</foo> extracts content\n\nvar matchtag = /*#__PURE__*/function () {\n  var mtcache\n  /*:{[k:string]:RegExp}*/\n  = {}\n  /*:any*/\n  ;\n  return function matchtag(f\n  /*:string*/\n  , g\n  /*:?string*/\n  )\n  /*:RegExp*/\n  {\n    var t = f + \"|\" + (g || \"\");\n    if (mtcache[t]) return mtcache[t];\n    return mtcache[t] = new RegExp('<(?:\\\\w+:)?' + f + '(?: xml:space=\"preserve\")?(?:[^>]*)>([\\\\s\\\\S]*?)</(?:\\\\w+:)?' + f + '>', g || \"\"\n    /*:any*/\n    );\n  };\n}();\n\nvar htmldecode\n/*:{(s:string):string}*/\n= /*#__PURE__*/function () {\n  var entities\n  /*:Array<[RegExp, string]>*/\n  = [['nbsp', ' '], ['middot', ''], ['quot', '\"'], ['apos', \"'\"], ['gt', '>'], ['lt', '<'], ['amp', '&']].map(function (x\n  /*:[string, string]*/\n  ) {\n    return [new RegExp('&' + x[0] + ';', \"ig\"), x[1]];\n  });\n  return function htmldecode(str\n  /*:string*/\n  )\n  /*:string*/\n  {\n    var o = str // Remove new lines and spaces from start of content\n    .replace(/^[\\t\\n\\r ]+/, \"\") // Remove new lines and spaces from end of content\n    .replace(/[\\t\\n\\r ]+$/, \"\") // Added line which removes any white space characters after and before html tags\n    .replace(/>\\s+/g, \">\").replace(/\\s+</g, \"<\") // Replace remaining new lines and spaces with space\n    .replace(/[\\t\\n\\r ]+/g, \" \") // Replace <br> tags with new lines\n    .replace(/<\\s*[bB][rR]\\s*\\/?>/g, \"\\n\") // Strip HTML elements\n    .replace(/<[^>]*>/g, \"\");\n\n    for (var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\n\n    return o;\n  };\n}();\n\nvar vtregex = /*#__PURE__*/function () {\n  var vt_cache = {};\n  return function vt_regex(bt) {\n    if (vt_cache[bt] !== undefined) return vt_cache[bt];\n    return vt_cache[bt] = new RegExp(\"<(?:vt:)?\" + bt + \">([\\\\s\\\\S]*?)</(?:vt:)?\" + bt + \">\", 'g');\n  };\n}();\n\nvar vtvregex = /<\\/?(?:vt:)?variant>/g,\n    vtmregex = /<(?:vt:)([^>]*)>([\\s\\S]*)</;\n\nfunction parseVector(data\n/*:string*/\n, opts)\n/*:Array<{v:string,t:string}>*/\n{\n  var h = parsexmltag(data);\n  var matches\n  /*:Array<string>*/\n  = data.match(vtregex(h.baseType)) || [];\n  var res\n  /*:Array<any>*/\n  = [];\n\n  if (matches.length != h.size) {\n    if (opts.WTF) throw new Error(\"unexpected vector length \" + matches.length + \" != \" + h.size);\n    return res;\n  }\n\n  matches.forEach(function (x\n  /*:string*/\n  ) {\n    var v = x.replace(vtvregex, \"\").match(vtmregex);\n    if (v) res.push({\n      v: utf8read(v[2]),\n      t: v[1]\n    });\n  });\n  return res;\n}\n\nvar wtregex = /(^\\s|\\s$|\\n)/;\n\nfunction writetag(f\n/*:string*/\n, g\n/*:string*/\n)\n/*:string*/\n{\n  return '<' + f + (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>';\n}\n\nfunction wxt_helper(h)\n/*:string*/\n{\n  return keys(h).map(function (k) {\n    return \" \" + k + '=\"' + h[k] + '\"';\n  }).join(\"\");\n}\n\nfunction writextag(f\n/*:string*/\n, g\n/*:?string*/\n, h) {\n  return '<' + f + (h != null ? wxt_helper(h) : \"\") + (g != null ? (g.match(wtregex) ? ' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';\n}\n\nfunction write_w3cdtf(d\n/*:Date*/\n, t\n/*:?boolean*/\n)\n/*:string*/\n{\n  try {\n    return d.toISOString().replace(/\\.\\d*/, \"\");\n  } catch (e) {\n    if (t) throw e;\n  }\n\n  return \"\";\n}\n\nfunction write_vt(s, xlsx\n/*:?boolean*/\n)\n/*:string*/\n{\n  switch (typeof s) {\n    case 'string':\n      var o = writextag('vt:lpwstr', escapexml(s));\n      if (xlsx) o = o.replace(/&quot;/g, \"_x0022_\");\n      return o;\n\n    case 'number':\n      return writextag((s | 0) == s ? 'vt:i4' : 'vt:r8', escapexml(String(s)));\n\n    case 'boolean':\n      return writextag('vt:bool', s ? 'true' : 'false');\n  }\n\n  if (s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\n  throw new Error(\"Unable to serialize \" + s);\n}\n\nfunction xlml_normalize(d)\n/*:string*/\n{\n  if (has_buf &&\n  /*::typeof Buffer !== \"undefined\" && d != null && d instanceof Buffer &&*/\n  Buffer.isBuffer(d)) return d.toString('utf8');\n  if (typeof d === 'string') return d;\n  /* duktape */\n\n  if (typeof Uint8Array !== 'undefined' && d instanceof Uint8Array) return utf8read(a2s(ab2a(d)));\n  throw new Error(\"Bad input format: expected Buffer or string\");\n}\n/* UOS uses CJK in tags */\n\n\nvar xlmlregex = /<(\\/?)([^\\s?><!\\/:]*:|)([^\\s?<>:\\/]+)(?:[\\s?:\\/][^>]*)?>/mg; //var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\n\nvar XMLNS = {\n  CORE_PROPS: 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',\n  CUST_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\",\n  EXT_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\",\n  CT: 'http://schemas.openxmlformats.org/package/2006/content-types',\n  RELS: 'http://schemas.openxmlformats.org/package/2006/relationships',\n  TCMNT: 'http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments',\n  'dc': 'http://purl.org/dc/elements/1.1/',\n  'dcterms': 'http://purl.org/dc/terms/',\n  'dcmitype': 'http://purl.org/dc/dcmitype/',\n  'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n  'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n  'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n  'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n  'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n  'xsd': 'http://www.w3.org/2001/XMLSchema'\n}\n/*:any*/\n;\nvar XMLNS_main = ['http://schemas.openxmlformats.org/spreadsheetml/2006/main', 'http://purl.oclc.org/ooxml/spreadsheetml/main', 'http://schemas.microsoft.com/office/excel/2006/main', 'http://schemas.microsoft.com/office/excel/2006/2'];\nvar XLMLNS = {\n  'o': 'urn:schemas-microsoft-com:office:office',\n  'x': 'urn:schemas-microsoft-com:office:excel',\n  'ss': 'urn:schemas-microsoft-com:office:spreadsheet',\n  'dt': 'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882',\n  'mv': 'http://macVmlSchemaUri',\n  'v': 'urn:schemas-microsoft-com:vml',\n  'html': 'http://www.w3.org/TR/REC-html40'\n}\n/*:any*/\n;\n\nfunction read_double_le(b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  var s = 1 - 2 * (b[idx + 7] >>> 7);\n  var e = ((b[idx + 7] & 0x7f) << 4) + (b[idx + 6] >>> 4 & 0x0f);\n  var m = b[idx + 6] & 0x0f;\n\n  for (var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];\n\n  if (e == 0x7ff) return m == 0 ? s * Infinity : NaN;\n  if (e == 0) e = -1022;else {\n    e -= 1023;\n    m += Math.pow(2, 52);\n  }\n  return s * Math.pow(2, e - 52) * m;\n}\n\nfunction write_double_le(b\n/*:RawBytes|CFBlob*/\n, v\n/*:number*/\n, idx\n/*:number*/\n) {\n  var bs = (v < 0 || 1 / v == -Infinity ? 1 : 0) << 7,\n      e = 0,\n      m = 0;\n  var av = bs ? -v : v;\n\n  if (!isFinite(av)) {\n    e = 0x7ff;\n    m = isNaN(v) ? 0x6969 : 0;\n  } else if (av == 0) e = m = 0;else {\n    e = Math.floor(Math.log(av) / Math.LN2);\n    m = av * Math.pow(2, 52 - e);\n\n    if (e <= -1023 && (!isFinite(m) || m < Math.pow(2, 52))) {\n      e = -1022;\n    } else {\n      m -= Math.pow(2, 52);\n      e += 1023;\n    }\n  }\n\n  for (var i = 0; i <= 5; ++i, m /= 256) b[idx + i] = m & 0xff;\n\n  b[idx + 6] = (e & 0x0f) << 4 | m & 0xf;\n  b[idx + 7] = e >> 4 | bs;\n}\n\nvar ___toBuffer = function (bufs\n/*:Array<Array<RawBytes> >*/\n)\n/*:RawBytes*/\n{\n  var x = [],\n      w = 10240;\n\n  for (var i = 0; i < bufs[0].length; ++i) if (bufs[0][i]) for (var j = 0, L = bufs[0][i].length; j < L; j += w) x.push.apply(x, bufs[0][i].slice(j, j + w));\n\n  return x;\n};\n\nvar __toBuffer = has_buf ? function (bufs) {\n  return bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0]) ? Buffer.concat(bufs[0].map(function (x) {\n    return Buffer.isBuffer(x) ? x : Buffer_from(x);\n  })) : ___toBuffer(bufs);\n} : ___toBuffer;\n\nvar ___utf16le = function (b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, e\n/*:number*/\n)\n/*:string*/\n{\n  var ss\n  /*:Array<string>*/\n  = [];\n\n  for (var i = s; i < e; i += 2) ss.push(String.fromCharCode(__readUInt16LE(b, i)));\n\n  return ss.join(\"\").replace(chr0, '');\n};\n\nvar __utf16le = has_buf ? function (b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, e\n/*:number*/\n)\n/*:string*/\n{\n  if (!Buffer.isBuffer(b)\n  /*:: || !(b instanceof Buffer)*/\n  ) return ___utf16le(b, s, e);\n  return b.toString('utf16le', s, e).replace(chr0, '')\n  /*.replace(chr1,'!')*/\n  ;\n} : ___utf16le;\n\nvar ___hexlify = function (b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, l\n/*:number*/\n)\n/*:string*/\n{\n  var ss\n  /*:Array<string>*/\n  = [];\n\n  for (var i = s; i < s + l; ++i) ss.push((\"0\" + b[i].toString(16)).slice(-2));\n\n  return ss.join(\"\");\n};\n\nvar __hexlify = has_buf ? function (b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, l\n/*:number*/\n)\n/*:string*/\n{\n  return Buffer.isBuffer(b)\n  /*:: && b instanceof Buffer*/\n  ? b.toString('hex', s, s + l) : ___hexlify(b, s, l);\n} : ___hexlify;\n\nvar ___utf8 = function (b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, e\n/*:number*/\n) {\n  var ss = [];\n\n  for (var i = s; i < e; i++) ss.push(String.fromCharCode(__readUInt8(b, i)));\n\n  return ss.join(\"\");\n};\n\nvar __utf8 = has_buf ? function utf8_b(b\n/*:RawBytes|CFBlob*/\n, s\n/*:number*/\n, e\n/*:number*/\n) {\n  return Buffer.isBuffer(b)\n  /*:: && (b instanceof Buffer)*/\n  ? b.toString('utf8', s, e) : ___utf8(b, s, e);\n} : ___utf8;\n\nvar ___lpstr = function (b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = __readUInt32LE(b, i);\n\n  return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n};\n\nvar __lpstr = ___lpstr;\n\nvar ___cpstr = function (b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = __readUInt32LE(b, i);\n\n  return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n};\n\nvar __cpstr = ___cpstr;\n\nvar ___lpwstr = function (b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = 2 * __readUInt32LE(b, i);\n\n  return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n};\n\nvar __lpwstr = ___lpwstr;\n\nvar ___lpp4 = function lpp4_(b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = __readUInt32LE(b, i);\n\n  return len > 0 ? __utf16le(b, i + 4, i + 4 + len) : \"\";\n};\n\nvar __lpp4 = ___lpp4;\n\nvar ___8lpp4 = function (b\n/*:RawBytes|CFBlob*/\n, i\n/*:number*/\n) {\n  var len = __readUInt32LE(b, i);\n\n  return len > 0 ? __utf8(b, i + 4, i + 4 + len) : \"\";\n};\n\nvar __8lpp4 = ___8lpp4;\n\nvar ___double = function (b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n) {\n  return read_double_le(b, idx);\n};\n\nvar __double = ___double;\n\nvar is_buf = function is_buf_a(a) {\n  return Array.isArray(a) || typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array;\n};\n\nif (has_buf\n/*:: && typeof Buffer !== 'undefined'*/\n) {\n  __lpstr = function lpstr_b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___lpstr(b, i);\n    var len = b.readUInt32LE(i);\n    return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\";\n  };\n\n  __cpstr = function cpstr_b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___cpstr(b, i);\n    var len = b.readUInt32LE(i);\n    return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\";\n  };\n\n  __lpwstr = function lpwstr_b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___lpwstr(b, i);\n    var len = 2 * b.readUInt32LE(i);\n    return b.toString('utf16le', i + 4, i + 4 + len - 1);\n  };\n\n  __lpp4 = function lpp4_b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___lpp4(b, i);\n    var len = b.readUInt32LE(i);\n    return b.toString('utf16le', i + 4, i + 4 + len);\n  };\n\n  __8lpp4 = function lpp4_8b(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (!Buffer.isBuffer(b)\n    /*:: || !(b instanceof Buffer)*/\n    ) return ___8lpp4(b, i);\n    var len = b.readUInt32LE(i);\n    return b.toString('utf8', i + 4, i + 4 + len);\n  };\n\n  __double = function double_(b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    if (Buffer.isBuffer(b)\n    /*::&& b instanceof Buffer*/\n    ) return b.readDoubleLE(i);\n    return ___double(b, i);\n  };\n\n  is_buf = function is_buf_b(a) {\n    return Buffer.isBuffer(a) || Array.isArray(a) || typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array;\n  };\n}\n/* from js-xls */\n\n\nfunction cpdoit() {\n  __utf16le = function (b\n  /*:RawBytes|CFBlob*/\n  , s\n  /*:number*/\n  , e\n  /*:number*/\n  ) {\n    return $cptable.utils.decode(1200, b.slice(s, e)).replace(chr0, '');\n  };\n\n  __utf8 = function (b\n  /*:RawBytes|CFBlob*/\n  , s\n  /*:number*/\n  , e\n  /*:number*/\n  ) {\n    return $cptable.utils.decode(65001, b.slice(s, e));\n  };\n\n  __lpstr = function (b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    var len = __readUInt32LE(b, i);\n\n    return len > 0 ? $cptable.utils.decode(current_ansi, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n  };\n\n  __cpstr = function (b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    var len = __readUInt32LE(b, i);\n\n    return len > 0 ? $cptable.utils.decode(current_codepage, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n  };\n\n  __lpwstr = function (b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    var len = 2 * __readUInt32LE(b, i);\n\n    return len > 0 ? $cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n  };\n\n  __lpp4 = function (b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    var len = __readUInt32LE(b, i);\n\n    return len > 0 ? $cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len)) : \"\";\n  };\n\n  __8lpp4 = function (b\n  /*:RawBytes|CFBlob*/\n  , i\n  /*:number*/\n  ) {\n    var len = __readUInt32LE(b, i);\n\n    return len > 0 ? $cptable.utils.decode(65001, b.slice(i + 4, i + 4 + len)) : \"\";\n  };\n}\n\nif (typeof $cptable !== 'undefined') cpdoit();\n\nvar __readUInt8 = function (b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx];\n};\n\nvar __readUInt16LE = function (b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx + 1] * (1 << 8) + b[idx];\n};\n\nvar __readInt16LE = function (b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  var u = b[idx + 1] * (1 << 8) + b[idx];\n  return u < 0x8000 ? u : (0xffff - u + 1) * -1;\n};\n\nvar __readUInt32LE = function (b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx + 3] * (1 << 24) + (b[idx + 2] << 16) + (b[idx + 1] << 8) + b[idx];\n};\n\nvar __readInt32LE = function (b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx + 3] << 24 | b[idx + 2] << 16 | b[idx + 1] << 8 | b[idx];\n};\n\nvar __readInt32BE = function (b\n/*:RawBytes|CFBlob*/\n, idx\n/*:number*/\n)\n/*:number*/\n{\n  return b[idx] << 24 | b[idx + 1] << 16 | b[idx + 2] << 8 | b[idx + 3];\n};\n\nfunction ReadShift(size\n/*:number*/\n, t\n/*:?string*/\n)\n/*:number|string*/\n{\n  var o = \"\",\n      oI\n  /*:: :number = 0*/\n  ,\n      oR,\n      oo = [],\n      w,\n      vv,\n      i,\n      loc;\n\n  switch (t) {\n    case 'dbcs':\n      loc = this.l;\n      if (has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l + 2 * size).toString(\"utf16le\");else for (i = 0; i < size; ++i) {\n        o += String.fromCharCode(__readUInt16LE(this, loc));\n        loc += 2;\n      }\n      size *= 2;\n      break;\n\n    case 'utf8':\n      o = __utf8(this, this.l, this.l + size);\n      break;\n\n    case 'utf16le':\n      size *= 2;\n      o = __utf16le(this, this.l, this.l + size);\n      break;\n\n    case 'wstr':\n      if (typeof $cptable !== 'undefined') o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + 2 * size));else return ReadShift.call(this, size, 'dbcs');\n      size = 2 * size;\n      break;\n\n    /* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\n    case 'lpstr-ansi':\n      o = __lpstr(this, this.l);\n      size = 4 + __readUInt32LE(this, this.l);\n      break;\n\n    case 'lpstr-cp':\n      o = __cpstr(this, this.l);\n      size = 4 + __readUInt32LE(this, this.l);\n      break;\n\n    /* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\n    case 'lpwstr':\n      o = __lpwstr(this, this.l);\n      size = 4 + 2 * __readUInt32LE(this, this.l);\n      break;\n\n    /* [MS-OFFCRYPTO] 2.1.2 Length-Prefixed Padded Unicode String (UNICODE-LP-P4) */\n\n    case 'lpp4':\n      size = 4 + __readUInt32LE(this, this.l);\n      o = __lpp4(this, this.l);\n      if (size & 0x02) size += 2;\n      break;\n\n    /* [MS-OFFCRYPTO] 2.1.3 Length-Prefixed UTF-8 String (UTF-8-LP-P4) */\n\n    case '8lpp4':\n      size = 4 + __readUInt32LE(this, this.l);\n      o = __8lpp4(this, this.l);\n      if (size & 0x03) size += 4 - (size & 0x03);\n      break;\n\n    case 'cstr':\n      size = 0;\n      o = \"\";\n\n      while ((w = __readUInt8(this, this.l + size++)) !== 0) oo.push(_getchar(w));\n\n      o = oo.join(\"\");\n      break;\n\n    case '_wstr':\n      size = 0;\n      o = \"\";\n\n      while ((w = __readUInt16LE(this, this.l + size)) !== 0) {\n        oo.push(_getchar(w));\n        size += 2;\n      }\n\n      size += 2;\n      o = oo.join(\"\");\n      break;\n\n    /* sbcs and dbcs support continue records in the SST way TODO codepages */\n\n    case 'dbcs-cont':\n      o = \"\";\n      loc = this.l;\n\n      for (i = 0; i < size; ++i) {\n        if (this.lens && this.lens.indexOf(loc) !== -1) {\n          w = __readUInt8(this, loc);\n          this.l = loc + 1;\n          vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n          return oo.join(\"\") + vv;\n        }\n\n        oo.push(_getchar(__readUInt16LE(this, loc)));\n        loc += 2;\n      }\n\n      o = oo.join(\"\");\n      size *= 2;\n      break;\n\n    case 'cpstr':\n      if (typeof $cptable !== 'undefined') {\n        o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + size));\n        break;\n      }\n\n    /* falls through */\n\n    case 'sbcs-cont':\n      o = \"\";\n      loc = this.l;\n\n      for (i = 0; i != size; ++i) {\n        if (this.lens && this.lens.indexOf(loc) !== -1) {\n          w = __readUInt8(this, loc);\n          this.l = loc + 1;\n          vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n          return oo.join(\"\") + vv;\n        }\n\n        oo.push(_getchar(__readUInt8(this, loc)));\n        loc += 1;\n      }\n\n      o = oo.join(\"\");\n      break;\n\n    default:\n      switch (size) {\n        case 1:\n          oI = __readUInt8(this, this.l);\n          this.l++;\n          return oI;\n\n        case 2:\n          oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l);\n          this.l += 2;\n          return oI;\n\n        case 4:\n        case -4:\n          if (t === 'i' || (this[this.l + 3] & 0x80) === 0) {\n            oI = (size > 0 ? __readInt32LE : __readInt32BE)(this, this.l);\n            this.l += 4;\n            return oI;\n          } else {\n            oR = __readUInt32LE(this, this.l);\n            this.l += 4;\n          }\n\n          return oR;\n\n        case 8:\n        case -8:\n          if (t === 'f') {\n            if (size == 8) oR = __double(this, this.l);else oR = __double([this[this.l + 7], this[this.l + 6], this[this.l + 5], this[this.l + 4], this[this.l + 3], this[this.l + 2], this[this.l + 1], this[this.l + 0]], 0);\n            this.l += 8;\n            return oR;\n          } else size = 8;\n\n        /* falls through */\n\n        case 16:\n          o = __hexlify(this, this.l, size);\n          break;\n      }\n\n  }\n\n  this.l += size;\n  return o;\n}\n\nvar __writeUInt32LE = function (b\n/*:RawBytes|CFBlob*/\n, val\n/*:number*/\n, idx\n/*:number*/\n)\n/*:void*/\n{\n  b[idx] = val & 0xFF;\n  b[idx + 1] = val >>> 8 & 0xFF;\n  b[idx + 2] = val >>> 16 & 0xFF;\n  b[idx + 3] = val >>> 24 & 0xFF;\n};\n\nvar __writeInt32LE = function (b\n/*:RawBytes|CFBlob*/\n, val\n/*:number*/\n, idx\n/*:number*/\n)\n/*:void*/\n{\n  b[idx] = val & 0xFF;\n  b[idx + 1] = val >> 8 & 0xFF;\n  b[idx + 2] = val >> 16 & 0xFF;\n  b[idx + 3] = val >> 24 & 0xFF;\n};\n\nvar __writeUInt16LE = function (b\n/*:RawBytes|CFBlob*/\n, val\n/*:number*/\n, idx\n/*:number*/\n)\n/*:void*/\n{\n  b[idx] = val & 0xFF;\n  b[idx + 1] = val >>> 8 & 0xFF;\n};\n\nfunction WriteShift(t\n/*:number*/\n, val\n/*:string|number*/\n, f\n/*:?string*/\n)\n/*:any*/\n{\n  var size = 0,\n      i = 0;\n\n  if (f === 'dbcs') {\n    /*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n    for (i = 0; i != val.length; ++i) __writeUInt16LE(this, val.charCodeAt(i), this.l + 2 * i);\n\n    size = 2 * val.length;\n  } else if (f === 'sbcs') {\n    if (typeof $cptable !== 'undefined' && current_ansi == 874) {\n      /* TODO: use tables directly, don't encode */\n\n      /*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n      for (i = 0; i != val.length; ++i) {\n        var cppayload = $cptable.utils.encode(current_ansi, val.charAt(i));\n        this[this.l + i] = cppayload[0];\n      }\n    } else {\n      /*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n      val = val.replace(/[^\\x00-\\x7F]/g, \"_\");\n      /*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n\n      for (i = 0; i != val.length; ++i) this[this.l + i] = val.charCodeAt(i) & 0xFF;\n    }\n\n    size = val.length;\n  } else if (f === 'hex') {\n    for (; i < t; ++i) {\n      /*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n      this[this.l++] = parseInt(val.slice(2 * i, 2 * i + 2), 16) || 0;\n    }\n\n    return this;\n  } else if (f === 'utf16le') {\n    /*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n    var end\n    /*:number*/\n    = Math.min(this.l + t, this.length);\n\n    for (i = 0; i < Math.min(val.length, t); ++i) {\n      var cc = val.charCodeAt(i);\n      this[this.l++] = cc & 0xff;\n      this[this.l++] = cc >> 8;\n    }\n\n    while (this.l < end) this[this.l++] = 0;\n\n    return this;\n  } else\n    /*:: if(typeof val === 'number') */\n    switch (t) {\n      case 1:\n        size = 1;\n        this[this.l] = val & 0xFF;\n        break;\n\n      case 2:\n        size = 2;\n        this[this.l] = val & 0xFF;\n        val >>>= 8;\n        this[this.l + 1] = val & 0xFF;\n        break;\n\n      case 3:\n        size = 3;\n        this[this.l] = val & 0xFF;\n        val >>>= 8;\n        this[this.l + 1] = val & 0xFF;\n        val >>>= 8;\n        this[this.l + 2] = val & 0xFF;\n        break;\n\n      case 4:\n        size = 4;\n\n        __writeUInt32LE(this, val, this.l);\n\n        break;\n\n      case 8:\n        size = 8;\n\n        if (f === 'f') {\n          write_double_le(this, val, this.l);\n          break;\n        }\n\n      /* falls through */\n\n      case 16:\n        break;\n\n      case -4:\n        size = 4;\n\n        __writeInt32LE(this, val, this.l);\n\n        break;\n    }\n\n  this.l += size;\n  return this;\n}\n\nfunction CheckField(hexstr\n/*:string*/\n, fld\n/*:string*/\n)\n/*:void*/\n{\n  var m = __hexlify(this, this.l, hexstr.length >> 1);\n\n  if (m !== hexstr) throw new Error(fld + 'Expected ' + hexstr + ' saw ' + m);\n  this.l += hexstr.length >> 1;\n}\n\nfunction prep_blob(blob, pos\n/*:number*/\n)\n/*:void*/\n{\n  blob.l = pos;\n  blob.read_shift =\n  /*::(*/\n  ReadShift\n  /*:: :any)*/\n  ;\n  blob.chk = CheckField;\n  blob.write_shift = WriteShift;\n}\n\nfunction parsenoop(blob, length\n/*:: :number, opts?:any */\n) {\n  blob.l += length;\n}\n\nfunction new_buf(sz\n/*:number*/\n)\n/*:Block*/\n{\n  var o = new_raw_buf(sz);\n  prep_blob(o, 0);\n  return o;\n}\n/* [MS-XLSB] 2.1.4 Record */\n\n\nfunction recordhopper(data, cb\n/*:RecordHopperCB*/\n, opts\n/*:?any*/\n) {\n  if (!data) return;\n  var tmpbyte, cntbyte, length;\n  prep_blob(data, data.l || 0);\n  var L = data.length,\n      RT = 0,\n      tgt = 0;\n\n  while (data.l < L) {\n    RT = data.read_shift(1);\n    if (RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F) << 7);\n    var R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n    tmpbyte = data.read_shift(1);\n    length = tmpbyte & 0x7F;\n\n    for (cntbyte = 1; cntbyte < 4 && tmpbyte & 0x80; ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F) << 7 * cntbyte;\n\n    tgt = data.l + length;\n    var d = R.f && R.f(data, length, opts);\n    data.l = tgt;\n    if (cb(d, R, RT)) return;\n  }\n}\n/* control buffer usage for fixed-length buffers */\n\n\nfunction buf_array()\n/*:BufArray*/\n{\n  var bufs\n  /*:Array<Block>*/\n  = [],\n      blksz = has_buf ? 256 : 2048;\n\n  var newblk = function ba_newblk(sz\n  /*:number*/\n  )\n  /*:Block*/\n  {\n    var o\n    /*:Block*/\n    = new_buf(sz)\n    /*:any*/\n    ;\n    prep_blob(o, 0);\n    return o;\n  };\n\n  var curbuf\n  /*:Block*/\n  = newblk(blksz);\n\n  var endbuf = function ba_endbuf() {\n    if (!curbuf) return;\n\n    if (curbuf.length > curbuf.l) {\n      curbuf = curbuf.slice(0, curbuf.l);\n      curbuf.l = curbuf.length;\n    }\n\n    if (curbuf.length > 0) bufs.push(curbuf);\n    curbuf = null;\n  };\n\n  var next = function ba_next(sz\n  /*:number*/\n  )\n  /*:Block*/\n  {\n    if (curbuf && sz < curbuf.length - curbuf.l) return curbuf;\n    endbuf();\n    return curbuf = newblk(Math.max(sz + 1, blksz));\n  };\n\n  var end = function ba_end() {\n    endbuf();\n    return bconcat(bufs);\n  };\n\n  var push = function ba_push(buf) {\n    endbuf();\n    curbuf = buf;\n    if (curbuf.l == null) curbuf.l = curbuf.length;\n    next(blksz);\n  };\n\n  return {\n    next: next,\n    push: push,\n    end: end,\n    _bufs: bufs\n  }\n  /*:any*/\n  ;\n}\n\nfunction write_record(ba\n/*:BufArray*/\n, type\n/*:number*/\n, payload, length\n/*:?number*/\n) {\n  var t\n  /*:number*/\n  = +type,\n      l;\n  if (isNaN(t)) return; // TODO: throw something here?\n\n  if (!length) length = XLSBRecordEnum[t].p || (payload || []).length || 0;\n  l = 1 + (t >= 0x80 ? 1 : 0) + 1\n  /* + length*/\n  ;\n  if (length >= 0x80) ++l;\n  if (length >= 0x4000) ++l;\n  if (length >= 0x200000) ++l;\n  var o = ba.next(l);\n  if (t <= 0x7F) o.write_shift(1, t);else {\n    o.write_shift(1, (t & 0x7F) + 0x80);\n    o.write_shift(1, t >> 7);\n  }\n\n  for (var i = 0; i != 4; ++i) {\n    if (length >= 0x80) {\n      o.write_shift(1, (length & 0x7F) + 0x80);\n      length >>= 7;\n    } else {\n      o.write_shift(1, length);\n      break;\n    }\n  }\n\n  if (\n  /*:: length != null &&*/\n  length > 0 && is_buf(payload)) ba.push(payload);\n}\n/* XLS ranges enforced */\n\n\nfunction shift_cell_xls(cell\n/*:CellAddress*/\n, tgt\n/*:any*/\n, opts\n/*:?any*/\n)\n/*:CellAddress*/\n{\n  var out = dup(cell);\n\n  if (tgt.s) {\n    if (out.cRel) out.c += tgt.s.c;\n    if (out.rRel) out.r += tgt.s.r;\n  } else {\n    if (out.cRel) out.c += tgt.c;\n    if (out.rRel) out.r += tgt.r;\n  }\n\n  if (!opts || opts.biff < 12) {\n    while (out.c >= 0x100) out.c -= 0x100;\n\n    while (out.r >= 0x10000) out.r -= 0x10000;\n  }\n\n  return out;\n}\n\nfunction shift_range_xls(cell, range, opts) {\n  var out = dup(cell);\n  out.s = shift_cell_xls(out.s, range.s, opts);\n  out.e = shift_cell_xls(out.e, range.s, opts);\n  return out;\n}\n\nfunction encode_cell_xls(c\n/*:CellAddress*/\n, biff\n/*:number*/\n)\n/*:string*/\n{\n  if (c.cRel && c.c < 0) {\n    c = dup(c);\n\n    while (c.c < 0) c.c += biff > 8 ? 0x4000 : 0x100;\n  }\n\n  if (c.rRel && c.r < 0) {\n    c = dup(c);\n\n    while (c.r < 0) c.r += biff > 8 ? 0x100000 : biff > 5 ? 0x10000 : 0x4000;\n  }\n\n  var s = encode_cell(c);\n  if (!c.cRel && c.cRel != null) s = fix_col(s);\n  if (!c.rRel && c.rRel != null) s = fix_row(s);\n  return s;\n}\n\nfunction encode_range_xls(r, opts)\n/*:string*/\n{\n  if (r.s.r == 0 && !r.s.rRel) {\n    if (r.e.r == (opts.biff >= 12 ? 0xFFFFF : opts.biff >= 8 ? 0x10000 : 0x4000) && !r.e.rRel) {\n      return (r.s.cRel ? \"\" : \"$\") + encode_col(r.s.c) + \":\" + (r.e.cRel ? \"\" : \"$\") + encode_col(r.e.c);\n    }\n  }\n\n  if (r.s.c == 0 && !r.s.cRel) {\n    if (r.e.c == (opts.biff >= 12 ? 0x3FFF : 0xFF) && !r.e.cRel) {\n      return (r.s.rRel ? \"\" : \"$\") + encode_row(r.s.r) + \":\" + (r.e.rRel ? \"\" : \"$\") + encode_row(r.e.r);\n    }\n  }\n\n  return encode_cell_xls(r.s, opts.biff) + \":\" + encode_cell_xls(r.e, opts.biff);\n}\n\nfunction decode_row(rowstr\n/*:string*/\n)\n/*:number*/\n{\n  return parseInt(unfix_row(rowstr), 10) - 1;\n}\n\nfunction encode_row(row\n/*:number*/\n)\n/*:string*/\n{\n  return \"\" + (row + 1);\n}\n\nfunction fix_row(cstr\n/*:string*/\n)\n/*:string*/\n{\n  return cstr.replace(/([A-Z]|^)(\\d+)$/, \"$1$$$2\");\n}\n\nfunction unfix_row(cstr\n/*:string*/\n)\n/*:string*/\n{\n  return cstr.replace(/\\$(\\d+)$/, \"$1\");\n}\n\nfunction decode_col(colstr\n/*:string*/\n)\n/*:number*/\n{\n  var c = unfix_col(colstr),\n      d = 0,\n      i = 0;\n\n  for (; i !== c.length; ++i) d = 26 * d + c.charCodeAt(i) - 64;\n\n  return d - 1;\n}\n\nfunction encode_col(col\n/*:number*/\n)\n/*:string*/\n{\n  if (col < 0) throw new Error(\"invalid column \" + col);\n  var s = \"\";\n\n  for (++col; col; col = Math.floor((col - 1) / 26)) s = String.fromCharCode((col - 1) % 26 + 65) + s;\n\n  return s;\n}\n\nfunction fix_col(cstr\n/*:string*/\n)\n/*:string*/\n{\n  return cstr.replace(/^([A-Z])/, \"$$$1\");\n}\n\nfunction unfix_col(cstr\n/*:string*/\n)\n/*:string*/\n{\n  return cstr.replace(/^\\$([A-Z])/, \"$1\");\n}\n\nfunction split_cell(cstr\n/*:string*/\n)\n/*:Array<string>*/\n{\n  return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/, \"$1,$2\").split(\",\");\n} //function decode_cell(cstr/*:string*/)/*:CellAddress*/ { var splt = split_cell(cstr); return { c:decode_col(splt[0]), r:decode_row(splt[1]) }; }\n\n\nfunction decode_cell(cstr\n/*:string*/\n)\n/*:CellAddress*/\n{\n  var R = 0,\n      C = 0;\n\n  for (var i = 0; i < cstr.length; ++i) {\n    var cc = cstr.charCodeAt(i);\n    if (cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);else if (cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n  }\n\n  return {\n    c: C - 1,\n    r: R - 1\n  };\n} //function encode_cell(cell/*:CellAddress*/)/*:string*/ { return encode_col(cell.c) + encode_row(cell.r); }\n\n\nfunction encode_cell(cell\n/*:CellAddress*/\n)\n/*:string*/\n{\n  var col = cell.c + 1;\n  var s = \"\";\n\n  for (; col; col = (col - 1) / 26 | 0) s = String.fromCharCode((col - 1) % 26 + 65) + s;\n\n  return s + (cell.r + 1);\n}\n\nfunction decode_range(range\n/*:string*/\n)\n/*:Range*/\n{\n  var idx = range.indexOf(\":\");\n  if (idx == -1) return {\n    s: decode_cell(range),\n    e: decode_cell(range)\n  };\n  return {\n    s: decode_cell(range.slice(0, idx)),\n    e: decode_cell(range.slice(idx + 1))\n  };\n}\n/*# if only one arg, it is assumed to be a Range.  If 2 args, both are cell addresses */\n\n\nfunction encode_range(cs\n/*:CellAddrSpec|Range*/\n, ce\n/*:?CellAddrSpec*/\n)\n/*:string*/\n{\n  if (typeof ce === 'undefined' || typeof ce === 'number') {\n    /*:: if(!(cs instanceof Range)) throw \"unreachable\"; */\n    return encode_range(cs.s, cs.e);\n  }\n  /*:: if((cs instanceof Range)) throw \"unreachable\"; */\n\n\n  if (typeof cs !== 'string') cs = encode_cell(cs\n  /*:any*/\n  );\n  if (typeof ce !== 'string') ce = encode_cell(ce\n  /*:any*/\n  );\n  /*:: if(typeof cs !== 'string') throw \"unreachable\"; */\n\n  /*:: if(typeof ce !== 'string') throw \"unreachable\"; */\n\n  return cs == ce ? cs : cs + \":\" + ce;\n}\n\nfunction safe_decode_range(range\n/*:string*/\n)\n/*:Range*/\n{\n  var o = {\n    s: {\n      c: 0,\n      r: 0\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  var idx = 0,\n      i = 0,\n      cc = 0;\n  var len = range.length;\n\n  for (idx = 0; i < len; ++i) {\n    if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n    idx = 26 * idx + cc;\n  }\n\n  o.s.c = --idx;\n\n  for (idx = 0; i < len; ++i) {\n    if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n    idx = 10 * idx + cc;\n  }\n\n  o.s.r = --idx;\n\n  if (i === len || cc != 10) {\n    o.e.c = o.s.c;\n    o.e.r = o.s.r;\n    return o;\n  }\n\n  ++i;\n\n  for (idx = 0; i != len; ++i) {\n    if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n    idx = 26 * idx + cc;\n  }\n\n  o.e.c = --idx;\n\n  for (idx = 0; i != len; ++i) {\n    if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n    idx = 10 * idx + cc;\n  }\n\n  o.e.r = --idx;\n  return o;\n}\n\nfunction safe_format_cell(cell\n/*:Cell*/\n, v\n/*:any*/\n) {\n  var q = cell.t == 'd' && v instanceof Date;\n  if (cell.z != null) try {\n    return cell.w = SSF_format(cell.z, q ? datenum(v) : v);\n  } catch (e) {}\n\n  try {\n    return cell.w = SSF_format((cell.XF || {}).numFmtId || (q ? 14 : 0), q ? datenum(v) : v);\n  } catch (e) {\n    return '' + v;\n  }\n}\n\nfunction format_cell(cell\n/*:Cell*/\n, v\n/*:any*/\n, o\n/*:any*/\n) {\n  if (cell == null || cell.t == null || cell.t == 'z') return \"\";\n  if (cell.w !== undefined) return cell.w;\n  if (cell.t == 'd' && !cell.z && o && o.dateNF) cell.z = o.dateNF;\n  if (cell.t == \"e\") return BErr[cell.v] || cell.v;\n  if (v == undefined) return safe_format_cell(cell, cell.v);\n  return safe_format_cell(cell, v);\n}\n\nfunction sheet_to_workbook(sheet\n/*:Worksheet*/\n, opts)\n/*:Workbook*/\n{\n  var n = opts && opts.sheet ? opts.sheet : \"Sheet1\";\n  var sheets = {};\n  sheets[n] = sheet;\n  return {\n    SheetNames: [n],\n    Sheets: sheets\n  };\n}\n\nfunction sheet_add_aoa(_ws\n/*:?Worksheet*/\n, data\n/*:AOA*/\n, opts\n/*:?any*/\n)\n/*:Worksheet*/\n{\n  var o = opts || {};\n  var dense = _ws ? Array.isArray(_ws) : o.dense;\n  if (DENSE != null && dense == null) dense = DENSE;\n  var ws\n  /*:Worksheet*/\n  = _ws || (dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  );\n  var _R = 0,\n      _C = 0;\n\n  if (ws && o.origin != null) {\n    if (typeof o.origin == 'number') _R = o.origin;else {\n      var _origin\n      /*:CellAddress*/\n      = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\n      _R = _origin.r;\n      _C = _origin.c;\n    }\n    if (!ws[\"!ref\"]) ws[\"!ref\"] = \"A1:A1\";\n  }\n\n  var range\n  /*:Range*/\n  = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  }\n  /*:any*/\n  ;\n\n  if (ws['!ref']) {\n    var _range = safe_decode_range(ws['!ref']);\n\n    range.s.c = _range.s.c;\n    range.s.r = _range.s.r;\n    range.e.c = Math.max(range.e.c, _range.e.c);\n    range.e.r = Math.max(range.e.r, _range.e.r);\n    if (_R == -1) range.e.r = _R = _range.e.r + 1;\n  }\n\n  for (var R = 0; R != data.length; ++R) {\n    if (!data[R]) continue;\n    if (!Array.isArray(data[R])) throw new Error(\"aoa_to_sheet expects an array of arrays\");\n\n    for (var C = 0; C != data[R].length; ++C) {\n      if (typeof data[R][C] === 'undefined') continue;\n      var cell\n      /*:Cell*/\n      = {\n        v: data[R][C]\n      }\n      /*:any*/\n      ;\n\n      var __R = _R + R,\n          __C = _C + C;\n\n      if (range.s.r > __R) range.s.r = __R;\n      if (range.s.c > __C) range.s.c = __C;\n      if (range.e.r < __R) range.e.r = __R;\n      if (range.e.c < __C) range.e.c = __C;\n      if (data[R][C] && typeof data[R][C] === 'object' && !Array.isArray(data[R][C]) && !(data[R][C] instanceof Date)) cell = data[R][C];else {\n        if (Array.isArray(cell.v)) {\n          cell.f = data[R][C][1];\n          cell.v = cell.v[0];\n        }\n\n        if (cell.v === null) {\n          if (cell.f) cell.t = 'n';else if (o.nullError) {\n            cell.t = 'e';\n            cell.v = 0;\n          } else if (!o.sheetStubs) continue;else cell.t = 'z';\n        } else if (typeof cell.v === 'number') cell.t = 'n';else if (typeof cell.v === 'boolean') cell.t = 'b';else if (cell.v instanceof Date) {\n          cell.z = o.dateNF || table_fmt[14];\n\n          if (o.cellDates) {\n            cell.t = 'd';\n            cell.w = SSF_format(cell.z, datenum(cell.v));\n          } else {\n            cell.t = 'n';\n            cell.v = datenum(cell.v);\n            cell.w = SSF_format(cell.z, cell.v);\n          }\n        } else cell.t = 's';\n      }\n\n      if (dense) {\n        if (!ws[__R]) ws[__R] = [];\n        if (ws[__R][__C] && ws[__R][__C].z) cell.z = ws[__R][__C].z;\n        ws[__R][__C] = cell;\n      } else {\n        var cell_ref = encode_cell({\n          c: __C,\n          r: __R\n        }\n        /*:any*/\n        );\n        if (ws[cell_ref] && ws[cell_ref].z) cell.z = ws[cell_ref].z;\n        ws[cell_ref] = cell;\n      }\n    }\n  }\n\n  if (range.s.c < 10000000) ws['!ref'] = encode_range(range);\n  return ws;\n}\n\nfunction aoa_to_sheet(data\n/*:AOA*/\n, opts\n/*:?any*/\n)\n/*:Worksheet*/\n{\n  return sheet_add_aoa(null, data, opts);\n}\n\nfunction parse_Int32LE(data) {\n  return data.read_shift(4, 'i');\n}\n\nfunction write_UInt32LE(x\n/*:number*/\n, o) {\n  if (!o) o = new_buf(4);\n  o.write_shift(4, x);\n  return o;\n}\n/* [MS-XLSB] 2.5.168 */\n\n\nfunction parse_XLWideString(data\n/*::, length*/\n)\n/*:string*/\n{\n  var cchCharacters = data.read_shift(4);\n  return cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\n\nfunction write_XLWideString(data\n/*:string*/\n, o) {\n  var _null = false;\n\n  if (o == null) {\n    _null = true;\n    o = new_buf(4 + 2 * data.length);\n  }\n\n  o.write_shift(4, data.length);\n  if (data.length > 0) o.write_shift(0, data, 'dbcs');\n  return _null ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.5.91 */\n//function parse_LPWideString(data/*::, length*/)/*:string*/ {\n//\tvar cchCharacters = data.read_shift(2);\n//\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, \"utf16le\");\n//}\n\n/* [MS-XLSB] 2.5.143 */\n\n\nfunction parse_StrRun(data) {\n  return {\n    ich: data.read_shift(2),\n    ifnt: data.read_shift(2)\n  };\n}\n\nfunction write_StrRun(run, o) {\n  if (!o) o = new_buf(4);\n  o.write_shift(2, run.ich || 0);\n  o.write_shift(2, run.ifnt || 0);\n  return o;\n}\n/* [MS-XLSB] 2.5.121 */\n\n\nfunction parse_RichStr(data, length\n/*:number*/\n)\n/*:XLString*/\n{\n  var start = data.l;\n  var flags = data.read_shift(1);\n  var str = parse_XLWideString(data);\n  var rgsStrRun = [];\n  var z = {\n    t: str,\n    h: str\n  }\n  /*:any*/\n  ;\n\n  if ((flags & 1) !== 0) {\n    /* fRichStr */\n\n    /* TODO: formatted string */\n    var dwSizeStrRun = data.read_shift(4);\n\n    for (var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\n\n    z.r = rgsStrRun;\n  } else z.r = [{\n    ich: 0,\n    ifnt: 0\n  }]; //if((flags & 2) !== 0) { /* fExtStr */\n  //\t/* TODO: phonetic string */\n  //}\n\n\n  data.l = start + length;\n  return z;\n}\n\nfunction write_RichStr(str\n/*:XLString*/\n, o\n/*:?Block*/\n)\n/*:Block*/\n{\n  /* TODO: formatted string */\n  var _null = false;\n\n  if (o == null) {\n    _null = true;\n    o = new_buf(15 + 4 * str.t.length);\n  }\n\n  o.write_shift(1, 0);\n  write_XLWideString(str.t, o);\n  return _null ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.328 BrtCommentText (RichStr w/1 run) */\n\n\nvar parse_BrtCommentText = parse_RichStr;\n\nfunction write_BrtCommentText(str\n/*:XLString*/\n, o\n/*:?Block*/\n)\n/*:Block*/\n{\n  /* TODO: formatted string */\n  var _null = false;\n\n  if (o == null) {\n    _null = true;\n    o = new_buf(23 + 4 * str.t.length);\n  }\n\n  o.write_shift(1, 1);\n  write_XLWideString(str.t, o);\n  o.write_shift(4, 1);\n  write_StrRun({\n    ich: 0,\n    ifnt: 0\n  }, o);\n  return _null ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.5.9 */\n\n\nfunction parse_XLSBCell(data)\n/*:any*/\n{\n  var col = data.read_shift(4);\n  var iStyleRef = data.read_shift(2);\n  iStyleRef += data.read_shift(1) << 16;\n  data.l++; //var fPhShow = data.read_shift(1);\n\n  return {\n    c: col,\n    iStyleRef: iStyleRef\n  };\n}\n\nfunction write_XLSBCell(cell\n/*:any*/\n, o\n/*:?Block*/\n) {\n  if (o == null) o = new_buf(8);\n  o.write_shift(-4, cell.c);\n  o.write_shift(3, cell.iStyleRef || cell.s);\n  o.write_shift(1, 0);\n  /* fPhShow */\n\n  return o;\n}\n/* Short XLSB Cell does not include column */\n\n\nfunction parse_XLSBShortCell(data)\n/*:any*/\n{\n  var iStyleRef = data.read_shift(2);\n  iStyleRef += data.read_shift(1) << 16;\n  data.l++; //var fPhShow = data.read_shift(1);\n\n  return {\n    c: -1,\n    iStyleRef: iStyleRef\n  };\n}\n\nfunction write_XLSBShortCell(cell\n/*:any*/\n, o\n/*:?Block*/\n) {\n  if (o == null) o = new_buf(4);\n  o.write_shift(3, cell.iStyleRef || cell.s);\n  o.write_shift(1, 0);\n  /* fPhShow */\n\n  return o;\n}\n/* [MS-XLSB] 2.5.21 */\n\n\nvar parse_XLSBCodeName = parse_XLWideString;\nvar write_XLSBCodeName = write_XLWideString;\n/* [MS-XLSB] 2.5.166 */\n\nfunction parse_XLNullableWideString(data\n/*::, length*/\n)\n/*:string*/\n{\n  var cchCharacters = data.read_shift(4);\n  return cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\n\nfunction write_XLNullableWideString(data\n/*:string*/\n, o) {\n  var _null = false;\n\n  if (o == null) {\n    _null = true;\n    o = new_buf(127);\n  }\n\n  o.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\n  if (data.length > 0) o.write_shift(0, data, 'dbcs');\n  return _null ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.5.165 */\n\n\nvar parse_XLNameWideString = parse_XLWideString; //var write_XLNameWideString = write_XLWideString;\n\n/* [MS-XLSB] 2.5.114 */\n\nvar parse_RelID = parse_XLNullableWideString;\nvar write_RelID = write_XLNullableWideString;\n/* [MS-XLS] 2.5.217 ; [MS-XLSB] 2.5.122 */\n\nfunction parse_RkNumber(data)\n/*:number*/\n{\n  var b = data.slice(data.l, data.l + 4);\n  var fX100 = b[0] & 1,\n      fInt = b[0] & 2;\n  data.l += 4;\n  var RK = fInt === 0 ? __double([0, 0, 0, 0, b[0] & 0xFC, b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n  return fX100 ? RK / 100 : RK;\n}\n\nfunction write_RkNumber(data\n/*:number*/\n, o) {\n  if (o == null) o = new_buf(4);\n  var fX100 = 0,\n      fInt = 0,\n      d100 = data * 100;\n\n  if (data == (data | 0) && data >= -(1 << 29) && data < 1 << 29) {\n    fInt = 1;\n  } else if (d100 == (d100 | 0) && d100 >= -(1 << 29) && d100 < 1 << 29) {\n    fInt = 1;\n    fX100 = 1;\n  }\n\n  if (fInt) o.write_shift(-4, ((fX100 ? d100 : data) << 2) + (fX100 + 2));else throw new Error(\"unsupported RkNumber \" + data); // TODO\n}\n/* [MS-XLSB] 2.5.117 RfX */\n\n\nfunction parse_RfX(data\n/*::, length*/\n)\n/*:Range*/\n{\n  var cell\n  /*:Range*/\n  = {\n    s: {},\n    e: {}\n  }\n  /*:any*/\n  ;\n  cell.s.r = data.read_shift(4);\n  cell.e.r = data.read_shift(4);\n  cell.s.c = data.read_shift(4);\n  cell.e.c = data.read_shift(4);\n  return cell;\n}\n\nfunction write_RfX(r\n/*:Range*/\n, o) {\n  if (!o) o = new_buf(16);\n  o.write_shift(4, r.s.r);\n  o.write_shift(4, r.e.r);\n  o.write_shift(4, r.s.c);\n  o.write_shift(4, r.e.c);\n  return o;\n}\n/* [MS-XLSB] 2.5.153 UncheckedRfX */\n\n\nvar parse_UncheckedRfX = parse_RfX;\nvar write_UncheckedRfX = write_RfX;\n/* [MS-XLSB] 2.5.155 UncheckedSqRfX */\n//function parse_UncheckedSqRfX(data) {\n//\tvar cnt = data.read_shift(4);\n//\tvar out = [];\n//\tfor(var i = 0; i < cnt; ++i) {\n//\t\tvar rng = parse_UncheckedRfX(data);\n//\t\tout.push(encode_range(rng));\n//\t}\n//\treturn out.join(\",\");\n//}\n//function write_UncheckedSqRfX(sqrfx/*:string*/) {\n//\tvar parts = sqrfx.split(/\\s*,\\s*/);\n//\tvar o = new_buf(4); o.write_shift(4, parts.length);\n//\tvar out = [o];\n//\tparts.forEach(function(rng) {\n//\t\tout.push(write_UncheckedRfX(safe_decode_range(rng)));\n//\t});\n//\treturn bconcat(out);\n//}\n\n/* [MS-XLS] 2.5.342 ; [MS-XLSB] 2.5.171 */\n\n/* TODO: error checking, NaN and Infinity values are not valid Xnum */\n\nfunction parse_Xnum(data\n/*::, length*/\n) {\n  if (data.length - data.l < 8) throw \"XLS Xnum Buffer underflow\";\n  return data.read_shift(8, 'f');\n}\n\nfunction write_Xnum(data, o) {\n  return (o || new_buf(8)).write_shift(8, data, 'f');\n}\n/* [MS-XLSB] 2.4.324 BrtColor */\n\n\nfunction parse_BrtColor(data\n/*::, length*/\n) {\n  var out = {};\n  var d = data.read_shift(1); //var fValidRGB = d & 1;\n\n  var xColorType = d >>> 1;\n  var index = data.read_shift(1);\n  var nTS = data.read_shift(2, 'i');\n  var bR = data.read_shift(1);\n  var bG = data.read_shift(1);\n  var bB = data.read_shift(1);\n  data.l++; //var bAlpha = data.read_shift(1);\n\n  switch (xColorType) {\n    case 0:\n      out.auto = 1;\n      break;\n\n    case 1:\n      out.index = index;\n      var icv = XLSIcv[index];\n      /* automatic pseudo index 81 */\n\n      if (icv) out.rgb = rgb2Hex(icv);\n      break;\n\n    case 2:\n      /* if(!fValidRGB) throw new Error(\"invalid\"); */\n      out.rgb = rgb2Hex([bR, bG, bB]);\n      break;\n\n    case 3:\n      out.theme = index;\n      break;\n  }\n\n  if (nTS != 0) out.tint = nTS > 0 ? nTS / 32767 : nTS / 32768;\n  return out;\n}\n\nfunction write_BrtColor(color, o) {\n  if (!o) o = new_buf(8);\n\n  if (!color || color.auto) {\n    o.write_shift(4, 0);\n    o.write_shift(4, 0);\n    return o;\n  }\n\n  if (color.index != null) {\n    o.write_shift(1, 0x02);\n    o.write_shift(1, color.index);\n  } else if (color.theme != null) {\n    o.write_shift(1, 0x06);\n    o.write_shift(1, color.theme);\n  } else {\n    o.write_shift(1, 0x05);\n    o.write_shift(1, 0);\n  }\n\n  var nTS = color.tint || 0;\n  if (nTS > 0) nTS *= 32767;else if (nTS < 0) nTS *= 32768;\n  o.write_shift(2, nTS);\n\n  if (!color.rgb || color.theme != null) {\n    o.write_shift(2, 0);\n    o.write_shift(1, 0);\n    o.write_shift(1, 0);\n  } else {\n    var rgb = color.rgb || 'FFFFFF';\n    if (typeof rgb == 'number') rgb = (\"000000\" + rgb.toString(16)).slice(-6);\n    o.write_shift(1, parseInt(rgb.slice(0, 2), 16));\n    o.write_shift(1, parseInt(rgb.slice(2, 4), 16));\n    o.write_shift(1, parseInt(rgb.slice(4, 6), 16));\n    o.write_shift(1, 0xFF);\n  }\n\n  return o;\n}\n/* [MS-XLSB] 2.5.52 */\n\n\nfunction parse_FontFlags(data\n/*::, length, opts*/\n) {\n  var d = data.read_shift(1);\n  data.l++;\n  var out = {\n    fBold: d & 0x01,\n    fItalic: d & 0x02,\n    fUnderline: d & 0x04,\n    fStrikeout: d & 0x08,\n    fOutline: d & 0x10,\n    fShadow: d & 0x20,\n    fCondense: d & 0x40,\n    fExtend: d & 0x80\n  };\n  return out;\n}\n\nfunction write_FontFlags(font, o) {\n  if (!o) o = new_buf(2);\n  var grbit = (font.italic ? 0x02 : 0) | (font.strike ? 0x08 : 0) | (font.outline ? 0x10 : 0) | (font.shadow ? 0x20 : 0) | (font.condense ? 0x40 : 0) | (font.extend ? 0x80 : 0);\n  o.write_shift(1, grbit);\n  o.write_shift(1, 0);\n  return o;\n}\n/* [MS-OLEDS] 2.3.1 and 2.3.2 */\n\n\nfunction parse_ClipboardFormatOrString(o, w\n/*:number*/\n)\n/*:string*/\n{\n  // $FlowIgnore\n  var ClipFmt = {\n    2: \"BITMAP\",\n    3: \"METAFILEPICT\",\n    8: \"DIB\",\n    14: \"ENHMETAFILE\"\n  };\n  var m\n  /*:number*/\n  = o.read_shift(4);\n\n  switch (m) {\n    case 0x00000000:\n      return \"\";\n\n    case 0xffffffff:\n    case 0xfffffffe:\n      return ClipFmt[o.read_shift(4)] || \"\";\n  }\n\n  if (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n  o.l -= 4;\n  return o.read_shift(0, w == 1 ? \"lpstr\" : \"lpwstr\");\n}\n\nfunction parse_ClipboardFormatOrAnsiString(o) {\n  return parse_ClipboardFormatOrString(o, 1);\n}\n\nfunction parse_ClipboardFormatOrUnicodeString(o) {\n  return parse_ClipboardFormatOrString(o, 2);\n}\n/* [MS-OLEPS] 2.2 PropertyType */\n// Note: some tree shakers cannot handle VT_VECTOR | $CONST, hence extra vars\n//var VT_EMPTY    = 0x0000;\n//var VT_NULL     = 0x0001;\n\n\nvar VT_I2 = 0x0002;\nvar VT_I4 = 0x0003; //var VT_R4       = 0x0004;\n//var VT_R8       = 0x0005;\n//var VT_CY       = 0x0006;\n//var VT_DATE     = 0x0007;\n//var VT_BSTR     = 0x0008;\n//var VT_ERROR    = 0x000A;\n\nvar VT_BOOL = 0x000B;\nvar VT_VARIANT = 0x000C; //var VT_DECIMAL  = 0x000E;\n//var VT_I1       = 0x0010;\n//var VT_UI1      = 0x0011;\n//var VT_UI2      = 0x0012;\n\nvar VT_UI4 = 0x0013; //var VT_I8       = 0x0014;\n//var VT_UI8      = 0x0015;\n//var VT_INT      = 0x0016;\n//var VT_UINT     = 0x0017;\n\nvar VT_LPSTR = 0x001E; //var VT_LPWSTR   = 0x001F;\n\nvar VT_FILETIME = 0x0040;\nvar VT_BLOB = 0x0041; //var VT_STREAM   = 0x0042;\n//var VT_STORAGE  = 0x0043;\n//var VT_STREAMED_Object  = 0x0044;\n//var VT_STORED_Object    = 0x0045;\n//var VT_BLOB_Object      = 0x0046;\n\nvar VT_CF = 0x0047; //var VT_CLSID    = 0x0048;\n//var VT_VERSIONED_STREAM = 0x0049;\n\nvar VT_VECTOR = 0x1000;\nvar VT_VECTOR_VARIANT = 0x100C;\nvar VT_VECTOR_LPSTR = 0x101E; //var VT_ARRAY    = 0x2000;\n\nvar VT_STRING = 0x0050; // 2.3.3.1.11 VtString\n\nvar VT_USTR = 0x0051; // 2.3.3.1.12 VtUnalignedString\n\nvar VT_CUSTOM = [VT_STRING, VT_USTR];\n/* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\n\nvar DocSummaryPIDDSI = {\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'CodePage',\n    t: VT_I2\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'Category',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x03\n  /*::]*/\n  : {\n    n: 'PresentationFormat',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : {\n    n: 'ByteCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x05\n  /*::]*/\n  : {\n    n: 'LineCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : {\n    n: 'ParagraphCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : {\n    n: 'SlideCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : {\n    n: 'NoteCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x09\n  /*::]*/\n  : {\n    n: 'HiddenCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x0a\n  /*::]*/\n  : {\n    n: 'MultimediaClipCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x0b\n  /*::]*/\n  : {\n    n: 'ScaleCrop',\n    t: VT_BOOL\n  },\n\n  /*::[*/\n  0x0c\n  /*::]*/\n  : {\n    n: 'HeadingPairs',\n    t: VT_VECTOR_VARIANT\n    /* VT_VECTOR | VT_VARIANT */\n\n  },\n\n  /*::[*/\n  0x0d\n  /*::]*/\n  : {\n    n: 'TitlesOfParts',\n    t: VT_VECTOR_LPSTR\n    /* VT_VECTOR | VT_LPSTR */\n\n  },\n\n  /*::[*/\n  0x0e\n  /*::]*/\n  : {\n    n: 'Manager',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x0f\n  /*::]*/\n  : {\n    n: 'Company',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'LinksUpToDate',\n    t: VT_BOOL\n  },\n\n  /*::[*/\n  0x11\n  /*::]*/\n  : {\n    n: 'CharacterCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x13\n  /*::]*/\n  : {\n    n: 'SharedDoc',\n    t: VT_BOOL\n  },\n\n  /*::[*/\n  0x16\n  /*::]*/\n  : {\n    n: 'HyperlinksChanged',\n    t: VT_BOOL\n  },\n\n  /*::[*/\n  0x17\n  /*::]*/\n  : {\n    n: 'AppVersion',\n    t: VT_I4,\n    p: 'version'\n  },\n\n  /*::[*/\n  0x18\n  /*::]*/\n  : {\n    n: 'DigSig',\n    t: VT_BLOB\n  },\n\n  /*::[*/\n  0x1A\n  /*::]*/\n  : {\n    n: 'ContentType',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x1B\n  /*::]*/\n  : {\n    n: 'ContentStatus',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x1C\n  /*::]*/\n  : {\n    n: 'Language',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x1D\n  /*::]*/\n  : {\n    n: 'Version',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {},\n\n  /* [MS-OLEPS] 2.18 */\n\n  /*::[*/\n  0x80000000\n  /*::]*/\n  : {\n    n: 'Locale',\n    t: VT_UI4\n  },\n\n  /*::[*/\n  0x80000003\n  /*::]*/\n  : {\n    n: 'Behavior',\n    t: VT_UI4\n  },\n\n  /*::[*/\n  0x72627262\n  /*::]*/\n  : {}\n};\n/* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\n\nvar SummaryPIDSI = {\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'CodePage',\n    t: VT_I2\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'Title',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x03\n  /*::]*/\n  : {\n    n: 'Subject',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : {\n    n: 'Author',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x05\n  /*::]*/\n  : {\n    n: 'Keywords',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : {\n    n: 'Comments',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : {\n    n: 'Template',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : {\n    n: 'LastAuthor',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x09\n  /*::]*/\n  : {\n    n: 'RevNumber',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x0A\n  /*::]*/\n  : {\n    n: 'EditTime',\n    t: VT_FILETIME\n  },\n\n  /*::[*/\n  0x0B\n  /*::]*/\n  : {\n    n: 'LastPrinted',\n    t: VT_FILETIME\n  },\n\n  /*::[*/\n  0x0C\n  /*::]*/\n  : {\n    n: 'CreatedDate',\n    t: VT_FILETIME\n  },\n\n  /*::[*/\n  0x0D\n  /*::]*/\n  : {\n    n: 'ModifiedDate',\n    t: VT_FILETIME\n  },\n\n  /*::[*/\n  0x0E\n  /*::]*/\n  : {\n    n: 'PageCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : {\n    n: 'WordCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'CharCount',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0x11\n  /*::]*/\n  : {\n    n: 'Thumbnail',\n    t: VT_CF\n  },\n\n  /*::[*/\n  0x12\n  /*::]*/\n  : {\n    n: 'Application',\n    t: VT_STRING\n  },\n\n  /*::[*/\n  0x13\n  /*::]*/\n  : {\n    n: 'DocSecurity',\n    t: VT_I4\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {},\n\n  /* [MS-OLEPS] 2.18 */\n\n  /*::[*/\n  0x80000000\n  /*::]*/\n  : {\n    n: 'Locale',\n    t: VT_UI4\n  },\n\n  /*::[*/\n  0x80000003\n  /*::]*/\n  : {\n    n: 'Behavior',\n    t: VT_UI4\n  },\n\n  /*::[*/\n  0x72627262\n  /*::]*/\n  : {}\n};\n/* [MS-XLS] 2.4.63 Country/Region codes */\n\nvar CountryEnum = {\n  /*::[*/\n  0x0001\n  /*::]*/\n  : \"US\",\n  // United States\n\n  /*::[*/\n  0x0002\n  /*::]*/\n  : \"CA\",\n  // Canada\n\n  /*::[*/\n  0x0003\n  /*::]*/\n  : \"\",\n  // Latin America (except Brazil)\n\n  /*::[*/\n  0x0007\n  /*::]*/\n  : \"RU\",\n  // Russia\n\n  /*::[*/\n  0x0014\n  /*::]*/\n  : \"EG\",\n  // Egypt\n\n  /*::[*/\n  0x001E\n  /*::]*/\n  : \"GR\",\n  // Greece\n\n  /*::[*/\n  0x001F\n  /*::]*/\n  : \"NL\",\n  // Netherlands\n\n  /*::[*/\n  0x0020\n  /*::]*/\n  : \"BE\",\n  // Belgium\n\n  /*::[*/\n  0x0021\n  /*::]*/\n  : \"FR\",\n  // France\n\n  /*::[*/\n  0x0022\n  /*::]*/\n  : \"ES\",\n  // Spain\n\n  /*::[*/\n  0x0024\n  /*::]*/\n  : \"HU\",\n  // Hungary\n\n  /*::[*/\n  0x0027\n  /*::]*/\n  : \"IT\",\n  // Italy\n\n  /*::[*/\n  0x0029\n  /*::]*/\n  : \"CH\",\n  // Switzerland\n\n  /*::[*/\n  0x002B\n  /*::]*/\n  : \"AT\",\n  // Austria\n\n  /*::[*/\n  0x002C\n  /*::]*/\n  : \"GB\",\n  // United Kingdom\n\n  /*::[*/\n  0x002D\n  /*::]*/\n  : \"DK\",\n  // Denmark\n\n  /*::[*/\n  0x002E\n  /*::]*/\n  : \"SE\",\n  // Sweden\n\n  /*::[*/\n  0x002F\n  /*::]*/\n  : \"NO\",\n  // Norway\n\n  /*::[*/\n  0x0030\n  /*::]*/\n  : \"PL\",\n  // Poland\n\n  /*::[*/\n  0x0031\n  /*::]*/\n  : \"DE\",\n  // Germany\n\n  /*::[*/\n  0x0034\n  /*::]*/\n  : \"MX\",\n  // Mexico\n\n  /*::[*/\n  0x0037\n  /*::]*/\n  : \"BR\",\n  // Brazil\n\n  /*::[*/\n  0x003d\n  /*::]*/\n  : \"AU\",\n  // Australia\n\n  /*::[*/\n  0x0040\n  /*::]*/\n  : \"NZ\",\n  // New Zealand\n\n  /*::[*/\n  0x0042\n  /*::]*/\n  : \"TH\",\n  // Thailand\n\n  /*::[*/\n  0x0051\n  /*::]*/\n  : \"JP\",\n  // Japan\n\n  /*::[*/\n  0x0052\n  /*::]*/\n  : \"KR\",\n  // Korea\n\n  /*::[*/\n  0x0054\n  /*::]*/\n  : \"VN\",\n  // Viet Nam\n\n  /*::[*/\n  0x0056\n  /*::]*/\n  : \"CN\",\n  // China\n\n  /*::[*/\n  0x005A\n  /*::]*/\n  : \"TR\",\n  // Turkey\n\n  /*::[*/\n  0x0069\n  /*::]*/\n  : \"JS\",\n  // Ramastan\n\n  /*::[*/\n  0x00D5\n  /*::]*/\n  : \"DZ\",\n  // Algeria\n\n  /*::[*/\n  0x00D8\n  /*::]*/\n  : \"MA\",\n  // Morocco\n\n  /*::[*/\n  0x00DA\n  /*::]*/\n  : \"LY\",\n  // Libya\n\n  /*::[*/\n  0x015F\n  /*::]*/\n  : \"PT\",\n  // Portugal\n\n  /*::[*/\n  0x0162\n  /*::]*/\n  : \"IS\",\n  // Iceland\n\n  /*::[*/\n  0x0166\n  /*::]*/\n  : \"FI\",\n  // Finland\n\n  /*::[*/\n  0x01A4\n  /*::]*/\n  : \"CZ\",\n  // Czech Republic\n\n  /*::[*/\n  0x0376\n  /*::]*/\n  : \"TW\",\n  // Taiwan\n\n  /*::[*/\n  0x03C1\n  /*::]*/\n  : \"LB\",\n  // Lebanon\n\n  /*::[*/\n  0x03C2\n  /*::]*/\n  : \"JO\",\n  // Jordan\n\n  /*::[*/\n  0x03C3\n  /*::]*/\n  : \"SY\",\n  // Syria\n\n  /*::[*/\n  0x03C4\n  /*::]*/\n  : \"IQ\",\n  // Iraq\n\n  /*::[*/\n  0x03C5\n  /*::]*/\n  : \"KW\",\n  // Kuwait\n\n  /*::[*/\n  0x03C6\n  /*::]*/\n  : \"SA\",\n  // Saudi Arabia\n\n  /*::[*/\n  0x03CB\n  /*::]*/\n  : \"AE\",\n  // United Arab Emirates\n\n  /*::[*/\n  0x03CC\n  /*::]*/\n  : \"IL\",\n  // Israel\n\n  /*::[*/\n  0x03CE\n  /*::]*/\n  : \"QA\",\n  // Qatar\n\n  /*::[*/\n  0x03D5\n  /*::]*/\n  : \"IR\",\n  // Iran\n\n  /*::[*/\n  0xFFFF\n  /*::]*/\n  : \"US\" // United States\n\n};\n/* [MS-XLS] 2.5.127 */\n\nvar XLSFillPattern = [null, 'solid', 'mediumGray', 'darkGray', 'lightGray', 'darkHorizontal', 'darkVertical', 'darkDown', 'darkUp', 'darkGrid', 'darkTrellis', 'lightHorizontal', 'lightVertical', 'lightDown', 'lightUp', 'lightGrid', 'lightTrellis', 'gray125', 'gray0625'];\n\nfunction rgbify(arr\n/*:Array<number>*/\n)\n/*:Array<[number, number, number]>*/\n{\n  return arr.map(function (x) {\n    return [x >> 16 & 255, x >> 8 & 255, x & 255];\n  });\n}\n/* [MS-XLS] 2.5.161 */\n\n/* [MS-XLSB] 2.5.75 Icv */\n\n\nvar _XLSIcv = /*#__PURE__*/rgbify([\n/* Color Constants */\n0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF,\n/* Overridable Defaults */\n0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF, 0x800000, 0x008000, 0x000080, 0x808000, 0x800080, 0x008080, 0xC0C0C0, 0x808080, 0x9999FF, 0x993366, 0xFFFFCC, 0xCCFFFF, 0x660066, 0xFF8080, 0x0066CC, 0xCCCCFF, 0x000080, 0xFF00FF, 0xFFFF00, 0x00FFFF, 0x800080, 0x800000, 0x008080, 0x0000FF, 0x00CCFF, 0xCCFFFF, 0xCCFFCC, 0xFFFF99, 0x99CCFF, 0xFF99CC, 0xCC99FF, 0xFFCC99, 0x3366FF, 0x33CCCC, 0x99CC00, 0xFFCC00, 0xFF9900, 0xFF6600, 0x666699, 0x969696, 0x003366, 0x339966, 0x003300, 0x333300, 0x993300, 0x993366, 0x333399, 0x333333,\n/* Other entries to appease BIFF8/12 */\n0xFFFFFF,\n/* 0x40 icvForeground ?? */\n0x000000,\n/* 0x41 icvBackground ?? */\n0x000000,\n/* 0x42 icvFrame ?? */\n0x000000,\n/* 0x43 icv3D ?? */\n0x000000,\n/* 0x44 icv3DText ?? */\n0x000000,\n/* 0x45 icv3DHilite ?? */\n0x000000,\n/* 0x46 icv3DShadow ?? */\n0x000000,\n/* 0x47 icvHilite ?? */\n0x000000,\n/* 0x48 icvCtlText ?? */\n0x000000,\n/* 0x49 icvCtlScrl ?? */\n0x000000,\n/* 0x4A icvCtlInv ?? */\n0x000000,\n/* 0x4B icvCtlBody ?? */\n0x000000,\n/* 0x4C icvCtlFrame ?? */\n0x000000,\n/* 0x4D icvCtlFore ?? */\n0x000000,\n/* 0x4E icvCtlBack ?? */\n0x000000,\n/* 0x4F icvCtlNeutral */\n0x000000,\n/* 0x50 icvInfoBk ?? */\n0x000000\n/* 0x51 icvInfoText ?? */\n]);\n\nvar XLSIcv = /*#__PURE__*/dup(_XLSIcv);\n/* [MS-XLSB] 2.5.97.2 */\n\nvar BErr = {\n  /*::[*/\n  0x00\n  /*::]*/\n  : \"#NULL!\",\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : \"#DIV/0!\",\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : \"#VALUE!\",\n\n  /*::[*/\n  0x17\n  /*::]*/\n  : \"#REF!\",\n\n  /*::[*/\n  0x1D\n  /*::]*/\n  : \"#NAME?\",\n\n  /*::[*/\n  0x24\n  /*::]*/\n  : \"#NUM!\",\n\n  /*::[*/\n  0x2A\n  /*::]*/\n  : \"#N/A\",\n\n  /*::[*/\n  0x2B\n  /*::]*/\n  : \"#GETTING_DATA\",\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : \"#WTF?\"\n}; //var RBErr = evert_num(BErr);\n\nvar RBErr = {\n  \"#NULL!\": 0x00,\n  \"#DIV/0!\": 0x07,\n  \"#VALUE!\": 0x0F,\n  \"#REF!\": 0x17,\n  \"#NAME?\": 0x1D,\n  \"#NUM!\": 0x24,\n  \"#N/A\": 0x2A,\n  \"#GETTING_DATA\": 0x2B,\n  \"#WTF?\": 0xFF\n};\n/* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n\n/* 12.3 Part Summary <SpreadsheetML> */\n\n/* 14.2 Part Summary <DrawingML> */\n\n/* [MS-XLSX] 2.1 Part Enumerations ; [MS-XLSB] 2.1.7 Part Enumeration */\n\nvar ct2type\n/*{[string]:string}*/\n= {\n  /* Workbook */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n  \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\": \"workbooks\",\n  \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\": \"workbooks\",\n  \"application/vnd.ms-excel.addin.macroEnabled.main+xml\": \"workbooks\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\": \"workbooks\",\n\n  /* Worksheet */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\": \"sheets\",\n  \"application/vnd.ms-excel.worksheet\": \"sheets\",\n  \"application/vnd.ms-excel.binIndexWs\": \"TODO\",\n\n  /* Binary Index */\n\n  /* Chartsheet */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"charts\",\n  \"application/vnd.ms-excel.chartsheet\": \"charts\",\n\n  /* Macrosheet */\n  \"application/vnd.ms-excel.macrosheet+xml\": \"macros\",\n  \"application/vnd.ms-excel.macrosheet\": \"macros\",\n  \"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n  \"application/vnd.ms-excel.binIndexMs\": \"TODO\",\n\n  /* Binary Index */\n\n  /* Dialogsheet */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"dialogs\",\n  \"application/vnd.ms-excel.dialogsheet\": \"dialogs\",\n\n  /* Shared Strings */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\": \"strs\",\n  \"application/vnd.ms-excel.sharedStrings\": \"strs\",\n\n  /* Styles */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\": \"styles\",\n  \"application/vnd.ms-excel.styles\": \"styles\",\n\n  /* File Properties */\n  \"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n  \"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n  \"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\n  /* Custom Data Properties */\n  \"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty\": \"TODO\",\n\n  /* Comments */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n  \"application/vnd.ms-excel.comments\": \"comments\",\n  \"application/vnd.ms-excel.threadedcomments+xml\": \"threadedcomments\",\n  \"application/vnd.ms-excel.person+xml\": \"people\",\n\n  /* Metadata (Stock/Geography and Dynamic Array) */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"metadata\",\n  \"application/vnd.ms-excel.sheetMetadata\": \"metadata\",\n\n  /* PivotTable */\n  \"application/vnd.ms-excel.pivotTable\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n\n  /* Chart Objects */\n  \"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n\n  /* Chart Colors */\n  \"application/vnd.ms-office.chartcolorstyle+xml\": \"TODO\",\n\n  /* Chart Style */\n  \"application/vnd.ms-office.chartstyle+xml\": \"TODO\",\n\n  /* Chart Advanced */\n  \"application/vnd.ms-office.chartex+xml\": \"TODO\",\n\n  /* Calculation Chain */\n  \"application/vnd.ms-excel.calcChain\": \"calcchains\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\n  /* Printer Settings */\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n\n  /* ActiveX */\n  \"application/vnd.ms-office.activeX\": \"TODO\",\n  \"application/vnd.ms-office.activeX+xml\": \"TODO\",\n\n  /* Custom Toolbars */\n  \"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n\n  /* External Data Connections */\n  \"application/vnd.ms-excel.connections\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n\n  /* External Links */\n  \"application/vnd.ms-excel.externalLink\": \"links\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"links\",\n\n  /* PivotCache */\n  \"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n  \"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n\n  /* Query Table */\n  \"application/vnd.ms-excel.queryTable\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n\n  /* Shared Workbook */\n  \"application/vnd.ms-excel.userNames\": \"TODO\",\n  \"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n  \"application/vnd.ms-excel.revisionLog\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n\n  /* Single Cell Table */\n  \"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n\n  /* Slicer */\n  \"application/vnd.ms-excel.slicer\": \"TODO\",\n  \"application/vnd.ms-excel.slicerCache\": \"TODO\",\n  \"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n  \"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n\n  /* Sort Map */\n  \"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n\n  /* Table */\n  \"application/vnd.ms-excel.table\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n\n  /* Themes */\n  \"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\n  /* Theme Override */\n  \"application/vnd.openxmlformats-officedocument.themeOverride+xml\": \"TODO\",\n\n  /* Timeline */\n  \"application/vnd.ms-excel.Timeline+xml\": \"TODO\",\n\n  /* verify */\n  \"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\",\n\n  /* verify */\n\n  /* VBA */\n  \"application/vnd.ms-office.vbaProject\": \"vba\",\n  \"application/vnd.ms-office.vbaProjectSignature\": \"TODO\",\n\n  /* Volatile Dependencies */\n  \"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n\n  /* Control Properties */\n  \"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n\n  /* Data Model */\n  \"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n\n  /* Survey */\n  \"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n\n  /* Drawing */\n  \"application/vnd.openxmlformats-officedocument.drawing+xml\": \"drawings\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n  \"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n\n  /* VML */\n  \"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n  \"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n  \"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n\n  /* Image */\n  \"image/png\": \"TODO\",\n  \"sheet\": \"js\"\n}\n/*:any*/\n;\nvar CT_LIST = {\n  workbooks: {\n    xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n    xlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n    xlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n    xlam: \"application/vnd.ms-excel.addin.macroEnabled.main+xml\",\n    xltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\n  },\n  strs: {\n    /* Shared Strings */\n    xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n    xlsb: \"application/vnd.ms-excel.sharedStrings\"\n  },\n  comments: {\n    /* Comments */\n    xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\",\n    xlsb: \"application/vnd.ms-excel.comments\"\n  },\n  sheets: {\n    /* Worksheet */\n    xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n    xlsb: \"application/vnd.ms-excel.worksheet\"\n  },\n  charts: {\n    /* Chartsheet */\n    xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\",\n    xlsb: \"application/vnd.ms-excel.chartsheet\"\n  },\n  dialogs: {\n    /* Dialogsheet */\n    xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\",\n    xlsb: \"application/vnd.ms-excel.dialogsheet\"\n  },\n  macros: {\n    /* Macrosheet (Excel 4.0 Macros) */\n    xlsx: \"application/vnd.ms-excel.macrosheet+xml\",\n    xlsb: \"application/vnd.ms-excel.macrosheet\"\n  },\n  metadata: {\n    /* Metadata (Stock/Geography and Dynamic Array) */\n    xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\",\n    xlsb: \"application/vnd.ms-excel.sheetMetadata\"\n  },\n  styles: {\n    /* Styles */\n    xlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n    xlsb: \"application/vnd.ms-excel.styles\"\n  }\n};\n\nfunction new_ct()\n/*:any*/\n{\n  return {\n    workbooks: [],\n    sheets: [],\n    charts: [],\n    dialogs: [],\n    macros: [],\n    rels: [],\n    strs: [],\n    comments: [],\n    threadedcomments: [],\n    links: [],\n    coreprops: [],\n    extprops: [],\n    custprops: [],\n    themes: [],\n    styles: [],\n    calcchains: [],\n    vba: [],\n    drawings: [],\n    metadata: [],\n    people: [],\n    TODO: [],\n    xmlns: \"\"\n  }\n  /*:any*/\n  ;\n}\n\nfunction parse_ct(data\n/*:?string*/\n) {\n  var ct = new_ct();\n  if (!data || !data.match) return ct;\n  var ctext = {};\n  (data.match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (y[0].replace(nsregex, \"<\")) {\n      case '<?xml':\n        break;\n\n      case '<Types':\n        ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/) || [\"\", \"\"])[1]];\n        break;\n\n      case '<Default':\n        ctext[y.Extension] = y.ContentType;\n        break;\n\n      case '<Override':\n        if (ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\n        break;\n    }\n  });\n  if (ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n  ct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n  ct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n  ct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n  ct.defaults = ctext;\n  delete ct.calcchains;\n  return ct;\n}\n\nfunction write_ct(ct, opts)\n/*:string*/\n{\n  var type2ct\n  /*{[string]:Array<string>}*/\n  = evert_arr(ct2type);\n  var o\n  /*:Array<string>*/\n  = [],\n      v;\n  o[o.length] = XML_HEADER;\n  o[o.length] = writextag('Types', null, {\n    'xmlns': XMLNS.CT,\n    'xmlns:xsd': XMLNS.xsd,\n    'xmlns:xsi': XMLNS.xsi\n  });\n  o = o.concat([['xml', 'application/xml'], ['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'], ['vml', 'application/vnd.openxmlformats-officedocument.vmlDrawing'], ['data', 'application/vnd.openxmlformats-officedocument.model+data'],\n  /* from test files */\n  ['bmp', 'image/bmp'], ['png', 'image/png'], ['gif', 'image/gif'], ['emf', 'image/x-emf'], ['wmf', 'image/x-wmf'], ['jpg', 'image/jpeg'], ['jpeg', 'image/jpeg'], ['tif', 'image/tiff'], ['tiff', 'image/tiff'], ['pdf', 'application/pdf'], ['rels', 'application/vnd.openxmlformats-package.relationships+xml']].map(function (x) {\n    return writextag('Default', null, {\n      'Extension': x[0],\n      'ContentType': x[1]\n    });\n  }));\n  /* only write first instance */\n\n  var f1 = function (w) {\n    if (ct[w] && ct[w].length > 0) {\n      v = ct[w][0];\n      o[o.length] = writextag('Override', null, {\n        'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n        'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n      });\n    }\n  };\n  /* book type-specific */\n\n\n  var f2 = function (w) {\n    (ct[w] || []).forEach(function (v) {\n      o[o.length] = writextag('Override', null, {\n        'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n        'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n      });\n    });\n  };\n  /* standard type */\n\n\n  var f3 = function (t) {\n    (ct[t] || []).forEach(function (v) {\n      o[o.length] = writextag('Override', null, {\n        'PartName': (v[0] == '/' ? \"\" : \"/\") + v,\n        'ContentType': type2ct[t][0]\n      });\n    });\n  };\n\n  f1('workbooks');\n  f2('sheets');\n  f2('charts');\n  f3('themes');\n  ['strs', 'styles'].forEach(f1);\n  ['coreprops', 'extprops', 'custprops'].forEach(f3);\n  f3('vba');\n  f3('comments');\n  f3('threadedcomments');\n  f3('drawings');\n  f2('metadata');\n  f3('people');\n\n  if (o.length > 2) {\n    o[o.length] = '</Types>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* 9.3 Relationships */\n\n\nvar RELS = {\n  WB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n  SHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n  HLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\n  VML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",\n  XPATH: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath\",\n  XMISS: \"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing\",\n  XLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink\",\n  CXML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml\",\n  CXMLP: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps\",\n  CMNT: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\",\n  CORE_PROPS: \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",\n  EXT_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\n  CUST_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties',\n  SST: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",\n  STY: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",\n  THEME: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",\n  CHART: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\",\n  CHARTEX: \"http://schemas.microsoft.com/office/2014/relationships/chartEx\",\n  CS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\",\n  WS: [\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\", \"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\"],\n  DS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet\",\n  MS: \"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet\",\n  IMG: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\",\n  DRAW: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\",\n  XLMETA: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata\",\n  TCMNT: \"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment\",\n  PEOPLE: \"http://schemas.microsoft.com/office/2017/10/relationships/person\",\n  VBA: \"http://schemas.microsoft.com/office/2006/relationships/vbaProject\"\n}\n/*:any*/\n;\n/* 9.3.3 Representing Relationships */\n\nfunction get_rels_path(file\n/*:string*/\n)\n/*:string*/\n{\n  var n = file.lastIndexOf(\"/\");\n  return file.slice(0, n + 1) + '_rels/' + file.slice(n + 1) + \".rels\";\n}\n\nfunction parse_rels(data\n/*:?string*/\n, currentFilePath\n/*:string*/\n) {\n  var rels = {\n    \"!id\": {}\n  };\n  if (!data) return rels;\n\n  if (currentFilePath.charAt(0) !== '/') {\n    currentFilePath = '/' + currentFilePath;\n  }\n\n  var hash = {};\n  (data.match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n    /* 9.3.2.2 OPC_Relationships */\n\n    if (y[0] === '<Relationship') {\n      var rel = {};\n      rel.Type = y.Type;\n      rel.Target = y.Target;\n      rel.Id = y.Id;\n      if (y.TargetMode) rel.TargetMode = y.TargetMode;\n      var canonictarget = y.TargetMode === 'External' ? y.Target : resolve_path(y.Target, currentFilePath);\n      rels[canonictarget] = rel;\n      hash[y.Id] = rel;\n    }\n  });\n  rels[\"!id\"] = hash;\n  return rels;\n}\n/* TODO */\n\n\nfunction write_rels(rels)\n/*:string*/\n{\n  var o = [XML_HEADER, writextag('Relationships', null, {\n    //'xmlns:ns0': XMLNS.RELS,\n    'xmlns': XMLNS.RELS\n  })];\n  keys(rels['!id']).forEach(function (rid) {\n    o[o.length] = writextag('Relationship', null, rels['!id'][rid]);\n  });\n\n  if (o.length > 2) {\n    o[o.length] = '</Relationships>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n\nfunction add_rels(rels, rId\n/*:number*/\n, f, type, relobj, targetmode\n/*:?string*/\n)\n/*:number*/\n{\n  if (!relobj) relobj = {};\n  if (!rels['!id']) rels['!id'] = {};\n  if (!rels['!idx']) rels['!idx'] = 1;\n  if (rId < 0) for (rId = rels['!idx']; rels['!id']['rId' + rId]; ++rId) {\n    /* empty */\n  }\n  rels['!idx'] = rId + 1;\n  relobj.Id = 'rId' + rId;\n  relobj.Type = type;\n  relobj.Target = f;\n  if (targetmode) relobj.TargetMode = targetmode;else if ([RELS.HLINK, RELS.XPATH, RELS.XMISS].indexOf(relobj.Type) > -1) relobj.TargetMode = \"External\";\n  if (rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n  rels['!id'][relobj.Id] = relobj;\n  rels[('/' + relobj.Target).replace(\"//\", \"/\")] = relobj;\n  return rId;\n}\n/* Open Document Format for Office Applications (OpenDocument) Version 1.2 */\n\n/* Part 3 Section 4 Manifest File */\n\n\nvar CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\n\nfunction parse_manifest(d, opts) {\n  var str = xlml_normalize(d);\n  var Rn;\n  var FEtag;\n\n  while (Rn = xlmlregex.exec(str)) switch (Rn[3]) {\n    case 'manifest':\n      break;\n    // 4.2 <manifest:manifest>\n\n    case 'file-entry':\n      // 4.3 <manifest:file-entry>\n      FEtag = parsexmltag(Rn[0], false);\n      if (FEtag.path == '/' && FEtag.type !== CT_ODS) throw new Error(\"This OpenDocument is not a spreadsheet\");\n      break;\n\n    case 'encryption-data': // 4.4 <manifest:encryption-data>\n\n    case 'algorithm': // 4.5 <manifest:algorithm>\n\n    case 'start-key-generation': // 4.6 <manifest:start-key-generation>\n\n    case 'key-derivation':\n      // 4.7 <manifest:key-derivation>\n      throw new Error(\"Unsupported ODS Encryption\");\n\n    default:\n      if (opts && opts.WTF) throw Rn;\n  }\n}\n\nfunction write_manifest(manifest\n/*:Array<Array<string> >*/\n)\n/*:string*/\n{\n  var o = [XML_HEADER];\n  o.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');\n  o.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');\n\n  for (var i = 0; i < manifest.length; ++i) o.push('  <manifest:file-entry manifest:full-path=\"' + manifest[i][0] + '\" manifest:media-type=\"' + manifest[i][1] + '\"/>\\n');\n\n  o.push('</manifest:manifest>');\n  return o.join(\"\");\n}\n/* Part 3 Section 6 Metadata Manifest File */\n\n\nfunction write_rdf_type(file\n/*:string*/\n, res\n/*:string*/\n, tag\n/*:?string*/\n) {\n  return ['  <rdf:Description rdf:about=\"' + file + '\">\\n', '    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || \"odf\") + '#' + res + '\"/>\\n', '  </rdf:Description>\\n'].join(\"\");\n}\n\nfunction write_rdf_has(base\n/*:string*/\n, file\n/*:string*/\n) {\n  return ['  <rdf:Description rdf:about=\"' + base + '\">\\n', '    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"' + file + '\"/>\\n', '  </rdf:Description>\\n'].join(\"\");\n}\n\nfunction write_rdf(rdf) {\n  var o = [XML_HEADER];\n  o.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');\n\n  for (var i = 0; i != rdf.length; ++i) {\n    o.push(write_rdf_type(rdf[i][0], rdf[i][1]));\n    o.push(write_rdf_has(\"\", rdf[i][0]));\n  }\n\n  o.push(write_rdf_type(\"\", \"Document\", \"pkg\"));\n  o.push('</rdf:RDF>');\n  return o.join(\"\");\n}\n/* TODO: pull properties */\n\n\nfunction\n  /*:: wb: Workbook, opts: any*/\nwrite_meta_ods()\n/*:string*/\n{\n  return '<office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" office:version=\"1.2\"><office:meta><meta:generator>Sheet' + 'JS ' + XLSX.version + '</meta:generator></office:meta></office:document-meta>';\n}\n/* ECMA-376 Part II 11.1 Core Properties Part */\n\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n\n\nvar CORE_PROPS\n/*:Array<Array<string> >*/\n= [[\"cp:category\", \"Category\"], [\"cp:contentStatus\", \"ContentStatus\"], [\"cp:keywords\", \"Keywords\"], [\"cp:lastModifiedBy\", \"LastAuthor\"], [\"cp:lastPrinted\", \"LastPrinted\"], [\"cp:revision\", \"RevNumber\"], [\"cp:version\", \"Version\"], [\"dc:creator\", \"Author\"], [\"dc:description\", \"Comments\"], [\"dc:identifier\", \"Identifier\"], [\"dc:language\", \"Language\"], [\"dc:subject\", \"Subject\"], [\"dc:title\", \"Title\"], [\"dcterms:created\", \"CreatedDate\", 'date'], [\"dcterms:modified\", \"ModifiedDate\", 'date']];\n\nvar CORE_PROPS_REGEX\n/*:Array<RegExp>*/\n= /*#__PURE__*/function () {\n  var r = new Array(CORE_PROPS.length);\n\n  for (var i = 0; i < CORE_PROPS.length; ++i) {\n    var f = CORE_PROPS[i];\n    var g = \"(?:\" + f[0].slice(0, f[0].indexOf(\":\")) + \":)\" + f[0].slice(f[0].indexOf(\":\") + 1);\n    r[i] = new RegExp(\"<\" + g + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + g + \">\");\n  }\n\n  return r;\n}();\n\nfunction parse_core_props(data) {\n  var p = {};\n  data = utf8read(data);\n\n  for (var i = 0; i < CORE_PROPS.length; ++i) {\n    var f = CORE_PROPS[i],\n        cur = data.match(CORE_PROPS_REGEX[i]);\n    if (cur != null && cur.length > 0) p[f[1]] = unescapexml(cur[1]);\n    if (f[2] === 'date' && p[f[1]]) p[f[1]] = parseDate(p[f[1]]);\n  }\n\n  return p;\n}\n\nfunction cp_doit(f, g, h, o, p) {\n  if (p[f] != null || g == null || g === \"\") return;\n  p[f] = g;\n  g = escapexml(g);\n  o[o.length] = h ? writextag(f, g, h) : writetag(f, g);\n}\n\nfunction write_core_props(cp, _opts) {\n  var opts = _opts || {};\n  var o = [XML_HEADER, writextag('cp:coreProperties', null, {\n    //'xmlns': XMLNS.CORE_PROPS,\n    'xmlns:cp': XMLNS.CORE_PROPS,\n    'xmlns:dc': XMLNS.dc,\n    'xmlns:dcterms': XMLNS.dcterms,\n    'xmlns:dcmitype': XMLNS.dcmitype,\n    'xmlns:xsi': XMLNS.xsi\n  })],\n      p = {};\n  if (!cp && !opts.Props) return o.join(\"\");\n\n  if (cp) {\n    if (cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\n      \"xsi:type\": \"dcterms:W3CDTF\"\n    }, o, p);\n    if (cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\n      \"xsi:type\": \"dcterms:W3CDTF\"\n    }, o, p);\n  }\n\n  for (var i = 0; i != CORE_PROPS.length; ++i) {\n    var f = CORE_PROPS[i];\n    var v = opts.Props && opts.Props[f[1]] != null ? opts.Props[f[1]] : cp ? cp[f[1]] : null;\n    if (v === true) v = \"1\";else if (v === false) v = \"0\";else if (typeof v == \"number\") v = String(v);\n    if (v != null) cp_doit(f[0], v, null, o, p);\n  }\n\n  if (o.length > 2) {\n    o[o.length] = '</cp:coreProperties>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* 15.2.12.3 Extended File Properties Part */\n\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\n\n\nvar EXT_PROPS\n/*:Array<Array<string> >*/\n= [[\"Application\", \"Application\", \"string\"], [\"AppVersion\", \"AppVersion\", \"string\"], [\"Company\", \"Company\", \"string\"], [\"DocSecurity\", \"DocSecurity\", \"string\"], [\"Manager\", \"Manager\", \"string\"], [\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"], [\"SharedDoc\", \"SharedDoc\", \"bool\"], [\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"], [\"ScaleCrop\", \"ScaleCrop\", \"bool\"], [\"HeadingPairs\", \"HeadingPairs\", \"raw\"], [\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]];\nvar PseudoPropsPairs = [\"Worksheets\", \"SheetNames\", \"NamedRanges\", \"DefinedNames\", \"Chartsheets\", \"ChartNames\"];\n\nfunction load_props_pairs(HP\n/*:string|Array<Array<any>>*/\n, TOP, props, opts) {\n  var v = [];\n  if (typeof HP == \"string\") v = parseVector(HP, opts);else for (var j = 0; j < HP.length; ++j) v = v.concat(HP[j].map(function (hp) {\n    return {\n      v: hp\n    };\n  }));\n  var parts = typeof TOP == \"string\" ? parseVector(TOP, opts).map(function (x) {\n    return x.v;\n  }) : TOP;\n  var idx = 0,\n      len = 0;\n  if (parts.length > 0) for (var i = 0; i !== v.length; i += 2) {\n    len = +v[i + 1].v;\n\n    switch (v[i].v) {\n      case \"Worksheets\":\n      case \"\":\n      case \"\":\n      case \" \":\n      case \"\":\n      case \" \":\n      case \"Arbeitsbltter\":\n      case \"alma Sayfalar\":\n      case \"Feuilles de calcul\":\n      case \"Fogli di lavoro\":\n      case \"Folhas de clculo\":\n      case \"Planilhas\":\n      case \"Regneark\":\n      case \"Hojas de clculo\":\n      case \"Werkbladen\":\n        props.Worksheets = len;\n        props.SheetNames = parts.slice(idx, idx + len);\n        break;\n\n      case \"Named Ranges\":\n      case \"Rangos con nombre\":\n      case \"\":\n      case \"Benannte Bereiche\":\n      case \"Navngivne omrder\":\n        props.NamedRanges = len;\n        props.DefinedNames = parts.slice(idx, idx + len);\n        break;\n\n      case \"Charts\":\n      case \"Diagramme\":\n        props.Chartsheets = len;\n        props.ChartNames = parts.slice(idx, idx + len);\n        break;\n    }\n\n    idx += len;\n  }\n}\n\nfunction parse_ext_props(data, p, opts) {\n  var q = {};\n  if (!p) p = {};\n  data = utf8read(data);\n  EXT_PROPS.forEach(function (f) {\n    var xml = (data.match(matchtag(f[0])) || [])[1];\n\n    switch (f[2]) {\n      case \"string\":\n        if (xml) p[f[1]] = unescapexml(xml);\n        break;\n\n      case \"bool\":\n        p[f[1]] = xml === \"true\";\n        break;\n\n      case \"raw\":\n        var cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + f[0] + \">\"));\n        if (cur && cur.length > 0) q[f[1]] = cur[1];\n        break;\n    }\n  });\n  if (q.HeadingPairs && q.TitlesOfParts) load_props_pairs(q.HeadingPairs, q.TitlesOfParts, p, opts);\n  return p;\n}\n\nfunction write_ext_props(cp\n/*::, opts*/\n)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [],\n      W = writextag;\n  if (!cp) cp = {};\n  cp.Application = \"SheetJS\";\n  o[o.length] = XML_HEADER;\n  o[o.length] = writextag('Properties', null, {\n    'xmlns': XMLNS.EXT_PROPS,\n    'xmlns:vt': XMLNS.vt\n  });\n  EXT_PROPS.forEach(function (f) {\n    if (cp[f[1]] === undefined) return;\n    var v;\n\n    switch (f[2]) {\n      case 'string':\n        v = escapexml(String(cp[f[1]]));\n        break;\n\n      case 'bool':\n        v = cp[f[1]] ? 'true' : 'false';\n        break;\n    }\n\n    if (v !== undefined) o[o.length] = W(f[0], v);\n  });\n  /* TODO: HeadingPairs, TitlesOfParts */\n\n  o[o.length] = W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>') + W('vt:variant', W('vt:i4', String(cp.Worksheets))), {\n    size: 2,\n    baseType: \"variant\"\n  }));\n  o[o.length] = W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function (s) {\n    return \"<vt:lpstr>\" + escapexml(s) + \"</vt:lpstr>\";\n  }).join(\"\"), {\n    size: cp.Worksheets,\n    baseType: \"lpstr\"\n  }));\n\n  if (o.length > 2) {\n    o[o.length] = '</Properties>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* 15.2.12.2 Custom File Properties Part */\n\n\nvar custregex = /<[^>]+>[^<]*/g;\n\nfunction parse_cust_props(data\n/*:string*/\n, opts) {\n  var p = {},\n      name = \"\";\n  var m = data.match(custregex);\n  if (m) for (var i = 0; i != m.length; ++i) {\n    var x = m[i],\n        y = parsexmltag(x);\n\n    switch (y[0]) {\n      case '<?xml':\n        break;\n\n      case '<Properties':\n        break;\n\n      case '<property':\n        name = unescapexml(y.name);\n        break;\n\n      case '</property>':\n        name = null;\n        break;\n\n      default:\n        if (x.indexOf('<vt:') === 0) {\n          var toks = x.split('>');\n          var type = toks[0].slice(4),\n              text = toks[1];\n          /* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n\n          switch (type) {\n            case 'lpstr':\n            case 'bstr':\n            case 'lpwstr':\n              p[name] = unescapexml(text);\n              break;\n\n            case 'bool':\n              p[name] = parsexmlbool(text);\n              break;\n\n            case 'i1':\n            case 'i2':\n            case 'i4':\n            case 'i8':\n            case 'int':\n            case 'uint':\n              p[name] = parseInt(text, 10);\n              break;\n\n            case 'r4':\n            case 'r8':\n            case 'decimal':\n              p[name] = parseFloat(text);\n              break;\n\n            case 'filetime':\n            case 'date':\n              p[name] = parseDate(text);\n              break;\n\n            case 'cy':\n            case 'error':\n              p[name] = unescapexml(text);\n              break;\n\n            default:\n              if (type.slice(-1) == '/') break;\n              if (opts.WTF && typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n          }\n        } else if (x.slice(0, 2) === \"</\") {\n          /* empty */\n        } else if (opts.WTF) throw new Error(x);\n\n    }\n  }\n  return p;\n}\n\nfunction write_cust_props(cp\n/*::, opts*/\n)\n/*:string*/\n{\n  var o = [XML_HEADER, writextag('Properties', null, {\n    'xmlns': XMLNS.CUST_PROPS,\n    'xmlns:vt': XMLNS.vt\n  })];\n  if (!cp) return o.join(\"\");\n  var pid = 1;\n  keys(cp).forEach(function custprop(k) {\n    ++pid;\n    o[o.length] = writextag('property', write_vt(cp[k], true), {\n      'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\n      'pid': pid,\n      'name': escapexml(k)\n    });\n  });\n\n  if (o.length > 2) {\n    o[o.length] = '</Properties>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* Common Name -> XLML Name */\n\n\nvar XLMLDocPropsMap = {\n  Title: 'Title',\n  Subject: 'Subject',\n  Author: 'Author',\n  Keywords: 'Keywords',\n  Comments: 'Description',\n  LastAuthor: 'LastAuthor',\n  RevNumber: 'Revision',\n  Application: 'AppName',\n\n  /* TotalTime: 'TotalTime', */\n  LastPrinted: 'LastPrinted',\n  CreatedDate: 'Created',\n  ModifiedDate: 'LastSaved',\n\n  /* Pages */\n\n  /* Words */\n\n  /* Characters */\n  Category: 'Category',\n\n  /* PresentationFormat */\n  Manager: 'Manager',\n  Company: 'Company',\n\n  /* Guid */\n\n  /* HyperlinkBase */\n\n  /* Bytes */\n\n  /* Lines */\n\n  /* Paragraphs */\n\n  /* CharactersWithSpaces */\n  AppVersion: 'Version',\n  ContentStatus: 'ContentStatus',\n\n  /* NOTE: missing from schema */\n  Identifier: 'Identifier',\n\n  /* NOTE: missing from schema */\n  Language: 'Language'\n  /* NOTE: missing from schema */\n\n};\nvar evert_XLMLDPM;\n\nfunction xlml_set_prop(Props, tag\n/*:string*/\n, val) {\n  if (!evert_XLMLDPM) evert_XLMLDPM = evert(XLMLDocPropsMap);\n  tag = evert_XLMLDPM[tag] || tag;\n  Props[tag] = val;\n}\n\nfunction xlml_write_docprops(Props, opts) {\n  var o\n  /*:Array<string>*/\n  = [];\n  keys(XLMLDocPropsMap).map(function (m) {\n    for (var i = 0; i < CORE_PROPS.length; ++i) if (CORE_PROPS[i][1] == m) return CORE_PROPS[i];\n\n    for (i = 0; i < EXT_PROPS.length; ++i) if (EXT_PROPS[i][1] == m) return EXT_PROPS[i];\n\n    throw m;\n  }).forEach(function (p) {\n    if (Props[p[1]] == null) return;\n    var m = opts && opts.Props && opts.Props[p[1]] != null ? opts.Props[p[1]] : Props[p[1]];\n\n    switch (p[2]) {\n      case 'date':\n        m = new Date(m).toISOString().replace(/\\.\\d*Z/, \"Z\");\n        break;\n    }\n\n    if (typeof m == 'number') m = String(m);else if (m === true || m === false) {\n      m = m ? \"1\" : \"0\";\n    } else if (m instanceof Date) m = new Date(m).toISOString().replace(/\\.\\d*Z/, \"\");\n    o.push(writetag(XLMLDocPropsMap[p[1]] || p[1], m));\n  });\n  return writextag('DocumentProperties', o.join(\"\"), {\n    xmlns: XLMLNS.o\n  });\n}\n\nfunction xlml_write_custprops(Props, Custprops\n/*::, opts*/\n) {\n  var BLACKLIST = [\"Worksheets\", \"SheetNames\"];\n  var T = 'CustomDocumentProperties';\n  var o\n  /*:Array<string>*/\n  = [];\n  if (Props) keys(Props).forEach(function (k) {\n    /*:: if(!Props) return; */\n    if (!Object.prototype.hasOwnProperty.call(Props, k)) return;\n\n    for (var i = 0; i < CORE_PROPS.length; ++i) if (k == CORE_PROPS[i][1]) return;\n\n    for (i = 0; i < EXT_PROPS.length; ++i) if (k == EXT_PROPS[i][1]) return;\n\n    for (i = 0; i < BLACKLIST.length; ++i) if (k == BLACKLIST[i]) return;\n\n    var m = Props[k];\n    var t = \"string\";\n\n    if (typeof m == 'number') {\n      t = \"float\";\n      m = String(m);\n    } else if (m === true || m === false) {\n      t = \"boolean\";\n      m = m ? \"1\" : \"0\";\n    } else m = String(m);\n\n    o.push(writextag(escapexmltag(k), m, {\n      \"dt:dt\": t\n    }));\n  });\n  if (Custprops) keys(Custprops).forEach(function (k) {\n    /*:: if(!Custprops) return; */\n    if (!Object.prototype.hasOwnProperty.call(Custprops, k)) return;\n    if (Props && Object.prototype.hasOwnProperty.call(Props, k)) return;\n    var m = Custprops[k];\n    var t = \"string\";\n\n    if (typeof m == 'number') {\n      t = \"float\";\n      m = String(m);\n    } else if (m === true || m === false) {\n      t = \"boolean\";\n      m = m ? \"1\" : \"0\";\n    } else if (m instanceof Date) {\n      t = \"dateTime.tz\";\n      m = m.toISOString();\n    } else m = String(m);\n\n    o.push(writextag(escapexmltag(k), m, {\n      \"dt:dt\": t\n    }));\n  });\n  return '<' + T + ' xmlns=\"' + XLMLNS.o + '\">' + o.join(\"\") + '</' + T + '>';\n}\n/* [MS-DTYP] 2.3.3 FILETIME */\n\n/* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n\n/* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\n\n\nfunction parse_FILETIME(blob) {\n  var dwLowDateTime = blob.read_shift(4),\n      dwHighDateTime = blob.read_shift(4);\n  return new Date((dwHighDateTime / 1e7 * Math.pow(2, 32) + dwLowDateTime / 1e7 - 11644473600) * 1000).toISOString().replace(/\\.000/, \"\");\n}\n\nfunction write_FILETIME(time\n/*:string|Date*/\n) {\n  var date = typeof time == \"string\" ? new Date(Date.parse(time)) : time;\n  var t = date.getTime() / 1000 + 11644473600;\n  var l = t % Math.pow(2, 32),\n      h = (t - l) / Math.pow(2, 32);\n  l *= 1e7;\n  h *= 1e7;\n  var w = l / Math.pow(2, 32) | 0;\n\n  if (w > 0) {\n    l = l % Math.pow(2, 32);\n    h += w;\n  }\n\n  var o = new_buf(8);\n  o.write_shift(4, l);\n  o.write_shift(4, h);\n  return o;\n}\n/* [MS-OSHARED] 2.3.3.1.4 Lpstr */\n\n\nfunction parse_lpstr(blob, type, pad\n/*:?number*/\n) {\n  var start = blob.l;\n  var str = blob.read_shift(0, 'lpstr-cp');\n  if (pad) while (blob.l - start & 3) ++blob.l;\n  return str;\n}\n/* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\n\n\nfunction parse_lpwstr(blob, type, pad) {\n  var str = blob.read_shift(0, 'lpwstr');\n  if (pad) blob.l += 4 - (str.length + 1 & 3) & 3;\n  return str;\n}\n/* [MS-OSHARED] 2.3.3.1.11 VtString */\n\n/* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\n\n\nfunction parse_VtStringBase(blob, stringType, pad) {\n  if (stringType === 0x1F\n  /*VT_LPWSTR*/\n  ) return parse_lpwstr(blob);\n  return parse_lpstr(blob, stringType, pad);\n}\n\nfunction parse_VtString(blob, t\n/*:number*/\n, pad\n/*:?boolean*/\n) {\n  return parse_VtStringBase(blob, t, pad === false ? 0 : 4);\n}\n\nfunction parse_VtUnalignedString(blob, t\n/*:number*/\n) {\n  if (!t) throw new Error(\"VtUnalignedString must have positive length\");\n  return parse_VtStringBase(blob, t, 0);\n}\n/* [MS-OSHARED] 2.3.3.1.7 VtVecLpwstrValue */\n\n\nfunction parse_VtVecLpwstrValue(blob)\n/*:Array<string>*/\n{\n  var length = blob.read_shift(4);\n  var ret\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i != length; ++i) {\n    var start = blob.l;\n    ret[i] = blob.read_shift(0, 'lpwstr').replace(chr0, '');\n    if (blob.l - start & 0x02) blob.l += 2;\n  }\n\n  return ret;\n}\n/* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\n\n\nfunction parse_VtVecUnalignedLpstrValue(blob)\n/*:Array<string>*/\n{\n  var length = blob.read_shift(4);\n  var ret\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr-cp').replace(chr0, '');\n\n  return ret;\n}\n/* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\n\n\nfunction parse_VtHeadingPair(blob) {\n  var start = blob.l;\n  var headingString = parse_TypedPropertyValue(blob, VT_USTR);\n  if (blob[blob.l] == 0x00 && blob[blob.l + 1] == 0x00 && blob.l - start & 0x02) blob.l += 2;\n  var headerParts = parse_TypedPropertyValue(blob, VT_I4);\n  return [headingString, headerParts];\n}\n/* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\n\n\nfunction parse_VtVecHeadingPairValue(blob) {\n  var cElements = blob.read_shift(4);\n  var out = [];\n\n  for (var i = 0; i < cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n\n  return out;\n}\n/* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\n\n\nfunction parse_dictionary(blob, CodePage) {\n  var cnt = blob.read_shift(4);\n  var dict\n  /*:{[number]:string}*/\n  = {}\n  /*:any*/\n  ;\n\n  for (var j = 0; j != cnt; ++j) {\n    var pid = blob.read_shift(4);\n    var len = blob.read_shift(4);\n    dict[pid] = blob.read_shift(len, CodePage === 0x4B0 ? 'utf16le' : 'utf8').replace(chr0, '').replace(chr1, '!');\n    if (CodePage === 0x4B0 && len % 2) blob.l += 2;\n  }\n\n  if (blob.l & 3) blob.l = blob.l >> 2 + 1 << 2;\n  return dict;\n}\n/* [MS-OLEPS] 2.9 BLOB */\n\n\nfunction parse_BLOB(blob) {\n  var size = blob.read_shift(4);\n  var bytes = blob.slice(blob.l, blob.l + size);\n  blob.l += size;\n  if ((size & 3) > 0) blob.l += 4 - (size & 3) & 3;\n  return bytes;\n}\n/* [MS-OLEPS] 2.11 ClipboardData */\n\n\nfunction parse_ClipboardData(blob) {\n  // TODO\n  var o = {};\n  o.Size = blob.read_shift(4); //o.Format = blob.read_shift(4);\n\n  blob.l += o.Size + 3 - (o.Size - 1) % 4;\n  return o;\n}\n/* [MS-OLEPS] 2.15 TypedPropertyValue */\n\n\nfunction parse_TypedPropertyValue(blob, type\n/*:number*/\n, _opts)\n/*:any*/\n{\n  var t = blob.read_shift(2),\n      ret,\n      opts = _opts || {};\n  blob.l += 2;\n  if (type !== VT_VARIANT) if (t !== type && VT_CUSTOM.indexOf(type) === -1 && !((type & 0xFFFE) == 0x101E && (t & 0xFFFE) == 0x101E)) throw new Error('Expected type ' + type + ' saw ' + t);\n\n  switch (type === VT_VARIANT ? t : type) {\n    case 0x02\n    /*VT_I2*/\n    :\n      ret = blob.read_shift(2, 'i');\n      if (!opts.raw) blob.l += 2;\n      return ret;\n\n    case 0x03\n    /*VT_I4*/\n    :\n      ret = blob.read_shift(4, 'i');\n      return ret;\n\n    case 0x0B\n    /*VT_BOOL*/\n    :\n      return blob.read_shift(4) !== 0x0;\n\n    case 0x13\n    /*VT_UI4*/\n    :\n      ret = blob.read_shift(4);\n      return ret;\n\n    case 0x1E\n    /*VT_LPSTR*/\n    :\n      return parse_lpstr(blob, t, 4).replace(chr0, '');\n\n    case 0x1F\n    /*VT_LPWSTR*/\n    :\n      return parse_lpwstr(blob);\n\n    case 0x40\n    /*VT_FILETIME*/\n    :\n      return parse_FILETIME(blob);\n\n    case 0x41\n    /*VT_BLOB*/\n    :\n      return parse_BLOB(blob);\n\n    case 0x47\n    /*VT_CF*/\n    :\n      return parse_ClipboardData(blob);\n\n    case 0x50\n    /*VT_STRING*/\n    :\n      return parse_VtString(blob, t, !opts.raw).replace(chr0, '');\n\n    case 0x51\n    /*VT_USTR*/\n    :\n      return parse_VtUnalignedString(blob, t\n      /*, 4*/\n      ).replace(chr0, '');\n\n    case 0x100C\n    /*VT_VECTOR|VT_VARIANT*/\n    :\n      return parse_VtVecHeadingPairValue(blob);\n\n    case 0x101E\n    /*VT_VECTOR|VT_LPSTR*/\n    :\n    case 0x101F\n    /*VT_VECTOR|VT_LPWSTR*/\n    :\n      return t == 0x101F ? parse_VtVecLpwstrValue(blob) : parse_VtVecUnalignedLpstrValue(blob);\n\n    default:\n      throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n  }\n}\n\nfunction write_TypedPropertyValue(type\n/*:number*/\n, value) {\n  var o = new_buf(4),\n      p = new_buf(4);\n  o.write_shift(4, type == 0x50 ? 0x1F : type);\n\n  switch (type) {\n    case 0x03\n    /*VT_I4*/\n    :\n      p.write_shift(-4, value);\n      break;\n\n    case 0x05\n    /*VT_I4*/\n    :\n      p = new_buf(8);\n      p.write_shift(8, value, 'f');\n      break;\n\n    case 0x0B\n    /*VT_BOOL*/\n    :\n      p.write_shift(4, value ? 0x01 : 0x00);\n      break;\n\n    case 0x40\n    /*VT_FILETIME*/\n    :\n      /*:: if(typeof value !== \"string\" && !(value instanceof Date)) throw \"unreachable\"; */\n      p = write_FILETIME(value);\n      break;\n\n    case 0x1F\n    /*VT_LPWSTR*/\n    :\n    case 0x50\n    /*VT_STRING*/\n    :\n      /*:: if(typeof value !== \"string\") throw \"unreachable\"; */\n      p = new_buf(4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n      p.write_shift(4, value.length + 1);\n      p.write_shift(0, value, \"dbcs\");\n\n      while (p.l != p.length) p.write_shift(1, 0);\n\n      break;\n\n    default:\n      throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + value);\n  }\n\n  return bconcat([o, p]);\n}\n/* [MS-OLEPS] 2.20 PropertySet */\n\n\nfunction parse_PropertySet(blob, PIDSI) {\n  var start_addr = blob.l;\n  var size = blob.read_shift(4);\n  var NumProps = blob.read_shift(4);\n  var Props = [],\n      i = 0;\n  var CodePage = 0;\n  var Dictionary = -1,\n      DictObj\n  /*:{[number]:string}*/\n  = {}\n  /*:any*/\n  ;\n\n  for (i = 0; i != NumProps; ++i) {\n    var PropID = blob.read_shift(4);\n    var Offset = blob.read_shift(4);\n    Props[i] = [PropID, Offset + start_addr];\n  }\n\n  Props.sort(function (x, y) {\n    return x[1] - y[1];\n  });\n  var PropH = {};\n\n  for (i = 0; i != NumProps; ++i) {\n    if (blob.l !== Props[i][1]) {\n      var fail = true;\n      if (i > 0 && PIDSI) switch (PIDSI[Props[i - 1][0]].t) {\n        case 0x02\n        /*VT_I2*/\n        :\n          if (blob.l + 2 === Props[i][1]) {\n            blob.l += 2;\n            fail = false;\n          }\n\n          break;\n\n        case 0x50\n        /*VT_STRING*/\n        :\n          if (blob.l <= Props[i][1]) {\n            blob.l = Props[i][1];\n            fail = false;\n          }\n\n          break;\n\n        case 0x100C\n        /*VT_VECTOR|VT_VARIANT*/\n        :\n          if (blob.l <= Props[i][1]) {\n            blob.l = Props[i][1];\n            fail = false;\n          }\n\n          break;\n      }\n\n      if ((!PIDSI || i == 0) && blob.l <= Props[i][1]) {\n        fail = false;\n        blob.l = Props[i][1];\n      }\n\n      if (fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n    }\n\n    if (PIDSI) {\n      var piddsi = PIDSI[Props[i][0]];\n      PropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {\n        raw: true\n      });\n      if (piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + (\"0000\" + String(PropH[piddsi.n] & 0xFFFF)).slice(-4);\n      if (piddsi.n == \"CodePage\") switch (PropH[piddsi.n]) {\n        case 0:\n          PropH[piddsi.n] = 1252;\n\n        /* falls through */\n\n        case 874:\n        case 932:\n        case 936:\n        case 949:\n        case 950:\n        case 1250:\n        case 1251:\n        case 1253:\n        case 1254:\n        case 1255:\n        case 1256:\n        case 1257:\n        case 1258:\n        case 10000:\n        case 1200:\n        case 1201:\n        case 1252:\n        case 65000:\n        case -536:\n        case 65001:\n        case -535:\n          set_cp(CodePage = PropH[piddsi.n] >>> 0 & 0xFFFF);\n          break;\n\n        default:\n          throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n      }\n    } else {\n      if (Props[i][0] === 0x1) {\n        CodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2)\n        /*:number*/\n        ;\n        set_cp(CodePage);\n\n        if (Dictionary !== -1) {\n          var oldpos = blob.l;\n          blob.l = Props[Dictionary][1];\n          DictObj = parse_dictionary(blob, CodePage);\n          blob.l = oldpos;\n        }\n      } else if (Props[i][0] === 0) {\n        if (CodePage === 0) {\n          Dictionary = i;\n          blob.l = Props[i + 1][1];\n          continue;\n        }\n\n        DictObj = parse_dictionary(blob, CodePage);\n      } else {\n        var name = DictObj[Props[i][0]];\n        var val;\n        /* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\n        switch (blob[blob.l]) {\n          case 0x41\n          /*VT_BLOB*/\n          :\n            blob.l += 4;\n            val = parse_BLOB(blob);\n            break;\n\n          case 0x1E\n          /*VT_LPSTR*/\n          :\n            blob.l += 4;\n            val = parse_VtString(blob, blob[blob.l - 4]).replace(/\\u0000+$/, \"\");\n            break;\n\n          case 0x1F\n          /*VT_LPWSTR*/\n          :\n            blob.l += 4;\n            val = parse_VtString(blob, blob[blob.l - 4]).replace(/\\u0000+$/, \"\");\n            break;\n\n          case 0x03\n          /*VT_I4*/\n          :\n            blob.l += 4;\n            val = blob.read_shift(4, 'i');\n            break;\n\n          case 0x13\n          /*VT_UI4*/\n          :\n            blob.l += 4;\n            val = blob.read_shift(4);\n            break;\n\n          case 0x05\n          /*VT_R8*/\n          :\n            blob.l += 4;\n            val = blob.read_shift(8, 'f');\n            break;\n\n          case 0x0B\n          /*VT_BOOL*/\n          :\n            blob.l += 4;\n            val = parsebool(blob, 4);\n            break;\n\n          case 0x40\n          /*VT_FILETIME*/\n          :\n            blob.l += 4;\n            val = parseDate(parse_FILETIME(blob));\n            break;\n\n          default:\n            throw new Error(\"unparsed value: \" + blob[blob.l]);\n        }\n\n        PropH[name] = val;\n      }\n    }\n  }\n\n  blob.l = start_addr + size;\n  /* step ahead to skip padding */\n\n  return PropH;\n}\n\nvar XLSPSSkip = [\"CodePage\", \"Thumbnail\", \"_PID_LINKBASE\", \"_PID_HLINKS\", \"SystemIdentifier\", \"FMTID\"]; //.concat(PseudoPropsPairs);\n\nfunction guess_property_type(val\n/*:any*/\n)\n/*:number*/\n{\n  switch (typeof val) {\n    case \"boolean\":\n      return 0x0B;\n\n    case \"number\":\n      return (val | 0) == val ? 0x03 : 0x05;\n\n    case \"string\":\n      return 0x1F;\n\n    case \"object\":\n      if (val instanceof Date) return 0x40;\n      break;\n  }\n\n  return -1;\n}\n\nfunction write_PropertySet(entries, RE, PIDSI) {\n  var hdr = new_buf(8),\n      piao = [],\n      prop = [];\n  var sz = 8,\n      i = 0;\n  var pr = new_buf(8),\n      pio = new_buf(8);\n  pr.write_shift(4, 0x0002);\n  pr.write_shift(4, 0x04B0);\n  pio.write_shift(4, 0x0001);\n  prop.push(pr);\n  piao.push(pio);\n  sz += 8 + pr.length;\n\n  if (!RE) {\n    pio = new_buf(8);\n    pio.write_shift(4, 0);\n    piao.unshift(pio);\n    var bufs = [new_buf(4)];\n    bufs[0].write_shift(4, entries.length);\n\n    for (i = 0; i < entries.length; ++i) {\n      var value = entries[i][0];\n      pr = new_buf(4 + 4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n      pr.write_shift(4, i + 2);\n      pr.write_shift(4, value.length + 1);\n      pr.write_shift(0, value, \"dbcs\");\n\n      while (pr.l != pr.length) pr.write_shift(1, 0);\n\n      bufs.push(pr);\n    }\n\n    pr = bconcat(bufs);\n    prop.unshift(pr);\n    sz += 8 + pr.length;\n  }\n\n  for (i = 0; i < entries.length; ++i) {\n    if (RE && !RE[entries[i][0]]) continue;\n    if (XLSPSSkip.indexOf(entries[i][0]) > -1 || PseudoPropsPairs.indexOf(entries[i][0]) > -1) continue;\n    if (entries[i][1] == null) continue;\n    var val = entries[i][1],\n        idx = 0;\n\n    if (RE) {\n      idx = +RE[entries[i][0]];\n      var pinfo = PIDSI\n      /*:: || {}*/\n      [idx]\n      /*:: || {} */\n      ;\n\n      if (pinfo.p == \"version\" && typeof val == \"string\") {\n        /*:: if(typeof val !== \"string\") throw \"unreachable\"; */\n        var arr = val.split(\".\");\n        val = (+arr[0] << 16) + (+arr[1] || 0);\n      }\n\n      pr = write_TypedPropertyValue(pinfo.t, val);\n    } else {\n      var T = guess_property_type(val);\n\n      if (T == -1) {\n        T = 0x1F;\n        val = String(val);\n      }\n\n      pr = write_TypedPropertyValue(T, val);\n    }\n\n    prop.push(pr);\n    pio = new_buf(8);\n    pio.write_shift(4, !RE ? 2 + i : idx);\n    piao.push(pio);\n    sz += 8 + pr.length;\n  }\n\n  var w = 8 * (prop.length + 1);\n\n  for (i = 0; i < prop.length; ++i) {\n    piao[i].write_shift(4, w);\n    w += prop[i].length;\n  }\n\n  hdr.write_shift(4, sz);\n  hdr.write_shift(4, prop.length);\n  return bconcat([hdr].concat(piao).concat(prop));\n}\n/* [MS-OLEPS] 2.21 PropertySetStream */\n\n\nfunction parse_PropertySetStream(file, PIDSI, clsid) {\n  var blob = file.content;\n  if (!blob) return {}\n  /*:any*/\n  ;\n  prep_blob(blob, 0);\n  var NumSets,\n      FMTID0,\n      FMTID1,\n      Offset0,\n      Offset1 = 0;\n  blob.chk('feff', 'Byte Order: ');\n  /*var vers = */\n\n  blob.read_shift(2); // TODO: check version\n\n  var SystemIdentifier = blob.read_shift(4);\n  var CLSID = blob.read_shift(16);\n  if (CLSID !== CFB.utils.consts.HEADER_CLSID && CLSID !== clsid) throw new Error(\"Bad PropertySet CLSID \" + CLSID);\n  NumSets = blob.read_shift(4);\n  if (NumSets !== 1 && NumSets !== 2) throw new Error(\"Unrecognized #Sets: \" + NumSets);\n  FMTID0 = blob.read_shift(16);\n  Offset0 = blob.read_shift(4);\n  if (NumSets === 1 && Offset0 !== blob.l) throw new Error(\"Length mismatch: \" + Offset0 + \" !== \" + blob.l);else if (NumSets === 2) {\n    FMTID1 = blob.read_shift(16);\n    Offset1 = blob.read_shift(4);\n  }\n  var PSet0 = parse_PropertySet(blob, PIDSI);\n  var rval = {\n    SystemIdentifier: SystemIdentifier\n  }\n  /*:any*/\n  ;\n\n  for (var y in PSet0) rval[y] = PSet0[y]; //rval.blob = blob;\n\n\n  rval.FMTID = FMTID0; //rval.PSet0 = PSet0;\n\n  if (NumSets === 1) return rval;\n  if (Offset1 - blob.l == 2) blob.l += 2;\n  if (blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\n  var PSet1;\n\n  try {\n    PSet1 = parse_PropertySet(blob, null);\n  } catch (e) {\n    /* empty */\n  }\n\n  for (y in PSet1) rval[y] = PSet1[y];\n\n  rval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\n  return rval;\n}\n\nfunction write_PropertySetStream(entries, clsid, RE, PIDSI\n/*:{[key:string|number]:any}*/\n, entries2\n/*:?any*/\n, clsid2\n/*:?any*/\n) {\n  var hdr = new_buf(entries2 ? 68 : 48);\n  var bufs = [hdr];\n  hdr.write_shift(2, 0xFFFE);\n  hdr.write_shift(2, 0x0000);\n  /* TODO: type 1 props */\n\n  hdr.write_shift(4, 0x32363237);\n  hdr.write_shift(16, CFB.utils.consts.HEADER_CLSID, \"hex\");\n  hdr.write_shift(4, entries2 ? 2 : 1);\n  hdr.write_shift(16, clsid, \"hex\");\n  hdr.write_shift(4, entries2 ? 68 : 48);\n  var ps0 = write_PropertySet(entries, RE, PIDSI);\n  bufs.push(ps0);\n\n  if (entries2) {\n    var ps1 = write_PropertySet(entries2, null, null);\n    hdr.write_shift(16, clsid2, \"hex\");\n    hdr.write_shift(4, 68 + ps0.length);\n    bufs.push(ps1);\n  }\n\n  return bconcat(bufs);\n}\n\nfunction parsenoop2(blob, length) {\n  blob.read_shift(length);\n  return null;\n}\n\nfunction writezeroes(n, o) {\n  if (!o) o = new_buf(n);\n\n  for (var j = 0; j < n; ++j) o.write_shift(1, 0);\n\n  return o;\n}\n\nfunction parslurp(blob, length, cb) {\n  var arr = [],\n      target = blob.l + length;\n\n  while (blob.l < target) arr.push(cb(blob, target - blob.l));\n\n  if (target !== blob.l) throw new Error(\"Slurp error\");\n  return arr;\n}\n\nfunction parsebool(blob, length\n/*:number*/\n) {\n  return blob.read_shift(length) === 0x1;\n}\n\nfunction writebool(v\n/*:any*/\n, o) {\n  if (!o) o = new_buf(2);\n  o.write_shift(2, +!!v);\n  return o;\n}\n\nfunction parseuint16(blob\n/*::, length:?number, opts:?any*/\n) {\n  return blob.read_shift(2, 'u');\n}\n\nfunction writeuint16(v\n/*:number*/\n, o) {\n  if (!o) o = new_buf(2);\n  o.write_shift(2, v);\n  return o;\n}\n\nfunction parseuint16a(blob, length\n/*:: :?number, opts:?any*/\n) {\n  return parslurp(blob, length, parseuint16);\n}\n/* --- 2.5 Structures --- */\n\n/* [MS-XLS] 2.5.10 Bes (boolean or error) */\n\n\nfunction parse_Bes(blob\n/*::, length*/\n) {\n  var v = blob.read_shift(1),\n      t = blob.read_shift(1);\n  return t === 0x01 ? v : v === 0x01;\n}\n\nfunction write_Bes(v, t\n/*:string*/\n, o) {\n  if (!o) o = new_buf(2);\n  o.write_shift(1, t == 'e' ? +v : +!!v);\n  o.write_shift(1, t == 'e' ? 1 : 0);\n  return o;\n}\n/* [MS-XLS] 2.5.240 ShortXLUnicodeString */\n\n\nfunction parse_ShortXLUnicodeString(blob, length, opts) {\n  var cch = blob.read_shift(opts && opts.biff >= 12 ? 2 : 1);\n  var encoding = 'sbcs-cont';\n  var cp = current_codepage;\n  if (opts && opts.biff >= 8) current_codepage = 1200;\n\n  if (!opts || opts.biff == 8) {\n    var fHighByte = blob.read_shift(1);\n\n    if (fHighByte) {\n      encoding = 'dbcs-cont';\n    }\n  } else if (opts.biff == 12) {\n    encoding = 'wstr';\n  }\n\n  if (opts.biff >= 2 && opts.biff <= 5) encoding = 'cpstr';\n  var o = cch ? blob.read_shift(cch, encoding) : \"\";\n  current_codepage = cp;\n  return o;\n}\n/* 2.5.293 XLUnicodeRichExtendedString */\n\n\nfunction parse_XLUnicodeRichExtendedString(blob) {\n  var cp = current_codepage;\n  current_codepage = 1200;\n  var cch = blob.read_shift(2),\n      flags = blob.read_shift(1);\n  var\n  /*fHighByte = flags & 0x1,*/\n  fExtSt = flags & 0x4,\n      fRichSt = flags & 0x8;\n  var width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\n  var cRun = 0,\n      cbExtRst;\n  var z = {};\n  if (fRichSt) cRun = blob.read_shift(2);\n  if (fExtSt) cbExtRst = blob.read_shift(4);\n  var encoding = width == 2 ? 'dbcs-cont' : 'sbcs-cont';\n  var msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n  if (fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\n  if (fExtSt) blob.l += cbExtRst; //TODO: parse this\n\n  z.t = msg;\n\n  if (!fRichSt) {\n    z.raw = \"<t>\" + z.t + \"</t>\";\n    z.r = z.t;\n  }\n\n  current_codepage = cp;\n  return z;\n}\n\nfunction write_XLUnicodeRichExtendedString(xlstr\n/*:: :XLString, opts*/\n) {\n  var str = xlstr.t || \"\",\n      nfmts = 1;\n  var hdr = new_buf(3 + (nfmts > 1 ? 2 : 0));\n  hdr.write_shift(2, str.length);\n  hdr.write_shift(1, (nfmts > 1 ? 0x08 : 0x00) | 0x01);\n  if (nfmts > 1) hdr.write_shift(2, nfmts);\n  var otext = new_buf(2 * str.length);\n  otext.write_shift(2 * str.length, str, 'utf16le');\n  var out = [hdr, otext];\n  return bconcat(out);\n}\n/* 2.5.296 XLUnicodeStringNoCch */\n\n\nfunction parse_XLUnicodeStringNoCch(blob, cch, opts) {\n  var retval;\n\n  if (opts) {\n    if (opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'cpstr');\n    if (opts.biff >= 12) return blob.read_shift(cch, 'dbcs-cont');\n  }\n\n  var fHighByte = blob.read_shift(1);\n\n  if (fHighByte === 0) {\n    retval = blob.read_shift(cch, 'sbcs-cont');\n  } else {\n    retval = blob.read_shift(cch, 'dbcs-cont');\n  }\n\n  return retval;\n}\n/* 2.5.294 XLUnicodeString */\n\n\nfunction parse_XLUnicodeString(blob, length, opts) {\n  var cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\n  if (cch === 0) {\n    blob.l++;\n    return \"\";\n  }\n\n  return parse_XLUnicodeStringNoCch(blob, cch, opts);\n}\n/* BIFF5 override */\n\n\nfunction parse_XLUnicodeString2(blob, length, opts) {\n  if (opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\n  var cch = blob.read_shift(1);\n\n  if (cch === 0) {\n    blob.l++;\n    return \"\";\n  }\n\n  return blob.read_shift(cch, opts.biff <= 4 || !blob.lens ? 'cpstr' : 'sbcs-cont');\n}\n/* TODO: BIFF5 and lower, codepage awareness */\n\n\nfunction write_XLUnicodeString(str, opts, o) {\n  if (!o) o = new_buf(3 + 2 * str.length);\n  o.write_shift(2, str.length);\n  o.write_shift(1, 1);\n  o.write_shift(31, str, 'utf16le');\n  return o;\n}\n/* [MS-XLS] 2.5.61 ControlInfo */\n\n\nfunction parse_ControlInfo(blob\n/*::, length, opts*/\n) {\n  var flags = blob.read_shift(1);\n  blob.l++;\n  var accel = blob.read_shift(2);\n  blob.l += 2;\n  return [flags, accel];\n}\n/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\n\n\nfunction parse_URLMoniker(blob\n/*::, length, opts*/\n) {\n  var len = blob.read_shift(4),\n      start = blob.l;\n  var extra = false;\n\n  if (len > 24) {\n    /* look ahead */\n    blob.l += len - 24;\n    if (blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n    blob.l = start;\n  }\n\n  var url = blob.read_shift((extra ? len - 24 : len) >> 1, 'utf16le').replace(chr0, \"\");\n  if (extra) blob.l += 24;\n  return url;\n}\n/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\n\n\nfunction parse_FileMoniker(blob\n/*::, length*/\n) {\n  var cAnti = blob.read_shift(2);\n  var preamble = \"\";\n\n  while (cAnti-- > 0) preamble += \"../\";\n\n  var ansiPath = blob.read_shift(0, 'lpstr-ansi');\n  blob.l += 2; //var endServer = blob.read_shift(2);\n\n  if (blob.read_shift(2) != 0xDEAD) throw new Error(\"Bad FileMoniker\");\n  var sz = blob.read_shift(4);\n  if (sz === 0) return preamble + ansiPath.replace(/\\\\/g, \"/\");\n  var bytes = blob.read_shift(4);\n  if (blob.read_shift(2) != 3) throw new Error(\"Bad FileMoniker\");\n  var unicodePath = blob.read_shift(bytes >> 1, 'utf16le').replace(chr0, \"\");\n  return preamble + unicodePath;\n}\n/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\n\n\nfunction parse_HyperlinkMoniker(blob, length) {\n  var clsid = blob.read_shift(16);\n  length -= 16;\n\n  switch (clsid) {\n    case \"e0c9ea79f9bace118c8200aa004ba90b\":\n      return parse_URLMoniker(blob, length);\n\n    case \"0303000000000000c000000000000046\":\n      return parse_FileMoniker(blob, length);\n\n    default:\n      throw new Error(\"Unsupported Moniker \" + clsid);\n  }\n}\n/* [MS-OSHARED] 2.3.7.9 HyperlinkString */\n\n\nfunction parse_HyperlinkString(blob\n/*::, length*/\n) {\n  var len = blob.read_shift(4);\n  var o = len > 0 ? blob.read_shift(len, 'utf16le').replace(chr0, \"\") : \"\";\n  return o;\n}\n\nfunction write_HyperlinkString(str\n/*:string*/\n, o) {\n  if (!o) o = new_buf(6 + str.length * 2);\n  o.write_shift(4, 1 + str.length);\n\n  for (var i = 0; i < str.length; ++i) o.write_shift(2, str.charCodeAt(i));\n\n  o.write_shift(2, 0);\n  return o;\n}\n/* [MS-OSHARED] 2.3.7.1 Hyperlink Object */\n\n\nfunction parse_Hyperlink(blob, length)\n/*:Hyperlink*/\n{\n  var end = blob.l + length;\n  var sVer = blob.read_shift(4);\n  if (sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n  var flags = blob.read_shift(2);\n  blob.l += 2;\n  var displayName,\n      targetFrameName,\n      moniker,\n      oleMoniker,\n      Loc = \"\",\n      guid,\n      fileTime;\n  if (flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n  if (flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n  if ((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n  if ((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n  if (flags & 0x0008) Loc = parse_HyperlinkString(blob, end - blob.l);\n  if (flags & 0x0020) guid = blob.read_shift(16);\n  if (flags & 0x0040) fileTime = parse_FILETIME(blob\n  /*, 8*/\n  );\n  blob.l = end;\n  var target = targetFrameName || moniker || oleMoniker || \"\";\n  if (target && Loc) target += \"#\" + Loc;\n  if (!target) target = \"#\" + Loc;\n  if (flags & 0x0002 && target.charAt(0) == \"/\" && target.charAt(1) != \"/\") target = \"file://\" + target;\n  var out = {\n    Target: target\n  }\n  /*:any*/\n  ;\n  if (guid) out.guid = guid;\n  if (fileTime) out.time = fileTime;\n  if (displayName) out.Tooltip = displayName;\n  return out;\n}\n\nfunction write_Hyperlink(hl) {\n  var out = new_buf(512),\n      i = 0;\n  var Target = hl.Target;\n  if (Target.slice(0, 7) == \"file://\") Target = Target.slice(7);\n  var hashidx = Target.indexOf(\"#\");\n  var F = hashidx > -1 ? 0x1f : 0x17;\n\n  switch (Target.charAt(0)) {\n    case \"#\":\n      F = 0x1c;\n      break;\n\n    case \".\":\n      F &= ~2;\n      break;\n  }\n\n  out.write_shift(4, 2);\n  out.write_shift(4, F);\n  var data = [8, 6815827, 6619237, 4849780, 83];\n\n  for (i = 0; i < data.length; ++i) out.write_shift(4, data[i]);\n\n  if (F == 0x1C) {\n    Target = Target.slice(1);\n    write_HyperlinkString(Target, out);\n  } else if (F & 0x02) {\n    data = \"e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\n    for (i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\n    var Pretarget = hashidx > -1 ? Target.slice(0, hashidx) : Target;\n    out.write_shift(4, 2 * (Pretarget.length + 1));\n\n    for (i = 0; i < Pretarget.length; ++i) out.write_shift(2, Pretarget.charCodeAt(i));\n\n    out.write_shift(2, 0);\n    if (F & 0x08) write_HyperlinkString(hashidx > -1 ? Target.slice(hashidx + 1) : \"\", out);\n  } else {\n    data = \"03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46\".split(\" \");\n\n    for (i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\n    var P = 0;\n\n    while (Target.slice(P * 3, P * 3 + 3) == \"../\" || Target.slice(P * 3, P * 3 + 3) == \"..\\\\\") ++P;\n\n    out.write_shift(2, P);\n    out.write_shift(4, Target.length - 3 * P + 1);\n\n    for (i = 0; i < Target.length - 3 * P; ++i) out.write_shift(1, Target.charCodeAt(i + 3 * P) & 0xFF);\n\n    out.write_shift(1, 0);\n    out.write_shift(2, 0xFFFF);\n    out.write_shift(2, 0xDEAD);\n\n    for (i = 0; i < 6; ++i) out.write_shift(4, 0);\n  }\n\n  return out.slice(0, out.l);\n}\n/* 2.5.178 LongRGBA */\n\n\nfunction parse_LongRGBA(blob\n/*::, length*/\n) {\n  var r = blob.read_shift(1),\n      g = blob.read_shift(1),\n      b = blob.read_shift(1),\n      a = blob.read_shift(1);\n  return [r, g, b, a];\n}\n/* 2.5.177 LongRGB */\n\n\nfunction parse_LongRGB(blob, length) {\n  var x = parse_LongRGBA(blob, length);\n  x[3] = 0;\n  return x;\n}\n/* [MS-XLS] 2.5.19 */\n\n\nfunction parse_XLSCell(blob\n/*::, length*/\n)\n/*:Cell*/\n{\n  var rw = blob.read_shift(2); // 0-indexed\n\n  var col = blob.read_shift(2);\n  var ixfe = blob.read_shift(2);\n  return {\n    r: rw,\n    c: col,\n    ixfe: ixfe\n  }\n  /*:any*/\n  ;\n}\n\nfunction write_XLSCell(R\n/*:number*/\n, C\n/*:number*/\n, ixfe\n/*:?number*/\n, o) {\n  if (!o) o = new_buf(6);\n  o.write_shift(2, R);\n  o.write_shift(2, C);\n  o.write_shift(2, ixfe || 0);\n  return o;\n}\n/* [MS-XLS] 2.5.134 */\n\n\nfunction parse_frtHeader(blob) {\n  var rt = blob.read_shift(2);\n  var flags = blob.read_shift(2); // TODO: parse these flags\n\n  blob.l += 8;\n  return {\n    type: rt,\n    flags: flags\n  };\n}\n\nfunction parse_OptXLUnicodeString(blob, length, opts) {\n  return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts);\n}\n/* [MS-XLS] 2.5.344 */\n\n\nfunction parse_XTI(blob, length, opts) {\n  var w = opts.biff > 8 ? 4 : 2;\n  var iSupBook = blob.read_shift(w),\n      itabFirst = blob.read_shift(w, 'i'),\n      itabLast = blob.read_shift(w, 'i');\n  return [iSupBook, itabFirst, itabLast];\n}\n/* [MS-XLS] 2.5.218 */\n\n\nfunction parse_RkRec(blob) {\n  var ixfe = blob.read_shift(2);\n  var RK = parse_RkNumber(blob);\n  return [ixfe, RK];\n}\n/* [MS-XLS] 2.5.1 */\n\n\nfunction parse_AddinUdf(blob, length, opts) {\n  blob.l += 4;\n  length -= 4;\n  var l = blob.l + length;\n  var udfName = parse_ShortXLUnicodeString(blob, length, opts);\n  var cb = blob.read_shift(2);\n  l -= blob.l;\n  if (cb !== l) throw new Error(\"Malformed AddinUdf: padding = \" + l + \" != \" + cb);\n  blob.l += cb;\n  return udfName;\n}\n/* [MS-XLS] 2.5.209 TODO: Check sizes */\n\n\nfunction parse_Ref8U(blob\n/*::, length*/\n) {\n  var rwFirst = blob.read_shift(2);\n  var rwLast = blob.read_shift(2);\n  var colFirst = blob.read_shift(2);\n  var colLast = blob.read_shift(2);\n  return {\n    s: {\n      c: colFirst,\n      r: rwFirst\n    },\n    e: {\n      c: colLast,\n      r: rwLast\n    }\n  };\n}\n\nfunction write_Ref8U(r\n/*:Range*/\n, o) {\n  if (!o) o = new_buf(8);\n  o.write_shift(2, r.s.r);\n  o.write_shift(2, r.e.r);\n  o.write_shift(2, r.s.c);\n  o.write_shift(2, r.e.c);\n  return o;\n}\n/* [MS-XLS] 2.5.211 */\n\n\nfunction parse_RefU(blob\n/*::, length*/\n) {\n  var rwFirst = blob.read_shift(2);\n  var rwLast = blob.read_shift(2);\n  var colFirst = blob.read_shift(1);\n  var colLast = blob.read_shift(1);\n  return {\n    s: {\n      c: colFirst,\n      r: rwFirst\n    },\n    e: {\n      c: colLast,\n      r: rwLast\n    }\n  };\n}\n/* [MS-XLS] 2.5.207 */\n\n\nvar parse_Ref = parse_RefU;\n/* [MS-XLS] 2.5.143 */\n\nfunction parse_FtCmo(blob\n/*::, length*/\n) {\n  blob.l += 4;\n  var ot = blob.read_shift(2);\n  var id = blob.read_shift(2);\n  var flags = blob.read_shift(2);\n  blob.l += 12;\n  return [id, ot, flags];\n}\n/* [MS-XLS] 2.5.149 */\n\n\nfunction parse_FtNts(blob) {\n  var out = {};\n  blob.l += 4;\n  blob.l += 16; // GUID TODO\n\n  out.fSharedNote = blob.read_shift(2);\n  blob.l += 4;\n  return out;\n}\n/* [MS-XLS] 2.5.142 */\n\n\nfunction parse_FtCf(blob) {\n  var out = {};\n  blob.l += 4;\n  blob.cf = blob.read_shift(2);\n  return out;\n}\n/* [MS-XLS] 2.5.140 - 2.5.154 and friends */\n\n\nfunction parse_FtSkip(blob) {\n  blob.l += 2;\n  blob.l += blob.read_shift(2);\n}\n\nvar FtTab = {\n  /*::[*/\n  0x00\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtEnd */\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtMacro */\n\n  /*::[*/\n  0x05\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtButton */\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtGmo */\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : parse_FtCf,\n\n  /* FtCf */\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtPioGrbit */\n\n  /*::[*/\n  0x09\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtPictFmla */\n\n  /*::[*/\n  0x0A\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtCbls */\n\n  /*::[*/\n  0x0B\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtRbo */\n\n  /*::[*/\n  0x0C\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtSbs */\n\n  /*::[*/\n  0x0D\n  /*::]*/\n  : parse_FtNts,\n\n  /* FtNts */\n\n  /*::[*/\n  0x0E\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtSbsFmla */\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtGboData */\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtEdoData */\n\n  /*::[*/\n  0x11\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtRboData */\n\n  /*::[*/\n  0x12\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtCblsData */\n\n  /*::[*/\n  0x13\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtLbsData */\n\n  /*::[*/\n  0x14\n  /*::]*/\n  : parse_FtSkip,\n\n  /* FtCblsFmla */\n\n  /*::[*/\n  0x15\n  /*::]*/\n  : parse_FtCmo\n};\n\nfunction parse_FtArray(blob, length\n/*::, ot*/\n) {\n  var tgt = blob.l + length;\n  var fts = [];\n\n  while (blob.l < tgt) {\n    var ft = blob.read_shift(2);\n    blob.l -= 2;\n\n    try {\n      fts.push(FtTab[ft](blob, tgt - blob.l));\n    } catch (e) {\n      blob.l = tgt;\n      return fts;\n    }\n  }\n\n  if (blob.l != tgt) blob.l = tgt; //throw new Error(\"bad Object Ft-sequence\");\n\n  return fts;\n}\n/* --- 2.4 Records --- */\n\n/* [MS-XLS] 2.4.21 */\n\n\nfunction parse_BOF(blob, length) {\n  var o = {\n    BIFFVer: 0,\n    dt: 0\n  };\n  o.BIFFVer = blob.read_shift(2);\n  length -= 2;\n\n  if (length >= 2) {\n    o.dt = blob.read_shift(2);\n    blob.l -= 2;\n  }\n\n  switch (o.BIFFVer) {\n    case 0x0600:\n    /* BIFF8 */\n\n    case 0x0500:\n    /* BIFF5 */\n\n    case 0x0400:\n    /* BIFF4 */\n\n    case 0x0300:\n    /* BIFF3 */\n\n    case 0x0200:\n    /* BIFF2 */\n\n    case 0x0002:\n    case 0x0007:\n      /* BIFF2 */\n      break;\n\n    default:\n      if (length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\n  }\n\n  blob.read_shift(length);\n  return o;\n}\n\nfunction write_BOF(wb\n/*:Workbook*/\n, t\n/*:number*/\n, o) {\n  var h = 0x0600,\n      w = 16;\n\n  switch (o.bookType) {\n    case 'biff8':\n      break;\n\n    case 'biff5':\n      h = 0x0500;\n      w = 8;\n      break;\n\n    case 'biff4':\n      h = 0x0004;\n      w = 6;\n      break;\n\n    case 'biff3':\n      h = 0x0003;\n      w = 6;\n      break;\n\n    case 'biff2':\n      h = 0x0002;\n      w = 4;\n      break;\n\n    case 'xla':\n      break;\n\n    default:\n      throw new Error(\"unsupported BIFF version\");\n  }\n\n  var out = new_buf(w);\n  out.write_shift(2, h);\n  out.write_shift(2, t);\n  if (w > 4) out.write_shift(2, 0x7262);\n  if (w > 6) out.write_shift(2, 0x07CD);\n\n  if (w > 8) {\n    out.write_shift(2, 0xC009);\n    out.write_shift(2, 0x0001);\n    out.write_shift(2, 0x0706);\n    out.write_shift(2, 0x0000);\n  }\n\n  return out;\n}\n/* [MS-XLS] 2.4.146 */\n\n\nfunction parse_InterfaceHdr(blob, length) {\n  if (length === 0) return 0x04b0;\n\n  if (blob.read_shift(2) !== 0x04b0) {\n    /* empty */\n  }\n\n  return 0x04b0;\n}\n/* [MS-XLS] 2.4.349 */\n\n\nfunction parse_WriteAccess(blob, length, opts) {\n  if (opts.enc) {\n    blob.l += length;\n    return \"\";\n  }\n\n  var l = blob.l; // TODO: make sure XLUnicodeString doesnt overrun\n\n  var UserName = parse_XLUnicodeString2(blob, 0, opts);\n  blob.read_shift(length + l - blob.l);\n  return UserName;\n}\n\nfunction write_WriteAccess(s\n/*:string*/\n, opts) {\n  var b8 = !opts || opts.biff == 8;\n  var o = new_buf(b8 ? 112 : 54);\n  o.write_shift(opts.biff == 8 ? 2 : 1, 7);\n  if (b8) o.write_shift(1, 0);\n  o.write_shift(4, 0x33336853);\n  o.write_shift(4, 0x00534A74 | (b8 ? 0 : 0x20000000));\n\n  while (o.l < o.length) o.write_shift(1, b8 ? 0 : 32);\n\n  return o;\n}\n/* [MS-XLS] 2.4.351 */\n\n\nfunction parse_WsBool(blob, length, opts) {\n  var flags = opts && opts.biff == 8 || length == 2 ? blob.read_shift(2) : (blob.l += length, 0);\n  return {\n    fDialog: flags & 0x10,\n    fBelow: flags & 0x40,\n    fRight: flags & 0x80\n  };\n}\n/* [MS-XLS] 2.4.28 */\n\n\nfunction parse_BoundSheet8(blob, length, opts) {\n  var pos = blob.read_shift(4);\n  var hidden = blob.read_shift(1) & 0x03;\n  var dt = blob.read_shift(1);\n\n  switch (dt) {\n    case 0:\n      dt = 'Worksheet';\n      break;\n\n    case 1:\n      dt = 'Macrosheet';\n      break;\n\n    case 2:\n      dt = 'Chartsheet';\n      break;\n\n    case 6:\n      dt = 'VBAModule';\n      break;\n  }\n\n  var name = parse_ShortXLUnicodeString(blob, 0, opts);\n  if (name.length === 0) name = \"Sheet1\";\n  return {\n    pos: pos,\n    hs: hidden,\n    dt: dt,\n    name: name\n  };\n}\n\nfunction write_BoundSheet8(data, opts) {\n  var w = !opts || opts.biff >= 8 ? 2 : 1;\n  var o = new_buf(8 + w * data.name.length);\n  o.write_shift(4, data.pos);\n  o.write_shift(1, data.hs || 0);\n  o.write_shift(1, data.dt);\n  o.write_shift(1, data.name.length);\n  if (opts.biff >= 8) o.write_shift(1, 1);\n  o.write_shift(w * data.name.length, data.name, opts.biff < 8 ? 'sbcs' : 'utf16le');\n  var out = o.slice(0, o.l);\n  out.l = o.l;\n  return out;\n}\n/* [MS-XLS] 2.4.265 TODO */\n\n\nfunction parse_SST(blob, length)\n/*:SST*/\n{\n  var end = blob.l + length;\n  var cnt = blob.read_shift(4);\n  var ucnt = blob.read_shift(4);\n  var strs\n  /*:SST*/\n  = []\n  /*:any*/\n  ;\n\n  for (var i = 0; i != ucnt && blob.l < end; ++i) {\n    strs.push(parse_XLUnicodeRichExtendedString(blob));\n  }\n\n  strs.Count = cnt;\n  strs.Unique = ucnt;\n  return strs;\n}\n\nfunction write_SST(sst, opts) {\n  var header = new_buf(8);\n  header.write_shift(4, sst.Count);\n  header.write_shift(4, sst.Unique);\n  var strs = [];\n\n  for (var j = 0; j < sst.length; ++j) strs[j] = write_XLUnicodeRichExtendedString(sst[j], opts);\n\n  var o = bconcat([header].concat(strs));\n  /*::(*/\n\n  o\n  /*:: :any)*/\n  .parts = [header.length].concat(strs.map(function (str) {\n    return str.length;\n  }));\n  return o;\n}\n/* [MS-XLS] 2.4.107 */\n\n\nfunction parse_ExtSST(blob, length) {\n  var extsst = {};\n  extsst.dsst = blob.read_shift(2);\n  blob.l += length - 2;\n  return extsst;\n}\n/* [MS-XLS] 2.4.221 TODO: check BIFF2-4 */\n\n\nfunction parse_Row(blob) {\n  var z = {}\n  /*:any*/\n  ;\n  z.r = blob.read_shift(2);\n  z.c = blob.read_shift(2);\n  z.cnt = blob.read_shift(2) - z.c;\n  var miyRw = blob.read_shift(2);\n  blob.l += 4; // reserved(2), unused(2)\n\n  var flags = blob.read_shift(1); // various flags\n\n  blob.l += 3; // reserved(8), ixfe(12), flags(4)\n\n  if (flags & 0x07) z.level = flags & 0x07; // collapsed: flags & 0x10\n\n  if (flags & 0x20) z.hidden = true;\n  if (flags & 0x40) z.hpt = miyRw / 20;\n  return z;\n}\n/* [MS-XLS] 2.4.125 */\n\n\nfunction parse_ForceFullCalculation(blob) {\n  var header = parse_frtHeader(blob);\n  if (header.type != 0x08A3) throw new Error(\"Invalid Future Record \" + header.type);\n  var fullcalc = blob.read_shift(4);\n  return fullcalc !== 0x0;\n}\n/* [MS-XLS] 2.4.215 rt */\n\n\nfunction parse_RecalcId(blob) {\n  blob.read_shift(2);\n  return blob.read_shift(4);\n}\n/* [MS-XLS] 2.4.87 */\n\n\nfunction parse_DefaultRowHeight(blob, length, opts) {\n  var f = 0;\n\n  if (!(opts && opts.biff == 2)) {\n    f = blob.read_shift(2);\n  }\n\n  var miyRw = blob.read_shift(2);\n\n  if (opts && opts.biff == 2) {\n    f = 1 - (miyRw >> 15);\n    miyRw &= 0x7fff;\n  }\n\n  var fl = {\n    Unsynced: f & 1,\n    DyZero: (f & 2) >> 1,\n    ExAsc: (f & 4) >> 2,\n    ExDsc: (f & 8) >> 3\n  };\n  return [fl, miyRw];\n}\n/* [MS-XLS] 2.4.345 TODO */\n\n\nfunction parse_Window1(blob) {\n  var xWn = blob.read_shift(2),\n      yWn = blob.read_shift(2),\n      dxWn = blob.read_shift(2),\n      dyWn = blob.read_shift(2);\n  var flags = blob.read_shift(2),\n      iTabCur = blob.read_shift(2),\n      iTabFirst = blob.read_shift(2);\n  var ctabSel = blob.read_shift(2),\n      wTabRatio = blob.read_shift(2);\n  return {\n    Pos: [xWn, yWn],\n    Dim: [dxWn, dyWn],\n    Flags: flags,\n    CurTab: iTabCur,\n    FirstTab: iTabFirst,\n    Selected: ctabSel,\n    TabRatio: wTabRatio\n  };\n}\n\nfunction\n  /*::opts*/\nwrite_Window1() {\n  var o = new_buf(18);\n  o.write_shift(2, 0);\n  o.write_shift(2, 0);\n  o.write_shift(2, 0x7260);\n  o.write_shift(2, 0x44c0);\n  o.write_shift(2, 0x38);\n  o.write_shift(2, 0);\n  o.write_shift(2, 0);\n  o.write_shift(2, 1);\n  o.write_shift(2, 0x01f4);\n  return o;\n}\n/* [MS-XLS] 2.4.346 TODO */\n\n\nfunction parse_Window2(blob, length, opts) {\n  if (opts && opts.biff >= 2 && opts.biff < 5) return {};\n  var f = blob.read_shift(2);\n  return {\n    RTL: f & 0x40\n  };\n}\n\nfunction write_Window2(view) {\n  var o = new_buf(18),\n      f = 0x6b6;\n  if (view && view.RTL) f |= 0x40;\n  o.write_shift(2, f);\n  o.write_shift(4, 0);\n  o.write_shift(4, 64);\n  o.write_shift(4, 0);\n  o.write_shift(4, 0);\n  return o;\n}\n/* [MS-XLS] 2.4.189 TODO */\n\n\nfunction\n  /*blob, length, opts*/\nparse_Pane() {}\n/* [MS-XLS] 2.4.122 TODO */\n\n\nfunction parse_Font(blob, length, opts) {\n  var o\n  /*:any*/\n  = {\n    dyHeight: blob.read_shift(2),\n    fl: blob.read_shift(2)\n  };\n\n  switch (opts && opts.biff || 8) {\n    case 2:\n      break;\n\n    case 3:\n    case 4:\n      blob.l += 2;\n      break;\n\n    default:\n      blob.l += 10;\n      break;\n  }\n\n  o.name = parse_ShortXLUnicodeString(blob, 0, opts);\n  return o;\n}\n\nfunction write_Font(data, opts) {\n  var name = data.name || \"Arial\";\n  var b5 = opts && opts.biff == 5,\n      w = b5 ? 15 + name.length : 16 + 2 * name.length;\n  var o = new_buf(w);\n  o.write_shift(2, (data.sz || 12) * 20);\n  o.write_shift(4, 0);\n  o.write_shift(2, 400);\n  o.write_shift(4, 0);\n  o.write_shift(2, 0);\n  o.write_shift(1, name.length);\n  if (!b5) o.write_shift(1, 1);\n  o.write_shift((b5 ? 1 : 2) * name.length, name, b5 ? \"sbcs\" : \"utf16le\");\n  return o;\n}\n/* [MS-XLS] 2.4.149 */\n\n\nfunction parse_LabelSst(blob) {\n  var cell = parse_XLSCell(blob);\n  cell.isst = blob.read_shift(4);\n  return cell;\n}\n\nfunction write_LabelSst(R\n/*:number*/\n, C\n/*:number*/\n, v\n/*:number*/\n, os\n/*:number*/\n\n/*::, opts*/\n) {\n  var o = new_buf(10);\n  write_XLSCell(R, C, os, o);\n  o.write_shift(4, v);\n  return o;\n}\n/* [MS-XLS] 2.4.148 */\n\n\nfunction parse_Label(blob, length, opts) {\n  if (opts.biffguess && opts.biff == 2) opts.biff = 5;\n  var target = blob.l + length;\n  var cell = parse_XLSCell(blob, 6);\n  if (opts.biff == 2) blob.l++;\n  var str = parse_XLUnicodeString(blob, target - blob.l, opts);\n  cell.val = str;\n  return cell;\n}\n\nfunction write_Label(R\n/*:number*/\n, C\n/*:number*/\n, v\n/*:string*/\n, os\n/*:number*/\n, opts) {\n  var b8 = !opts || opts.biff == 8;\n  var o = new_buf(6 + 2 + +b8 + (1 + b8) * v.length);\n  write_XLSCell(R, C, os, o);\n  o.write_shift(2, v.length);\n  if (b8) o.write_shift(1, 1);\n  o.write_shift((1 + b8) * v.length, v, b8 ? 'utf16le' : 'sbcs');\n  return o;\n}\n/* [MS-XLS] 2.4.126 Number Formats */\n\n\nfunction parse_Format(blob, length, opts) {\n  var numFmtId = blob.read_shift(2);\n  var fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n  return [numFmtId, fmtstr];\n}\n\nfunction write_Format(i\n/*:number*/\n, f\n/*:string*/\n, opts, o) {\n  var b5 = opts && opts.biff == 5;\n  if (!o) o = new_buf(b5 ? 3 + f.length : 5 + 2 * f.length);\n  o.write_shift(2, i);\n  o.write_shift(b5 ? 1 : 2, f.length);\n  if (!b5) o.write_shift(1, 1);\n  o.write_shift((b5 ? 1 : 2) * f.length, f, b5 ? 'sbcs' : 'utf16le');\n  var out = o.length > o.l ? o.slice(0, o.l) : o;\n  if (out.l == null) out.l = out.length;\n  return out;\n}\n\nvar parse_BIFF2Format = parse_XLUnicodeString2;\n/* [MS-XLS] 2.4.90 */\n\nfunction parse_Dimensions(blob, length, opts) {\n  var end = blob.l + length;\n  var w = opts.biff == 8 || !opts.biff ? 4 : 2;\n  var r = blob.read_shift(w),\n      R = blob.read_shift(w);\n  var c = blob.read_shift(2),\n      C = blob.read_shift(2);\n  blob.l = end;\n  return {\n    s: {\n      r: r,\n      c: c\n    },\n    e: {\n      r: R,\n      c: C\n    }\n  };\n}\n\nfunction write_Dimensions(range, opts) {\n  var w = opts.biff == 8 || !opts.biff ? 4 : 2;\n  var o = new_buf(2 * w + 6);\n  o.write_shift(w, range.s.r);\n  o.write_shift(w, range.e.r + 1);\n  o.write_shift(2, range.s.c);\n  o.write_shift(2, range.e.c + 1);\n  o.write_shift(2, 0);\n  return o;\n}\n/* [MS-XLS] 2.4.220 */\n\n\nfunction parse_RK(blob) {\n  var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n  var rkrec = parse_RkRec(blob);\n  return {\n    r: rw,\n    c: col,\n    ixfe: rkrec[0],\n    rknum: rkrec[1]\n  };\n}\n/* [MS-XLS] 2.4.175 */\n\n\nfunction parse_MulRk(blob, length) {\n  var target = blob.l + length - 2;\n  var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n  var rkrecs = [];\n\n  while (blob.l < target) rkrecs.push(parse_RkRec(blob));\n\n  if (blob.l !== target) throw new Error(\"MulRK read error\");\n  var lastcol = blob.read_shift(2);\n  if (rkrecs.length != lastcol - col + 1) throw new Error(\"MulRK length mismatch\");\n  return {\n    r: rw,\n    c: col,\n    C: lastcol,\n    rkrec: rkrecs\n  };\n}\n/* [MS-XLS] 2.4.174 */\n\n\nfunction parse_MulBlank(blob, length) {\n  var target = blob.l + length - 2;\n  var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n  var ixfes = [];\n\n  while (blob.l < target) ixfes.push(blob.read_shift(2));\n\n  if (blob.l !== target) throw new Error(\"MulBlank read error\");\n  var lastcol = blob.read_shift(2);\n  if (ixfes.length != lastcol - col + 1) throw new Error(\"MulBlank length mismatch\");\n  return {\n    r: rw,\n    c: col,\n    C: lastcol,\n    ixfe: ixfes\n  };\n}\n/* [MS-XLS] 2.5.20 2.5.249 TODO: interpret values here */\n\n\nfunction parse_CellStyleXF(blob, length, style, opts) {\n  var o = {};\n  var a = blob.read_shift(4),\n      b = blob.read_shift(4);\n  var c = blob.read_shift(4),\n      d = blob.read_shift(2);\n  o.patternType = XLSFillPattern[c >> 26];\n  if (!opts.cellStyles) return o;\n  o.alc = a & 0x07;\n  o.fWrap = a >> 3 & 0x01;\n  o.alcV = a >> 4 & 0x07;\n  o.fJustLast = a >> 7 & 0x01;\n  o.trot = a >> 8 & 0xFF;\n  o.cIndent = a >> 16 & 0x0F;\n  o.fShrinkToFit = a >> 20 & 0x01;\n  o.iReadOrder = a >> 22 & 0x02;\n  o.fAtrNum = a >> 26 & 0x01;\n  o.fAtrFnt = a >> 27 & 0x01;\n  o.fAtrAlc = a >> 28 & 0x01;\n  o.fAtrBdr = a >> 29 & 0x01;\n  o.fAtrPat = a >> 30 & 0x01;\n  o.fAtrProt = a >> 31 & 0x01;\n  o.dgLeft = b & 0x0F;\n  o.dgRight = b >> 4 & 0x0F;\n  o.dgTop = b >> 8 & 0x0F;\n  o.dgBottom = b >> 12 & 0x0F;\n  o.icvLeft = b >> 16 & 0x7F;\n  o.icvRight = b >> 23 & 0x7F;\n  o.grbitDiag = b >> 30 & 0x03;\n  o.icvTop = c & 0x7F;\n  o.icvBottom = c >> 7 & 0x7F;\n  o.icvDiag = c >> 14 & 0x7F;\n  o.dgDiag = c >> 21 & 0x0F;\n  o.icvFore = d & 0x7F;\n  o.icvBack = d >> 7 & 0x7F;\n  o.fsxButton = d >> 14 & 0x01;\n  return o;\n} //function parse_CellXF(blob, length, opts) {return parse_CellStyleXF(blob,length,0, opts);}\n//function parse_StyleXF(blob, length, opts) {return parse_CellStyleXF(blob,length,1, opts);}\n\n/* [MS-XLS] 2.4.353 TODO: actually do this right */\n\n\nfunction parse_XF(blob, length, opts) {\n  var o = {};\n  o.ifnt = blob.read_shift(2);\n  o.numFmtId = blob.read_shift(2);\n  o.flags = blob.read_shift(2);\n  o.fStyle = o.flags >> 2 & 0x01;\n  length -= 6;\n  o.data = parse_CellStyleXF(blob, length, o.fStyle, opts);\n  return o;\n}\n\nfunction write_XF(data, ixfeP, opts, o) {\n  var b5 = opts && opts.biff == 5;\n  if (!o) o = new_buf(b5 ? 16 : 20);\n  o.write_shift(2, 0);\n\n  if (data.style) {\n    o.write_shift(2, data.numFmtId || 0);\n    o.write_shift(2, 0xFFF4);\n  } else {\n    o.write_shift(2, data.numFmtId || 0);\n    o.write_shift(2, ixfeP << 4);\n  }\n\n  var f = 0;\n  if (data.numFmtId > 0 && b5) f |= 0x0400;\n  o.write_shift(4, f);\n  o.write_shift(4, 0);\n  if (!b5) o.write_shift(4, 0);\n  o.write_shift(2, 0);\n  return o;\n}\n/* [MS-XLS] 2.4.134 */\n\n\nfunction parse_Guts(blob) {\n  blob.l += 4;\n  var out = [blob.read_shift(2), blob.read_shift(2)];\n  if (out[0] !== 0) out[0]--;\n  if (out[1] !== 0) out[1]--;\n  if (out[0] > 7 || out[1] > 7) throw new Error(\"Bad Gutters: \" + out.join(\"|\"));\n  return out;\n}\n\nfunction write_Guts(guts\n/*:Array<number>*/\n) {\n  var o = new_buf(8);\n  o.write_shift(4, 0);\n  o.write_shift(2, guts[0] ? guts[0] + 1 : 0);\n  o.write_shift(2, guts[1] ? guts[1] + 1 : 0);\n  return o;\n}\n/* [MS-XLS] 2.4.24 */\n\n\nfunction parse_BoolErr(blob, length, opts) {\n  var cell = parse_XLSCell(blob, 6);\n  if (opts.biff == 2 || length == 9) ++blob.l;\n  var val = parse_Bes(blob, 2);\n  cell.val = val;\n  cell.t = val === true || val === false ? 'b' : 'e';\n  return cell;\n}\n\nfunction write_BoolErr(R\n/*:number*/\n, C\n/*:number*/\n, v, os\n/*:number*/\n, opts, t\n/*:string*/\n) {\n  var o = new_buf(8);\n  write_XLSCell(R, C, os, o);\n  write_Bes(v, t, o);\n  return o;\n}\n/* [MS-XLS] 2.4.180 Number */\n\n\nfunction parse_Number(blob, length, opts) {\n  if (opts.biffguess && opts.biff == 2) opts.biff = 5;\n  var cell = parse_XLSCell(blob, 6);\n  var xnum = parse_Xnum(blob, 8);\n  cell.val = xnum;\n  return cell;\n}\n\nfunction write_Number(R\n/*:number*/\n, C\n/*:number*/\n, v, os\n/*:: :number, opts*/\n) {\n  var o = new_buf(14);\n  write_XLSCell(R, C, os, o);\n  write_Xnum(v, o);\n  return o;\n}\n\nvar parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n/* [MS-XLS] 2.4.271 */\n\nfunction parse_SupBook(blob, length, opts) {\n  var end = blob.l + length;\n  var ctab = blob.read_shift(2);\n  var cch = blob.read_shift(2);\n  opts.sbcch = cch;\n  if (cch == 0x0401 || cch == 0x3A01) return [cch, ctab];\n  if (cch < 0x01 || cch > 0xff) throw new Error(\"Unexpected SupBook type: \" + cch);\n  var virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n  /* TODO: 2.5.277 Virtual Path */\n\n  var rgst = [];\n\n  while (end > blob.l) rgst.push(parse_XLUnicodeString(blob));\n\n  return [cch, ctab, virtPath, rgst];\n}\n/* [MS-XLS] 2.4.105 TODO */\n\n\nfunction parse_ExternName(blob, length, opts) {\n  var flags = blob.read_shift(2);\n  var body;\n  var o = {\n    fBuiltIn: flags & 0x01,\n    fWantAdvise: flags >>> 1 & 0x01,\n    fWantPict: flags >>> 2 & 0x01,\n    fOle: flags >>> 3 & 0x01,\n    fOleLink: flags >>> 4 & 0x01,\n    cf: flags >>> 5 & 0x3FF,\n    fIcon: flags >>> 15 & 0x01\n  }\n  /*:any*/\n  ;\n  if (opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length - 2, opts); //else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\n  o.body = body || blob.read_shift(length - 2);\n  if (typeof body === \"string\") o.Name = body;\n  return o;\n}\n/* [MS-XLS] 2.4.150 TODO */\n\n\nvar XLSLblBuiltIn = [\"_xlnm.Consolidate_Area\", \"_xlnm.Auto_Open\", \"_xlnm.Auto_Close\", \"_xlnm.Extract\", \"_xlnm.Database\", \"_xlnm.Criteria\", \"_xlnm.Print_Area\", \"_xlnm.Print_Titles\", \"_xlnm.Recorder\", \"_xlnm.Data_Form\", \"_xlnm.Auto_Activate\", \"_xlnm.Auto_Deactivate\", \"_xlnm.Sheet_Title\", \"_xlnm._FilterDatabase\"];\n\nfunction parse_Lbl(blob, length, opts) {\n  var target = blob.l + length;\n  var flags = blob.read_shift(2);\n  var chKey = blob.read_shift(1);\n  var cch = blob.read_shift(1);\n  var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  var itab = 0;\n\n  if (!opts || opts.biff >= 5) {\n    if (opts.biff != 5) blob.l += 2;\n    itab = blob.read_shift(2);\n    if (opts.biff == 5) blob.l += 2;\n    blob.l += 4;\n  }\n\n  var name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n  if (flags & 0x20) name = XLSLblBuiltIn[name.charCodeAt(0)];\n  var npflen = target - blob.l;\n  if (opts && opts.biff == 2) --npflen;\n  /*jshint -W018 */\n\n  var rgce = target == blob.l || cce === 0 || !(npflen > 0) ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\n  /*jshint +W018 */\n\n  return {\n    chKey: chKey,\n    Name: name,\n    itab: itab,\n    rgce: rgce\n  };\n}\n/* [MS-XLS] 2.4.106 TODO: verify filename encoding */\n\n\nfunction parse_ExternSheet(blob, length, opts) {\n  if (opts.biff < 8) return parse_BIFF5ExternSheet(blob, length, opts);\n  var o = [],\n      target = blob.l + length,\n      len = blob.read_shift(opts.biff > 8 ? 4 : 2);\n\n  while (len-- !== 0) o.push(parse_XTI(blob, opts.biff > 8 ? 12 : 6, opts)); // [iSupBook, itabFirst, itabLast];\n\n\n  if (blob.l != target) throw new Error(\"Bad ExternSheet: \" + blob.l + \" != \" + target);\n  return o;\n}\n\nfunction parse_BIFF5ExternSheet(blob, length, opts) {\n  if (blob[blob.l + 1] == 0x03) blob[blob.l]++;\n  var o = parse_ShortXLUnicodeString(blob, length, opts);\n  return o.charCodeAt(0) == 0x03 ? o.slice(1) : o;\n}\n/* [MS-XLS] 2.4.176 TODO: check older biff */\n\n\nfunction parse_NameCmt(blob, length, opts) {\n  if (opts.biff < 8) {\n    blob.l += length;\n    return;\n  }\n\n  var cchName = blob.read_shift(2);\n  var cchComment = blob.read_shift(2);\n  var name = parse_XLUnicodeStringNoCch(blob, cchName, opts);\n  var comment = parse_XLUnicodeStringNoCch(blob, cchComment, opts);\n  return [name, comment];\n}\n/* [MS-XLS] 2.4.260 */\n\n\nfunction parse_ShrFmla(blob, length, opts) {\n  var ref = parse_RefU(blob, 6);\n  blob.l++;\n  var cUse = blob.read_shift(1);\n  length -= 8;\n  return [parse_SharedParsedFormula(blob, length, opts), cUse, ref];\n}\n/* [MS-XLS] 2.4.4 TODO */\n\n\nfunction parse_Array(blob, length, opts) {\n  var ref = parse_Ref(blob, 6);\n  /* TODO: fAlwaysCalc */\n\n  switch (opts.biff) {\n    case 2:\n      blob.l++;\n      length -= 7;\n      break;\n\n    case 3:\n    case 4:\n      blob.l += 2;\n      length -= 8;\n      break;\n\n    default:\n      blob.l += 6;\n      length -= 12;\n  }\n\n  return [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n}\n/* [MS-XLS] 2.4.173 */\n\n\nfunction parse_MTRSettings(blob) {\n  var fMTREnabled = blob.read_shift(4) !== 0x00;\n  var fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n  var cUserThreadCount = blob.read_shift(4);\n  return [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n}\n/* [MS-XLS] 2.5.186 TODO: BIFF5 */\n\n\nfunction parse_NoteSh(blob, length, opts) {\n  if (opts.biff < 8) return;\n  var row = blob.read_shift(2),\n      col = blob.read_shift(2);\n  var flags = blob.read_shift(2),\n      idObj = blob.read_shift(2);\n  var stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n  if (opts.biff < 8) blob.read_shift(1);\n  return [{\n    r: row,\n    c: col\n  }, stAuthor, idObj, flags];\n}\n/* [MS-XLS] 2.4.179 */\n\n\nfunction parse_Note(blob, length, opts) {\n  /* TODO: Support revisions */\n  return parse_NoteSh(blob, length, opts);\n}\n/* [MS-XLS] 2.4.168 */\n\n\nfunction parse_MergeCells(blob, length)\n/*:Array<Range>*/\n{\n  var merges\n  /*:Array<Range>*/\n  = [];\n  var cmcs = blob.read_shift(2);\n\n  while (cmcs--) merges.push(parse_Ref8U(blob, length));\n\n  return merges;\n}\n\nfunction write_MergeCells(merges\n/*:Array<Range>*/\n) {\n  var o = new_buf(2 + merges.length * 8);\n  o.write_shift(2, merges.length);\n\n  for (var i = 0; i < merges.length; ++i) write_Ref8U(merges[i], o);\n\n  return o;\n}\n/* [MS-XLS] 2.4.181 TODO: parse all the things! */\n\n\nfunction parse_Obj(blob, length, opts) {\n  if (opts && opts.biff < 8) return parse_BIFF5Obj(blob, length, opts);\n  var cmo = parse_FtCmo(blob, 22); // id, ot, flags\n\n  var fts = parse_FtArray(blob, length - 22, cmo[1]);\n  return {\n    cmo: cmo,\n    ft: fts\n  };\n}\n/* from older spec */\n\n\nvar parse_BIFF5OT = {\n  0x08: function (blob, length) {\n    var tgt = blob.l + length;\n    blob.l += 10; // todo\n\n    var cf = blob.read_shift(2);\n    blob.l += 4;\n    blob.l += 2; //var cbPictFmla = blob.read_shift(2);\n\n    blob.l += 2;\n    blob.l += 2; //var grbit = blob.read_shift(2);\n\n    blob.l += 4;\n    var cchName = blob.read_shift(1);\n    blob.l += cchName; // TODO: stName\n\n    blob.l = tgt; // TODO: fmla\n\n    return {\n      fmt: cf\n    };\n  }\n};\n\nfunction parse_BIFF5Obj(blob, length, opts) {\n  blob.l += 4; //var cnt = blob.read_shift(4);\n\n  var ot = blob.read_shift(2);\n  var id = blob.read_shift(2);\n  var grbit = blob.read_shift(2);\n  blob.l += 2; //var colL = blob.read_shift(2);\n\n  blob.l += 2; //var dxL = blob.read_shift(2);\n\n  blob.l += 2; //var rwT = blob.read_shift(2);\n\n  blob.l += 2; //var dyT = blob.read_shift(2);\n\n  blob.l += 2; //var colR = blob.read_shift(2);\n\n  blob.l += 2; //var dxR = blob.read_shift(2);\n\n  blob.l += 2; //var rwB = blob.read_shift(2);\n\n  blob.l += 2; //var dyB = blob.read_shift(2);\n\n  blob.l += 2; //var cbMacro = blob.read_shift(2);\n\n  blob.l += 6;\n  length -= 36;\n  var fts = [];\n  fts.push((parse_BIFF5OT[ot] || parsenoop)(blob, length, opts));\n  return {\n    cmo: [id, ot, grbit],\n    ft: fts\n  };\n}\n/* [MS-XLS] 2.4.329 TODO: parse properly */\n\n\nfunction parse_TxO(blob, length, opts) {\n  var s = blob.l;\n  var texts = \"\";\n\n  try {\n    blob.l += 4;\n    var ot = (opts.lastobj || {\n      cmo: [0, 0]\n    }).cmo[1];\n    var controlInfo; // eslint-disable-line no-unused-vars\n\n    if ([0, 5, 7, 11, 12, 14].indexOf(ot) == -1) blob.l += 6;else controlInfo = parse_ControlInfo(blob, 6, opts); // eslint-disable-line no-unused-vars\n\n    var cchText = blob.read_shift(2);\n    /*var cbRuns = */\n\n    blob.read_shift(2);\n    /*var ifntEmpty = */\n\n    parseuint16(blob, 2);\n    var len = blob.read_shift(2);\n    blob.l += len; //var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n    for (var i = 1; i < blob.lens.length - 1; ++i) {\n      if (blob.l - s != blob.lens[i]) throw new Error(\"TxO: bad continue record\");\n      var hdr = blob[blob.l];\n      var t = parse_XLUnicodeStringNoCch(blob, blob.lens[i + 1] - blob.lens[i] - 1);\n      texts += t;\n      if (texts.length >= (hdr ? cchText : 2 * cchText)) break;\n    }\n\n    if (texts.length !== cchText && texts.length !== cchText * 2) {\n      throw new Error(\"cchText: \" + cchText + \" != \" + texts.length);\n    }\n\n    blob.l = s + length;\n    /* [MS-XLS] 2.5.272 TxORuns */\n    //\tvar rgTxoRuns = [];\n    //\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n    //\tvar cchText2 = blob.read_shift(2);\n    //\tif(cchText2 !== cchText) throw new Error(\"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText);\n    //\tblob.l += 6;\n    //\tif(s + length != blob.l) throw new Error(\"TxO \" + (s + length) + \", at \" + blob.l);\n\n    return {\n      t: texts\n    };\n  } catch (e) {\n    blob.l = s + length;\n    return {\n      t: texts\n    };\n  }\n}\n/* [MS-XLS] 2.4.140 */\n\n\nfunction parse_HLink(blob, length) {\n  var ref = parse_Ref8U(blob, 8);\n  blob.l += 16;\n  /* CLSID */\n\n  var hlink = parse_Hyperlink(blob, length - 24);\n  return [ref, hlink];\n}\n\nfunction write_HLink(hl) {\n  var O = new_buf(24);\n  var ref = decode_cell(hl[0]);\n  O.write_shift(2, ref.r);\n  O.write_shift(2, ref.r);\n  O.write_shift(2, ref.c);\n  O.write_shift(2, ref.c);\n  var clsid = \"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\n  for (var i = 0; i < 16; ++i) O.write_shift(1, parseInt(clsid[i], 16));\n\n  return bconcat([O, write_Hyperlink(hl[1])]);\n}\n/* [MS-XLS] 2.4.141 */\n\n\nfunction parse_HLinkTooltip(blob, length) {\n  blob.read_shift(2);\n  var ref = parse_Ref8U(blob, 8);\n  var wzTooltip = blob.read_shift((length - 10) / 2, 'dbcs-cont');\n  wzTooltip = wzTooltip.replace(chr0, \"\");\n  return [ref, wzTooltip];\n}\n\nfunction write_HLinkTooltip(hl) {\n  var TT = hl[1].Tooltip;\n  var O = new_buf(10 + 2 * (TT.length + 1));\n  O.write_shift(2, 0x0800);\n  var ref = decode_cell(hl[0]);\n  O.write_shift(2, ref.r);\n  O.write_shift(2, ref.r);\n  O.write_shift(2, ref.c);\n  O.write_shift(2, ref.c);\n\n  for (var i = 0; i < TT.length; ++i) O.write_shift(2, TT.charCodeAt(i));\n\n  O.write_shift(2, 0);\n  return O;\n}\n/* [MS-XLS] 2.4.63 */\n\n\nfunction parse_Country(blob)\n/*:[string|number, string|number]*/\n{\n  var o = [0, 0],\n      d;\n  d = blob.read_shift(2);\n  o[0] = CountryEnum[d] || d;\n  d = blob.read_shift(2);\n  o[1] = CountryEnum[d] || d;\n  return o;\n}\n\nfunction write_Country(o) {\n  if (!o) o = new_buf(4);\n  o.write_shift(2, 0x01);\n  o.write_shift(2, 0x01);\n  return o;\n}\n/* [MS-XLS] 2.4.50 ClrtClient */\n\n\nfunction parse_ClrtClient(blob) {\n  var ccv = blob.read_shift(2);\n  var o = [];\n\n  while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\n\n  return o;\n}\n/* [MS-XLS] 2.4.188 */\n\n\nfunction parse_Palette(blob) {\n  var ccv = blob.read_shift(2);\n  var o = [];\n\n  while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\n\n  return o;\n}\n/* [MS-XLS] 2.4.354 */\n\n\nfunction parse_XFCRC(blob) {\n  blob.l += 2;\n  var o = {\n    cxfs: 0,\n    crc: 0\n  };\n  o.cxfs = blob.read_shift(2);\n  o.crc = blob.read_shift(4);\n  return o;\n}\n/* [MS-XLS] 2.4.53 TODO: parse flags */\n\n/* [MS-XLSB] 2.4.323 TODO: parse flags */\n\n\nfunction parse_ColInfo(blob, length, opts) {\n  if (!opts.cellStyles) return parsenoop(blob, length);\n  var w = opts && opts.biff >= 12 ? 4 : 2;\n  var colFirst = blob.read_shift(w);\n  var colLast = blob.read_shift(w);\n  var coldx = blob.read_shift(w);\n  var ixfe = blob.read_shift(w);\n  var flags = blob.read_shift(2);\n  if (w == 2) blob.l += 2;\n  var o = {\n    s: colFirst,\n    e: colLast,\n    w: coldx,\n    ixfe: ixfe,\n    flags: flags\n  }\n  /*:any*/\n  ;\n  if (opts.biff >= 5 || !opts.biff) o.level = flags >> 8 & 0x7;\n  return o;\n}\n\nfunction write_ColInfo(col, idx) {\n  var o = new_buf(12);\n  o.write_shift(2, idx);\n  o.write_shift(2, idx);\n  o.write_shift(2, col.width * 256);\n  o.write_shift(2, 0);\n  var f = 0;\n  if (col.hidden) f |= 1;\n  o.write_shift(1, f);\n  f = col.level || 0;\n  o.write_shift(1, f);\n  o.write_shift(2, 0);\n  return o;\n}\n/* [MS-XLS] 2.4.257 */\n\n\nfunction parse_Setup(blob, length) {\n  var o = {};\n  if (length < 32) return o;\n  blob.l += 16;\n  o.header = parse_Xnum(blob, 8);\n  o.footer = parse_Xnum(blob, 8);\n  blob.l += 2;\n  return o;\n}\n/* [MS-XLS] 2.4.261 */\n\n\nfunction parse_ShtProps(blob, length, opts) {\n  var def = {\n    area: false\n  };\n\n  if (opts.biff != 5) {\n    blob.l += length;\n    return def;\n  }\n\n  var d = blob.read_shift(1);\n  blob.l += 3;\n  if (d & 0x10) def.area = true;\n  return def;\n}\n/* [MS-XLS] 2.4.241 */\n\n\nfunction write_RRTabId(n\n/*:number*/\n) {\n  var out = new_buf(2 * n);\n\n  for (var i = 0; i < n; ++i) out.write_shift(2, i + 1);\n\n  return out;\n}\n\nvar parse_Blank = parse_XLSCell;\n/* [MS-XLS] 2.4.20 Just the cell */\n\nvar parse_Scl = parseuint16a;\n/* [MS-XLS] 2.4.247 num, den */\n\nvar parse_String = parse_XLUnicodeString;\n/* [MS-XLS] 2.4.268 */\n\n/* --- Specific to versions before BIFF8 --- */\n\nfunction parse_ImData(blob) {\n  var cf = blob.read_shift(2);\n  var env = blob.read_shift(2);\n  var lcb = blob.read_shift(4);\n  var o = {\n    fmt: cf,\n    env: env,\n    len: lcb,\n    data: blob.slice(blob.l, blob.l + lcb)\n  };\n  blob.l += lcb;\n  return o;\n}\n/* BIFF2_??? where ??? is the name from [XLS] */\n\n\nfunction parse_BIFF2STR(blob, length, opts) {\n  if (opts.biffguess && opts.biff == 5) opts.biff = 2;\n  var cell = parse_XLSCell(blob, 6);\n  ++blob.l;\n  var str = parse_XLUnicodeString2(blob, length - 7, opts);\n  cell.t = 'str';\n  cell.val = str;\n  return cell;\n}\n\nfunction parse_BIFF2NUM(blob\n/*::, length*/\n) {\n  var cell = parse_XLSCell(blob, 6);\n  ++blob.l;\n  var num = parse_Xnum(blob, 8);\n  cell.t = 'n';\n  cell.val = num;\n  return cell;\n}\n\nfunction write_BIFF2NUM(r\n/*:number*/\n, c\n/*:number*/\n, val\n/*:number*/\n) {\n  var out = new_buf(15);\n  write_BIFF2Cell(out, r, c);\n  out.write_shift(8, val, 'f');\n  return out;\n}\n\nfunction parse_BIFF2INT(blob) {\n  var cell = parse_XLSCell(blob, 6);\n  ++blob.l;\n  var num = blob.read_shift(2);\n  cell.t = 'n';\n  cell.val = num;\n  return cell;\n}\n\nfunction write_BIFF2INT(r\n/*:number*/\n, c\n/*:number*/\n, val\n/*:number*/\n) {\n  var out = new_buf(9);\n  write_BIFF2Cell(out, r, c);\n  out.write_shift(2, val);\n  return out;\n}\n\nfunction parse_BIFF2STRING(blob) {\n  var cch = blob.read_shift(1);\n\n  if (cch === 0) {\n    blob.l++;\n    return \"\";\n  }\n\n  return blob.read_shift(cch, 'sbcs-cont');\n}\n/* TODO: convert to BIFF8 font struct */\n\n\nfunction parse_BIFF2FONTXTRA(blob, length) {\n  blob.l += 6; // unknown\n\n  blob.l += 2; // font weight \"bls\"\n\n  blob.l += 1; // charset\n\n  blob.l += 3; // unknown\n\n  blob.l += 1; // font family\n\n  blob.l += length - 13;\n}\n/* TODO: parse rich text runs */\n\n\nfunction parse_RString(blob, length, opts) {\n  var end = blob.l + length;\n  var cell = parse_XLSCell(blob, 6);\n  var cch = blob.read_shift(2);\n  var str = parse_XLUnicodeStringNoCch(blob, cch, opts);\n  blob.l = end;\n  cell.t = 'str';\n  cell.val = str;\n  return cell;\n}\n/* from js-harb (C) 2014-present  SheetJS */\n\n\nvar DBF_SUPPORTED_VERSIONS = [0x02, 0x03, 0x30, 0x31, 0x83, 0x8B, 0x8C, 0xF5];\n\nvar DBF = /*#__PURE__*/function () {\n  var dbf_codepage_map = {\n    /* Code Pages Supported by Visual FoxPro */\n\n    /*::[*/\n    0x01\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x02\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x03\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x04\n    /*::]*/\n    : 10000,\n\n    /*::[*/\n    0x64\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x65\n    /*::]*/\n    : 866,\n\n    /*::[*/\n    0x66\n    /*::]*/\n    : 865,\n\n    /*::[*/\n    0x67\n    /*::]*/\n    : 861,\n\n    /*::[*/\n    0x68\n    /*::]*/\n    : 895,\n\n    /*::[*/\n    0x69\n    /*::]*/\n    : 620,\n\n    /*::[*/\n    0x6A\n    /*::]*/\n    : 737,\n\n    /*::[*/\n    0x6B\n    /*::]*/\n    : 857,\n\n    /*::[*/\n    0x78\n    /*::]*/\n    : 950,\n\n    /*::[*/\n    0x79\n    /*::]*/\n    : 949,\n\n    /*::[*/\n    0x7A\n    /*::]*/\n    : 936,\n\n    /*::[*/\n    0x7B\n    /*::]*/\n    : 932,\n\n    /*::[*/\n    0x7C\n    /*::]*/\n    : 874,\n\n    /*::[*/\n    0x7D\n    /*::]*/\n    : 1255,\n\n    /*::[*/\n    0x7E\n    /*::]*/\n    : 1256,\n\n    /*::[*/\n    0x96\n    /*::]*/\n    : 10007,\n\n    /*::[*/\n    0x97\n    /*::]*/\n    : 10029,\n\n    /*::[*/\n    0x98\n    /*::]*/\n    : 10006,\n\n    /*::[*/\n    0xC8\n    /*::]*/\n    : 1250,\n\n    /*::[*/\n    0xC9\n    /*::]*/\n    : 1251,\n\n    /*::[*/\n    0xCA\n    /*::]*/\n    : 1254,\n\n    /*::[*/\n    0xCB\n    /*::]*/\n    : 1253,\n\n    /* shapefile DBF extension */\n\n    /*::[*/\n    0x00\n    /*::]*/\n    : 20127,\n\n    /*::[*/\n    0x08\n    /*::]*/\n    : 865,\n\n    /*::[*/\n    0x09\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x0A\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x0B\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x0D\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x0E\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x0F\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x10\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x11\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x12\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x13\n    /*::]*/\n    : 932,\n\n    /*::[*/\n    0x14\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x15\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x16\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x17\n    /*::]*/\n    : 865,\n\n    /*::[*/\n    0x18\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x19\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x1A\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x1B\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x1C\n    /*::]*/\n    : 863,\n\n    /*::[*/\n    0x1D\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x1F\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x22\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x23\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x24\n    /*::]*/\n    : 860,\n\n    /*::[*/\n    0x25\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x26\n    /*::]*/\n    : 866,\n\n    /*::[*/\n    0x37\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x40\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x4D\n    /*::]*/\n    : 936,\n\n    /*::[*/\n    0x4E\n    /*::]*/\n    : 949,\n\n    /*::[*/\n    0x4F\n    /*::]*/\n    : 950,\n\n    /*::[*/\n    0x50\n    /*::]*/\n    : 874,\n\n    /*::[*/\n    0x57\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x58\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x59\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x6C\n    /*::]*/\n    : 863,\n\n    /*::[*/\n    0x86\n    /*::]*/\n    : 737,\n\n    /*::[*/\n    0x87\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x88\n    /*::]*/\n    : 857,\n\n    /*::[*/\n    0xCC\n    /*::]*/\n    : 1257,\n\n    /*::[*/\n    0xFF\n    /*::]*/\n    : 16969\n  };\n  var dbf_reverse_map = evert({\n    /*::[*/\n    0x01\n    /*::]*/\n    : 437,\n\n    /*::[*/\n    0x02\n    /*::]*/\n    : 850,\n\n    /*::[*/\n    0x03\n    /*::]*/\n    : 1252,\n\n    /*::[*/\n    0x04\n    /*::]*/\n    : 10000,\n\n    /*::[*/\n    0x64\n    /*::]*/\n    : 852,\n\n    /*::[*/\n    0x65\n    /*::]*/\n    : 866,\n\n    /*::[*/\n    0x66\n    /*::]*/\n    : 865,\n\n    /*::[*/\n    0x67\n    /*::]*/\n    : 861,\n\n    /*::[*/\n    0x68\n    /*::]*/\n    : 895,\n\n    /*::[*/\n    0x69\n    /*::]*/\n    : 620,\n\n    /*::[*/\n    0x6A\n    /*::]*/\n    : 737,\n\n    /*::[*/\n    0x6B\n    /*::]*/\n    : 857,\n\n    /*::[*/\n    0x78\n    /*::]*/\n    : 950,\n\n    /*::[*/\n    0x79\n    /*::]*/\n    : 949,\n\n    /*::[*/\n    0x7A\n    /*::]*/\n    : 936,\n\n    /*::[*/\n    0x7B\n    /*::]*/\n    : 932,\n\n    /*::[*/\n    0x7C\n    /*::]*/\n    : 874,\n\n    /*::[*/\n    0x7D\n    /*::]*/\n    : 1255,\n\n    /*::[*/\n    0x7E\n    /*::]*/\n    : 1256,\n\n    /*::[*/\n    0x96\n    /*::]*/\n    : 10007,\n\n    /*::[*/\n    0x97\n    /*::]*/\n    : 10029,\n\n    /*::[*/\n    0x98\n    /*::]*/\n    : 10006,\n\n    /*::[*/\n    0xC8\n    /*::]*/\n    : 1250,\n\n    /*::[*/\n    0xC9\n    /*::]*/\n    : 1251,\n\n    /*::[*/\n    0xCA\n    /*::]*/\n    : 1254,\n\n    /*::[*/\n    0xCB\n    /*::]*/\n    : 1253,\n\n    /*::[*/\n    0x00\n    /*::]*/\n    : 20127\n  });\n  /* TODO: find an actual specification */\n\n  function dbf_to_aoa(buf, opts)\n  /*:AOA*/\n  {\n    var out\n    /*:AOA*/\n    = [];\n    var d\n    /*:Block*/\n    = new_raw_buf(1)\n    /*:any*/\n    ;\n\n    switch (opts.type) {\n      case 'base64':\n        d = s2a(Base64_decode(buf));\n        break;\n\n      case 'binary':\n        d = s2a(buf);\n        break;\n\n      case 'buffer':\n      case 'array':\n        d = buf;\n        break;\n    }\n\n    prep_blob(d, 0);\n    /* header */\n\n    var ft = d.read_shift(1);\n    var memo = !!(ft & 0x88);\n    var vfp = false,\n        l7 = false;\n\n    switch (ft) {\n      case 0x02:\n        break;\n      // dBASE II\n\n      case 0x03:\n        break;\n      // dBASE III\n\n      case 0x30:\n        vfp = true;\n        memo = true;\n        break;\n      // VFP\n\n      case 0x31:\n        vfp = true;\n        memo = true;\n        break;\n      // VFP with autoincrement\n      // 0x43 dBASE IV SQL table files\n      // 0x63 dBASE IV SQL system files\n\n      case 0x83:\n        break;\n      // dBASE III with memo\n\n      case 0x8B:\n        break;\n      // dBASE IV with memo\n\n      case 0x8C:\n        l7 = true;\n        break;\n      // dBASE Level 7 with memo\n      // case 0xCB dBASE IV SQL table files with memo\n\n      case 0xF5:\n        break;\n      // FoxPro 2.x with memo\n      // case 0xFB FoxBASE\n\n      default:\n        throw new Error(\"DBF Unsupported Version: \" + ft.toString(16));\n    }\n\n    var nrow = 0,\n        fpos = 0x0209;\n    if (ft == 0x02) nrow = d.read_shift(2);\n    d.l += 3; // dBASE II stores DDMMYY date, others use YYMMDD\n\n    if (ft != 0x02) nrow = d.read_shift(4);\n    if (nrow > 1048576) nrow = 1e6;\n    if (ft != 0x02) fpos = d.read_shift(2); // header length\n\n    var rlen = d.read_shift(2); // record length\n\n    var\n    /*flags = 0,*/\n    current_cp = opts.codepage || 1252;\n\n    if (ft != 0x02) {\n      // 20 reserved bytes\n      d.l += 16;\n      /*flags = */\n\n      d.read_shift(1); //if(memo && ((flags & 0x02) === 0)) throw new Error(\"DBF Flags \" + flags.toString(16) + \" ft \" + ft.toString(16));\n\n      /* codepage present in FoxPro and dBASE Level 7 */\n\n      if (d[d.l] !== 0) current_cp = dbf_codepage_map[d[d.l]];\n      d.l += 1;\n      d.l += 2;\n    }\n\n    if (l7) d.l += 36; // Level 7: 32 byte \"Language driver name\", 4 byte reserved\n\n    /*:: type DBFField = { name:string; len:number; type:string; } */\n\n    var fields\n    /*:Array<DBFField>*/\n    = [],\n        field\n    /*:DBFField*/\n    = {}\n    /*:any*/\n    ;\n    var hend = Math.min(d.length, ft == 0x02 ? 0x209 : fpos - 10 - (vfp ? 264 : 0));\n    var ww = l7 ? 32 : 11;\n\n    while (d.l < hend && d[d.l] != 0x0d) {\n      field = {}\n      /*:any*/\n      ;\n      field.name = $cptable.utils.decode(current_cp, d.slice(d.l, d.l + ww)).replace(/[\\u0000\\r\\n].*$/g, \"\");\n      d.l += ww;\n      field.type = String.fromCharCode(d.read_shift(1));\n      if (ft != 0x02 && !l7) field.offset = d.read_shift(4);\n      field.len = d.read_shift(1);\n      if (ft == 0x02) field.offset = d.read_shift(2);\n      field.dec = d.read_shift(1);\n      if (field.name.length) fields.push(field);\n      if (ft != 0x02) d.l += l7 ? 13 : 14;\n\n      switch (field.type) {\n        case 'B':\n          // Double (VFP) / Binary (dBASE L7)\n          if ((!vfp || field.len != 8) && opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n          break;\n\n        case 'G': // General (FoxPro and dBASE L7)\n\n        case 'P':\n          // Picture (FoxPro and dBASE L7)\n          if (opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n          break;\n\n        case '+': // Autoincrement (dBASE L7 only)\n\n        case '0': // _NullFlags (VFP only)\n\n        case '@': // Timestamp (dBASE L7 only)\n\n        case 'C': // Character (dBASE II)\n\n        case 'D': // Date (dBASE III)\n\n        case 'F': // Float (dBASE IV)\n\n        case 'I': // Long (VFP and dBASE L7)\n\n        case 'L': // Logical (dBASE II)\n\n        case 'M': // Memo (dBASE III)\n\n        case 'N': // Number (dBASE II)\n\n        case 'O': // Double (dBASE L7 only)\n\n        case 'T': // Datetime (VFP only)\n\n        case 'Y':\n          // Currency (VFP only)\n          break;\n\n        default:\n          throw new Error('Unknown Field Type: ' + field.type);\n      }\n    }\n\n    if (d[d.l] !== 0x0D) d.l = fpos - 1;\n    if (d.read_shift(1) !== 0x0D) throw new Error(\"DBF Terminator not found \" + d.l + \" \" + d[d.l]);\n    d.l = fpos;\n    /* data */\n\n    var R = 0,\n        C = 0;\n    out[0] = [];\n\n    for (C = 0; C != fields.length; ++C) out[0][C] = fields[C].name;\n\n    while (nrow-- > 0) {\n      if (d[d.l] === 0x2A) {\n        // TODO: record marked as deleted -- create a hidden row?\n        d.l += rlen;\n        continue;\n      }\n\n      ++d.l;\n      out[++R] = [];\n      C = 0;\n\n      for (C = 0; C != fields.length; ++C) {\n        var dd = d.slice(d.l, d.l + fields[C].len);\n        d.l += fields[C].len;\n        prep_blob(dd, 0);\n        var s = $cptable.utils.decode(current_cp, dd);\n\n        switch (fields[C].type) {\n          case 'C':\n            // NOTE: it is conventional to write '  /  /  ' for empty dates\n            if (s.trim().length) out[R][C] = s.replace(/\\s+$/, \"\");\n            break;\n\n          case 'D':\n            if (s.length === 8) out[R][C] = new Date(+s.slice(0, 4), +s.slice(4, 6) - 1, +s.slice(6, 8));else out[R][C] = s;\n            break;\n\n          case 'F':\n            out[R][C] = parseFloat(s.trim());\n            break;\n\n          case '+':\n          case 'I':\n            out[R][C] = l7 ? dd.read_shift(-4, 'i') ^ 0x80000000 : dd.read_shift(4, 'i');\n            break;\n\n          case 'L':\n            switch (s.trim().toUpperCase()) {\n              case 'Y':\n              case 'T':\n                out[R][C] = true;\n                break;\n\n              case 'N':\n              case 'F':\n                out[R][C] = false;\n                break;\n\n              case '':\n              case '?':\n                break;\n\n              default:\n                throw new Error(\"DBF Unrecognized L:|\" + s + \"|\");\n            }\n\n            break;\n\n          case 'M':\n            /* TODO: handle memo files */\n            if (!memo) throw new Error(\"DBF Unexpected MEMO for type \" + ft.toString(16));\n            out[R][C] = \"##MEMO##\" + (l7 ? parseInt(s.trim(), 10) : dd.read_shift(4));\n            break;\n\n          case 'N':\n            s = s.replace(/\\u0000/g, \"\").trim(); // NOTE: dBASE II interprets \"  .  \" as 0\n\n            if (s && s != \".\") out[R][C] = +s || 0;\n            break;\n\n          case '@':\n            // NOTE: dBASE specs appear to be incorrect\n            out[R][C] = new Date(dd.read_shift(-8, 'f') - 0x388317533400);\n            break;\n\n          case 'T':\n            out[R][C] = new Date((dd.read_shift(4) - 0x253D8C) * 0x5265C00 + dd.read_shift(4));\n            break;\n\n          case 'Y':\n            out[R][C] = dd.read_shift(4, 'i') / 1e4 + dd.read_shift(4, 'i') / 1e4 * Math.pow(2, 32);\n            break;\n\n          case 'O':\n            out[R][C] = -dd.read_shift(-8, 'f');\n            break;\n\n          case 'B':\n            if (vfp && fields[C].len == 8) {\n              out[R][C] = dd.read_shift(8, 'f');\n              break;\n            }\n\n          /* falls through */\n\n          case 'G':\n          case 'P':\n            dd.l += fields[C].len;\n            break;\n\n          case '0':\n            if (fields[C].name === '_NullFlags') break;\n\n          /* falls through */\n\n          default:\n            throw new Error(\"DBF Unsupported data type \" + fields[C].type);\n        }\n      }\n    }\n\n    if (ft != 0x02) if (d.l < d.length && d[d.l++] != 0x1A) throw new Error(\"DBF EOF Marker missing \" + (d.l - 1) + \" of \" + d.length + \" \" + d[d.l - 1].toString(16));\n    if (opts && opts.sheetRows) out = out.slice(0, opts.sheetRows);\n    opts.DBF = fields;\n    return out;\n  }\n\n  function dbf_to_sheet(buf, opts)\n  /*:Worksheet*/\n  {\n    var o = opts || {};\n    if (!o.dateNF) o.dateNF = \"yyyymmdd\";\n    var ws = aoa_to_sheet(dbf_to_aoa(buf, o), o);\n    ws[\"!cols\"] = o.DBF.map(function (field) {\n      return {\n        wch: field.len,\n        DBF: field\n      };\n    });\n    delete o.DBF;\n    return ws;\n  }\n\n  function dbf_to_workbook(buf, opts)\n  /*:Workbook*/\n  {\n    try {\n      return sheet_to_workbook(dbf_to_sheet(buf, opts), opts);\n    } catch (e) {\n      if (opts && opts.WTF) throw e;\n    }\n\n    return {\n      SheetNames: [],\n      Sheets: {}\n    };\n  }\n\n  var _RLEN = {\n    'B': 8,\n    'C': 250,\n    'L': 1,\n    'D': 8,\n    '?': 0,\n    '': 0\n  };\n\n  function sheet_to_dbf(ws\n  /*:Worksheet*/\n  , opts\n  /*:WriteOpts*/\n  ) {\n    var o = opts || {};\n    if (+o.codepage >= 0) set_cp(+o.codepage);\n    if (o.type == \"string\") throw new Error(\"Cannot write DBF to JS string\");\n    var ba = buf_array();\n    var aoa\n    /*:AOA*/\n    = sheet_to_json(ws, {\n      header: 1,\n      raw: true,\n      cellDates: true\n    });\n    var headers = aoa[0],\n        data = aoa.slice(1),\n        cols = ws[\"!cols\"] || [];\n    var i = 0,\n        j = 0,\n        hcnt = 0,\n        rlen = 1;\n\n    for (i = 0; i < headers.length; ++i) {\n      if (((cols[i] || {}).DBF || {}).name) {\n        headers[i] = cols[i].DBF.name;\n        ++hcnt;\n        continue;\n      }\n\n      if (headers[i] == null) continue;\n      ++hcnt;\n      if (typeof headers[i] === 'number') headers[i] = headers[i].toString(10);\n      if (typeof headers[i] !== 'string') throw new Error(\"DBF Invalid column name \" + headers[i] + \" |\" + typeof headers[i] + \"|\");\n      if (headers.indexOf(headers[i]) !== i) for (j = 0; j < 1024; ++j) if (headers.indexOf(headers[i] + \"_\" + j) == -1) {\n        headers[i] += \"_\" + j;\n        break;\n      }\n    }\n\n    var range = safe_decode_range(ws['!ref']);\n    var coltypes\n    /*:Array<string>*/\n    = [];\n    var colwidths\n    /*:Array<number>*/\n    = [];\n    var coldecimals\n    /*:Array<number>*/\n    = [];\n\n    for (i = 0; i <= range.e.c - range.s.c; ++i) {\n      var guess = '',\n          _guess = '',\n          maxlen = 0;\n      var col\n      /*:Array<any>*/\n      = [];\n\n      for (j = 0; j < data.length; ++j) {\n        if (data[j][i] != null) col.push(data[j][i]);\n      }\n\n      if (col.length == 0 || headers[i] == null) {\n        coltypes[i] = '?';\n        continue;\n      }\n\n      for (j = 0; j < col.length; ++j) {\n        switch (typeof col[j]) {\n          /* TODO: check if L2 compat is desired */\n          case 'number':\n            _guess = 'B';\n            break;\n\n          case 'string':\n            _guess = 'C';\n            break;\n\n          case 'boolean':\n            _guess = 'L';\n            break;\n\n          case 'object':\n            _guess = col[j] instanceof Date ? 'D' : 'C';\n            break;\n\n          default:\n            _guess = 'C';\n        }\n\n        maxlen = Math.max(maxlen, String(col[j]).length);\n        guess = guess && guess != _guess ? 'C' : _guess; //if(guess == 'C') break;\n      }\n\n      if (maxlen > 250) maxlen = 250;\n      _guess = ((cols[i] || {}).DBF || {}).type;\n      /* TODO: more fine grained control over DBF type resolution */\n\n      if (_guess == 'C') {\n        if (cols[i].DBF.len > maxlen) maxlen = cols[i].DBF.len;\n      }\n\n      if (guess == 'B' && _guess == 'N') {\n        guess = 'N';\n        coldecimals[i] = cols[i].DBF.dec;\n        maxlen = cols[i].DBF.len;\n      }\n\n      colwidths[i] = guess == 'C' || _guess == 'N' ? maxlen : _RLEN[guess] || 0;\n      rlen += colwidths[i];\n      coltypes[i] = guess;\n    }\n\n    var h = ba.next(32);\n    h.write_shift(4, 0x13021130);\n    h.write_shift(4, data.length);\n    h.write_shift(2, 296 + 32 * hcnt);\n    h.write_shift(2, rlen);\n\n    for (i = 0; i < 4; ++i) h.write_shift(4, 0);\n\n    h.write_shift(4, 0x00000000 | (+dbf_reverse_map[\n    /*::String(*/\n    current_ansi\n    /*::)*/\n    ] || 0x03) << 8);\n\n    for (i = 0, j = 0; i < headers.length; ++i) {\n      if (headers[i] == null) continue;\n      var hf = ba.next(32);\n\n      var _f = (headers[i].slice(-10) + \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\").slice(0, 11);\n\n      hf.write_shift(1, _f, \"sbcs\");\n      hf.write_shift(1, coltypes[i] == '?' ? 'C' : coltypes[i], \"sbcs\");\n      hf.write_shift(4, j);\n      hf.write_shift(1, colwidths[i] || _RLEN[coltypes[i]] || 0);\n      hf.write_shift(1, coldecimals[i] || 0);\n      hf.write_shift(1, 0x02);\n      hf.write_shift(4, 0);\n      hf.write_shift(1, 0);\n      hf.write_shift(4, 0);\n      hf.write_shift(4, 0);\n      j += colwidths[i] || _RLEN[coltypes[i]] || 0;\n    }\n\n    var hb = ba.next(264);\n    hb.write_shift(4, 0x0000000D);\n\n    for (i = 0; i < 65; ++i) hb.write_shift(4, 0x00000000);\n\n    for (i = 0; i < data.length; ++i) {\n      var rout = ba.next(rlen);\n      rout.write_shift(1, 0);\n\n      for (j = 0; j < headers.length; ++j) {\n        if (headers[j] == null) continue;\n\n        switch (coltypes[j]) {\n          case 'L':\n            rout.write_shift(1, data[i][j] == null ? 0x3F : data[i][j] ? 0x54 : 0x46);\n            break;\n\n          case 'B':\n            rout.write_shift(8, data[i][j] || 0, 'f');\n            break;\n\n          case 'N':\n            var _n = \"0\";\n            if (typeof data[i][j] == \"number\") _n = data[i][j].toFixed(coldecimals[j] || 0);\n\n            for (hcnt = 0; hcnt < colwidths[j] - _n.length; ++hcnt) rout.write_shift(1, 0x20);\n\n            rout.write_shift(1, _n, \"sbcs\");\n            break;\n\n          case 'D':\n            if (!data[i][j]) rout.write_shift(8, \"00000000\", \"sbcs\");else {\n              rout.write_shift(4, (\"0000\" + data[i][j].getFullYear()).slice(-4), \"sbcs\");\n              rout.write_shift(2, (\"00\" + (data[i][j].getMonth() + 1)).slice(-2), \"sbcs\");\n              rout.write_shift(2, (\"00\" + data[i][j].getDate()).slice(-2), \"sbcs\");\n            }\n            break;\n\n          case 'C':\n            var _s = String(data[i][j] != null ? data[i][j] : \"\").slice(0, colwidths[j]);\n\n            rout.write_shift(1, _s, \"sbcs\");\n\n            for (hcnt = 0; hcnt < colwidths[j] - _s.length; ++hcnt) rout.write_shift(1, 0x20);\n\n            break;\n        }\n      } // data\n\n    }\n\n    ba.next(1).write_shift(1, 0x1A);\n    return ba.end();\n  }\n\n  return {\n    to_workbook: dbf_to_workbook,\n    to_sheet: dbf_to_sheet,\n    from_sheet: sheet_to_dbf\n  };\n}();\n\nvar SYLK = /*#__PURE__*/function () {\n  /* TODO: stress test sequences */\n  var sylk_escapes = {\n    AA: '',\n    BA: '',\n    CA: '',\n    DA: 195,\n    HA: '',\n    JA: 197,\n    AE: '',\n    BE: '',\n    CE: '',\n    HE: '',\n    AI: '',\n    BI: '',\n    CI: '',\n    HI: '',\n    AO: '',\n    BO: '',\n    CO: '',\n    DO: 213,\n    HO: '',\n    AU: '',\n    BU: '',\n    CU: '',\n    HU: '',\n    Aa: '',\n    Ba: '',\n    Ca: '',\n    Da: 227,\n    Ha: '',\n    Ja: 229,\n    Ae: '',\n    Be: '',\n    Ce: '',\n    He: '',\n    Ai: '',\n    Bi: '',\n    Ci: '',\n    Hi: '',\n    Ao: '',\n    Bo: '',\n    Co: '',\n    Do: 245,\n    Ho: '',\n    Au: '',\n    Bu: '',\n    Cu: '',\n    Hu: '',\n    KC: '',\n    Kc: '',\n    q: '',\n    z: '',\n    a: '',\n    j: '',\n    DN: 209,\n    Dn: 241,\n    Hy: 255,\n    S: 169,\n    c: 170,\n    R: 174,\n    \"B \": 180,\n\n    /*::[*/\n    0\n    /*::]*/\n    : 176,\n\n    /*::[*/\n    1\n    /*::]*/\n    : 177,\n\n    /*::[*/\n    2\n    /*::]*/\n    : 178,\n\n    /*::[*/\n    3\n    /*::]*/\n    : 179,\n\n    /*::[*/\n    5\n    /*::]*/\n    : 181,\n\n    /*::[*/\n    6\n    /*::]*/\n    : 182,\n\n    /*::[*/\n    7\n    /*::]*/\n    : 183,\n    Q: 185,\n    k: 186,\n    b: 208,\n    i: 216,\n    l: 222,\n    s: 240,\n    y: 248,\n    \"!\": 161,\n    '\"': 162,\n    \"#\": 163,\n    \"(\": 164,\n    \"%\": 165,\n    \"'\": 167,\n    \"H \": 168,\n    \"+\": 171,\n    \";\": 187,\n    \"<\": 188,\n    \"=\": 189,\n    \">\": 190,\n    \"?\": 191,\n    \"{\": 223\n  }\n  /*:any*/\n  ;\n  var sylk_char_regex = new RegExp(\"\\u001BN(\" + keys(sylk_escapes).join(\"|\").replace(/\\|\\|\\|/, \"|\\\\||\").replace(/([?()+])/g, \"\\\\$1\") + \"|\\\\|)\", \"gm\");\n\n  var sylk_char_fn = function (_, $1) {\n    var o = sylk_escapes[$1];\n    return typeof o == \"number\" ? _getansi(o) : o;\n  };\n\n  var decode_sylk_char = function ($$, $1, $2) {\n    var newcc = $1.charCodeAt(0) - 0x20 << 4 | $2.charCodeAt(0) - 0x30;\n    return newcc == 59 ? $$ : _getansi(newcc);\n  };\n\n  sylk_escapes[\"|\"] = 254;\n  /* TODO: find an actual specification */\n\n  function sylk_to_aoa(d\n  /*:RawData*/\n  , opts)\n  /*:[AOA, Worksheet]*/\n  {\n    switch (opts.type) {\n      case 'base64':\n        return sylk_to_aoa_str(Base64_decode(d), opts);\n\n      case 'binary':\n        return sylk_to_aoa_str(d, opts);\n\n      case 'buffer':\n        return sylk_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\n      case 'array':\n        return sylk_to_aoa_str(cc2str(d), opts);\n    }\n\n    throw new Error(\"Unrecognized type \" + opts.type);\n  }\n\n  function sylk_to_aoa_str(str\n  /*:string*/\n  , opts)\n  /*:[AOA, Worksheet]*/\n  {\n    var records = str.split(/[\\n\\r]+/),\n        R = -1,\n        C = -1,\n        ri = 0,\n        rj = 0,\n        arr\n    /*:AOA*/\n    = [];\n    var formats\n    /*:Array<string>*/\n    = [];\n    var next_cell_format\n    /*:string|null*/\n    = null;\n    var sht = {},\n        rowinfo\n    /*:Array<RowInfo>*/\n    = [],\n        colinfo\n    /*:Array<ColInfo>*/\n    = [],\n        cw\n    /*:Array<string>*/\n    = [];\n    var Mval = 0,\n        j;\n    if (+opts.codepage >= 0) set_cp(+opts.codepage);\n\n    for (; ri !== records.length; ++ri) {\n      Mval = 0;\n      var rstr = records[ri].trim().replace(/\\x1B([\\x20-\\x2F])([\\x30-\\x3F])/g, decode_sylk_char).replace(sylk_char_regex, sylk_char_fn);\n      var record = rstr.replace(/;;/g, \"\\u0000\").split(\";\").map(function (x) {\n        return x.replace(/\\u0000/g, \";\");\n      });\n      var RT = record[0],\n          val;\n      if (rstr.length > 0) switch (RT) {\n        case 'ID':\n          break;\n\n        /* header */\n\n        case 'E':\n          break;\n\n        /* EOF */\n\n        case 'B':\n          break;\n\n        /* dimensions */\n\n        case 'O':\n          break;\n\n        /* options? */\n\n        case 'W':\n          break;\n\n        /* window? */\n\n        case 'P':\n          if (record[1].charAt(0) == 'P') formats.push(rstr.slice(3).replace(/;;/g, \";\"));\n          break;\n\n        case 'C':\n          var C_seen_K = false,\n              C_seen_X = false,\n              C_seen_S = false,\n              C_seen_E = false,\n              _R = -1,\n              _C = -1;\n\n          for (rj = 1; rj < record.length; ++rj) switch (record[rj].charAt(0)) {\n            case 'A':\n              break;\n            // TODO: comment\n\n            case 'X':\n              C = parseInt(record[rj].slice(1)) - 1;\n              C_seen_X = true;\n              break;\n\n            case 'Y':\n              R = parseInt(record[rj].slice(1)) - 1;\n              if (!C_seen_X) C = 0;\n\n              for (j = arr.length; j <= R; ++j) arr[j] = [];\n\n              break;\n\n            case 'K':\n              val = record[rj].slice(1);\n              if (val.charAt(0) === '\"') val = val.slice(1, val.length - 1);else if (val === 'TRUE') val = true;else if (val === 'FALSE') val = false;else if (!isNaN(fuzzynum(val))) {\n                val = fuzzynum(val);\n                if (next_cell_format !== null && fmt_is_date(next_cell_format)) val = numdate(val);\n              } else if (!isNaN(fuzzydate(val).getDate())) {\n                val = parseDate(val);\n              }\n              if (typeof $cptable !== 'undefined' && typeof val == \"string\" && (opts || {}).type != \"string\" && (opts || {}).codepage) val = $cptable.utils.decode(opts.codepage, val);\n              C_seen_K = true;\n              break;\n\n            case 'E':\n              C_seen_E = true;\n              var formula = rc_to_a1(record[rj].slice(1), {\n                r: R,\n                c: C\n              });\n              arr[R][C] = [arr[R][C], formula];\n              break;\n\n            case 'S':\n              C_seen_S = true;\n              arr[R][C] = [arr[R][C], \"S5S\"];\n              break;\n\n            case 'G':\n              break;\n            // unknown\n\n            case 'R':\n              _R = parseInt(record[rj].slice(1)) - 1;\n              break;\n\n            case 'C':\n              _C = parseInt(record[rj].slice(1)) - 1;\n              break;\n\n            default:\n              if (opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n          }\n\n          if (C_seen_K) {\n            if (arr[R][C] && arr[R][C].length == 2) arr[R][C][0] = val;else arr[R][C] = val;\n            next_cell_format = null;\n          }\n\n          if (C_seen_S) {\n            if (C_seen_E) throw new Error(\"SYLK shared formula cannot have own formula\");\n            var shrbase = _R > -1 && arr[_R][_C];\n            if (!shrbase || !shrbase[1]) throw new Error(\"SYLK shared formula cannot find base\");\n            arr[R][C][1] = shift_formula_str(shrbase[1], {\n              r: R - _R,\n              c: C - _C\n            });\n          }\n\n          break;\n\n        case 'F':\n          var F_seen = 0;\n\n          for (rj = 1; rj < record.length; ++rj) switch (record[rj].charAt(0)) {\n            case 'X':\n              C = parseInt(record[rj].slice(1)) - 1;\n              ++F_seen;\n              break;\n\n            case 'Y':\n              R = parseInt(record[rj].slice(1)) - 1;\n              /*C = 0;*/\n\n              for (j = arr.length; j <= R; ++j) arr[j] = [];\n\n              break;\n\n            case 'M':\n              Mval = parseInt(record[rj].slice(1)) / 20;\n              break;\n\n            case 'F':\n              break;\n\n            /* ??? */\n\n            case 'G':\n              break;\n\n            /* hide grid */\n\n            case 'P':\n              next_cell_format = formats[parseInt(record[rj].slice(1))];\n              break;\n\n            case 'S':\n              break;\n\n            /* cell style */\n\n            case 'D':\n              break;\n\n            /* column */\n\n            case 'N':\n              break;\n\n            /* font */\n\n            case 'W':\n              cw = record[rj].slice(1).split(\" \");\n\n              for (j = parseInt(cw[0], 10); j <= parseInt(cw[1], 10); ++j) {\n                Mval = parseInt(cw[2], 10);\n                colinfo[j - 1] = Mval === 0 ? {\n                  hidden: true\n                } : {\n                  wch: Mval\n                };\n                process_col(colinfo[j - 1]);\n              }\n\n              break;\n\n            case 'C':\n              /* default column format */\n              C = parseInt(record[rj].slice(1)) - 1;\n              if (!colinfo[C]) colinfo[C] = {};\n              break;\n\n            case 'R':\n              /* row properties */\n              R = parseInt(record[rj].slice(1)) - 1;\n              if (!rowinfo[R]) rowinfo[R] = {};\n\n              if (Mval > 0) {\n                rowinfo[R].hpt = Mval;\n                rowinfo[R].hpx = pt2px(Mval);\n              } else if (Mval === 0) rowinfo[R].hidden = true;\n\n              break;\n\n            default:\n              if (opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n          }\n\n          if (F_seen < 1) next_cell_format = null;\n          break;\n\n        default:\n          if (opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n      }\n    }\n\n    if (rowinfo.length > 0) sht['!rows'] = rowinfo;\n    if (colinfo.length > 0) sht['!cols'] = colinfo;\n    if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n    return [arr, sht];\n  }\n\n  function sylk_to_sheet(d\n  /*:RawData*/\n  , opts)\n  /*:Worksheet*/\n  {\n    var aoasht = sylk_to_aoa(d, opts);\n    var aoa = aoasht[0],\n        ws = aoasht[1];\n    var o = aoa_to_sheet(aoa, opts);\n    keys(ws).forEach(function (k) {\n      o[k] = ws[k];\n    });\n    return o;\n  }\n\n  function sylk_to_workbook(d\n  /*:RawData*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(sylk_to_sheet(d, opts), opts);\n  }\n\n  function write_ws_cell_sylk(cell\n  /*:Cell*/\n  , ws\n  /*:Worksheet*/\n  , R\n  /*:number*/\n  , C\n  /*:number*/\n\n  /*::, opts*/\n  )\n  /*:string*/\n  {\n    var o = \"C;Y\" + (R + 1) + \";X\" + (C + 1) + \";K\";\n\n    switch (cell.t) {\n      case 'n':\n        o += cell.v || 0;\n        if (cell.f && !cell.F) o += \";E\" + a1_to_rc(cell.f, {\n          r: R,\n          c: C\n        });\n        break;\n\n      case 'b':\n        o += cell.v ? \"TRUE\" : \"FALSE\";\n        break;\n\n      case 'e':\n        o += cell.w || cell.v;\n        break;\n\n      case 'd':\n        o += '\"' + (cell.w || cell.v) + '\"';\n        break;\n\n      case 's':\n        o += '\"' + cell.v.replace(/\"/g, \"\").replace(/;/g, \";;\") + '\"';\n        break;\n    }\n\n    return o;\n  }\n\n  function write_ws_cols_sylk(out, cols) {\n    cols.forEach(function (col, i) {\n      var rec = \"F;W\" + (i + 1) + \" \" + (i + 1) + \" \";\n      if (col.hidden) rec += \"0\";else {\n        if (typeof col.width == 'number' && !col.wpx) col.wpx = width2px(col.width);\n        if (typeof col.wpx == 'number' && !col.wch) col.wch = px2char(col.wpx);\n        if (typeof col.wch == 'number') rec += Math.round(col.wch);\n      }\n      if (rec.charAt(rec.length - 1) != \" \") out.push(rec);\n    });\n  }\n\n  function write_ws_rows_sylk(out\n  /*:Array<string>*/\n  , rows\n  /*:Array<RowInfo>*/\n  ) {\n    rows.forEach(function (row, i) {\n      var rec = \"F;\";\n      if (row.hidden) rec += \"M0;\";else if (row.hpt) rec += \"M\" + 20 * row.hpt + \";\";else if (row.hpx) rec += \"M\" + 20 * px2pt(row.hpx) + \";\";\n      if (rec.length > 2) out.push(rec + \"R\" + (i + 1));\n    });\n  }\n\n  function sheet_to_sylk(ws\n  /*:Worksheet*/\n  , opts\n  /*:?any*/\n  )\n  /*:string*/\n  {\n    var preamble\n    /*:Array<string>*/\n    = [\"ID;PWXL;N;E\"],\n        o\n    /*:Array<string>*/\n    = [];\n    var r = safe_decode_range(ws['!ref']),\n        cell\n    /*:Cell*/\n    ;\n    var dense = Array.isArray(ws);\n    var RS = \"\\r\\n\";\n    preamble.push(\"P;PGeneral\");\n    preamble.push(\"F;P0;DG0G8;M255\");\n    if (ws['!cols']) write_ws_cols_sylk(preamble, ws['!cols']);\n    if (ws['!rows']) write_ws_rows_sylk(preamble, ws['!rows']);\n    preamble.push(\"B;Y\" + (r.e.r - r.s.r + 1) + \";X\" + (r.e.c - r.s.c + 1) + \";D\" + [r.s.c, r.s.r, r.e.c, r.e.r].join(\" \"));\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      for (var C = r.s.c; C <= r.e.c; ++C) {\n        var coord = encode_cell({\n          r: R,\n          c: C\n        });\n        cell = dense ? (ws[R] || [])[C] : ws[coord];\n        if (!cell || cell.v == null && (!cell.f || cell.F)) continue;\n        o.push(write_ws_cell_sylk(cell, ws, R, C, opts));\n      }\n    }\n\n    return preamble.join(RS) + RS + o.join(RS) + RS + \"E\" + RS;\n  }\n\n  return {\n    to_workbook: sylk_to_workbook,\n    to_sheet: sylk_to_sheet,\n    from_sheet: sheet_to_sylk\n  };\n}();\n\nvar DIF = /*#__PURE__*/function () {\n  function dif_to_aoa(d\n  /*:RawData*/\n  , opts)\n  /*:AOA*/\n  {\n    switch (opts.type) {\n      case 'base64':\n        return dif_to_aoa_str(Base64_decode(d), opts);\n\n      case 'binary':\n        return dif_to_aoa_str(d, opts);\n\n      case 'buffer':\n        return dif_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\n      case 'array':\n        return dif_to_aoa_str(cc2str(d), opts);\n    }\n\n    throw new Error(\"Unrecognized type \" + opts.type);\n  }\n\n  function dif_to_aoa_str(str\n  /*:string*/\n  , opts)\n  /*:AOA*/\n  {\n    var records = str.split('\\n'),\n        R = -1,\n        C = -1,\n        ri = 0,\n        arr\n    /*:AOA*/\n    = [];\n\n    for (; ri !== records.length; ++ri) {\n      if (records[ri].trim() === 'BOT') {\n        arr[++R] = [];\n        C = 0;\n        continue;\n      }\n\n      if (R < 0) continue;\n      var metadata = records[ri].trim().split(\",\");\n      var type = metadata[0],\n          value = metadata[1];\n      ++ri;\n      var data = records[ri] || \"\";\n\n      while ((data.match(/[\"]/g) || []).length & 1 && ri < records.length - 1) data += \"\\n\" + records[++ri];\n\n      data = data.trim();\n\n      switch (+type) {\n        case -1:\n          if (data === 'BOT') {\n            arr[++R] = [];\n            C = 0;\n            continue;\n          } else if (data !== 'EOD') throw new Error(\"Unrecognized DIF special command \" + data);\n\n          break;\n\n        case 0:\n          if (data === 'TRUE') arr[R][C] = true;else if (data === 'FALSE') arr[R][C] = false;else if (!isNaN(fuzzynum(value))) arr[R][C] = fuzzynum(value);else if (!isNaN(fuzzydate(value).getDate())) arr[R][C] = parseDate(value);else arr[R][C] = value;\n          ++C;\n          break;\n\n        case 1:\n          data = data.slice(1, data.length - 1);\n          data = data.replace(/\"\"/g, '\"');\n          if (DIF_XL && data && data.match(/^=\".*\"$/)) data = data.slice(2, -1);\n          arr[R][C++] = data !== '' ? data : null;\n          break;\n      }\n\n      if (data === 'EOD') break;\n    }\n\n    if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n    return arr;\n  }\n\n  function dif_to_sheet(str\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    return aoa_to_sheet(dif_to_aoa(str, opts), opts);\n  }\n\n  function dif_to_workbook(str\n  /*:string*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(dif_to_sheet(str, opts), opts);\n  }\n\n  var sheet_to_dif = /*#__PURE__*/function () {\n    var push_field = function pf(o\n    /*:Array<string>*/\n    , topic\n    /*:string*/\n    , v\n    /*:number*/\n    , n\n    /*:number*/\n    , s\n    /*:string*/\n    ) {\n      o.push(topic);\n      o.push(v + \",\" + n);\n      o.push('\"' + s.replace(/\"/g, '\"\"') + '\"');\n    };\n\n    var push_value = function po(o\n    /*:Array<string>*/\n    , type\n    /*:number*/\n    , v\n    /*:any*/\n    , s\n    /*:string*/\n    ) {\n      o.push(type + \",\" + v);\n      o.push(type == 1 ? '\"' + s.replace(/\"/g, '\"\"') + '\"' : s);\n    };\n\n    return function sheet_to_dif(ws\n    /*:Worksheet*/\n\n    /*::, opts:?any*/\n    )\n    /*:string*/\n    {\n      var o\n      /*:Array<string>*/\n      = [];\n      var r = safe_decode_range(ws['!ref']),\n          cell\n      /*:Cell*/\n      ;\n      var dense = Array.isArray(ws);\n      push_field(o, \"TABLE\", 0, 1, \"sheetjs\");\n      push_field(o, \"VECTORS\", 0, r.e.r - r.s.r + 1, \"\");\n      push_field(o, \"TUPLES\", 0, r.e.c - r.s.c + 1, \"\");\n      push_field(o, \"DATA\", 0, 0, \"\");\n\n      for (var R = r.s.r; R <= r.e.r; ++R) {\n        push_value(o, -1, 0, \"BOT\");\n\n        for (var C = r.s.c; C <= r.e.c; ++C) {\n          var coord = encode_cell({\n            r: R,\n            c: C\n          });\n          cell = dense ? (ws[R] || [])[C] : ws[coord];\n\n          if (!cell) {\n            push_value(o, 1, 0, \"\");\n            continue;\n          }\n\n          switch (cell.t) {\n            case 'n':\n              var val = DIF_XL ? cell.w : cell.v;\n              if (!val && cell.v != null) val = cell.v;\n\n              if (val == null) {\n                if (DIF_XL && cell.f && !cell.F) push_value(o, 1, 0, \"=\" + cell.f);else push_value(o, 1, 0, \"\");\n              } else push_value(o, 0, val, \"V\");\n\n              break;\n\n            case 'b':\n              push_value(o, 0, cell.v ? 1 : 0, cell.v ? \"TRUE\" : \"FALSE\");\n              break;\n\n            case 's':\n              push_value(o, 1, 0, !DIF_XL || isNaN(cell.v) ? cell.v : '=\"' + cell.v + '\"');\n              break;\n\n            case 'd':\n              if (!cell.w) cell.w = SSF_format(cell.z || table_fmt[14], datenum(parseDate(cell.v)));\n              if (DIF_XL) push_value(o, 0, cell.w, \"V\");else push_value(o, 1, 0, cell.w);\n              break;\n\n            default:\n              push_value(o, 1, 0, \"\");\n          }\n        }\n      }\n\n      push_value(o, -1, 0, \"EOD\");\n      var RS = \"\\r\\n\";\n      var oo = o.join(RS); //while((oo.length & 0x7F) != 0) oo += \"\\0\";\n\n      return oo;\n    };\n  }();\n\n  return {\n    to_workbook: dif_to_workbook,\n    to_sheet: dif_to_sheet,\n    from_sheet: sheet_to_dif\n  };\n}();\n\nvar ETH = /*#__PURE__*/function () {\n  function decode(s\n  /*:string*/\n  )\n  /*:string*/\n  {\n    return s.replace(/\\\\b/g, \"\\\\\").replace(/\\\\c/g, \":\").replace(/\\\\n/g, \"\\n\");\n  }\n\n  function encode(s\n  /*:string*/\n  )\n  /*:string*/\n  {\n    return s.replace(/\\\\/g, \"\\\\b\").replace(/:/g, \"\\\\c\").replace(/\\n/g, \"\\\\n\");\n  }\n\n  function eth_to_aoa(str\n  /*:string*/\n  , opts)\n  /*:AOA*/\n  {\n    var records = str.split('\\n'),\n        R = -1,\n        C = -1,\n        ri = 0,\n        arr\n    /*:AOA*/\n    = [];\n\n    for (; ri !== records.length; ++ri) {\n      var record = records[ri].trim().split(\":\");\n      if (record[0] !== 'cell') continue;\n      var addr = decode_cell(record[1]);\n      if (arr.length <= addr.r) for (R = arr.length; R <= addr.r; ++R) if (!arr[R]) arr[R] = [];\n      R = addr.r;\n      C = addr.c;\n\n      switch (record[2]) {\n        case 't':\n          arr[R][C] = decode(record[3]);\n          break;\n\n        case 'v':\n          arr[R][C] = +record[3];\n          break;\n\n        case 'vtf':\n          var _f = record[record.length - 1];\n\n        /* falls through */\n\n        case 'vtc':\n          switch (record[3]) {\n            case 'nl':\n              arr[R][C] = +record[4] ? true : false;\n              break;\n\n            default:\n              arr[R][C] = +record[4];\n              break;\n          }\n\n          if (record[2] == 'vtf') arr[R][C] = [arr[R][C], _f];\n      }\n    }\n\n    if (opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n    return arr;\n  }\n\n  function eth_to_sheet(d\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    return aoa_to_sheet(eth_to_aoa(d, opts), opts);\n  }\n\n  function eth_to_workbook(d\n  /*:string*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(eth_to_sheet(d, opts), opts);\n  }\n\n  var header = [\"socialcalc:version:1.5\", \"MIME-Version: 1.0\", \"Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave\"].join(\"\\n\");\n  var sep = [\"--SocialCalcSpreadsheetControlSave\", \"Content-type: text/plain; charset=UTF-8\"].join(\"\\n\") + \"\\n\";\n  /* TODO: the other parts */\n\n  var meta = [\"# SocialCalc Spreadsheet Control Save\", \"part:sheet\"].join(\"\\n\");\n  var end = \"--SocialCalcSpreadsheetControlSave--\";\n\n  function sheet_to_eth_data(ws\n  /*:Worksheet*/\n  )\n  /*:string*/\n  {\n    if (!ws || !ws['!ref']) return \"\";\n    var o\n    /*:Array<string>*/\n    = [],\n        oo\n    /*:Array<string>*/\n    = [],\n        cell,\n        coord = \"\";\n    var r = decode_range(ws['!ref']);\n    var dense = Array.isArray(ws);\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      for (var C = r.s.c; C <= r.e.c; ++C) {\n        coord = encode_cell({\n          r: R,\n          c: C\n        });\n        cell = dense ? (ws[R] || [])[C] : ws[coord];\n        if (!cell || cell.v == null || cell.t === 'z') continue;\n        oo = [\"cell\", coord, 't'];\n\n        switch (cell.t) {\n          case 's':\n          case 'str':\n            oo.push(encode(cell.v));\n            break;\n\n          case 'n':\n            if (!cell.f) {\n              oo[2] = 'v';\n              oo[3] = cell.v;\n            } else {\n              oo[2] = 'vtf';\n              oo[3] = 'n';\n              oo[4] = cell.v;\n              oo[5] = encode(cell.f);\n            }\n\n            break;\n\n          case 'b':\n            oo[2] = 'vt' + (cell.f ? 'f' : 'c');\n            oo[3] = 'nl';\n            oo[4] = cell.v ? \"1\" : \"0\";\n            oo[5] = encode(cell.f || (cell.v ? 'TRUE' : 'FALSE'));\n            break;\n\n          case 'd':\n            var t = datenum(parseDate(cell.v));\n            oo[2] = 'vtc';\n            oo[3] = 'nd';\n            oo[4] = \"\" + t;\n            oo[5] = cell.w || SSF_format(cell.z || table_fmt[14], t);\n            break;\n\n          case 'e':\n            continue;\n        }\n\n        o.push(oo.join(\":\"));\n      }\n    }\n\n    o.push(\"sheet:c:\" + (r.e.c - r.s.c + 1) + \":r:\" + (r.e.r - r.s.r + 1) + \":tvf:1\");\n    o.push(\"valueformat:1:text-wiki\"); //o.push(\"copiedfrom:\" + ws['!ref']); // clipboard only\n\n    return o.join(\"\\n\");\n  }\n\n  function sheet_to_eth(ws\n  /*:Worksheet*/\n\n  /*::, opts:?any*/\n  )\n  /*:string*/\n  {\n    return [header, sep, meta, sep, sheet_to_eth_data(ws), end].join(\"\\n\"); // return [\"version:1.5\", sheet_to_eth_data(ws)].join(\"\\n\"); // clipboard form\n  }\n\n  return {\n    to_workbook: eth_to_workbook,\n    to_sheet: eth_to_sheet,\n    from_sheet: sheet_to_eth\n  };\n}();\n\nvar PRN = /*#__PURE__*/function () {\n  function set_text_arr(data\n  /*:string*/\n  , arr\n  /*:AOA*/\n  , R\n  /*:number*/\n  , C\n  /*:number*/\n  , o\n  /*:any*/\n  ) {\n    if (o.raw) arr[R][C] = data;else if (data === \"\") {\n      /* empty */\n    } else if (data === 'TRUE') arr[R][C] = true;else if (data === 'FALSE') arr[R][C] = false;else if (!isNaN(fuzzynum(data))) arr[R][C] = fuzzynum(data);else if (!isNaN(fuzzydate(data).getDate())) arr[R][C] = parseDate(data);else arr[R][C] = data;\n  }\n\n  function prn_to_aoa_str(f\n  /*:string*/\n  , opts)\n  /*:AOA*/\n  {\n    var o = opts || {};\n    var arr\n    /*:AOA*/\n    = []\n    /*:any*/\n    ;\n    if (!f || f.length === 0) return arr;\n    var lines = f.split(/[\\r\\n]/);\n    var L = lines.length - 1;\n\n    while (L >= 0 && lines[L].length === 0) --L;\n\n    var start = 10,\n        idx = 0;\n    var R = 0;\n\n    for (; R <= L; ++R) {\n      idx = lines[R].indexOf(\" \");\n      if (idx == -1) idx = lines[R].length;else idx++;\n      start = Math.max(start, idx);\n    }\n\n    for (R = 0; R <= L; ++R) {\n      arr[R] = [];\n      /* TODO: confirm that widths are always 10 */\n\n      var C = 0;\n      set_text_arr(lines[R].slice(0, start).trim(), arr, R, C, o);\n\n      for (C = 1; C <= (lines[R].length - start) / 10 + 1; ++C) set_text_arr(lines[R].slice(start + (C - 1) * 10, start + C * 10).trim(), arr, R, C, o);\n    }\n\n    if (o.sheetRows) arr = arr.slice(0, o.sheetRows);\n    return arr;\n  } // List of accepted CSV separators\n\n\n  var guess_seps = {\n    /*::[*/\n    0x2C\n    /*::]*/\n    : ',',\n\n    /*::[*/\n    0x09\n    /*::]*/\n    : \"\\t\",\n\n    /*::[*/\n    0x3B\n    /*::]*/\n    : ';',\n\n    /*::[*/\n    0x7C\n    /*::]*/\n    : '|'\n  }; // CSV separator weights to be used in case of equal numbers\n\n  var guess_sep_weights = {\n    /*::[*/\n    0x2C\n    /*::]*/\n    : 3,\n\n    /*::[*/\n    0x09\n    /*::]*/\n    : 2,\n\n    /*::[*/\n    0x3B\n    /*::]*/\n    : 1,\n\n    /*::[*/\n    0x7C\n    /*::]*/\n    : 0\n  };\n\n  function guess_sep(str) {\n    var cnt = {},\n        instr = false,\n        end = 0,\n        cc = 0;\n\n    for (; end < str.length; ++end) {\n      if ((cc = str.charCodeAt(end)) == 0x22) instr = !instr;else if (!instr && cc in guess_seps) cnt[cc] = (cnt[cc] || 0) + 1;\n    }\n\n    cc = [];\n\n    for (end in cnt) if (Object.prototype.hasOwnProperty.call(cnt, end)) {\n      cc.push([cnt[end], end]);\n    }\n\n    if (!cc.length) {\n      cnt = guess_sep_weights;\n\n      for (end in cnt) if (Object.prototype.hasOwnProperty.call(cnt, end)) {\n        cc.push([cnt[end], end]);\n      }\n    }\n\n    cc.sort(function (a, b) {\n      return a[0] - b[0] || guess_sep_weights[a[1]] - guess_sep_weights[b[1]];\n    });\n    return guess_seps[cc.pop()[1]] || 0x2C;\n  }\n\n  function dsv_to_sheet_str(str\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    var o = opts || {};\n    var sep = \"\";\n    if (DENSE != null && o.dense == null) o.dense = DENSE;\n    var ws\n    /*:Worksheet*/\n    = o.dense ? []\n    /*:any*/\n    : {}\n    /*:any*/\n    ;\n    var range\n    /*:Range*/\n    = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    }\n    /*:any*/\n    ;\n\n    if (str.slice(0, 4) == \"sep=\") {\n      // If the line ends in \\r\\n\n      if (str.charCodeAt(5) == 13 && str.charCodeAt(6) == 10) {\n        sep = str.charAt(4);\n        str = str.slice(7);\n      } // If line ends in \\r OR \\n\n      else if (str.charCodeAt(5) == 13 || str.charCodeAt(5) == 10) {\n        sep = str.charAt(4);\n        str = str.slice(6);\n      } else sep = guess_sep(str.slice(0, 1024));\n    } else if (o && o.FS) sep = o.FS;else sep = guess_sep(str.slice(0, 1024));\n\n    var R = 0,\n        C = 0,\n        v = 0;\n    var start = 0,\n        end = 0,\n        sepcc = sep.charCodeAt(0),\n        instr = false,\n        cc = 0,\n        startcc = str.charCodeAt(0);\n    str = str.replace(/\\r\\n/mg, \"\\n\");\n\n    var _re\n    /*:?RegExp*/\n    = o.dateNF != null ? dateNF_regex(o.dateNF) : null;\n\n    function finish_cell() {\n      var s = str.slice(start, end);\n      var cell = {}\n      /*:any*/\n      ;\n      if (s.charAt(0) == '\"' && s.charAt(s.length - 1) == '\"') s = s.slice(1, -1).replace(/\"\"/g, '\"');\n      if (s.length === 0) cell.t = 'z';else if (o.raw) {\n        cell.t = 's';\n        cell.v = s;\n      } else if (s.trim().length === 0) {\n        cell.t = 's';\n        cell.v = s;\n      } else if (s.charCodeAt(0) == 0x3D) {\n        if (s.charCodeAt(1) == 0x22 && s.charCodeAt(s.length - 1) == 0x22) {\n          cell.t = 's';\n          cell.v = s.slice(2, -1).replace(/\"\"/g, '\"');\n        } else if (fuzzyfmla(s)) {\n          cell.t = 'n';\n          cell.f = s.slice(1);\n        } else {\n          cell.t = 's';\n          cell.v = s;\n        }\n      } else if (s == \"TRUE\") {\n        cell.t = 'b';\n        cell.v = true;\n      } else if (s == \"FALSE\") {\n        cell.t = 'b';\n        cell.v = false;\n      } else if (!isNaN(v = fuzzynum(s))) {\n        cell.t = 'n';\n        if (o.cellText !== false) cell.w = s;\n        cell.v = v;\n      } else if (!isNaN(fuzzydate(s).getDate()) || _re && s.match(_re)) {\n        cell.z = o.dateNF || table_fmt[14];\n        var k = 0;\n\n        if (_re && s.match(_re)) {\n          s = dateNF_fix(s, o.dateNF, s.match(_re) || []);\n          k = 1;\n        }\n\n        if (o.cellDates) {\n          cell.t = 'd';\n          cell.v = parseDate(s, k);\n        } else {\n          cell.t = 'n';\n          cell.v = datenum(parseDate(s, k));\n        }\n\n        if (o.cellText !== false) cell.w = SSF_format(cell.z, cell.v instanceof Date ? datenum(cell.v) : cell.v);\n        if (!o.cellNF) delete cell.z;\n      } else {\n        cell.t = 's';\n        cell.v = s;\n      }\n\n      if (cell.t == 'z') {} else if (o.dense) {\n        if (!ws[R]) ws[R] = [];\n        ws[R][C] = cell;\n      } else ws[encode_cell({\n        c: C,\n        r: R\n      })] = cell;\n\n      start = end + 1;\n      startcc = str.charCodeAt(start);\n      if (range.e.c < C) range.e.c = C;\n      if (range.e.r < R) range.e.r = R;\n      if (cc == sepcc) ++C;else {\n        C = 0;\n        ++R;\n        if (o.sheetRows && o.sheetRows <= R) return true;\n      }\n    }\n\n    outer: for (; end < str.length; ++end) switch (cc = str.charCodeAt(end)) {\n      case 0x22:\n        if (startcc === 0x22) instr = !instr;\n        break;\n\n      case sepcc:\n      case 0x0a:\n      case 0x0d:\n        if (!instr && finish_cell()) break outer;\n        break;\n\n      default:\n        break;\n    }\n\n    if (end - start > 0) finish_cell();\n    ws['!ref'] = encode_range(range);\n    return ws;\n  }\n\n  function prn_to_sheet_str(str\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    if (!(opts && opts.PRN)) return dsv_to_sheet_str(str, opts);\n    if (opts.FS) return dsv_to_sheet_str(str, opts);\n    if (str.slice(0, 4) == \"sep=\") return dsv_to_sheet_str(str, opts);\n    if (str.indexOf(\"\\t\") >= 0 || str.indexOf(\",\") >= 0 || str.indexOf(\";\") >= 0) return dsv_to_sheet_str(str, opts);\n    return aoa_to_sheet(prn_to_aoa_str(str, opts), opts);\n  }\n\n  function prn_to_sheet(d\n  /*:RawData*/\n  , opts)\n  /*:Worksheet*/\n  {\n    var str = \"\",\n        bytes = opts.type == 'string' ? [0, 0, 0, 0] : firstbyte(d, opts);\n\n    switch (opts.type) {\n      case 'base64':\n        str = Base64_decode(d);\n        break;\n\n      case 'binary':\n        str = d;\n        break;\n\n      case 'buffer':\n        if (opts.codepage == 65001) str = d.toString('utf8'); // TODO: test if buf\n        else if (opts.codepage && typeof $cptable !== 'undefined') str = $cptable.utils.decode(opts.codepage, d);else str = has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d);\n        break;\n\n      case 'array':\n        str = cc2str(d);\n        break;\n\n      case 'string':\n        str = d;\n        break;\n\n      default:\n        throw new Error(\"Unrecognized type \" + opts.type);\n    }\n\n    if (bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str.slice(3));else if (opts.type != 'string' && opts.type != 'buffer' && opts.codepage == 65001) str = utf8read(str);else if (opts.type == 'binary' && typeof $cptable !== 'undefined' && opts.codepage) str = $cptable.utils.decode(opts.codepage, $cptable.utils.encode(28591, str));\n    if (str.slice(0, 19) == \"socialcalc:version:\") return ETH.to_sheet(opts.type == 'string' ? str : utf8read(str), opts);\n    return prn_to_sheet_str(str, opts);\n  }\n\n  function prn_to_workbook(d\n  /*:RawData*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(prn_to_sheet(d, opts), opts);\n  }\n\n  function sheet_to_prn(ws\n  /*:Worksheet*/\n\n  /*::, opts:?any*/\n  )\n  /*:string*/\n  {\n    var o\n    /*:Array<string>*/\n    = [];\n    var r = safe_decode_range(ws['!ref']),\n        cell\n    /*:Cell*/\n    ;\n    var dense = Array.isArray(ws);\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      var oo\n      /*:Array<string>*/\n      = [];\n\n      for (var C = r.s.c; C <= r.e.c; ++C) {\n        var coord = encode_cell({\n          r: R,\n          c: C\n        });\n        cell = dense ? (ws[R] || [])[C] : ws[coord];\n\n        if (!cell || cell.v == null) {\n          oo.push(\"          \");\n          continue;\n        }\n\n        var w = (cell.w || (format_cell(cell), cell.w) || \"\").slice(0, 10);\n\n        while (w.length < 10) w += \" \";\n\n        oo.push(w + (C === 0 ? \" \" : \"\"));\n      }\n\n      o.push(oo.join(\"\"));\n    }\n\n    return o.join(\"\\n\");\n  }\n\n  return {\n    to_workbook: prn_to_workbook,\n    to_sheet: prn_to_sheet,\n    from_sheet: sheet_to_prn\n  };\n}();\n/* Excel defaults to SYLK but warns if data is not valid */\n\n\nfunction read_wb_ID(d, opts) {\n  var o = opts || {},\n      OLD_WTF = !!o.WTF;\n  o.WTF = true;\n\n  try {\n    var out = SYLK.to_workbook(d, o);\n    o.WTF = OLD_WTF;\n    return out;\n  } catch (e) {\n    o.WTF = OLD_WTF;\n    if (!e.message.match(/SYLK bad record ID/) && OLD_WTF) throw e;\n    return PRN.to_workbook(d, opts);\n  }\n}\n\nvar WK_ = /*#__PURE__*/function () {\n  function lotushopper(data, cb\n  /*:RecordHopperCB*/\n  , opts\n  /*:any*/\n  ) {\n    if (!data) return;\n    prep_blob(data, data.l || 0);\n    var Enum = opts.Enum || WK1Enum;\n\n    while (data.l < data.length) {\n      var RT = data.read_shift(2);\n      var R = Enum[RT] || Enum[0xFFFF];\n      var length = data.read_shift(2);\n      var tgt = data.l + length;\n      var d = R.f && R.f(data, length, opts);\n      data.l = tgt;\n      if (cb(d, R, RT)) return;\n    }\n  }\n\n  function lotus_to_workbook(d\n  /*:RawData*/\n  , opts) {\n    switch (opts.type) {\n      case 'base64':\n        return lotus_to_workbook_buf(s2a(Base64_decode(d)), opts);\n\n      case 'binary':\n        return lotus_to_workbook_buf(s2a(d), opts);\n\n      case 'buffer':\n      case 'array':\n        return lotus_to_workbook_buf(d, opts);\n    }\n\n    throw \"Unsupported type \" + opts.type;\n  }\n\n  function lotus_to_workbook_buf(d, opts)\n  /*:Workbook*/\n  {\n    if (!d) return d;\n    var o = opts || {};\n    if (DENSE != null && o.dense == null) o.dense = DENSE;\n    var s\n    /*:Worksheet*/\n    = o.dense ? [] : {}\n    /*:any*/\n    ,\n        n = \"Sheet1\",\n        next_n = \"\",\n        sidx = 0;\n    var sheets = {},\n        snames = [],\n        realnames = [];\n    var refguess = {\n      s: {\n        r: 0,\n        c: 0\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var sheetRows = o.sheetRows || 0;\n\n    if (d[2] == 0x00) {\n      if (d[3] == 0x08 || d[3] == 0x09) {\n        if (d.length >= 16 && d[14] == 0x05 && d[15] === 0x6c) throw new Error(\"Unsupported Works 3 for Mac file\");\n      }\n    }\n\n    if (d[2] == 0x02) {\n      o.Enum = WK1Enum;\n      lotushopper(d, function (val, R, RT) {\n        switch (RT) {\n          case 0x00:\n            /* BOF */\n            o.vers = val;\n            if (val >= 0x1000) o.qpro = true;\n            break;\n\n          case 0x06:\n            refguess = val;\n            break;\n\n          /* RANGE */\n\n          case 0xCC:\n            if (val) next_n = val;\n            break;\n\n          /* SHEETNAMECS */\n\n          case 0xDE:\n            next_n = val;\n            break;\n\n          /* SHEETNAMELP */\n\n          case 0x0F:\n          /* LABEL */\n\n          case 0x33:\n            /* STRING */\n            if (!o.qpro) val[1].v = val[1].v.slice(1);\n\n          /* falls through */\n\n          case 0x0D:\n          /* INTEGER */\n\n          case 0x0E:\n          /* NUMBER */\n\n          case 0x10:\n            /* FORMULA */\n\n            /* TODO: actual translation of the format code */\n            if (RT == 0x0E && (val[2] & 0x70) == 0x70 && (val[2] & 0x0F) > 1 && (val[2] & 0x0F) < 15) {\n              val[1].z = o.dateNF || table_fmt[14];\n\n              if (o.cellDates) {\n                val[1].t = 'd';\n                val[1].v = numdate(val[1].v);\n              }\n            }\n\n            if (o.qpro) {\n              if (val[3] > sidx) {\n                s[\"!ref\"] = encode_range(refguess);\n                sheets[n] = s;\n                snames.push(n);\n                s = o.dense ? [] : {};\n                refguess = {\n                  s: {\n                    r: 0,\n                    c: 0\n                  },\n                  e: {\n                    r: 0,\n                    c: 0\n                  }\n                };\n                sidx = val[3];\n                n = next_n || \"Sheet\" + (sidx + 1);\n                next_n = \"\";\n              }\n            }\n\n            var tmpcell = o.dense ? (s[val[0].r] || [])[val[0].c] : s[encode_cell(val[0])];\n\n            if (tmpcell) {\n              tmpcell.t = val[1].t;\n              tmpcell.v = val[1].v;\n              if (val[1].z != null) tmpcell.z = val[1].z;\n              if (val[1].f != null) tmpcell.f = val[1].f;\n              break;\n            }\n\n            if (o.dense) {\n              if (!s[val[0].r]) s[val[0].r] = [];\n              s[val[0].r][val[0].c] = val[1];\n            } else s[encode_cell(val[0])] = val[1];\n\n            break;\n\n          default:\n        }\n      }, o);\n    } else if (d[2] == 0x1A || d[2] == 0x0E) {\n      o.Enum = WK3Enum;\n\n      if (d[2] == 0x0E) {\n        o.qpro = true;\n        d.l = 0;\n      }\n\n      lotushopper(d, function (val, R, RT) {\n        switch (RT) {\n          case 0xCC:\n            n = val;\n            break;\n\n          /* SHEETNAMECS */\n\n          case 0x16:\n            /* LABEL16 */\n            val[1].v = val[1].v.slice(1);\n\n          /* falls through */\n\n          case 0x17:\n          /* NUMBER17 */\n\n          case 0x18:\n          /* NUMBER18 */\n\n          case 0x19:\n          /* FORMULA19 */\n\n          case 0x25:\n          /* NUMBER25 */\n\n          case 0x27:\n          /* NUMBER27 */\n\n          case 0x28:\n            /* FORMULA28 */\n            if (val[3] > sidx) {\n              s[\"!ref\"] = encode_range(refguess);\n              sheets[n] = s;\n              snames.push(n);\n              s = o.dense ? [] : {};\n              refguess = {\n                s: {\n                  r: 0,\n                  c: 0\n                },\n                e: {\n                  r: 0,\n                  c: 0\n                }\n              };\n              sidx = val[3];\n              n = \"Sheet\" + (sidx + 1);\n            }\n\n            if (sheetRows > 0 && val[0].r >= sheetRows) break;\n\n            if (o.dense) {\n              if (!s[val[0].r]) s[val[0].r] = [];\n              s[val[0].r][val[0].c] = val[1];\n            } else s[encode_cell(val[0])] = val[1];\n\n            if (refguess.e.c < val[0].c) refguess.e.c = val[0].c;\n            if (refguess.e.r < val[0].r) refguess.e.r = val[0].r;\n            break;\n\n          case 0x1B:\n            /* XFORMAT */\n            if (val[0x36b0]) realnames[val[0x36b0][0]] = val[0x36b0][1];\n            break;\n\n          case 0x0601:\n            /* SHEETINFOQP */\n            realnames[val[0]] = val[1];\n            if (val[0] == sidx) n = val[1];\n            break;\n\n          default:\n            break;\n        }\n      }, o);\n    } else throw new Error(\"Unrecognized LOTUS BOF \" + d[2]);\n\n    s[\"!ref\"] = encode_range(refguess);\n    sheets[next_n || n] = s;\n    snames.push(next_n || n);\n    if (!realnames.length) return {\n      SheetNames: snames,\n      Sheets: sheets\n    };\n    var osheets = {},\n        rnames = [];\n    /* TODO: verify no collisions */\n\n    for (var i = 0; i < realnames.length; ++i) if (sheets[snames[i]]) {\n      rnames.push(realnames[i] || snames[i]);\n      osheets[realnames[i]] = sheets[realnames[i]] || sheets[snames[i]];\n    } else {\n      rnames.push(realnames[i]);\n      osheets[realnames[i]] = {\n        \"!ref\": \"A1\"\n      };\n    }\n\n    return {\n      SheetNames: rnames,\n      Sheets: osheets\n    };\n  }\n\n  function sheet_to_wk1(ws\n  /*:Worksheet*/\n  , opts\n  /*:WriteOpts*/\n  ) {\n    var o = opts || {};\n    if (+o.codepage >= 0) set_cp(+o.codepage);\n    if (o.type == \"string\") throw new Error(\"Cannot write WK1 to JS string\");\n    var ba = buf_array();\n    var range = safe_decode_range(ws[\"!ref\"]);\n    var dense = Array.isArray(ws);\n    var cols = [];\n    write_biff_rec(ba, 0x00, write_BOF_WK1(0x0406));\n    write_biff_rec(ba, 0x06, write_RANGE(range));\n    var max_R = Math.min(range.e.r, 8191);\n\n    for (var R = range.s.r; R <= max_R; ++R) {\n      var rr = encode_row(R);\n\n      for (var C = range.s.c; C <= range.e.c; ++C) {\n        if (R === range.s.r) cols[C] = encode_col(C);\n        var ref = cols[C] + rr;\n        var cell = dense ? (ws[R] || [])[C] : ws[ref];\n        if (!cell || cell.t == \"z\") continue;\n        /* TODO: formula records */\n\n        if (cell.t == \"n\") {\n          if ((cell.v | 0) == cell.v && cell.v >= -32768 && cell.v <= 32767) write_biff_rec(ba, 0x0d, write_INTEGER(R, C, cell.v));else write_biff_rec(ba, 0x0e, write_NUMBER(R, C, cell.v));\n        } else {\n          var str = format_cell(cell);\n          write_biff_rec(ba, 0x0F, write_LABEL(R, C, str.slice(0, 239)));\n        }\n      }\n    }\n\n    write_biff_rec(ba, 0x01);\n    return ba.end();\n  }\n\n  function book_to_wk3(wb\n  /*:Workbook*/\n  , opts\n  /*:WriteOpts*/\n  ) {\n    var o = opts || {};\n    if (+o.codepage >= 0) set_cp(+o.codepage);\n    if (o.type == \"string\") throw new Error(\"Cannot write WK3 to JS string\");\n    var ba = buf_array();\n    write_biff_rec(ba, 0x00, write_BOF_WK3(wb));\n\n    for (var i = 0, cnt = 0; i < wb.SheetNames.length; ++i) if ((wb.Sheets[wb.SheetNames[i]] || {})[\"!ref\"]) write_biff_rec(ba, 0x1b, write_XFORMAT_SHEETNAME(wb.SheetNames[i], cnt++));\n\n    var wsidx = 0;\n\n    for (i = 0; i < wb.SheetNames.length; ++i) {\n      var ws = wb.Sheets[wb.SheetNames[i]];\n      if (!ws || !ws[\"!ref\"]) continue;\n      var range = safe_decode_range(ws[\"!ref\"]);\n      var dense = Array.isArray(ws);\n      var cols = [];\n      var max_R = Math.min(range.e.r, 8191);\n\n      for (var R = range.s.r; R <= max_R; ++R) {\n        var rr = encode_row(R);\n\n        for (var C = range.s.c; C <= range.e.c; ++C) {\n          if (R === range.s.r) cols[C] = encode_col(C);\n          var ref = cols[C] + rr;\n          var cell = dense ? (ws[R] || [])[C] : ws[ref];\n          if (!cell || cell.t == \"z\") continue;\n          /* TODO: FORMULA19 NUMBER18 records */\n\n          if (cell.t == \"n\") {\n            write_biff_rec(ba, 0x17, write_NUMBER_17(R, C, wsidx, cell.v));\n          } else {\n            var str = format_cell(cell);\n            /* TODO: max len? */\n\n            write_biff_rec(ba, 0x16, write_LABEL_16(R, C, wsidx, str.slice(0, 239)));\n          }\n        }\n      }\n\n      ++wsidx;\n    }\n\n    write_biff_rec(ba, 0x01);\n    return ba.end();\n  }\n\n  function write_BOF_WK1(v\n  /*:number*/\n  ) {\n    var out = new_buf(2);\n    out.write_shift(2, v);\n    return out;\n  }\n\n  function write_BOF_WK3(wb\n  /*:Workbook*/\n  ) {\n    var out = new_buf(26);\n    out.write_shift(2, 0x1000);\n    out.write_shift(2, 0x0004);\n    out.write_shift(4, 0x0000);\n    var rows = 0,\n        cols = 0,\n        wscnt = 0;\n\n    for (var i = 0; i < wb.SheetNames.length; ++i) {\n      var name = wb.SheetNames[i];\n      var ws = wb.Sheets[name];\n      if (!ws || !ws[\"!ref\"]) continue;\n      ++wscnt;\n      var range = decode_range(ws[\"!ref\"]);\n      if (rows < range.e.r) rows = range.e.r;\n      if (cols < range.e.c) cols = range.e.c;\n    }\n\n    if (rows > 8191) rows = 8191;\n    out.write_shift(2, rows);\n    out.write_shift(1, wscnt);\n    out.write_shift(1, cols);\n    out.write_shift(2, 0x00);\n    out.write_shift(2, 0x00);\n    out.write_shift(1, 0x01);\n    out.write_shift(1, 0x02);\n    out.write_shift(4, 0);\n    out.write_shift(4, 0);\n    return out;\n  }\n\n  function parse_RANGE(blob, length, opts) {\n    var o = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    };\n\n    if (length == 8 && opts.qpro) {\n      o.s.c = blob.read_shift(1);\n      blob.l++;\n      o.s.r = blob.read_shift(2);\n      o.e.c = blob.read_shift(1);\n      blob.l++;\n      o.e.r = blob.read_shift(2);\n      return o;\n    }\n\n    o.s.c = blob.read_shift(2);\n    o.s.r = blob.read_shift(2);\n    if (length == 12 && opts.qpro) blob.l += 2;\n    o.e.c = blob.read_shift(2);\n    o.e.r = blob.read_shift(2);\n    if (length == 12 && opts.qpro) blob.l += 2;\n    if (o.s.c == 0xFFFF) o.s.c = o.e.c = o.s.r = o.e.r = 0;\n    return o;\n  }\n\n  function write_RANGE(range) {\n    var out = new_buf(8);\n    out.write_shift(2, range.s.c);\n    out.write_shift(2, range.s.r);\n    out.write_shift(2, range.e.c);\n    out.write_shift(2, range.e.r);\n    return out;\n  }\n\n  function parse_cell(blob, length, opts) {\n    var o = [{\n      c: 0,\n      r: 0\n    }, {\n      t: 'n',\n      v: 0\n    }, 0, 0];\n\n    if (opts.qpro && opts.vers != 0x5120) {\n      o[0].c = blob.read_shift(1);\n      o[3] = blob.read_shift(1);\n      o[0].r = blob.read_shift(2);\n      blob.l += 2;\n    } else {\n      o[2] = blob.read_shift(1);\n      o[0].c = blob.read_shift(2);\n      o[0].r = blob.read_shift(2);\n    }\n\n    return o;\n  }\n\n  function parse_LABEL(blob, length, opts) {\n    var tgt = blob.l + length;\n    var o = parse_cell(blob, length, opts);\n    o[1].t = 's';\n\n    if (opts.vers == 0x5120) {\n      blob.l++;\n      var len = blob.read_shift(1);\n      o[1].v = blob.read_shift(len, 'utf8');\n      return o;\n    }\n\n    if (opts.qpro) blob.l++;\n    o[1].v = blob.read_shift(tgt - blob.l, 'cstr');\n    return o;\n  }\n\n  function write_LABEL(R, C, s) {\n    /* TODO: encoding */\n    var o = new_buf(7 + s.length);\n    o.write_shift(1, 0xFF);\n    o.write_shift(2, C);\n    o.write_shift(2, R);\n    o.write_shift(1, 0x27); // ??\n\n    for (var i = 0; i < o.length; ++i) {\n      var cc = s.charCodeAt(i);\n      o.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n    }\n\n    o.write_shift(1, 0);\n    return o;\n  }\n\n  function parse_INTEGER(blob, length, opts) {\n    var o = parse_cell(blob, length, opts);\n    o[1].v = blob.read_shift(2, 'i');\n    return o;\n  }\n\n  function write_INTEGER(R, C, v) {\n    var o = new_buf(7);\n    o.write_shift(1, 0xFF);\n    o.write_shift(2, C);\n    o.write_shift(2, R);\n    o.write_shift(2, v, 'i');\n    return o;\n  }\n\n  function parse_NUMBER(blob, length, opts) {\n    var o = parse_cell(blob, length, opts);\n    o[1].v = blob.read_shift(8, 'f');\n    return o;\n  }\n\n  function write_NUMBER(R, C, v) {\n    var o = new_buf(13);\n    o.write_shift(1, 0xFF);\n    o.write_shift(2, C);\n    o.write_shift(2, R);\n    o.write_shift(8, v, 'f');\n    return o;\n  }\n\n  function parse_FORMULA(blob, length, opts) {\n    var tgt = blob.l + length;\n    var o = parse_cell(blob, length, opts);\n    /* TODO: formula */\n\n    o[1].v = blob.read_shift(8, 'f');\n    if (opts.qpro) blob.l = tgt;else {\n      var flen = blob.read_shift(2);\n      wk1_fmla_to_csf(blob.slice(blob.l, blob.l + flen), o);\n      blob.l += flen;\n    }\n    return o;\n  }\n\n  function wk1_parse_rc(B, V, col) {\n    var rel = V & 0x8000;\n    V &= ~0x8000;\n    V = (rel ? B : 0) + (V >= 0x2000 ? V - 0x4000 : V);\n    return (rel ? \"\" : \"$\") + (col ? encode_col(V) : encode_row(V));\n  }\n  /* var oprec = [\n  \t8, 8, 8, 8, 8, 8, 8, 8, 6, 4, 4, 5, 5, 7, 3, 3,\n  \t3, 3, 3, 3, 1, 1, 2, 6, 8, 8, 8, 8, 8, 8, 8, 8\n  ]; */\n\n  /* TODO: flesh out */\n\n\n  var FuncTab = {\n    0x33: [\"FALSE\", 0],\n    0x34: [\"TRUE\", 0],\n    0x46: [\"LEN\", 1],\n    0x50: [\"SUM\", 69],\n    0x51: [\"AVERAGEA\", 69],\n    0x52: [\"COUNTA\", 69],\n    0x53: [\"MINA\", 69],\n    0x54: [\"MAXA\", 69],\n    0x6F: [\"T\", 1]\n  };\n  var BinOpTab = [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n  \"\", \"+\", \"-\", \"*\", \"/\", \"^\", \"=\", \"<>\", // eslint-disable-line no-mixed-spaces-and-tabs\n  \"<=\", \">=\", \"<\", \">\", \"\", \"\", \"\", \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n  \"&\", \"\", \"\", \"\", \"\", \"\", \"\", \"\" // eslint-disable-line no-mixed-spaces-and-tabs\n  ];\n\n  function wk1_fmla_to_csf(blob, o) {\n    prep_blob(blob, 0);\n    var out = [],\n        argc = 0,\n        R = \"\",\n        C = \"\",\n        argL = \"\",\n        argR = \"\";\n\n    while (blob.l < blob.length) {\n      var cc = blob[blob.l++];\n\n      switch (cc) {\n        case 0x00:\n          out.push(blob.read_shift(8, 'f'));\n          break;\n\n        case 0x01:\n          {\n            C = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n            R = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n            out.push(C + R);\n          }\n          break;\n\n        case 0x02:\n          {\n            var c = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n            var r = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n            C = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n            R = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n            out.push(c + r + \":\" + C + R);\n          }\n          break;\n\n        case 0x03:\n          if (blob.l < blob.length) {\n            console.error(\"WK1 premature formula end\");\n            return;\n          }\n\n          break;\n\n        case 0x04:\n          out.push(\"(\" + out.pop() + \")\");\n          break;\n\n        case 0x05:\n          out.push(blob.read_shift(2));\n          break;\n\n        case 0x06:\n          {\n            /* TODO: text encoding */\n            var Z = \"\";\n\n            while (cc = blob[blob.l++]) Z += String.fromCharCode(cc);\n\n            out.push('\"' + Z.replace(/\"/g, '\"\"') + '\"');\n          }\n          break;\n\n        case 0x08:\n          out.push(\"-\" + out.pop());\n          break;\n\n        case 0x17:\n          out.push(\"+\" + out.pop());\n          break;\n\n        case 0x16:\n          out.push(\"NOT(\" + out.pop() + \")\");\n          break;\n\n        case 0x14:\n        case 0x15:\n          {\n            argR = out.pop();\n            argL = out.pop();\n            out.push([\"AND\", \"OR\"][cc - 0x14] + \"(\" + argL + \",\" + argR + \")\");\n          }\n          break;\n\n        default:\n          if (cc < 0x20 && BinOpTab[cc]) {\n            argR = out.pop();\n            argL = out.pop();\n            out.push(argL + BinOpTab[cc] + argR);\n          } else if (FuncTab[cc]) {\n            argc = FuncTab[cc][1];\n            if (argc == 69) argc = blob[blob.l++];\n\n            if (argc > out.length) {\n              console.error(\"WK1 bad formula parse 0x\" + cc.toString(16) + \":|\" + out.join(\"|\") + \"|\");\n              return;\n            }\n\n            var args = out.slice(-argc);\n            out.length -= argc;\n            out.push(FuncTab[cc][0] + \"(\" + args.join(\",\") + \")\");\n          } else if (cc <= 0x07) return console.error(\"WK1 invalid opcode \" + cc.toString(16));else if (cc <= 0x18) return console.error(\"WK1 unsupported op \" + cc.toString(16));else if (cc <= 0x1E) return console.error(\"WK1 invalid opcode \" + cc.toString(16));else if (cc <= 0x73) return console.error(\"WK1 unsupported function opcode \" + cc.toString(16)); // possible future functions ??\n          else return console.error(\"WK1 unrecognized opcode \" + cc.toString(16));\n\n      }\n    }\n\n    if (out.length == 1) o[1].f = \"\" + out[0];else console.error(\"WK1 bad formula parse |\" + out.join(\"|\") + \"|\");\n  }\n\n  function parse_cell_3(blob\n  /*::, length*/\n  ) {\n    var o = [{\n      c: 0,\n      r: 0\n    }, {\n      t: 'n',\n      v: 0\n    }, 0];\n    o[0].r = blob.read_shift(2);\n    o[3] = blob[blob.l++];\n    o[0].c = blob[blob.l++];\n    return o;\n  }\n\n  function parse_LABEL_16(blob, length) {\n    var o = parse_cell_3(blob, length);\n    o[1].t = 's';\n    o[1].v = blob.read_shift(length - 4, 'cstr');\n    return o;\n  }\n\n  function write_LABEL_16(R, C, wsidx, s) {\n    /* TODO: encoding */\n    var o = new_buf(6 + s.length);\n    o.write_shift(2, R);\n    o.write_shift(1, wsidx);\n    o.write_shift(1, C);\n    o.write_shift(1, 0x27);\n\n    for (var i = 0; i < s.length; ++i) {\n      var cc = s.charCodeAt(i);\n      o.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n    }\n\n    o.write_shift(1, 0);\n    return o;\n  }\n\n  function parse_NUMBER_18(blob, length) {\n    var o = parse_cell_3(blob, length);\n    o[1].v = blob.read_shift(2);\n    var v = o[1].v >> 1;\n\n    if (o[1].v & 0x1) {\n      switch (v & 0x07) {\n        case 0:\n          v = (v >> 3) * 5000;\n          break;\n\n        case 1:\n          v = (v >> 3) * 500;\n          break;\n\n        case 2:\n          v = (v >> 3) / 20;\n          break;\n\n        case 3:\n          v = (v >> 3) / 200;\n          break;\n\n        case 4:\n          v = (v >> 3) / 2000;\n          break;\n\n        case 5:\n          v = (v >> 3) / 20000;\n          break;\n\n        case 6:\n          v = (v >> 3) / 16;\n          break;\n\n        case 7:\n          v = (v >> 3) / 64;\n          break;\n      }\n    }\n\n    o[1].v = v;\n    return o;\n  }\n\n  function parse_NUMBER_17(blob, length) {\n    var o = parse_cell_3(blob, length);\n    var v1 = blob.read_shift(4);\n    var v2 = blob.read_shift(4);\n    var e = blob.read_shift(2);\n\n    if (e == 0xFFFF) {\n      if (v1 === 0 && v2 === 0xC0000000) {\n        o[1].t = \"e\";\n        o[1].v = 0x0F;\n      } // ERR -> #VALUE!\n      else if (v1 === 0 && v2 === 0xD0000000) {\n        o[1].t = \"e\";\n        o[1].v = 0x2A;\n      } // NA -> #N/A\n      else o[1].v = 0;\n\n      return o;\n    }\n\n    var s = e & 0x8000;\n    e = (e & 0x7FFF) - 16446;\n    o[1].v = (1 - s * 2) * (v2 * Math.pow(2, e + 32) + v1 * Math.pow(2, e));\n    return o;\n  }\n\n  function write_NUMBER_17(R, C, wsidx, v) {\n    var o = new_buf(14);\n    o.write_shift(2, R);\n    o.write_shift(1, wsidx);\n    o.write_shift(1, C);\n\n    if (v == 0) {\n      o.write_shift(4, 0);\n      o.write_shift(4, 0);\n      o.write_shift(2, 0xFFFF);\n      return o;\n    }\n\n    var s = 0,\n        e = 0,\n        v1 = 0,\n        v2 = 0;\n\n    if (v < 0) {\n      s = 1;\n      v = -v;\n    }\n\n    e = Math.log2(v) | 0;\n    v /= Math.pow(2, e - 31);\n    v2 = v >>> 0;\n\n    if ((v2 & 0x80000000) == 0) {\n      v /= 2;\n      ++e;\n      v2 = v >>> 0;\n    }\n\n    v -= v2;\n    v2 |= 0x80000000;\n    v2 >>>= 0;\n    v *= Math.pow(2, 32);\n    v1 = v >>> 0;\n    o.write_shift(4, v1);\n    o.write_shift(4, v2);\n    e += 0x3FFF + (s ? 0x8000 : 0);\n    o.write_shift(2, e);\n    return o;\n  }\n\n  function parse_FORMULA_19(blob, length) {\n    var o = parse_NUMBER_17(blob, 14);\n    blob.l += length - 14;\n    /* TODO: WK3 formula */\n\n    return o;\n  }\n\n  function parse_NUMBER_25(blob, length) {\n    var o = parse_cell_3(blob, length);\n    var v1 = blob.read_shift(4);\n    o[1].v = v1 >> 6;\n    return o;\n  }\n\n  function parse_NUMBER_27(blob, length) {\n    var o = parse_cell_3(blob, length);\n    var v1 = blob.read_shift(8, 'f');\n    o[1].v = v1;\n    return o;\n  }\n\n  function parse_FORMULA_28(blob, length) {\n    var o = parse_NUMBER_27(blob, 14);\n    blob.l += length - 10;\n    /* TODO: formula */\n\n    return o;\n  }\n\n  function parse_SHEETNAMECS(blob, length) {\n    return blob[blob.l + length - 1] == 0 ? blob.read_shift(length, 'cstr') : \"\";\n  }\n\n  function parse_SHEETNAMELP(blob, length) {\n    var len = blob[blob.l++];\n    if (len > length - 1) len = length - 1;\n    var o = \"\";\n\n    while (o.length < len) o += String.fromCharCode(blob[blob.l++]);\n\n    return o;\n  }\n\n  function parse_SHEETINFOQP(blob, length, opts) {\n    if (!opts.qpro || length < 21) return;\n    var id = blob.read_shift(1);\n    blob.l += 17;\n    blob.l += 1; //var len = blob.read_shift(1);\n\n    blob.l += 2;\n    var nm = blob.read_shift(length - 21, 'cstr');\n    return [id, nm];\n  }\n\n  function parse_XFORMAT(blob, length) {\n    var o = {},\n        tgt = blob.l + length;\n\n    while (blob.l < tgt) {\n      var dt = blob.read_shift(2);\n\n      if (dt == 0x36b0) {\n        o[dt] = [0, \"\"];\n        o[dt][0] = blob.read_shift(2);\n\n        while (blob[blob.l]) {\n          o[dt][1] += String.fromCharCode(blob[blob.l]);\n          blob.l++;\n        }\n\n        blob.l++;\n      } // TODO: 0x3a99 ??\n\n    }\n\n    return o;\n  }\n\n  function write_XFORMAT_SHEETNAME(name, wsidx) {\n    var out = new_buf(5 + name.length);\n    out.write_shift(2, 0x36b0);\n    out.write_shift(2, wsidx);\n\n    for (var i = 0; i < name.length; ++i) {\n      var cc = name.charCodeAt(i);\n      out[out.l++] = cc > 0x7F ? 0x5F : cc;\n    }\n\n    out[out.l++] = 0;\n    return out;\n  }\n\n  var WK1Enum = {\n    /*::[*/\n    0x0000\n    /*::]*/\n    : {\n      n: \"BOF\",\n      f: parseuint16\n    },\n\n    /*::[*/\n    0x0001\n    /*::]*/\n    : {\n      n: \"EOF\"\n    },\n\n    /*::[*/\n    0x0002\n    /*::]*/\n    : {\n      n: \"CALCMODE\"\n    },\n\n    /*::[*/\n    0x0003\n    /*::]*/\n    : {\n      n: \"CALCORDER\"\n    },\n\n    /*::[*/\n    0x0004\n    /*::]*/\n    : {\n      n: \"SPLIT\"\n    },\n\n    /*::[*/\n    0x0005\n    /*::]*/\n    : {\n      n: \"SYNC\"\n    },\n\n    /*::[*/\n    0x0006\n    /*::]*/\n    : {\n      n: \"RANGE\",\n      f: parse_RANGE\n    },\n\n    /*::[*/\n    0x0007\n    /*::]*/\n    : {\n      n: \"WINDOW1\"\n    },\n\n    /*::[*/\n    0x0008\n    /*::]*/\n    : {\n      n: \"COLW1\"\n    },\n\n    /*::[*/\n    0x0009\n    /*::]*/\n    : {\n      n: \"WINTWO\"\n    },\n\n    /*::[*/\n    0x000A\n    /*::]*/\n    : {\n      n: \"COLW2\"\n    },\n\n    /*::[*/\n    0x000B\n    /*::]*/\n    : {\n      n: \"NAME\"\n    },\n\n    /*::[*/\n    0x000C\n    /*::]*/\n    : {\n      n: \"BLANK\"\n    },\n\n    /*::[*/\n    0x000D\n    /*::]*/\n    : {\n      n: \"INTEGER\",\n      f: parse_INTEGER\n    },\n\n    /*::[*/\n    0x000E\n    /*::]*/\n    : {\n      n: \"NUMBER\",\n      f: parse_NUMBER\n    },\n\n    /*::[*/\n    0x000F\n    /*::]*/\n    : {\n      n: \"LABEL\",\n      f: parse_LABEL\n    },\n\n    /*::[*/\n    0x0010\n    /*::]*/\n    : {\n      n: \"FORMULA\",\n      f: parse_FORMULA\n    },\n\n    /*::[*/\n    0x0018\n    /*::]*/\n    : {\n      n: \"TABLE\"\n    },\n\n    /*::[*/\n    0x0019\n    /*::]*/\n    : {\n      n: \"ORANGE\"\n    },\n\n    /*::[*/\n    0x001A\n    /*::]*/\n    : {\n      n: \"PRANGE\"\n    },\n\n    /*::[*/\n    0x001B\n    /*::]*/\n    : {\n      n: \"SRANGE\"\n    },\n\n    /*::[*/\n    0x001C\n    /*::]*/\n    : {\n      n: \"FRANGE\"\n    },\n\n    /*::[*/\n    0x001D\n    /*::]*/\n    : {\n      n: \"KRANGE1\"\n    },\n\n    /*::[*/\n    0x0020\n    /*::]*/\n    : {\n      n: \"HRANGE\"\n    },\n\n    /*::[*/\n    0x0023\n    /*::]*/\n    : {\n      n: \"KRANGE2\"\n    },\n\n    /*::[*/\n    0x0024\n    /*::]*/\n    : {\n      n: \"PROTEC\"\n    },\n\n    /*::[*/\n    0x0025\n    /*::]*/\n    : {\n      n: \"FOOTER\"\n    },\n\n    /*::[*/\n    0x0026\n    /*::]*/\n    : {\n      n: \"HEADER\"\n    },\n\n    /*::[*/\n    0x0027\n    /*::]*/\n    : {\n      n: \"SETUP\"\n    },\n\n    /*::[*/\n    0x0028\n    /*::]*/\n    : {\n      n: \"MARGINS\"\n    },\n\n    /*::[*/\n    0x0029\n    /*::]*/\n    : {\n      n: \"LABELFMT\"\n    },\n\n    /*::[*/\n    0x002A\n    /*::]*/\n    : {\n      n: \"TITLES\"\n    },\n\n    /*::[*/\n    0x002B\n    /*::]*/\n    : {\n      n: \"SHEETJS\"\n    },\n\n    /*::[*/\n    0x002D\n    /*::]*/\n    : {\n      n: \"GRAPH\"\n    },\n\n    /*::[*/\n    0x002E\n    /*::]*/\n    : {\n      n: \"NGRAPH\"\n    },\n\n    /*::[*/\n    0x002F\n    /*::]*/\n    : {\n      n: \"CALCCOUNT\"\n    },\n\n    /*::[*/\n    0x0030\n    /*::]*/\n    : {\n      n: \"UNFORMATTED\"\n    },\n\n    /*::[*/\n    0x0031\n    /*::]*/\n    : {\n      n: \"CURSORW12\"\n    },\n\n    /*::[*/\n    0x0032\n    /*::]*/\n    : {\n      n: \"WINDOW\"\n    },\n\n    /*::[*/\n    0x0033\n    /*::]*/\n    : {\n      n: \"STRING\",\n      f: parse_LABEL\n    },\n\n    /*::[*/\n    0x0037\n    /*::]*/\n    : {\n      n: \"PASSWORD\"\n    },\n\n    /*::[*/\n    0x0038\n    /*::]*/\n    : {\n      n: \"LOCKED\"\n    },\n\n    /*::[*/\n    0x003C\n    /*::]*/\n    : {\n      n: \"QUERY\"\n    },\n\n    /*::[*/\n    0x003D\n    /*::]*/\n    : {\n      n: \"QUERYNAME\"\n    },\n\n    /*::[*/\n    0x003E\n    /*::]*/\n    : {\n      n: \"PRINT\"\n    },\n\n    /*::[*/\n    0x003F\n    /*::]*/\n    : {\n      n: \"PRINTNAME\"\n    },\n\n    /*::[*/\n    0x0040\n    /*::]*/\n    : {\n      n: \"GRAPH2\"\n    },\n\n    /*::[*/\n    0x0041\n    /*::]*/\n    : {\n      n: \"GRAPHNAME\"\n    },\n\n    /*::[*/\n    0x0042\n    /*::]*/\n    : {\n      n: \"ZOOM\"\n    },\n\n    /*::[*/\n    0x0043\n    /*::]*/\n    : {\n      n: \"SYMSPLIT\"\n    },\n\n    /*::[*/\n    0x0044\n    /*::]*/\n    : {\n      n: \"NSROWS\"\n    },\n\n    /*::[*/\n    0x0045\n    /*::]*/\n    : {\n      n: \"NSCOLS\"\n    },\n\n    /*::[*/\n    0x0046\n    /*::]*/\n    : {\n      n: \"RULER\"\n    },\n\n    /*::[*/\n    0x0047\n    /*::]*/\n    : {\n      n: \"NNAME\"\n    },\n\n    /*::[*/\n    0x0048\n    /*::]*/\n    : {\n      n: \"ACOMM\"\n    },\n\n    /*::[*/\n    0x0049\n    /*::]*/\n    : {\n      n: \"AMACRO\"\n    },\n\n    /*::[*/\n    0x004A\n    /*::]*/\n    : {\n      n: \"PARSE\"\n    },\n\n    /*::[*/\n    0x0066\n    /*::]*/\n    : {\n      n: \"PRANGES??\"\n    },\n\n    /*::[*/\n    0x0067\n    /*::]*/\n    : {\n      n: \"RRANGES??\"\n    },\n\n    /*::[*/\n    0x0068\n    /*::]*/\n    : {\n      n: \"FNAME??\"\n    },\n\n    /*::[*/\n    0x0069\n    /*::]*/\n    : {\n      n: \"MRANGES??\"\n    },\n\n    /*::[*/\n    0x00CC\n    /*::]*/\n    : {\n      n: \"SHEETNAMECS\",\n      f: parse_SHEETNAMECS\n    },\n\n    /*::[*/\n    0x00DE\n    /*::]*/\n    : {\n      n: \"SHEETNAMELP\",\n      f: parse_SHEETNAMELP\n    },\n\n    /*::[*/\n    0xFFFF\n    /*::]*/\n    : {\n      n: \"\"\n    }\n  };\n  var WK3Enum = {\n    /*::[*/\n    0x0000\n    /*::]*/\n    : {\n      n: \"BOF\"\n    },\n\n    /*::[*/\n    0x0001\n    /*::]*/\n    : {\n      n: \"EOF\"\n    },\n\n    /*::[*/\n    0x0002\n    /*::]*/\n    : {\n      n: \"PASSWORD\"\n    },\n\n    /*::[*/\n    0x0003\n    /*::]*/\n    : {\n      n: \"CALCSET\"\n    },\n\n    /*::[*/\n    0x0004\n    /*::]*/\n    : {\n      n: \"WINDOWSET\"\n    },\n\n    /*::[*/\n    0x0005\n    /*::]*/\n    : {\n      n: \"SHEETCELLPTR\"\n    },\n\n    /*::[*/\n    0x0006\n    /*::]*/\n    : {\n      n: \"SHEETLAYOUT\"\n    },\n\n    /*::[*/\n    0x0007\n    /*::]*/\n    : {\n      n: \"COLUMNWIDTH\"\n    },\n\n    /*::[*/\n    0x0008\n    /*::]*/\n    : {\n      n: \"HIDDENCOLUMN\"\n    },\n\n    /*::[*/\n    0x0009\n    /*::]*/\n    : {\n      n: \"USERRANGE\"\n    },\n\n    /*::[*/\n    0x000A\n    /*::]*/\n    : {\n      n: \"SYSTEMRANGE\"\n    },\n\n    /*::[*/\n    0x000B\n    /*::]*/\n    : {\n      n: \"ZEROFORCE\"\n    },\n\n    /*::[*/\n    0x000C\n    /*::]*/\n    : {\n      n: \"SORTKEYDIR\"\n    },\n\n    /*::[*/\n    0x000D\n    /*::]*/\n    : {\n      n: \"FILESEAL\"\n    },\n\n    /*::[*/\n    0x000E\n    /*::]*/\n    : {\n      n: \"DATAFILLNUMS\"\n    },\n\n    /*::[*/\n    0x000F\n    /*::]*/\n    : {\n      n: \"PRINTMAIN\"\n    },\n\n    /*::[*/\n    0x0010\n    /*::]*/\n    : {\n      n: \"PRINTSTRING\"\n    },\n\n    /*::[*/\n    0x0011\n    /*::]*/\n    : {\n      n: \"GRAPHMAIN\"\n    },\n\n    /*::[*/\n    0x0012\n    /*::]*/\n    : {\n      n: \"GRAPHSTRING\"\n    },\n\n    /*::[*/\n    0x0013\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0014\n    /*::]*/\n    : {\n      n: \"ERRCELL\"\n    },\n\n    /*::[*/\n    0x0015\n    /*::]*/\n    : {\n      n: \"NACELL\"\n    },\n\n    /*::[*/\n    0x0016\n    /*::]*/\n    : {\n      n: \"LABEL16\",\n      f: parse_LABEL_16\n    },\n\n    /*::[*/\n    0x0017\n    /*::]*/\n    : {\n      n: \"NUMBER17\",\n      f: parse_NUMBER_17\n    },\n\n    /*::[*/\n    0x0018\n    /*::]*/\n    : {\n      n: \"NUMBER18\",\n      f: parse_NUMBER_18\n    },\n\n    /*::[*/\n    0x0019\n    /*::]*/\n    : {\n      n: \"FORMULA19\",\n      f: parse_FORMULA_19\n    },\n\n    /*::[*/\n    0x001A\n    /*::]*/\n    : {\n      n: \"FORMULA1A\"\n    },\n\n    /*::[*/\n    0x001B\n    /*::]*/\n    : {\n      n: \"XFORMAT\",\n      f: parse_XFORMAT\n    },\n\n    /*::[*/\n    0x001C\n    /*::]*/\n    : {\n      n: \"DTLABELMISC\"\n    },\n\n    /*::[*/\n    0x001D\n    /*::]*/\n    : {\n      n: \"DTLABELCELL\"\n    },\n\n    /*::[*/\n    0x001E\n    /*::]*/\n    : {\n      n: \"GRAPHWINDOW\"\n    },\n\n    /*::[*/\n    0x001F\n    /*::]*/\n    : {\n      n: \"CPA\"\n    },\n\n    /*::[*/\n    0x0020\n    /*::]*/\n    : {\n      n: \"LPLAUTO\"\n    },\n\n    /*::[*/\n    0x0021\n    /*::]*/\n    : {\n      n: \"QUERY\"\n    },\n\n    /*::[*/\n    0x0022\n    /*::]*/\n    : {\n      n: \"HIDDENSHEET\"\n    },\n\n    /*::[*/\n    0x0023\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0025\n    /*::]*/\n    : {\n      n: \"NUMBER25\",\n      f: parse_NUMBER_25\n    },\n\n    /*::[*/\n    0x0026\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0027\n    /*::]*/\n    : {\n      n: \"NUMBER27\",\n      f: parse_NUMBER_27\n    },\n\n    /*::[*/\n    0x0028\n    /*::]*/\n    : {\n      n: \"FORMULA28\",\n      f: parse_FORMULA_28\n    },\n\n    /*::[*/\n    0x008E\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0093\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0096\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0097\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0098\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0099\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x009A\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x009B\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x009C\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00A3\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00AE\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00AF\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00B0\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00B1\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00B8\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00B9\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00BA\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00BB\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00BC\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00C3\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00C9\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00CC\n    /*::]*/\n    : {\n      n: \"SHEETNAMECS\",\n      f: parse_SHEETNAMECS\n    },\n\n    /*::[*/\n    0x00CD\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00CE\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00CF\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x00D0\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0100\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0103\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0104\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0105\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0106\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0107\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0109\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010A\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010B\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010C\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010E\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x010F\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0180\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0185\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0186\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0189\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x018C\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0200\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0202\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0201\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0204\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0205\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0280\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0281\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0282\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0283\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0284\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0285\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0286\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0287\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0288\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0292\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0293\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0294\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0295\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0296\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0299\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x029A\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0300\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0304\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0601\n    /*::]*/\n    : {\n      n: \"SHEETINFOQP\",\n      f: parse_SHEETINFOQP\n    },\n\n    /*::[*/\n    0x0640\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0642\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0701\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0702\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0703\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0704\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0780\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0800\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0801\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0804\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x0A80\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x2AF6\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x3231\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x6E49\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0x6F44\n    /*::]*/\n    : {\n      n: \"??\"\n    },\n\n    /*::[*/\n    0xFFFF\n    /*::]*/\n    : {\n      n: \"\"\n    }\n  };\n  return {\n    sheet_to_wk1: sheet_to_wk1,\n    book_to_wk3: book_to_wk3,\n    to_workbook: lotus_to_workbook\n  };\n}();\n/* 18.4.7 rPr CT_RPrElt */\n\n\nfunction parse_rpr(rpr) {\n  var font = {},\n      m = rpr.match(tagregex),\n      i = 0;\n  var pass = false;\n  if (m) for (; i != m.length; ++i) {\n    var y = parsexmltag(m[i]);\n\n    switch (y[0].replace(/\\w*:/g, \"\")) {\n      /* 18.8.12 condense CT_BooleanProperty */\n\n      /* ** not required . */\n      case '<condense':\n        break;\n\n      /* 18.8.17 extend CT_BooleanProperty */\n\n      /* ** not required . */\n\n      case '<extend':\n        break;\n\n      /* 18.8.36 shadow CT_BooleanProperty */\n\n      /* ** not required . */\n\n      case '<shadow':\n        if (!y.val) break;\n\n      /* falls through */\n\n      case '<shadow>':\n      case '<shadow/>':\n        font.shadow = 1;\n        break;\n\n      case '</shadow>':\n        break;\n\n      /* 18.4.1 charset CT_IntProperty TODO */\n\n      case '<charset':\n        if (y.val == '1') break;\n        font.cp = CS2CP[parseInt(y.val, 10)];\n        break;\n\n      /* 18.4.2 outline CT_BooleanProperty TODO */\n\n      case '<outline':\n        if (!y.val) break;\n\n      /* falls through */\n\n      case '<outline>':\n      case '<outline/>':\n        font.outline = 1;\n        break;\n\n      case '</outline>':\n        break;\n\n      /* 18.4.5 rFont CT_FontName */\n\n      case '<rFont':\n        font.name = y.val;\n        break;\n\n      /* 18.4.11 sz CT_FontSize */\n\n      case '<sz':\n        font.sz = y.val;\n        break;\n\n      /* 18.4.10 strike CT_BooleanProperty */\n\n      case '<strike':\n        if (!y.val) break;\n\n      /* falls through */\n\n      case '<strike>':\n      case '<strike/>':\n        font.strike = 1;\n        break;\n\n      case '</strike>':\n        break;\n\n      /* 18.4.13 u CT_UnderlineProperty */\n\n      case '<u':\n        if (!y.val) break;\n\n        switch (y.val) {\n          case 'double':\n            font.uval = \"double\";\n            break;\n\n          case 'singleAccounting':\n            font.uval = \"single-accounting\";\n            break;\n\n          case 'doubleAccounting':\n            font.uval = \"double-accounting\";\n            break;\n        }\n\n      /* falls through */\n\n      case '<u>':\n      case '<u/>':\n        font.u = 1;\n        break;\n\n      case '</u>':\n        break;\n\n      /* 18.8.2 b */\n\n      case '<b':\n        if (y.val == '0') break;\n\n      /* falls through */\n\n      case '<b>':\n      case '<b/>':\n        font.b = 1;\n        break;\n\n      case '</b>':\n        break;\n\n      /* 18.8.26 i */\n\n      case '<i':\n        if (y.val == '0') break;\n\n      /* falls through */\n\n      case '<i>':\n      case '<i/>':\n        font.i = 1;\n        break;\n\n      case '</i>':\n        break;\n\n      /* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n\n      case '<color':\n        if (y.rgb) font.color = y.rgb.slice(2, 8);\n        break;\n\n      case '<color>':\n      case '<color/>':\n      case '</color>':\n        break;\n\n      /* 18.8.18 family ST_FontFamily */\n\n      case '<family':\n        font.family = y.val;\n        break;\n\n      case '<family>':\n      case '<family/>':\n      case '</family>':\n        break;\n\n      /* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n\n      case '<vertAlign':\n        font.valign = y.val;\n        break;\n\n      case '<vertAlign>':\n      case '<vertAlign/>':\n      case '</vertAlign>':\n        break;\n\n      /* 18.8.35 scheme CT_FontScheme TODO */\n\n      case '<scheme':\n        break;\n\n      case '<scheme>':\n      case '<scheme/>':\n      case '</scheme>':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (y[0].charCodeAt(1) !== 47 && !pass) throw new Error('Unrecognized rich format ' + y[0]);\n    }\n  }\n  return font;\n}\n\nvar parse_rs = /*#__PURE__*/function () {\n  var tregex = matchtag(\"t\"),\n      rpregex = matchtag(\"rPr\");\n  /* 18.4.4 r CT_RElt */\n\n  function parse_r(r) {\n    /* 18.4.12 t ST_Xstring */\n    var t = r.match(tregex)\n    /*, cp = 65001*/\n    ;\n    if (!t) return {\n      t: \"s\",\n      v: \"\"\n    };\n    var o\n    /*:Cell*/\n    = {\n      t: 's',\n      v: unescapexml(t[1])\n    }\n    /*:any*/\n    ;\n    var rpr = r.match(rpregex);\n    if (rpr) o.s = parse_rpr(rpr[1]);\n    return o;\n  }\n\n  var rregex = /<(?:\\w+:)?r>/g,\n      rend = /<\\/(?:\\w+:)?r>/;\n  return function parse_rs(rs) {\n    return rs.replace(rregex, \"\").split(rend).map(parse_r).filter(function (r) {\n      return r.v;\n    });\n  };\n}();\n/* Parse a list of <r> tags */\n\n\nvar rs_to_html = /*#__PURE__*/function parse_rs_factory() {\n  var nlregex = /(\\r\\n|\\n)/g;\n\n  function parse_rpr2(font, intro, outro) {\n    var style\n    /*:Array<string>*/\n    = [];\n    if (font.u) style.push(\"text-decoration: underline;\");\n    if (font.uval) style.push(\"text-underline-style:\" + font.uval + \";\");\n    if (font.sz) style.push(\"font-size:\" + font.sz + \"pt;\");\n    if (font.outline) style.push(\"text-effect: outline;\");\n    if (font.shadow) style.push(\"text-shadow: auto;\");\n    intro.push('<span style=\"' + style.join(\"\") + '\">');\n\n    if (font.b) {\n      intro.push(\"<b>\");\n      outro.push(\"</b>\");\n    }\n\n    if (font.i) {\n      intro.push(\"<i>\");\n      outro.push(\"</i>\");\n    }\n\n    if (font.strike) {\n      intro.push(\"<s>\");\n      outro.push(\"</s>\");\n    }\n\n    var align = font.valign || \"\";\n    if (align == \"superscript\" || align == \"super\") align = \"sup\";else if (align == \"subscript\") align = \"sub\";\n\n    if (align != \"\") {\n      intro.push(\"<\" + align + \">\");\n      outro.push(\"</\" + align + \">\");\n    }\n\n    outro.push(\"</span>\");\n    return font;\n  }\n  /* 18.4.4 r CT_RElt */\n\n\n  function r_to_html(r) {\n    var terms\n    /*:[Array<string>, string, Array<string>]*/\n    = [[], r.v, []];\n    if (!r.v) return \"\";\n    if (r.s) parse_rpr2(r.s, terms[0], terms[2]);\n    return terms[0].join(\"\") + terms[1].replace(nlregex, '<br/>') + terms[2].join(\"\");\n  }\n\n  return function parse_rs(rs) {\n    return rs.map(r_to_html).join(\"\");\n  };\n}();\n/* 18.4.8 si CT_Rst */\n\n\nvar sitregex = /<(?:\\w+:)?t[^>]*>([^<]*)<\\/(?:\\w+:)?t>/g,\n    sirregex = /<(?:\\w+:)?r>/;\nvar sirphregex = /<(?:\\w+:)?rPh.*?>([\\s\\S]*?)<\\/(?:\\w+:)?rPh>/g;\n\nfunction parse_si(x, opts) {\n  var html = opts ? opts.cellHTML : true;\n  var z = {};\n  if (!x) return {\n    t: \"\"\n  }; //var y;\n\n  /* 18.4.12 t ST_Xstring (Plaintext String) */\n  // TODO: is whitespace actually valid here?\n\n  if (x.match(/^\\s*<(?:\\w+:)?t[^>]*>/)) {\n    z.t = unescapexml(utf8read(x.slice(x.indexOf(\">\") + 1).split(/<\\/(?:\\w+:)?t>/)[0] || \"\"));\n    z.r = utf8read(x);\n    if (html) z.h = escapehtml(z.t);\n  }\n  /* 18.4.4 r CT_RElt (Rich Text Run) */\n  else if (\n  /*y = */\n  x.match(sirregex)) {\n    z.r = utf8read(x);\n    z.t = unescapexml(utf8read((x.replace(sirphregex, '').match(sitregex) || []).join(\"\").replace(tagregex, \"\")));\n    if (html) z.h = rs_to_html(parse_rs(z.r));\n  }\n  /* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n\n  /* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n\n\n  return z;\n}\n/* 18.4 Shared String Table */\n\n\nvar sstr0 = /<(?:\\w+:)?sst([^>]*)>([\\s\\S]*)<\\/(?:\\w+:)?sst>/;\nvar sstr1 = /<(?:\\w+:)?(?:si|sstItem)>/g;\nvar sstr2 = /<\\/(?:\\w+:)?(?:si|sstItem)>/;\n\nfunction parse_sst_xml(data\n/*:string*/\n, opts)\n/*:SST*/\n{\n  var s\n  /*:SST*/\n  = []\n  /*:any*/\n  ,\n      ss = \"\";\n  if (!data) return s;\n  /* 18.4.9 sst CT_Sst */\n\n  var sst = data.match(sstr0);\n\n  if (sst) {\n    ss = sst[2].replace(sstr1, \"\").split(sstr2);\n\n    for (var i = 0; i != ss.length; ++i) {\n      var o = parse_si(ss[i].trim(), opts);\n      if (o != null) s[s.length] = o;\n    }\n\n    sst = parsexmltag(sst[1]);\n    s.Count = sst.count;\n    s.Unique = sst.uniqueCount;\n  }\n\n  return s;\n}\n\nvar straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\n\nfunction write_sst_xml(sst\n/*:SST*/\n, opts)\n/*:string*/\n{\n  if (!opts.bookSST) return \"\";\n  var o = [XML_HEADER];\n  o[o.length] = writextag('sst', null, {\n    xmlns: XMLNS_main[0],\n    count: sst.Count,\n    uniqueCount: sst.Unique\n  });\n\n  for (var i = 0; i != sst.length; ++i) {\n    if (sst[i] == null) continue;\n    var s\n    /*:XLString*/\n    = sst[i];\n    var sitag = \"<si>\";\n    if (s.r) sitag += s.r;else {\n      sitag += \"<t\";\n      if (!s.t) s.t = \"\";\n      if (s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n      sitag += \">\" + escapexml(s.t) + \"</t>\";\n    }\n    sitag += \"</si>\";\n    o[o.length] = sitag;\n  }\n\n  if (o.length > 2) {\n    o[o.length] = '</sst>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* [MS-XLSB] 2.4.221 BrtBeginSst */\n\n\nfunction parse_BrtBeginSst(data) {\n  return [data.read_shift(4), data.read_shift(4)];\n}\n/* [MS-XLSB] 2.1.7.45 Shared Strings */\n\n\nfunction parse_sst_bin(data, opts)\n/*:SST*/\n{\n  var s\n  /*:SST*/\n  = []\n  /*:any*/\n  ;\n  var pass = false;\n  recordhopper(data, function hopper_sst(val, R, RT) {\n    switch (RT) {\n      case 0x009F:\n        /* BrtBeginSst */\n        s.Count = val[0];\n        s.Unique = val[1];\n        break;\n\n      case 0x0013:\n        /* BrtSSTItem */\n        s.push(val);\n        break;\n\n      case 0x00A0:\n        /* BrtEndSst */\n        return true;\n\n      case 0x0023:\n        /* BrtFRTBegin */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* BrtFRTEnd */\n        pass = false;\n        break;\n\n      default:\n        if (R.T) {}\n\n        if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return s;\n}\n\nfunction write_BrtBeginSst(sst, o) {\n  if (!o) o = new_buf(8);\n  o.write_shift(4, sst.Count);\n  o.write_shift(4, sst.Unique);\n  return o;\n}\n\nvar write_BrtSSTItem = write_RichStr;\n\nfunction write_sst_bin(sst\n/*::, opts*/\n) {\n  var ba = buf_array();\n  write_record(ba, 0x009F\n  /* BrtBeginSst */\n  , write_BrtBeginSst(sst));\n\n  for (var i = 0; i < sst.length; ++i) write_record(ba, 0x0013\n  /* BrtSSTItem */\n  , write_BrtSSTItem(sst[i]));\n  /* FRTSST */\n\n\n  write_record(ba, 0x00A0\n  /* BrtEndSst */\n  );\n  return ba.end();\n}\n\nfunction _JS2ANSI(str\n/*:string*/\n)\n/*:Array<number>*/\n{\n  if (typeof $cptable !== 'undefined') return $cptable.utils.encode(current_ansi, str);\n  var o\n  /*:Array<number>*/\n  = [],\n      oo = str.split(\"\");\n\n  for (var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);\n\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.4 Version */\n\n\nfunction parse_CRYPTOVersion(blob, length\n/*:?number*/\n) {\n  var o\n  /*:any*/\n  = {};\n  o.Major = blob.read_shift(2);\n  o.Minor = blob.read_shift(2);\n  /*:: if(length == null) return o; */\n\n  if (length >= 4) blob.l += length - 4;\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.5 DataSpaceVersionInfo */\n\n\nfunction parse_DataSpaceVersionInfo(blob) {\n  var o = {};\n  o.id = blob.read_shift(0, 'lpp4');\n  o.R = parse_CRYPTOVersion(blob, 4);\n  o.U = parse_CRYPTOVersion(blob, 4);\n  o.W = parse_CRYPTOVersion(blob, 4);\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.6.1 DataSpaceMapEntry Structure */\n\n\nfunction parse_DataSpaceMapEntry(blob) {\n  var len = blob.read_shift(4);\n  var end = blob.l + len - 4;\n  var o = {};\n  var cnt = blob.read_shift(4);\n  var comps\n  /*:Array<{t:number, v:string}>*/\n  = [];\n  /* [MS-OFFCRYPTO] 2.1.6.2 DataSpaceReferenceComponent Structure */\n\n  while (cnt-- > 0) comps.push({\n    t: blob.read_shift(4),\n    v: blob.read_shift(0, 'lpp4')\n  });\n\n  o.name = blob.read_shift(0, 'lpp4');\n  o.comps = comps;\n  if (blob.l != end) throw new Error(\"Bad DataSpaceMapEntry: \" + blob.l + \" != \" + end);\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.6 DataSpaceMap */\n\n\nfunction parse_DataSpaceMap(blob) {\n  var o = [];\n  blob.l += 4; // must be 0x8\n\n  var cnt = blob.read_shift(4);\n\n  while (cnt-- > 0) o.push(parse_DataSpaceMapEntry(blob));\n\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.7 DataSpaceDefinition */\n\n\nfunction parse_DataSpaceDefinition(blob)\n/*:Array<string>*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n  blob.l += 4; // must be 0x8\n\n  var cnt = blob.read_shift(4);\n\n  while (cnt-- > 0) o.push(blob.read_shift(0, 'lpp4'));\n\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.1.8 DataSpaceDefinition */\n\n\nfunction parse_TransformInfoHeader(blob) {\n  var o = {};\n  /*var len = */\n\n  blob.read_shift(4);\n  blob.l += 4; // must be 0x1\n\n  o.id = blob.read_shift(0, 'lpp4');\n  o.name = blob.read_shift(0, 'lpp4');\n  o.R = parse_CRYPTOVersion(blob, 4);\n  o.U = parse_CRYPTOVersion(blob, 4);\n  o.W = parse_CRYPTOVersion(blob, 4);\n  return o;\n}\n\nfunction parse_Primary(blob) {\n  /* [MS-OFFCRYPTO] 2.2.6 IRMDSTransformInfo */\n  var hdr = parse_TransformInfoHeader(blob);\n  /* [MS-OFFCRYPTO] 2.1.9 EncryptionTransformInfo */\n\n  hdr.ename = blob.read_shift(0, '8lpp4');\n  hdr.blksz = blob.read_shift(4);\n  hdr.cmode = blob.read_shift(4);\n  if (blob.read_shift(4) != 0x04) throw new Error(\"Bad !Primary record\");\n  return hdr;\n}\n/* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\n\n\nfunction parse_EncryptionHeader(blob, length\n/*:number*/\n) {\n  var tgt = blob.l + length;\n  var o = {};\n  o.Flags = blob.read_shift(4) & 0x3F;\n  blob.l += 4;\n  o.AlgID = blob.read_shift(4);\n  var valid = false;\n\n  switch (o.AlgID) {\n    case 0x660E:\n    case 0x660F:\n    case 0x6610:\n      valid = o.Flags == 0x24;\n      break;\n\n    case 0x6801:\n      valid = o.Flags == 0x04;\n      break;\n\n    case 0:\n      valid = o.Flags == 0x10 || o.Flags == 0x04 || o.Flags == 0x24;\n      break;\n\n    default:\n      throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n  }\n\n  if (!valid) throw new Error(\"Encryption Flags/AlgID mismatch\");\n  o.AlgIDHash = blob.read_shift(4);\n  o.KeySize = blob.read_shift(4);\n  o.ProviderType = blob.read_shift(4);\n  blob.l += 8;\n  o.CSPName = blob.read_shift(tgt - blob.l >> 1, 'utf16le');\n  blob.l = tgt;\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\n\n\nfunction parse_EncryptionVerifier(blob, length\n/*:number*/\n) {\n  var o = {},\n      tgt = blob.l + length;\n  blob.l += 4; // SaltSize must be 0x10\n\n  o.Salt = blob.slice(blob.l, blob.l + 16);\n  blob.l += 16;\n  o.Verifier = blob.slice(blob.l, blob.l + 16);\n  blob.l += 16;\n  /*var sz = */\n\n  blob.read_shift(4);\n  o.VerifierHash = blob.slice(blob.l, tgt);\n  blob.l = tgt;\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.4.* EncryptionInfo Stream */\n\n\nfunction parse_EncryptionInfo(blob) {\n  var vers = parse_CRYPTOVersion(blob);\n\n  switch (vers.Minor) {\n    case 0x02:\n      return [vers.Minor, parse_EncInfoStd(blob, vers)];\n\n    case 0x03:\n      return [vers.Minor, parse_EncInfoExt(blob, vers)];\n\n    case 0x04:\n      return [vers.Minor, parse_EncInfoAgl(blob, vers)];\n  }\n\n  throw new Error(\"ECMA-376 Encrypted file unrecognized Version: \" + vers.Minor);\n}\n/* [MS-OFFCRYPTO] 2.3.4.5  EncryptionInfo Stream (Standard Encryption) */\n\n\nfunction parse_EncInfoStd(blob\n/*::, vers*/\n) {\n  var flags = blob.read_shift(4);\n  if ((flags & 0x3F) != 0x24) throw new Error(\"EncryptionInfo mismatch\");\n  var sz = blob.read_shift(4); //var tgt = blob.l + sz;\n\n  var hdr = parse_EncryptionHeader(blob, sz);\n  var verifier = parse_EncryptionVerifier(blob, blob.length - blob.l);\n  return {\n    t: \"Std\",\n    h: hdr,\n    v: verifier\n  };\n}\n/* [MS-OFFCRYPTO] 2.3.4.6  EncryptionInfo Stream (Extensible Encryption) */\n\n\nfunction\n  /*::blob, vers*/\nparse_EncInfoExt() {\n  throw new Error(\"File is password-protected: ECMA-376 Extensible\");\n}\n/* [MS-OFFCRYPTO] 2.3.4.10 EncryptionInfo Stream (Agile Encryption) */\n\n\nfunction parse_EncInfoAgl(blob\n/*::, vers*/\n) {\n  var KeyData = [\"saltSize\", \"blockSize\", \"keyBits\", \"hashSize\", \"cipherAlgorithm\", \"cipherChaining\", \"hashAlgorithm\", \"saltValue\"];\n  blob.l += 4;\n  var xml = blob.read_shift(blob.length - blob.l, 'utf8');\n  var o = {};\n  xml.replace(tagregex, function xml_agile(x) {\n    var y\n    /*:any*/\n    = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<?xml':\n        break;\n\n      case '<encryption':\n      case '</encryption>':\n        break;\n\n      case '<keyData':\n        KeyData.forEach(function (k) {\n          o[k] = y[k];\n        });\n        break;\n\n      case '<dataIntegrity':\n        o.encryptedHmacKey = y.encryptedHmacKey;\n        o.encryptedHmacValue = y.encryptedHmacValue;\n        break;\n\n      case '<keyEncryptors>':\n      case '<keyEncryptors':\n        o.encs = [];\n        break;\n\n      case '</keyEncryptors>':\n        break;\n\n      case '<keyEncryptor':\n        o.uri = y.uri;\n        break;\n\n      case '</keyEncryptor>':\n        break;\n\n      case '<encryptedKey':\n        o.encs.push(y);\n        break;\n\n      default:\n        throw y[0];\n    }\n  });\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\n\n\nfunction parse_RC4CryptoHeader(blob, length\n/*:number*/\n) {\n  var o = {};\n  var vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n  length -= 4;\n  if (vers.Minor != 2) throw new Error('unrecognized minor version code: ' + vers.Minor);\n  if (vers.Major > 4 || vers.Major < 2) throw new Error('unrecognized major version code: ' + vers.Major);\n  o.Flags = blob.read_shift(4);\n  length -= 4;\n  var sz = blob.read_shift(4);\n  length -= 4;\n  o.EncryptionHeader = parse_EncryptionHeader(blob, sz);\n  length -= sz;\n  o.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\n\n\nfunction parse_RC4Header(blob\n/*::, length*/\n) {\n  var o = {};\n  var vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n  if (vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n  o.Salt = blob.read_shift(16);\n  o.EncryptedVerifier = blob.read_shift(16);\n  o.EncryptedVerifierHash = blob.read_shift(16);\n  return o;\n}\n/* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\n\n\nfunction crypto_CreatePasswordVerifier_Method1(Password\n/*:string*/\n) {\n  var Verifier = 0x0000,\n      PasswordArray;\n\n  var PasswordDecoded = _JS2ANSI(Password);\n\n  var len = PasswordDecoded.length + 1,\n      i,\n      PasswordByte;\n  var Intermediate1, Intermediate2, Intermediate3;\n  PasswordArray = new_raw_buf(len);\n  PasswordArray[0] = PasswordDecoded.length;\n\n  for (i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i - 1];\n\n  for (i = len - 1; i >= 0; --i) {\n    PasswordByte = PasswordArray[i];\n    Intermediate1 = (Verifier & 0x4000) === 0x0000 ? 0 : 1;\n    Intermediate2 = Verifier << 1 & 0x7FFF;\n    Intermediate3 = Intermediate1 | Intermediate2;\n    Verifier = Intermediate3 ^ PasswordByte;\n  }\n\n  return Verifier ^ 0xCE4B;\n}\n/* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\n\n\nvar crypto_CreateXorArray_Method1 = /*#__PURE__*/function () {\n  var PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n  var InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n  var XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\n  var Ror = function (Byte) {\n    return (Byte / 2 | Byte * 128) & 0xFF;\n  };\n\n  var XorRor = function (byte1, byte2) {\n    return Ror(byte1 ^ byte2);\n  };\n\n  var CreateXorKey_Method1 = function (Password) {\n    var XorKey = InitialCode[Password.length - 1];\n    var CurrentElement = 0x68;\n\n    for (var i = Password.length - 1; i >= 0; --i) {\n      var Char = Password[i];\n\n      for (var j = 0; j != 7; ++j) {\n        if (Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n        Char *= 2;\n        --CurrentElement;\n      }\n    }\n\n    return XorKey;\n  };\n\n  return function (password\n  /*:string*/\n  ) {\n    var Password = _JS2ANSI(password);\n\n    var XorKey = CreateXorKey_Method1(Password);\n    var Index = Password.length;\n    var ObfuscationArray = new_raw_buf(16);\n\n    for (var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n\n    var Temp, PasswordLastChar, PadIndex;\n\n    if ((Index & 1) === 1) {\n      Temp = XorKey >> 8;\n      ObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n      --Index;\n      Temp = XorKey & 0xFF;\n      PasswordLastChar = Password[Password.length - 1];\n      ObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n    }\n\n    while (Index > 0) {\n      --Index;\n      Temp = XorKey >> 8;\n      ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n      --Index;\n      Temp = XorKey & 0xFF;\n      ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n    }\n\n    Index = 15;\n    PadIndex = 15 - Password.length;\n\n    while (PadIndex > 0) {\n      Temp = XorKey >> 8;\n      ObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n      --Index;\n      --PadIndex;\n      Temp = XorKey & 0xFF;\n      ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n      --Index;\n      --PadIndex;\n    }\n\n    return ObfuscationArray;\n  };\n}();\n/* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\n\n\nvar crypto_DecryptData_Method1 = function (password\n/*:string*/\n, Data, XorArrayIndex, XorArray, O) {\n  /* If XorArray is set, use it; if O is not set, make changes in-place */\n  if (!O) O = Data;\n  if (!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n  var Index, Value;\n\n  for (Index = 0; Index != Data.length; ++Index) {\n    Value = Data[Index];\n    Value ^= XorArray[XorArrayIndex];\n    Value = (Value >> 5 | Value << 3) & 0xFF;\n    O[Index] = Value;\n    ++XorArrayIndex;\n  }\n\n  return [O, XorArrayIndex, XorArray];\n};\n\nvar crypto_MakeXorDecryptor = function (password\n/*:string*/\n) {\n  var XorArrayIndex = 0,\n      XorArray = crypto_CreateXorArray_Method1(password);\n  return function (Data) {\n    var O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\n    XorArrayIndex = O[1];\n    return O[0];\n  };\n};\n/* 2.5.343 */\n\n\nfunction parse_XORObfuscation(blob, length, opts, out) {\n  var o = {\n    key: parseuint16(blob),\n    verificationBytes: parseuint16(blob)\n  }\n  /*:any*/\n  ;\n  if (opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n  out.valid = o.verificationBytes === o.verifier;\n  if (out.valid) out.insitu = crypto_MakeXorDecryptor(opts.password);\n  return o;\n}\n/* 2.4.117 */\n\n\nfunction parse_FilePassHeader(blob, length\n/*:number*/\n, oo) {\n  var o = oo || {};\n  o.Info = blob.read_shift(2);\n  blob.l -= 2;\n  if (o.Info === 1) o.Data = parse_RC4Header(blob, length);else o.Data = parse_RC4CryptoHeader(blob, length);\n  return o;\n}\n\nfunction parse_FilePass(blob, length\n/*:number*/\n, opts) {\n  var o = {\n    Type: opts.biff >= 8 ? blob.read_shift(2) : 0\n  }\n  /*:any*/\n  ;\n  /* wEncryptionType */\n\n  if (o.Type) parse_FilePassHeader(blob, length - 2, o);else parse_XORObfuscation(blob, opts.biff >= 8 ? length : length - 2, opts, o);\n  return o;\n}\n\nvar RTF = /*#__PURE__*/function () {\n  function rtf_to_sheet(d\n  /*:RawData*/\n  , opts)\n  /*:Worksheet*/\n  {\n    switch (opts.type) {\n      case 'base64':\n        return rtf_to_sheet_str(Base64_decode(d), opts);\n\n      case 'binary':\n        return rtf_to_sheet_str(d, opts);\n\n      case 'buffer':\n        return rtf_to_sheet_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\n      case 'array':\n        return rtf_to_sheet_str(cc2str(d), opts);\n    }\n\n    throw new Error(\"Unrecognized type \" + opts.type);\n  }\n  /* TODO: this is a stub */\n\n\n  function rtf_to_sheet_str(str\n  /*:string*/\n  , opts)\n  /*:Worksheet*/\n  {\n    var o = opts || {};\n    var ws\n    /*:Worksheet*/\n    = o.dense ? []\n    /*:any*/\n    : {}\n    /*:any*/\n    ;\n    var rows = str.match(/\\\\trowd.*?\\\\row\\b/g);\n    if (!rows.length) throw new Error(\"RTF missing table\");\n    var range\n    /*:Range*/\n    = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: rows.length - 1\n      }\n    }\n    /*:any*/\n    ;\n    rows.forEach(function (rowtf, R) {\n      if (Array.isArray(ws)) ws[R] = [];\n      var rtfre = /\\\\\\w+\\b/g;\n      var last_index = 0;\n      var res;\n      var C = -1;\n\n      while (res = rtfre.exec(rowtf)) {\n        switch (res[0]) {\n          case \"\\\\cell\":\n            var data = rowtf.slice(last_index, rtfre.lastIndex - res[0].length);\n            if (data[0] == \" \") data = data.slice(1);\n            ++C;\n\n            if (data.length) {\n              // TODO: value parsing, including codepage adjustments\n              var cell = {\n                v: data,\n                t: \"s\"\n              };\n              if (Array.isArray(ws)) ws[R][C] = cell;else ws[encode_cell({\n                r: R,\n                c: C\n              })] = cell;\n            }\n\n            break;\n        }\n\n        last_index = rtfre.lastIndex;\n      }\n\n      if (C > range.e.c) range.e.c = C;\n    });\n    ws['!ref'] = encode_range(range);\n    return ws;\n  }\n\n  function rtf_to_workbook(d\n  /*:RawData*/\n  , opts)\n  /*:Workbook*/\n  {\n    return sheet_to_workbook(rtf_to_sheet(d, opts), opts);\n  }\n  /* TODO: this is a stub */\n\n\n  function sheet_to_rtf(ws\n  /*:Worksheet*/\n\n  /*::, opts*/\n  )\n  /*:string*/\n  {\n    var o = [\"{\\\\rtf1\\\\ansi\"];\n    var r = safe_decode_range(ws['!ref']),\n        cell\n    /*:Cell*/\n    ;\n    var dense = Array.isArray(ws);\n\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      o.push(\"\\\\trowd\\\\trautofit1\");\n\n      for (var C = r.s.c; C <= r.e.c; ++C) o.push(\"\\\\cellx\" + (C + 1));\n\n      o.push(\"\\\\pard\\\\intbl\");\n\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        var coord = encode_cell({\n          r: R,\n          c: C\n        });\n        cell = dense ? (ws[R] || [])[C] : ws[coord];\n        if (!cell || cell.v == null && (!cell.f || cell.F)) continue;\n        o.push(\" \" + (cell.w || (format_cell(cell), cell.w)));\n        o.push(\"\\\\cell\");\n      }\n\n      o.push(\"\\\\pard\\\\intbl\\\\row\");\n    }\n\n    return o.join(\"\") + \"}\";\n  }\n\n  return {\n    to_workbook: rtf_to_workbook,\n    to_sheet: rtf_to_sheet,\n    from_sheet: sheet_to_rtf\n  };\n}();\n\nfunction hex2RGB(h) {\n  var o = h.slice(h[0] === \"#\" ? 1 : 0).slice(0, 6);\n  return [parseInt(o.slice(0, 2), 16), parseInt(o.slice(2, 4), 16), parseInt(o.slice(4, 6), 16)];\n}\n\nfunction rgb2Hex(rgb) {\n  for (var i = 0, o = 1; i != 3; ++i) o = o * 256 + (rgb[i] > 255 ? 255 : rgb[i] < 0 ? 0 : rgb[i]);\n\n  return o.toString(16).toUpperCase().slice(1);\n}\n\nfunction rgb2HSL(rgb) {\n  var R = rgb[0] / 255,\n      G = rgb[1] / 255,\n      B = rgb[2] / 255;\n  var M = Math.max(R, G, B),\n      m = Math.min(R, G, B),\n      C = M - m;\n  if (C === 0) return [0, 0, R];\n  var H6 = 0,\n      S = 0,\n      L2 = M + m;\n  S = C / (L2 > 1 ? 2 - L2 : L2);\n\n  switch (M) {\n    case R:\n      H6 = ((G - B) / C + 6) % 6;\n      break;\n\n    case G:\n      H6 = (B - R) / C + 2;\n      break;\n\n    case B:\n      H6 = (R - G) / C + 4;\n      break;\n  }\n\n  return [H6 / 6, S, L2 / 2];\n}\n\nfunction hsl2RGB(hsl) {\n  var H = hsl[0],\n      S = hsl[1],\n      L = hsl[2];\n  var C = S * 2 * (L < 0.5 ? L : 1 - L),\n      m = L - C / 2;\n  var rgb = [m, m, m],\n      h6 = 6 * H;\n  var X;\n  if (S !== 0) switch (h6 | 0) {\n    case 0:\n    case 6:\n      X = C * h6;\n      rgb[0] += C;\n      rgb[1] += X;\n      break;\n\n    case 1:\n      X = C * (2 - h6);\n      rgb[0] += X;\n      rgb[1] += C;\n      break;\n\n    case 2:\n      X = C * (h6 - 2);\n      rgb[1] += C;\n      rgb[2] += X;\n      break;\n\n    case 3:\n      X = C * (4 - h6);\n      rgb[1] += X;\n      rgb[2] += C;\n      break;\n\n    case 4:\n      X = C * (h6 - 4);\n      rgb[2] += C;\n      rgb[0] += X;\n      break;\n\n    case 5:\n      X = C * (6 - h6);\n      rgb[2] += X;\n      rgb[0] += C;\n      break;\n  }\n\n  for (var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i] * 255);\n\n  return rgb;\n}\n/* 18.8.3 bgColor tint algorithm */\n\n\nfunction rgb_tint(hex, tint) {\n  if (tint === 0) return hex;\n  var hsl = rgb2HSL(hex2RGB(hex));\n  if (tint < 0) hsl[2] = hsl[2] * (1 + tint);else hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n  return rgb2Hex(hsl2RGB(hsl));\n}\n/* 18.3.1.13 width calculations */\n\n/* [MS-OI29500] 2.1.595 Column Width & Formatting */\n\n\nvar DEF_MDW = 6,\n    MAX_MDW = 15,\n    MIN_MDW = 1,\n    MDW = DEF_MDW;\n\nfunction width2px(width) {\n  return Math.floor((width + Math.round(128 / MDW) / 256) * MDW);\n}\n\nfunction px2char(px) {\n  return Math.floor((px - 5) / MDW * 100 + 0.5) / 100;\n}\n\nfunction char2width(chr) {\n  return Math.round((chr * MDW + 5) / MDW * 256) / 256;\n} //function px2char_(px) { return (((px - 5)/MDW * 100 + 0.5))/100; }\n//function char2width_(chr) { return (((chr * MDW + 5)/MDW*256))/256; }\n\n\nfunction cycle_width(collw) {\n  return char2width(px2char(width2px(collw)));\n}\n/* XLSX/XLSB/XLS specify width in units of MDW */\n\n\nfunction find_mdw_colw(collw) {\n  var delta = Math.abs(collw - cycle_width(collw)),\n      _MDW = MDW;\n  if (delta > 0.005) for (MDW = MIN_MDW; MDW < MAX_MDW; ++MDW) if (Math.abs(collw - cycle_width(collw)) <= delta) {\n    delta = Math.abs(collw - cycle_width(collw));\n    _MDW = MDW;\n  }\n  MDW = _MDW;\n}\n/* XLML specifies width in terms of pixels */\n\n/*function find_mdw_wpx(wpx) {\n\tvar delta = Infinity, guess = 0, _MDW = MIN_MDW;\n\tfor(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) {\n\t\tguess = char2width_(px2char_(wpx))*256;\n\t\tguess = (guess) % 1;\n\t\tif(guess > 0.5) guess--;\n\t\tif(Math.abs(guess) < delta) { delta = Math.abs(guess); _MDW = MDW; }\n\t}\n\tMDW = _MDW;\n}*/\n\n\nfunction process_col(coll\n/*:ColInfo*/\n) {\n  if (coll.width) {\n    coll.wpx = width2px(coll.width);\n    coll.wch = px2char(coll.wpx);\n    coll.MDW = MDW;\n  } else if (coll.wpx) {\n    coll.wch = px2char(coll.wpx);\n    coll.width = char2width(coll.wch);\n    coll.MDW = MDW;\n  } else if (typeof coll.wch == 'number') {\n    coll.width = char2width(coll.wch);\n    coll.wpx = width2px(coll.width);\n    coll.MDW = MDW;\n  }\n\n  if (coll.customWidth) delete coll.customWidth;\n}\n\nvar DEF_PPI = 96,\n    PPI = DEF_PPI;\n\nfunction px2pt(px) {\n  return px * 96 / PPI;\n}\n\nfunction pt2px(pt) {\n  return pt * PPI / 96;\n}\n/* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\n\n\nvar XLMLPatternTypeMap = {\n  \"None\": \"none\",\n  \"Solid\": \"solid\",\n  \"Gray50\": \"mediumGray\",\n  \"Gray75\": \"darkGray\",\n  \"Gray25\": \"lightGray\",\n  \"HorzStripe\": \"darkHorizontal\",\n  \"VertStripe\": \"darkVertical\",\n  \"ReverseDiagStripe\": \"darkDown\",\n  \"DiagStripe\": \"darkUp\",\n  \"DiagCross\": \"darkGrid\",\n  \"ThickDiagCross\": \"darkTrellis\",\n  \"ThinHorzStripe\": \"lightHorizontal\",\n  \"ThinVertStripe\": \"lightVertical\",\n  \"ThinReverseDiagStripe\": \"lightDown\",\n  \"ThinHorzCross\": \"lightGrid\"\n};\n/* 18.8.5 borders CT_Borders */\n\nfunction parse_borders(t, styles, themes, opts) {\n  styles.Borders = [];\n  var border = {};\n  var pass = false;\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<borders':\n      case '<borders>':\n      case '</borders>':\n        break;\n\n      /* 18.8.4 border CT_Border */\n\n      case '<border':\n      case '<border>':\n      case '<border/>':\n        border =\n        /*::(*/\n        {}\n        /*:: :any)*/\n        ;\n        if (y.diagonalUp) border.diagonalUp = parsexmlbool(y.diagonalUp);\n        if (y.diagonalDown) border.diagonalDown = parsexmlbool(y.diagonalDown);\n        styles.Borders.push(border);\n        break;\n\n      case '</border>':\n        break;\n\n      /* note: not in spec, appears to be CT_BorderPr */\n\n      case '<left/>':\n        break;\n\n      case '<left':\n      case '<left>':\n        break;\n\n      case '</left>':\n        break;\n\n      /* note: not in spec, appears to be CT_BorderPr */\n\n      case '<right/>':\n        break;\n\n      case '<right':\n      case '<right>':\n        break;\n\n      case '</right>':\n        break;\n\n      /* 18.8.43 top CT_BorderPr */\n\n      case '<top/>':\n        break;\n\n      case '<top':\n      case '<top>':\n        break;\n\n      case '</top>':\n        break;\n\n      /* 18.8.6 bottom CT_BorderPr */\n\n      case '<bottom/>':\n        break;\n\n      case '<bottom':\n      case '<bottom>':\n        break;\n\n      case '</bottom>':\n        break;\n\n      /* 18.8.13 diagonal CT_BorderPr */\n\n      case '<diagonal':\n      case '<diagonal>':\n      case '<diagonal/>':\n        break;\n\n      case '</diagonal>':\n        break;\n\n      /* 18.8.25 horizontal CT_BorderPr */\n\n      case '<horizontal':\n      case '<horizontal>':\n      case '<horizontal/>':\n        break;\n\n      case '</horizontal>':\n        break;\n\n      /* 18.8.44 vertical CT_BorderPr */\n\n      case '<vertical':\n      case '<vertical>':\n      case '<vertical/>':\n        break;\n\n      case '</vertical>':\n        break;\n\n      /* 18.8.37 start CT_BorderPr */\n\n      case '<start':\n      case '<start>':\n      case '<start/>':\n        break;\n\n      case '</start>':\n        break;\n\n      /* 18.8.16 end CT_BorderPr */\n\n      case '<end':\n      case '<end>':\n      case '<end/>':\n        break;\n\n      case '</end>':\n        break;\n\n      /* 18.8.? color CT_Color */\n\n      case '<color':\n      case '<color>':\n        break;\n\n      case '<color/>':\n      case '</color>':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (opts && opts.WTF) {\n          if (!pass) throw new Error('unrecognized ' + y[0] + ' in borders');\n        }\n\n    }\n  });\n}\n/* 18.8.21 fills CT_Fills */\n\n\nfunction parse_fills(t, styles, themes, opts) {\n  styles.Fills = [];\n  var fill = {};\n  var pass = false;\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<fills':\n      case '<fills>':\n      case '</fills>':\n        break;\n\n      /* 18.8.20 fill CT_Fill */\n\n      case '<fill>':\n      case '<fill':\n      case '<fill/>':\n        fill = {};\n        styles.Fills.push(fill);\n        break;\n\n      case '</fill>':\n        break;\n\n      /* 18.8.24 gradientFill CT_GradientFill */\n\n      case '<gradientFill>':\n        break;\n\n      case '<gradientFill':\n      case '</gradientFill>':\n        styles.Fills.push(fill);\n        fill = {};\n        break;\n\n      /* 18.8.32 patternFill CT_PatternFill */\n\n      case '<patternFill':\n      case '<patternFill>':\n        if (y.patternType) fill.patternType = y.patternType;\n        break;\n\n      case '<patternFill/>':\n      case '</patternFill>':\n        break;\n\n      /* 18.8.3 bgColor CT_Color */\n\n      case '<bgColor':\n        if (!fill.bgColor) fill.bgColor = {};\n        if (y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n        if (y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n        if (y.tint) fill.bgColor.tint = parseFloat(y.tint);\n        /* Excel uses ARGB strings */\n\n        if (y.rgb) fill.bgColor.rgb = y.rgb.slice(-6);\n        break;\n\n      case '<bgColor/>':\n      case '</bgColor>':\n        break;\n\n      /* 18.8.19 fgColor CT_Color */\n\n      case '<fgColor':\n        if (!fill.fgColor) fill.fgColor = {};\n        if (y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n        if (y.tint) fill.fgColor.tint = parseFloat(y.tint);\n        /* Excel uses ARGB strings */\n\n        if (y.rgb != null) fill.fgColor.rgb = y.rgb.slice(-6);\n        break;\n\n      case '<fgColor/>':\n      case '</fgColor>':\n        break;\n\n      /* 18.8.38 stop CT_GradientStop */\n\n      case '<stop':\n      case '<stop/>':\n        break;\n\n      case '</stop>':\n        break;\n\n      /* 18.8.? color CT_Color */\n\n      case '<color':\n      case '<color/>':\n        break;\n\n      case '</color>':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (opts && opts.WTF) {\n          if (!pass) throw new Error('unrecognized ' + y[0] + ' in fills');\n        }\n\n    }\n  });\n}\n/* 18.8.23 fonts CT_Fonts */\n\n\nfunction parse_fonts(t, styles, themes, opts) {\n  styles.Fonts = [];\n  var font = {};\n  var pass = false;\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<fonts':\n      case '<fonts>':\n      case '</fonts>':\n        break;\n\n      /* 18.8.22 font CT_Font */\n\n      case '<font':\n      case '<font>':\n        break;\n\n      case '</font>':\n      case '<font/>':\n        styles.Fonts.push(font);\n        font = {};\n        break;\n\n      /* 18.8.29 name CT_FontName */\n\n      case '<name':\n        if (y.val) font.name = utf8read(y.val);\n        break;\n\n      case '<name/>':\n      case '</name>':\n        break;\n\n      /* 18.8.2  b CT_BooleanProperty */\n\n      case '<b':\n        font.bold = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<b/>':\n        font.bold = 1;\n        break;\n\n      /* 18.8.26 i CT_BooleanProperty */\n\n      case '<i':\n        font.italic = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<i/>':\n        font.italic = 1;\n        break;\n\n      /* 18.4.13 u CT_UnderlineProperty */\n\n      case '<u':\n        switch (y.val) {\n          case \"none\":\n            font.underline = 0x00;\n            break;\n\n          case \"single\":\n            font.underline = 0x01;\n            break;\n\n          case \"double\":\n            font.underline = 0x02;\n            break;\n\n          case \"singleAccounting\":\n            font.underline = 0x21;\n            break;\n\n          case \"doubleAccounting\":\n            font.underline = 0x22;\n            break;\n        }\n\n        break;\n\n      case '<u/>':\n        font.underline = 1;\n        break;\n\n      /* 18.4.10 strike CT_BooleanProperty */\n\n      case '<strike':\n        font.strike = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<strike/>':\n        font.strike = 1;\n        break;\n\n      /* 18.4.2  outline CT_BooleanProperty */\n\n      case '<outline':\n        font.outline = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<outline/>':\n        font.outline = 1;\n        break;\n\n      /* 18.8.36 shadow CT_BooleanProperty */\n\n      case '<shadow':\n        font.shadow = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<shadow/>':\n        font.shadow = 1;\n        break;\n\n      /* 18.8.12 condense CT_BooleanProperty */\n\n      case '<condense':\n        font.condense = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<condense/>':\n        font.condense = 1;\n        break;\n\n      /* 18.8.17 extend CT_BooleanProperty */\n\n      case '<extend':\n        font.extend = y.val ? parsexmlbool(y.val) : 1;\n        break;\n\n      case '<extend/>':\n        font.extend = 1;\n        break;\n\n      /* 18.4.11 sz CT_FontSize */\n\n      case '<sz':\n        if (y.val) font.sz = +y.val;\n        break;\n\n      case '<sz/>':\n      case '</sz>':\n        break;\n\n      /* 18.4.14 vertAlign CT_VerticalAlignFontProperty */\n\n      case '<vertAlign':\n        if (y.val) font.vertAlign = y.val;\n        break;\n\n      case '<vertAlign/>':\n      case '</vertAlign>':\n        break;\n\n      /* 18.8.18 family CT_FontFamily */\n\n      case '<family':\n        if (y.val) font.family = parseInt(y.val, 10);\n        break;\n\n      case '<family/>':\n      case '</family>':\n        break;\n\n      /* 18.8.35 scheme CT_FontScheme */\n\n      case '<scheme':\n        if (y.val) font.scheme = y.val;\n        break;\n\n      case '<scheme/>':\n      case '</scheme>':\n        break;\n\n      /* 18.4.1 charset CT_IntProperty */\n\n      case '<charset':\n        if (y.val == '1') break;\n        y.codepage = CS2CP[parseInt(y.val, 10)];\n        break;\n\n      /* 18.?.? color CT_Color */\n\n      case '<color':\n        if (!font.color) font.color = {};\n        if (y.auto) font.color.auto = parsexmlbool(y.auto);\n        if (y.rgb) font.color.rgb = y.rgb.slice(-6);else if (y.indexed) {\n          font.color.index = parseInt(y.indexed, 10);\n          var icv = XLSIcv[font.color.index];\n          if (font.color.index == 81) icv = XLSIcv[1];\n          if (!icv) icv = XLSIcv[1]; //throw new Error(x); // note: 206 is valid\n\n          font.color.rgb = icv[0].toString(16) + icv[1].toString(16) + icv[2].toString(16);\n        } else if (y.theme) {\n          font.color.theme = parseInt(y.theme, 10);\n          if (y.tint) font.color.tint = parseFloat(y.tint);\n\n          if (y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n            font.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n          }\n        }\n        break;\n\n      case '<color/>':\n      case '</color>':\n        break;\n\n      /* note: sometimes mc:AlternateContent appears bare */\n\n      case '<AlternateContent':\n        pass = true;\n        break;\n\n      case '</AlternateContent>':\n        pass = false;\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (opts && opts.WTF) {\n          if (!pass) throw new Error('unrecognized ' + y[0] + ' in fonts');\n        }\n\n    }\n  });\n}\n/* 18.8.31 numFmts CT_NumFmts */\n\n\nfunction parse_numFmts(t, styles, opts) {\n  styles.NumberFmt = [];\n  var k\n  /*Array<number>*/\n  = keys(table_fmt)\n  /*:any*/\n  ;\n\n  for (var i = 0; i < k.length; ++i) styles.NumberFmt[k[i]] = table_fmt[k[i]];\n\n  var m = t[0].match(tagregex);\n  if (!m) return;\n\n  for (i = 0; i < m.length; ++i) {\n    var y = parsexmltag(m[i]);\n\n    switch (strip_ns(y[0])) {\n      case '<numFmts':\n      case '</numFmts>':\n      case '<numFmts/>':\n      case '<numFmts>':\n        break;\n\n      case '<numFmt':\n        {\n          var f = unescapexml(utf8read(y.formatCode)),\n              j = parseInt(y.numFmtId, 10);\n          styles.NumberFmt[j] = f;\n\n          if (j > 0) {\n            if (j > 0x188) {\n              for (j = 0x188; j > 0x3c; --j) if (styles.NumberFmt[j] == null) break;\n\n              styles.NumberFmt[j] = f;\n            }\n\n            SSF_load(f, j);\n          }\n        }\n        break;\n\n      case '</numFmt>':\n        break;\n\n      default:\n        if (opts.WTF) throw new Error('unrecognized ' + y[0] + ' in numFmts');\n    }\n  }\n}\n\nfunction write_numFmts(NF\n/*:{[n:number|string]:string}*/\n\n/*::, opts*/\n) {\n  var o = [\"<numFmts>\"];\n  [[5, 8], [23, 26], [41, 44], [\n  /*63*/\n  50,\n  /*66],[164,*/\n  392]].forEach(function (r) {\n    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) o[o.length] = writextag('numFmt', null, {\n      numFmtId: i,\n      formatCode: escapexml(NF[i])\n    });\n  });\n  if (o.length === 1) return \"\";\n  o[o.length] = \"</numFmts>\";\n  o[0] = writextag('numFmts', null, {\n    count: o.length - 2\n  }).replace(\"/>\", \">\");\n  return o.join(\"\");\n}\n/* 18.8.10 cellXfs CT_CellXfs */\n\n\nvar cellXF_uint = [\"numFmtId\", \"fillId\", \"fontId\", \"borderId\", \"xfId\"];\nvar cellXF_bool = [\"applyAlignment\", \"applyBorder\", \"applyFill\", \"applyFont\", \"applyNumberFormat\", \"applyProtection\", \"pivotButton\", \"quotePrefix\"];\n\nfunction parse_cellXfs(t, styles, opts) {\n  styles.CellXf = [];\n  var xf;\n  var pass = false;\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x),\n        i = 0;\n\n    switch (strip_ns(y[0])) {\n      case '<cellXfs':\n      case '<cellXfs>':\n      case '<cellXfs/>':\n      case '</cellXfs>':\n        break;\n\n      /* 18.8.45 xf CT_Xf */\n\n      case '<xf':\n      case '<xf/>':\n        xf = y;\n        delete xf[0];\n\n        for (i = 0; i < cellXF_uint.length; ++i) if (xf[cellXF_uint[i]]) xf[cellXF_uint[i]] = parseInt(xf[cellXF_uint[i]], 10);\n\n        for (i = 0; i < cellXF_bool.length; ++i) if (xf[cellXF_bool[i]]) xf[cellXF_bool[i]] = parsexmlbool(xf[cellXF_bool[i]]);\n\n        if (styles.NumberFmt && xf.numFmtId > 0x188) {\n          for (i = 0x188; i > 0x3c; --i) if (styles.NumberFmt[xf.numFmtId] == styles.NumberFmt[i]) {\n            xf.numFmtId = i;\n            break;\n          }\n        }\n\n        styles.CellXf.push(xf);\n        break;\n\n      case '</xf>':\n        break;\n\n      /* 18.8.1 alignment CT_CellAlignment */\n\n      case '<alignment':\n      case '<alignment/>':\n        var alignment = {};\n        if (y.vertical) alignment.vertical = y.vertical;\n        if (y.horizontal) alignment.horizontal = y.horizontal;\n        if (y.textRotation != null) alignment.textRotation = y.textRotation;\n        if (y.indent) alignment.indent = y.indent;\n        if (y.wrapText) alignment.wrapText = parsexmlbool(y.wrapText);\n        xf.alignment = alignment;\n        break;\n\n      case '</alignment>':\n        break;\n\n      /* 18.8.33 protection CT_CellProtection */\n\n      case '<protection':\n        break;\n\n      case '</protection>':\n      case '<protection/>':\n        break;\n\n      /* note: sometimes mc:AlternateContent appears bare */\n\n      case '<AlternateContent':\n        pass = true;\n        break;\n\n      case '</AlternateContent>':\n        pass = false;\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n        break;\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (opts && opts.WTF) {\n          if (!pass) throw new Error('unrecognized ' + y[0] + ' in cellXfs');\n        }\n\n    }\n  });\n}\n\nfunction write_cellXfs(cellXfs)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n  o[o.length] = writextag('cellXfs', null);\n  cellXfs.forEach(function (c) {\n    o[o.length] = writextag('xf', null, c);\n  });\n  o[o.length] = \"</cellXfs>\";\n  if (o.length === 2) return \"\";\n  o[0] = writextag('cellXfs', null, {\n    count: o.length - 2\n  }).replace(\"/>\", \">\");\n  return o.join(\"\");\n}\n/* 18.8 Styles CT_Stylesheet*/\n\n\nvar parse_sty_xml = /*#__PURE__*/function make_pstyx() {\n  var numFmtRegex = /<(?:\\w+:)?numFmts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?numFmts>/;\n  var cellXfRegex = /<(?:\\w+:)?cellXfs([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?cellXfs>/;\n  var fillsRegex = /<(?:\\w+:)?fills([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fills>/;\n  var fontsRegex = /<(?:\\w+:)?fonts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fonts>/;\n  var bordersRegex = /<(?:\\w+:)?borders([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?borders>/;\n  return function parse_sty_xml(data, themes, opts) {\n    var styles = {};\n    if (!data) return styles;\n    data = data.replace(/<!--([\\s\\S]*?)-->/mg, \"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm, \"\");\n    /* 18.8.39 styleSheet CT_Stylesheet */\n\n    var t;\n    /* 18.8.31 numFmts CT_NumFmts ? */\n\n    if (t = data.match(numFmtRegex)) parse_numFmts(t, styles, opts);\n    /* 18.8.23 fonts CT_Fonts ? */\n\n    if (t = data.match(fontsRegex)) parse_fonts(t, styles, themes, opts);\n    /* 18.8.21 fills CT_Fills ? */\n\n    if (t = data.match(fillsRegex)) parse_fills(t, styles, themes, opts);\n    /* 18.8.5  borders CT_Borders ? */\n\n    if (t = data.match(bordersRegex)) parse_borders(t, styles, themes, opts);\n    /* 18.8.9  cellStyleXfs CT_CellStyleXfs ? */\n\n    /* 18.8.8  cellStyles CT_CellStyles ? */\n\n    /* 18.8.10 cellXfs CT_CellXfs ? */\n\n    if (t = data.match(cellXfRegex)) parse_cellXfs(t, styles, opts);\n    /* 18.8.15 dxfs CT_Dxfs ? */\n\n    /* 18.8.42 tableStyles CT_TableStyles ? */\n\n    /* 18.8.11 colors CT_Colors ? */\n\n    /* 18.2.10 extLst CT_ExtensionList ? */\n\n    return styles;\n  };\n}();\n\nfunction write_sty_xml(wb\n/*:Workbook*/\n, opts)\n/*:string*/\n{\n  var o = [XML_HEADER, writextag('styleSheet', null, {\n    'xmlns': XMLNS_main[0],\n    'xmlns:vt': XMLNS.vt\n  })],\n      w;\n  if (wb.SSF && (w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\n  o[o.length] = '<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>';\n  o[o.length] = '<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>';\n  o[o.length] = '<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>';\n  o[o.length] = '<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>';\n  if (w = write_cellXfs(opts.cellXfs)) o[o.length] = w;\n  o[o.length] = '<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>';\n  o[o.length] = '<dxfs count=\"0\"/>';\n  o[o.length] = '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>';\n\n  if (o.length > 2) {\n    o[o.length] = '</styleSheet>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* [MS-XLSB] 2.4.657 BrtFmt */\n\n\nfunction parse_BrtFmt(data, length\n/*:number*/\n) {\n  var numFmtId = data.read_shift(2);\n  var stFmtCode = parse_XLWideString(data, length - 2);\n  return [numFmtId, stFmtCode];\n}\n\nfunction write_BrtFmt(i\n/*:number*/\n, f\n/*:string*/\n, o) {\n  if (!o) o = new_buf(6 + 4 * f.length);\n  o.write_shift(2, i);\n  write_XLWideString(f, o);\n  var out = o.length > o.l ? o.slice(0, o.l) : o;\n  if (o.l == null) o.l = o.length;\n  return out;\n}\n/* [MS-XLSB] 2.4.659 BrtFont TODO */\n\n\nfunction parse_BrtFont(data, length\n/*:number*/\n, opts) {\n  var out = {}\n  /*:any*/\n  ;\n  out.sz = data.read_shift(2) / 20;\n  var grbit = parse_FontFlags(data, 2, opts);\n  if (grbit.fItalic) out.italic = 1;\n  if (grbit.fCondense) out.condense = 1;\n  if (grbit.fExtend) out.extend = 1;\n  if (grbit.fShadow) out.shadow = 1;\n  if (grbit.fOutline) out.outline = 1;\n  if (grbit.fStrikeout) out.strike = 1;\n  var bls = data.read_shift(2);\n  if (bls === 0x02BC) out.bold = 1;\n\n  switch (data.read_shift(2)) {\n    /* case 0: out.vertAlign = \"baseline\"; break; */\n    case 1:\n      out.vertAlign = \"superscript\";\n      break;\n\n    case 2:\n      out.vertAlign = \"subscript\";\n      break;\n  }\n\n  var underline = data.read_shift(1);\n  if (underline != 0) out.underline = underline;\n  var family = data.read_shift(1);\n  if (family > 0) out.family = family;\n  var bCharSet = data.read_shift(1);\n  if (bCharSet > 0) out.charset = bCharSet;\n  data.l++;\n  out.color = parse_BrtColor(data, 8);\n\n  switch (data.read_shift(1)) {\n    /* case 0: out.scheme = \"none\": break; */\n    case 1:\n      out.scheme = \"major\";\n      break;\n\n    case 2:\n      out.scheme = \"minor\";\n      break;\n  }\n\n  out.name = parse_XLWideString(data, length - 21);\n  return out;\n}\n\nfunction write_BrtFont(font\n/*:any*/\n, o) {\n  if (!o) o = new_buf(25 + 4 * 32);\n  o.write_shift(2, font.sz * 20);\n  write_FontFlags(font, o);\n  o.write_shift(2, font.bold ? 0x02BC : 0x0190);\n  var sss = 0;\n  if (font.vertAlign == \"superscript\") sss = 1;else if (font.vertAlign == \"subscript\") sss = 2;\n  o.write_shift(2, sss);\n  o.write_shift(1, font.underline || 0);\n  o.write_shift(1, font.family || 0);\n  o.write_shift(1, font.charset || 0);\n  o.write_shift(1, 0);\n  write_BrtColor(font.color, o);\n  var scheme = 0;\n  if (font.scheme == \"major\") scheme = 1;\n  if (font.scheme == \"minor\") scheme = 2;\n  o.write_shift(1, scheme);\n  write_XLWideString(font.name, o);\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.650 BrtFill */\n\n\nvar XLSBFillPTNames = [\"none\", \"solid\", \"mediumGray\", \"darkGray\", \"lightGray\", \"darkHorizontal\", \"darkVertical\", \"darkDown\", \"darkUp\", \"darkGrid\", \"darkTrellis\", \"lightHorizontal\", \"lightVertical\", \"lightDown\", \"lightUp\", \"lightGrid\", \"lightTrellis\", \"gray125\", \"gray0625\"];\nvar rev_XLSBFillPTNames\n/*:EvertNumType*/\n;\n/* TODO: gradient fill representation */\n\nvar parse_BrtFill = parsenoop;\n\nfunction write_BrtFill(fill, o) {\n  if (!o) o = new_buf(4 * 3 + 8 * 7 + 16 * 1);\n  if (!rev_XLSBFillPTNames) rev_XLSBFillPTNames = evert(XLSBFillPTNames)\n  /*:any*/\n  ;\n  var fls\n  /*:number*/\n  = rev_XLSBFillPTNames[fill.patternType];\n  if (fls == null) fls = 0x28;\n  o.write_shift(4, fls);\n  var j = 0;\n\n  if (fls != 0x28) {\n    /* TODO: custom FG Color */\n    write_BrtColor({\n      auto: 1\n    }, o);\n    /* TODO: custom BG Color */\n\n    write_BrtColor({\n      auto: 1\n    }, o);\n\n    for (; j < 12; ++j) o.write_shift(4, 0);\n  } else {\n    for (; j < 4; ++j) o.write_shift(4, 0);\n\n    for (; j < 12; ++j) o.write_shift(4, 0);\n    /* TODO */\n\n    /* iGradientType */\n\n    /* xnumDegree */\n\n    /* xnumFillToLeft */\n\n    /* xnumFillToRight */\n\n    /* xnumFillToTop */\n\n    /* xnumFillToBottom */\n\n    /* cNumStop */\n\n    /* xfillGradientStop */\n\n  }\n\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.824 BrtXF */\n\n\nfunction parse_BrtXF(data, length\n/*:number*/\n) {\n  var tgt = data.l + length;\n  var ixfeParent = data.read_shift(2);\n  var ifmt = data.read_shift(2);\n  data.l = tgt;\n  return {\n    ixfe: ixfeParent,\n    numFmtId: ifmt\n  };\n}\n\nfunction write_BrtXF(data, ixfeP, o) {\n  if (!o) o = new_buf(16);\n  o.write_shift(2, ixfeP || 0);\n  o.write_shift(2, data.numFmtId || 0);\n  o.write_shift(2, 0);\n  /* iFont */\n\n  o.write_shift(2, 0);\n  /* iFill */\n\n  o.write_shift(2, 0);\n  /* ixBorder */\n\n  o.write_shift(1, 0);\n  /* trot */\n\n  o.write_shift(1, 0);\n  /* indent */\n\n  var flow = 0;\n  o.write_shift(1, flow);\n  /* flags */\n\n  o.write_shift(1, 0);\n  /* flags */\n\n  o.write_shift(1, 0);\n  /* xfGrbitAtr */\n\n  o.write_shift(1, 0);\n  return o;\n}\n/* [MS-XLSB] 2.5.4 Blxf TODO */\n\n\nfunction write_Blxf(data, o) {\n  if (!o) o = new_buf(10);\n  o.write_shift(1, 0);\n  /* dg */\n\n  o.write_shift(1, 0);\n  o.write_shift(4, 0);\n  /* color */\n\n  o.write_shift(4, 0);\n  /* color */\n\n  return o;\n}\n/* [MS-XLSB] 2.4.302 BrtBorder TODO */\n\n\nvar parse_BrtBorder = parsenoop;\n\nfunction write_BrtBorder(border, o) {\n  if (!o) o = new_buf(51);\n  o.write_shift(1, 0);\n  /* diagonal */\n\n  write_Blxf(null, o);\n  /* top */\n\n  write_Blxf(null, o);\n  /* bottom */\n\n  write_Blxf(null, o);\n  /* left */\n\n  write_Blxf(null, o);\n  /* right */\n\n  write_Blxf(null, o);\n  /* diag */\n\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.763 BrtStyle TODO */\n\n\nfunction write_BrtStyle(style, o) {\n  if (!o) o = new_buf(12 + 4 * 10);\n  o.write_shift(4, style.xfId);\n  o.write_shift(2, 1);\n  o.write_shift(1, +style.builtinId);\n  o.write_shift(1, 0);\n  /* iLevel */\n\n  write_XLNullableWideString(style.name || \"\", o);\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.272 BrtBeginTableStyles */\n\n\nfunction write_BrtBeginTableStyles(cnt, defTableStyle, defPivotStyle) {\n  var o = new_buf(4 + 256 * 2 * 4);\n  o.write_shift(4, cnt);\n  write_XLNullableWideString(defTableStyle, o);\n  write_XLNullableWideString(defPivotStyle, o);\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.1.7.50 Styles */\n\n\nfunction parse_sty_bin(data, themes, opts) {\n  var styles = {};\n  styles.NumberFmt = []\n  /*:any*/\n  ;\n\n  for (var y in table_fmt) styles.NumberFmt[y] = table_fmt[y];\n\n  styles.CellXf = [];\n  styles.Fonts = [];\n  var state\n  /*:Array<string>*/\n  = [];\n  var pass = false;\n  recordhopper(data, function hopper_sty(val, R, RT) {\n    switch (RT) {\n      case 0x002C:\n        /* BrtFmt */\n        styles.NumberFmt[val[0]] = val[1];\n        SSF_load(val[1], val[0]);\n        break;\n\n      case 0x002B:\n        /* BrtFont */\n        styles.Fonts.push(val);\n\n        if (val.color.theme != null && themes && themes.themeElements && themes.themeElements.clrScheme) {\n          val.color.rgb = rgb_tint(themes.themeElements.clrScheme[val.color.theme].rgb, val.color.tint || 0);\n        }\n\n        break;\n\n      case 0x0401:\n        /* BrtKnownFonts */\n        break;\n\n      case 0x002D:\n        /* BrtFill */\n        break;\n\n      case 0x002E:\n        /* BrtBorder */\n        break;\n\n      case 0x002F:\n        /* BrtXF */\n        if (state[state.length - 1] == 0x0269\n        /* BrtBeginCellXFs */\n        ) {\n          styles.CellXf.push(val);\n        }\n\n        break;\n\n      case 0x0030:\n      /* BrtStyle */\n\n      case 0x01FB:\n      /* BrtDXF */\n\n      case 0x023C:\n      /* BrtMRUColor */\n\n      case 0x01DB:\n        /* BrtIndexedColor */\n        break;\n\n      case 0x0493:\n      /* BrtDXF14 */\n\n      case 0x0836:\n      /* BrtDXF15 */\n\n      case 0x046A:\n      /* BrtSlicerStyleElement */\n\n      case 0x0200:\n      /* BrtTableStyleElement */\n\n      case 0x082F:\n      /* BrtTimelineStyleElement */\n\n      case 0x0C00:\n        /* BrtUid */\n        break;\n\n      case 0x0023:\n        /* BrtFRTBegin */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* BrtFRTEnd */\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* BrtACBegin */\n        state.push(RT);\n        pass = true;\n        break;\n\n      case 0x0026:\n        /* BrtACEnd */\n        state.pop();\n        pass = false;\n        break;\n\n      default:\n        if (R.T > 0) state.push(RT);else if (R.T < 0) state.pop();else if (!pass || opts.WTF && state[state.length - 1] != 0x0025\n        /* BrtACBegin */\n        ) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return styles;\n}\n\nfunction write_FMTS_bin(ba, NF\n/*:?SSFTable*/\n) {\n  if (!NF) return;\n  var cnt = 0;\n  [[5, 8], [23, 26], [41, 44], [\n  /*63*/\n  50,\n  /*66],[164,*/\n  392]].forEach(function (r) {\n    /*:: if(!NF) return; */\n    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) ++cnt;\n  });\n  if (cnt == 0) return;\n  write_record(ba, 0x0267\n  /* BrtBeginFmts */\n  , write_UInt32LE(cnt));\n  [[5, 8], [23, 26], [41, 44], [\n  /*63*/\n  50,\n  /*66],[164,*/\n  392]].forEach(function (r) {\n    /*:: if(!NF) return; */\n    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) write_record(ba, 0x002C\n    /* BrtFmt */\n    , write_BrtFmt(i, NF[i]));\n  });\n  write_record(ba, 0x0268\n  /* BrtEndFmts */\n  );\n}\n\nfunction write_FONTS_bin(ba\n/*::, data*/\n) {\n  var cnt = 1;\n  if (cnt == 0) return;\n  write_record(ba, 0x0263\n  /* BrtBeginFonts */\n  , write_UInt32LE(cnt));\n  write_record(ba, 0x002B\n  /* BrtFont */\n  , write_BrtFont({\n    sz: 12,\n    color: {\n      theme: 1\n    },\n    name: \"Calibri\",\n    family: 2,\n    scheme: \"minor\"\n  }));\n  /* 1*65491BrtFont [ACFONTS] */\n\n  write_record(ba, 0x0264\n  /* BrtEndFonts */\n  );\n}\n\nfunction write_FILLS_bin(ba\n/*::, data*/\n) {\n  var cnt = 2;\n  if (cnt == 0) return;\n  write_record(ba, 0x025B\n  /* BrtBeginFills */\n  , write_UInt32LE(cnt));\n  write_record(ba, 0x002D\n  /* BrtFill */\n  , write_BrtFill({\n    patternType: \"none\"\n  }));\n  write_record(ba, 0x002D\n  /* BrtFill */\n  , write_BrtFill({\n    patternType: \"gray125\"\n  }));\n  /* 1*65431BrtFill */\n\n  write_record(ba, 0x025C\n  /* BrtEndFills */\n  );\n}\n\nfunction write_BORDERS_bin(ba\n/*::, data*/\n) {\n  var cnt = 1;\n  if (cnt == 0) return;\n  write_record(ba, 0x0265\n  /* BrtBeginBorders */\n  , write_UInt32LE(cnt));\n  write_record(ba, 0x002E\n  /* BrtBorder */\n  , write_BrtBorder({}));\n  /* 1*65430BrtBorder */\n\n  write_record(ba, 0x0266\n  /* BrtEndBorders */\n  );\n}\n\nfunction write_CELLSTYLEXFS_bin(ba\n/*::, data*/\n) {\n  var cnt = 1;\n  write_record(ba, 0x0272\n  /* BrtBeginCellStyleXFs */\n  , write_UInt32LE(cnt));\n  write_record(ba, 0x002F\n  /* BrtXF */\n  , write_BrtXF({\n    numFmtId: 0,\n    fontId: 0,\n    fillId: 0,\n    borderId: 0\n  }, 0xFFFF));\n  /* 1*65430(BrtXF *FRT) */\n\n  write_record(ba, 0x0273\n  /* BrtEndCellStyleXFs */\n  );\n}\n\nfunction write_CELLXFS_bin(ba, data) {\n  write_record(ba, 0x0269\n  /* BrtBeginCellXFs */\n  , write_UInt32LE(data.length));\n  data.forEach(function (c) {\n    write_record(ba, 0x002F\n    /* BrtXF */\n    , write_BrtXF(c, 0));\n  });\n  /* 1*65430(BrtXF *FRT) */\n\n  write_record(ba, 0x026A\n  /* BrtEndCellXFs */\n  );\n}\n\nfunction write_STYLES_bin(ba\n/*::, data*/\n) {\n  var cnt = 1;\n  write_record(ba, 0x026B\n  /* BrtBeginStyles */\n  , write_UInt32LE(cnt));\n  write_record(ba, 0x0030\n  /* BrtStyle */\n  , write_BrtStyle({\n    xfId: 0,\n    builtinId: 0,\n    name: \"Normal\"\n  }));\n  /* 1*65430(BrtStyle *FRT) */\n\n  write_record(ba, 0x026C\n  /* BrtEndStyles */\n  );\n}\n\nfunction write_DXFS_bin(ba\n/*::, data*/\n) {\n  var cnt = 0;\n  write_record(ba, 0x01F9\n  /* BrtBeginDXFs */\n  , write_UInt32LE(cnt));\n  /* *2147483647(BrtDXF *FRT) */\n\n  write_record(ba, 0x01FA\n  /* BrtEndDXFs */\n  );\n}\n\nfunction write_TABLESTYLES_bin(ba\n/*::, data*/\n) {\n  var cnt = 0;\n  write_record(ba, 0x01FC\n  /* BrtBeginTableStyles */\n  , write_BrtBeginTableStyles(cnt, \"TableStyleMedium9\", \"PivotStyleMedium4\"));\n  /* *TABLESTYLE */\n\n  write_record(ba, 0x01FD\n  /* BrtEndTableStyles */\n  );\n}\n\nfunction\n  /*::ba, data*/\nwrite_COLORPALETTE_bin() {\n  return;\n  /* BrtBeginColorPalette [INDEXEDCOLORS] [MRUCOLORS] BrtEndColorPalette */\n}\n/* [MS-XLSB] 2.1.7.50 Styles */\n\n\nfunction write_sty_bin(wb, opts) {\n  var ba = buf_array();\n  write_record(ba, 0x0116\n  /* BrtBeginStyleSheet */\n  );\n  write_FMTS_bin(ba, wb.SSF);\n  write_FONTS_bin(ba, wb);\n  write_FILLS_bin(ba, wb);\n  write_BORDERS_bin(ba, wb);\n  write_CELLSTYLEXFS_bin(ba, wb);\n  write_CELLXFS_bin(ba, opts.cellXfs);\n  write_STYLES_bin(ba, wb);\n  write_DXFS_bin(ba, wb);\n  write_TABLESTYLES_bin(ba, wb);\n  write_COLORPALETTE_bin(ba, wb);\n  /* FRTSTYLESHEET*/\n\n  write_record(ba, 0x0117\n  /* BrtEndStyleSheet */\n  );\n  return ba.end();\n}\n/* Even though theme layout is dk1 lt1 dk2 lt2, true order is lt1 dk1 lt2 dk2 */\n\n\nvar XLSXThemeClrScheme = ['</a:lt1>', '</a:dk1>', '</a:lt2>', '</a:dk2>', '</a:accent1>', '</a:accent2>', '</a:accent3>', '</a:accent4>', '</a:accent5>', '</a:accent6>', '</a:hlink>', '</a:folHlink>'];\n/* 20.1.6.2 clrScheme CT_ColorScheme */\n\nfunction parse_clrScheme(t, themes, opts) {\n  themes.themeElements.clrScheme = [];\n  var color = {};\n  (t[0].match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (y[0]) {\n      /* 20.1.6.2 clrScheme (Color Scheme) CT_ColorScheme */\n      case '<a:clrScheme':\n      case '</a:clrScheme>':\n        break;\n\n      /* 20.1.2.3.32 srgbClr CT_SRgbColor */\n\n      case '<a:srgbClr':\n        color.rgb = y.val;\n        break;\n\n      /* 20.1.2.3.33 sysClr CT_SystemColor */\n\n      case '<a:sysClr':\n        color.rgb = y.lastClr;\n        break;\n\n      /* 20.1.4.1.1 accent1 (Accent 1) */\n\n      /* 20.1.4.1.2 accent2 (Accent 2) */\n\n      /* 20.1.4.1.3 accent3 (Accent 3) */\n\n      /* 20.1.4.1.4 accent4 (Accent 4) */\n\n      /* 20.1.4.1.5 accent5 (Accent 5) */\n\n      /* 20.1.4.1.6 accent6 (Accent 6) */\n\n      /* 20.1.4.1.9 dk1 (Dark 1) */\n\n      /* 20.1.4.1.10 dk2 (Dark 2) */\n\n      /* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n\n      /* 20.1.4.1.19 hlink (Hyperlink) */\n\n      /* 20.1.4.1.22 lt1 (Light 1) */\n\n      /* 20.1.4.1.23 lt2 (Light 2) */\n\n      case '<a:dk1>':\n      case '</a:dk1>':\n      case '<a:lt1>':\n      case '</a:lt1>':\n      case '<a:dk2>':\n      case '</a:dk2>':\n      case '<a:lt2>':\n      case '</a:lt2>':\n      case '<a:accent1>':\n      case '</a:accent1>':\n      case '<a:accent2>':\n      case '</a:accent2>':\n      case '<a:accent3>':\n      case '</a:accent3>':\n      case '<a:accent4>':\n      case '</a:accent4>':\n      case '<a:accent5>':\n      case '</a:accent5>':\n      case '<a:accent6>':\n      case '</a:accent6>':\n      case '<a:hlink>':\n      case '</a:hlink>':\n      case '<a:folHlink>':\n      case '</a:folHlink>':\n        if (y[0].charAt(1) === '/') {\n          themes.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(y[0])] = color;\n          color = {};\n        } else {\n          color.name = y[0].slice(3, y[0].length - 1);\n        }\n\n        break;\n\n      default:\n        if (opts && opts.WTF) throw new Error('Unrecognized ' + y[0] + ' in clrScheme');\n    }\n  });\n}\n/* 20.1.4.1.18 fontScheme CT_FontScheme */\n\n\nfunction\n  /*::t, themes, opts*/\nparse_fontScheme() {}\n/* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\n\n\nfunction\n  /*::t, themes, opts*/\nparse_fmtScheme() {}\n\nvar clrsregex = /<a:clrScheme([^>]*)>[\\s\\S]*<\\/a:clrScheme>/;\nvar fntsregex = /<a:fontScheme([^>]*)>[\\s\\S]*<\\/a:fontScheme>/;\nvar fmtsregex = /<a:fmtScheme([^>]*)>[\\s\\S]*<\\/a:fmtScheme>/;\n/* 20.1.6.10 themeElements CT_BaseStyles */\n\nfunction parse_themeElements(data, themes, opts) {\n  themes.themeElements = {};\n  var t;\n  [\n  /* clrScheme CT_ColorScheme */\n  ['clrScheme', clrsregex, parse_clrScheme],\n  /* fontScheme CT_FontScheme */\n  ['fontScheme', fntsregex, parse_fontScheme],\n  /* fmtScheme CT_StyleMatrix */\n  ['fmtScheme', fmtsregex, parse_fmtScheme]].forEach(function (m) {\n    if (!(t = data.match(m[1]))) throw new Error(m[0] + ' not found in themeElements');\n    m[2](t, themes, opts);\n  });\n}\n\nvar themeltregex = /<a:themeElements([^>]*)>[\\s\\S]*<\\/a:themeElements>/;\n/* 14.2.7 Theme Part */\n\nfunction parse_theme_xml(data\n/*:string*/\n, opts) {\n  /* 20.1.6.9 theme CT_OfficeStyleSheet */\n  if (!data || data.length === 0) data = write_theme();\n  var t;\n  var themes = {};\n  /* themeElements CT_BaseStyles */\n\n  if (!(t = data.match(themeltregex))) throw new Error('themeElements not found in theme');\n  parse_themeElements(t[0], themes, opts);\n  themes.raw = data;\n  return themes;\n}\n\nfunction write_theme(Themes, opts)\n/*:string*/\n{\n  if (opts && opts.themeXLSX) return opts.themeXLSX;\n  if (Themes && typeof Themes.raw == \"string\") return Themes.raw;\n  var o = [XML_HEADER];\n  o[o.length] = '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">';\n  o[o.length] = '<a:themeElements>';\n  o[o.length] = '<a:clrScheme name=\"Office\">';\n  o[o.length] = '<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>';\n  o[o.length] = '<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>';\n  o[o.length] = '<a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>';\n  o[o.length] = '<a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2>';\n  o[o.length] = '<a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1>';\n  o[o.length] = '<a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2>';\n  o[o.length] = '<a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3>';\n  o[o.length] = '<a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4>';\n  o[o.length] = '<a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>';\n  o[o.length] = '<a:accent6><a:srgbClr val=\"F79646\"/></a:accent6>';\n  o[o.length] = '<a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink>';\n  o[o.length] = '<a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink>';\n  o[o.length] = '</a:clrScheme>';\n  o[o.length] = '<a:fontScheme name=\"Office\">';\n  o[o.length] = '<a:majorFont>';\n  o[o.length] = '<a:latin typeface=\"Cambria\"/>';\n  o[o.length] = '<a:ea typeface=\"\"/>';\n  o[o.length] = '<a:cs typeface=\"\"/>';\n  o[o.length] = '<a:font script=\"Jpan\" typeface=\" \"/>';\n  o[o.length] = '<a:font script=\"Hang\" typeface=\" \"/>';\n  o[o.length] = '<a:font script=\"Hans\" typeface=\"\"/>';\n  o[o.length] = '<a:font script=\"Hant\" typeface=\"\"/>';\n  o[o.length] = '<a:font script=\"Arab\" typeface=\"Times New Roman\"/>';\n  o[o.length] = '<a:font script=\"Hebr\" typeface=\"Times New Roman\"/>';\n  o[o.length] = '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n  o[o.length] = '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n  o[o.length] = '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n  o[o.length] = '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n  o[o.length] = '<a:font script=\"Khmr\" typeface=\"MoolBoran\"/>';\n  o[o.length] = '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n  o[o.length] = '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n  o[o.length] = '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n  o[o.length] = '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n  o[o.length] = '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n  o[o.length] = '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n  o[o.length] = '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n  o[o.length] = '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n  o[o.length] = '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n  o[o.length] = '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n  o[o.length] = '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n  o[o.length] = '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n  o[o.length] = '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n  o[o.length] = '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n  o[o.length] = '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n  o[o.length] = '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n  o[o.length] = '<a:font script=\"Viet\" typeface=\"Times New Roman\"/>';\n  o[o.length] = '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n  o[o.length] = '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n  o[o.length] = '</a:majorFont>';\n  o[o.length] = '<a:minorFont>';\n  o[o.length] = '<a:latin typeface=\"Calibri\"/>';\n  o[o.length] = '<a:ea typeface=\"\"/>';\n  o[o.length] = '<a:cs typeface=\"\"/>';\n  o[o.length] = '<a:font script=\"Jpan\" typeface=\" \"/>';\n  o[o.length] = '<a:font script=\"Hang\" typeface=\" \"/>';\n  o[o.length] = '<a:font script=\"Hans\" typeface=\"\"/>';\n  o[o.length] = '<a:font script=\"Hant\" typeface=\"\"/>';\n  o[o.length] = '<a:font script=\"Arab\" typeface=\"Arial\"/>';\n  o[o.length] = '<a:font script=\"Hebr\" typeface=\"Arial\"/>';\n  o[o.length] = '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n  o[o.length] = '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n  o[o.length] = '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n  o[o.length] = '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n  o[o.length] = '<a:font script=\"Khmr\" typeface=\"DaunPenh\"/>';\n  o[o.length] = '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n  o[o.length] = '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n  o[o.length] = '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n  o[o.length] = '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n  o[o.length] = '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n  o[o.length] = '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n  o[o.length] = '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n  o[o.length] = '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n  o[o.length] = '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n  o[o.length] = '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n  o[o.length] = '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n  o[o.length] = '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n  o[o.length] = '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n  o[o.length] = '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n  o[o.length] = '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n  o[o.length] = '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n  o[o.length] = '<a:font script=\"Viet\" typeface=\"Arial\"/>';\n  o[o.length] = '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n  o[o.length] = '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n  o[o.length] = '</a:minorFont>';\n  o[o.length] = '</a:fontScheme>';\n  o[o.length] = '<a:fmtScheme name=\"Office\">';\n  o[o.length] = '<a:fillStyleLst>';\n  o[o.length] = '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n  o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n  o[o.length] = '<a:gsLst>';\n  o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '</a:gsLst>';\n  o[o.length] = '<a:lin ang=\"16200000\" scaled=\"1\"/>';\n  o[o.length] = '</a:gradFill>';\n  o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n  o[o.length] = '<a:gsLst>';\n  o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '</a:gsLst>';\n  o[o.length] = '<a:lin ang=\"16200000\" scaled=\"0\"/>';\n  o[o.length] = '</a:gradFill>';\n  o[o.length] = '</a:fillStyleLst>';\n  o[o.length] = '<a:lnStyleLst>';\n  o[o.length] = '<a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n  o[o.length] = '<a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n  o[o.length] = '<a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n  o[o.length] = '</a:lnStyleLst>';\n  o[o.length] = '<a:effectStyleLst>';\n  o[o.length] = '<a:effectStyle>';\n  o[o.length] = '<a:effectLst>';\n  o[o.length] = '<a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw>';\n  o[o.length] = '</a:effectLst>';\n  o[o.length] = '</a:effectStyle>';\n  o[o.length] = '<a:effectStyle>';\n  o[o.length] = '<a:effectLst>';\n  o[o.length] = '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n  o[o.length] = '</a:effectLst>';\n  o[o.length] = '</a:effectStyle>';\n  o[o.length] = '<a:effectStyle>';\n  o[o.length] = '<a:effectLst>';\n  o[o.length] = '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n  o[o.length] = '</a:effectLst>';\n  o[o.length] = '<a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d>';\n  o[o.length] = '<a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d>';\n  o[o.length] = '</a:effectStyle>';\n  o[o.length] = '</a:effectStyleLst>';\n  o[o.length] = '<a:bgFillStyleLst>';\n  o[o.length] = '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n  o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n  o[o.length] = '<a:gsLst>';\n  o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '</a:gsLst>';\n  o[o.length] = '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path>';\n  o[o.length] = '</a:gradFill>';\n  o[o.length] = '<a:gradFill rotWithShape=\"1\">';\n  o[o.length] = '<a:gsLst>';\n  o[o.length] = '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs>';\n  o[o.length] = '</a:gsLst>';\n  o[o.length] = '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path>';\n  o[o.length] = '</a:gradFill>';\n  o[o.length] = '</a:bgFillStyleLst>';\n  o[o.length] = '</a:fmtScheme>';\n  o[o.length] = '</a:themeElements>';\n  o[o.length] = '<a:objectDefaults>';\n  o[o.length] = '<a:spDef>';\n  o[o.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style>';\n  o[o.length] = '</a:spDef>';\n  o[o.length] = '<a:lnDef>';\n  o[o.length] = '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style>';\n  o[o.length] = '</a:lnDef>';\n  o[o.length] = '</a:objectDefaults>';\n  o[o.length] = '<a:extraClrSchemeLst/>';\n  o[o.length] = '</a:theme>';\n  return o.join(\"\");\n}\n/* [MS-XLS] 2.4.326 TODO: payload is a zip file */\n\n\nfunction parse_Theme(blob, length, opts) {\n  var end = blob.l + length;\n  var dwThemeVersion = blob.read_shift(4);\n  if (dwThemeVersion === 124226) return;\n\n  if (!opts.cellStyles) {\n    blob.l = end;\n    return;\n  }\n\n  var data = blob.slice(blob.l);\n  blob.l = end;\n  var zip;\n\n  try {\n    zip = zip_read(data, {\n      type: \"array\"\n    });\n  } catch (e) {\n    return;\n  }\n\n  var themeXML = getzipstr(zip, \"theme/theme/theme1.xml\", true);\n  if (!themeXML) return;\n  return parse_theme_xml(themeXML, opts);\n}\n/* 2.5.49 */\n\n\nfunction parse_ColorTheme(blob\n/*::, length*/\n) {\n  return blob.read_shift(4);\n}\n/* 2.5.155 */\n\n\nfunction parse_FullColorExt(blob\n/*::, length*/\n) {\n  var o = {};\n  o.xclrType = blob.read_shift(2);\n  o.nTintShade = blob.read_shift(2);\n\n  switch (o.xclrType) {\n    case 0:\n      blob.l += 4;\n      break;\n\n    case 1:\n      o.xclrValue = parse_IcvXF(blob, 4);\n      break;\n\n    case 2:\n      o.xclrValue = parse_LongRGBA(blob, 4);\n      break;\n\n    case 3:\n      o.xclrValue = parse_ColorTheme(blob, 4);\n      break;\n\n    case 4:\n      blob.l += 4;\n      break;\n  }\n\n  blob.l += 8;\n  return o;\n}\n/* 2.5.164 TODO: read 7 bits*/\n\n\nfunction parse_IcvXF(blob, length) {\n  return parsenoop(blob, length);\n}\n/* 2.5.280 */\n\n\nfunction parse_XFExtGradient(blob, length) {\n  return parsenoop(blob, length);\n}\n/* [MS-XLS] 2.5.108 */\n\n\nfunction parse_ExtProp(blob\n/*::, length*/\n)\n/*:Array<any>*/\n{\n  var extType = blob.read_shift(2);\n  var cb = blob.read_shift(2) - 4;\n  var o = [extType];\n\n  switch (extType) {\n    case 0x04:\n    case 0x05:\n    case 0x07:\n    case 0x08:\n    case 0x09:\n    case 0x0A:\n    case 0x0B:\n    case 0x0D:\n      o[1] = parse_FullColorExt(blob, cb);\n      break;\n\n    case 0x06:\n      o[1] = parse_XFExtGradient(blob, cb);\n      break;\n\n    case 0x0E:\n    case 0x0F:\n      o[1] = blob.read_shift(cb === 1 ? 1 : 2);\n      break;\n\n    default:\n      throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n  }\n\n  return o;\n}\n/* 2.4.355 */\n\n\nfunction parse_XFExt(blob, length) {\n  var end = blob.l + length;\n  blob.l += 2;\n  var ixfe = blob.read_shift(2);\n  blob.l += 2;\n  var cexts = blob.read_shift(2);\n  var ext\n  /*:AOA*/\n  = [];\n\n  while (cexts-- > 0) ext.push(parse_ExtProp(blob, end - blob.l));\n\n  return {\n    ixfe: ixfe,\n    ext: ext\n  };\n}\n/* xf is an XF, see parse_XFExt for xfext */\n\n\nfunction update_xfext(xf, xfext) {\n  xfext.forEach(function (xfe) {\n    switch (xfe[0]) {\n      /* 2.5.108 extPropData */\n      case 0x04:\n        break;\n\n      /* foreground color */\n\n      case 0x05:\n        break;\n\n      /* background color */\n\n      case 0x06:\n        break;\n\n      /* gradient fill */\n\n      case 0x07:\n        break;\n\n      /* top cell border color */\n\n      case 0x08:\n        break;\n\n      /* bottom cell border color */\n\n      case 0x09:\n        break;\n\n      /* left cell border color */\n\n      case 0x0a:\n        break;\n\n      /* right cell border color */\n\n      case 0x0b:\n        break;\n\n      /* diagonal cell border color */\n\n      case 0x0d:\n        /* text color */\n        break;\n\n      case 0x0e:\n        break;\n\n      /* font scheme */\n\n      case 0x0f:\n        break;\n\n      /* indentation level */\n    }\n  });\n}\n\nfunction parse_BrtMdtinfo(data, length) {\n  return {\n    flags: data.read_shift(4),\n    version: data.read_shift(4),\n    name: parse_XLWideString(data, length - 8)\n  };\n}\n\nfunction write_BrtMdtinfo(data) {\n  var o = new_buf(12 + 2 * data.name.length);\n  o.write_shift(4, data.flags);\n  o.write_shift(4, data.version);\n  write_XLWideString(data.name, o);\n  return o.slice(0, o.l);\n}\n\nfunction parse_BrtMdb(data) {\n  var out = [];\n  var cnt = data.read_shift(4);\n\n  while (cnt-- > 0) out.push([data.read_shift(4), data.read_shift(4)]);\n\n  return out;\n}\n\nfunction write_BrtMdb(mdb) {\n  var o = new_buf(4 + 8 * mdb.length);\n  o.write_shift(4, mdb.length);\n\n  for (var i = 0; i < mdb.length; ++i) {\n    o.write_shift(4, mdb[i][0]);\n    o.write_shift(4, mdb[i][1]);\n  }\n\n  return o;\n}\n\nfunction write_BrtBeginEsfmd(cnt, name) {\n  var o = new_buf(8 + 2 * name.length);\n  o.write_shift(4, cnt);\n  write_XLWideString(name, o);\n  return o.slice(0, o.l);\n}\n\nfunction parse_BrtBeginEsmdb(data) {\n  data.l += 4;\n  return data.read_shift(4) != 0;\n}\n\nfunction write_BrtBeginEsmdb(cnt, cm) {\n  var o = new_buf(8);\n  o.write_shift(4, cnt);\n  o.write_shift(4, cm ? 1 : 0);\n  return o;\n}\n\nfunction parse_xlmeta_bin(data, name, _opts) {\n  var out = {\n    Types: [],\n    Cell: [],\n    Value: []\n  };\n  var opts = _opts || {};\n  var state = [];\n  var pass = false;\n  var metatype = 2;\n  recordhopper(data, function (val, R, RT) {\n    switch (RT) {\n      case 335:\n        out.Types.push({\n          name: val.name\n        });\n        break;\n\n      case 51:\n        val.forEach(function (r) {\n          if (metatype == 1) out.Cell.push({\n            type: out.Types[r[0] - 1].name,\n            index: r[1]\n          });else if (metatype == 0) out.Value.push({\n            type: out.Types[r[0] - 1].name,\n            index: r[1]\n          });\n        });\n        break;\n\n      case 337:\n        metatype = val ? 1 : 0;\n        break;\n\n      case 338:\n        metatype = 2;\n        break;\n\n      case 35:\n        state.push(RT);\n        pass = true;\n        break;\n\n      case 36:\n        state.pop();\n        pass = false;\n        break;\n\n      default:\n        if (R.T) {} else if (!pass || opts.WTF && state[state.length - 1] != 35) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\n    }\n  });\n  return out;\n}\n\nfunction write_xlmeta_bin() {\n  var ba = buf_array();\n  write_record(ba, 332);\n  write_record(ba, 334, write_UInt32LE(1));\n  write_record(ba, 335, write_BrtMdtinfo({\n    name: \"XLDAPR\",\n    version: 12e4,\n    flags: 3496657072\n  }));\n  write_record(ba, 336);\n  write_record(ba, 339, write_BrtBeginEsfmd(1, \"XLDAPR\"));\n  write_record(ba, 52);\n  write_record(ba, 35, write_UInt32LE(514));\n  write_record(ba, 4096, write_UInt32LE(0));\n  write_record(ba, 4097, writeuint16(1));\n  write_record(ba, 36);\n  write_record(ba, 53);\n  write_record(ba, 340);\n  write_record(ba, 337, write_BrtBeginEsmdb(1, true));\n  write_record(ba, 51, write_BrtMdb([[1, 0]]));\n  write_record(ba, 338);\n  write_record(ba, 333);\n  return ba.end();\n}\n\nfunction parse_xlmeta_xml(data, name, opts) {\n  var out = {\n    Types: [],\n    Cell: [],\n    Value: []\n  };\n  if (!data) return out;\n  var pass = false;\n  var metatype = 2;\n  var lastmeta;\n  data.replace(tagregex, function (x) {\n    var y = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case \"<?xml\":\n        break;\n\n      case \"<metadata\":\n      case \"</metadata>\":\n        break;\n\n      case \"<metadataTypes\":\n      case \"</metadataTypes>\":\n        break;\n\n      case \"<metadataType\":\n        out.Types.push({\n          name: y.name\n        });\n        break;\n\n      case \"</metadataType>\":\n        break;\n\n      case \"<futureMetadata\":\n        for (var j = 0; j < out.Types.length; ++j) if (out.Types[j].name == y.name) lastmeta = out.Types[j];\n\n        break;\n\n      case \"</futureMetadata>\":\n        break;\n\n      case \"<bk>\":\n        break;\n\n      case \"</bk>\":\n        break;\n\n      case \"<rc\":\n        if (metatype == 1) out.Cell.push({\n          type: out.Types[y.t - 1].name,\n          index: +y.v\n        });else if (metatype == 0) out.Value.push({\n          type: out.Types[y.t - 1].name,\n          index: +y.v\n        });\n        break;\n\n      case \"</rc>\":\n        break;\n\n      case \"<cellMetadata\":\n        metatype = 1;\n        break;\n\n      case \"</cellMetadata>\":\n        metatype = 2;\n        break;\n\n      case \"<valueMetadata\":\n        metatype = 0;\n        break;\n\n      case \"</valueMetadata>\":\n        metatype = 2;\n        break;\n\n      case \"<extLst\":\n      case \"<extLst>\":\n      case \"</extLst>\":\n      case \"<extLst/>\":\n        break;\n\n      case \"<ext\":\n        pass = true;\n        break;\n\n      case \"</ext>\":\n        pass = false;\n        break;\n\n      case \"<rvb\":\n        if (!lastmeta) break;\n        if (!lastmeta.offsets) lastmeta.offsets = [];\n        lastmeta.offsets.push(+y.i);\n        break;\n\n      default:\n        if (!pass && opts.WTF) throw new Error(\"unrecognized \" + y[0] + \" in metadata\");\n    }\n\n    return x;\n  });\n  return out;\n}\n\nfunction write_xlmeta_xml() {\n  var o = [XML_HEADER];\n  o.push('<metadata xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:xlrd=\"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata\" xmlns:xda=\"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray\">\\n  <metadataTypes count=\"1\">\\n    <metadataType name=\"XLDAPR\" minSupportedVersion=\"120000\" copy=\"1\" pasteAll=\"1\" pasteValues=\"1\" merge=\"1\" splitFirst=\"1\" rowColShift=\"1\" clearFormats=\"1\" clearComments=\"1\" assign=\"1\" coerce=\"1\" cellMeta=\"1\"/>\\n  </metadataTypes>\\n  <futureMetadata name=\"XLDAPR\" count=\"1\">\\n    <bk>\\n      <extLst>\\n        <ext uri=\"{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}\">\\n          <xda:dynamicArrayProperties fDynamic=\"1\" fCollapsed=\"0\"/>\\n        </ext>\\n      </extLst>\\n    </bk>\\n  </futureMetadata>\\n  <cellMetadata count=\"1\">\\n    <bk>\\n      <rc t=\"1\" v=\"0\"/>\\n    </bk>\\n  </cellMetadata>\\n</metadata>');\n  return o.join(\"\");\n}\n/* 18.6 Calculation Chain */\n\n\nfunction parse_cc_xml(data\n/*::, name, opts*/\n)\n/*:Array<any>*/\n{\n  var d = [];\n  if (!data) return d;\n  var i = 1;\n  (data.match(tagregex) || []).forEach(function (x) {\n    var y = parsexmltag(x);\n\n    switch (y[0]) {\n      case '<?xml':\n        break;\n\n      /* 18.6.2  calcChain CT_CalcChain 1 */\n\n      case '<calcChain':\n      case '<calcChain>':\n      case '</calcChain>':\n        break;\n\n      /* 18.6.1  c CT_CalcCell 1 */\n\n      case '<c':\n        delete y[0];\n        if (y.i) i = y.i;else y.i = i;\n        d.push(y);\n        break;\n    }\n  });\n  return d;\n} //function write_cc_xml(data, opts) { }\n\n/* [MS-XLSB] 2.6.4.1 */\n\n\nfunction parse_BrtCalcChainItem$(data) {\n  var out = {};\n  out.i = data.read_shift(4);\n  var cell = {};\n  cell.r = data.read_shift(4);\n  cell.c = data.read_shift(4);\n  out.r = encode_cell(cell);\n  var flags = data.read_shift(1);\n  if (flags & 0x2) out.l = '1';\n  if (flags & 0x8) out.a = '1';\n  return out;\n}\n/* 18.6 Calculation Chain */\n\n\nfunction parse_cc_bin(data, name, opts) {\n  var out = [];\n  var pass = false;\n  recordhopper(data, function hopper_cc(val, R, RT) {\n    switch (RT) {\n      case 0x003F:\n        /* 'BrtCalcChainItem$' */\n        out.push(val);\n        break;\n\n      default:\n        if (R.T) {\n          /* empty */\n        } else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\n    }\n  });\n  return out;\n} //function write_cc_bin(data, opts) { }\n\n/* 18.14 Supplementary Workbook Data */\n\n\nfunction\n  /*::data, rel, name:string, _opts*/\nparse_xlink_xml() {//var opts = _opts || {};\n  //if(opts.WTF) throw \"XLSX External Link\";\n}\n/* [MS-XLSB] 2.1.7.25 External Link */\n\n\nfunction parse_xlink_bin(data, rel, name\n/*:string*/\n, _opts) {\n  if (!data) return data;\n  var opts = _opts || {};\n  var pass = false,\n      end = false;\n  recordhopper(data, function xlink_parse(val, R, RT) {\n    if (end) return;\n\n    switch (RT) {\n      case 0x0167:\n      /* 'BrtSupTabs' */\n\n      case 0x016B:\n      /* 'BrtExternTableStart' */\n\n      case 0x016C:\n      /* 'BrtExternTableEnd' */\n\n      case 0x016E:\n      /* 'BrtExternRowHdr' */\n\n      case 0x016F:\n      /* 'BrtExternCellBlank' */\n\n      case 0x0170:\n      /* 'BrtExternCellReal' */\n\n      case 0x0171:\n      /* 'BrtExternCellBool' */\n\n      case 0x0172:\n      /* 'BrtExternCellError' */\n\n      case 0x0173:\n      /* 'BrtExternCellString' */\n\n      case 0x01D8:\n      /* 'BrtExternValueMeta' */\n\n      case 0x0241:\n      /* 'BrtSupNameStart' */\n\n      case 0x0242:\n      /* 'BrtSupNameValueStart' */\n\n      case 0x0243:\n      /* 'BrtSupNameValueEnd' */\n\n      case 0x0244:\n      /* 'BrtSupNameNum' */\n\n      case 0x0245:\n      /* 'BrtSupNameErr' */\n\n      case 0x0246:\n      /* 'BrtSupNameSt' */\n\n      case 0x0247:\n      /* 'BrtSupNameNil' */\n\n      case 0x0248:\n      /* 'BrtSupNameBool' */\n\n      case 0x0249:\n      /* 'BrtSupNameFmla' */\n\n      case 0x024A:\n      /* 'BrtSupNameBits' */\n\n      case 0x024B:\n        /* 'BrtSupNameEnd' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        pass = false;\n        break;\n\n      default:\n        if (R.T) {\n          /* empty */\n        } else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\n    }\n  }, opts);\n}\n/* 20.5 DrawingML - SpreadsheetML Drawing */\n\n/* 20.5.2.35 wsDr CT_Drawing */\n\n\nfunction parse_drawing(data, rels\n/*:any*/\n) {\n  if (!data) return \"??\";\n  /*\n    Chartsheet Drawing:\n     - 20.5.2.35 wsDr CT_Drawing\n      - 20.5.2.1  absoluteAnchor CT_AbsoluteAnchor\n       - 20.5.2.16 graphicFrame CT_GraphicalObjectFrame\n        - 20.1.2.2.16 graphic CT_GraphicalObject\n         - 20.1.2.2.17 graphicData CT_GraphicalObjectData\n           - chart reference\n     the actual type is based on the URI of the graphicData\n  \tTODO: handle embedded charts and other types of graphics\n  */\n\n  var id = (data.match(/<c:chart [^>]*r:id=\"([^\"]*)\"/) || [\"\", \"\"])[1];\n  return rels['!id'][id].Target;\n}\n/* L.5.5.2 SpreadsheetML Comments + VML Schema */\n\n\nvar _shapeid = 1024;\n\nfunction write_comments_vml(rId\n/*:number*/\n, comments) {\n  var csize = [21600, 21600];\n  /* L.5.2.1.2 Path Attribute */\n\n  var bbox = [\"m0,0l0\", csize[1], csize[0], csize[1], csize[0], \"0xe\"].join(\",\");\n  var o = [writextag(\"xml\", null, {\n    'xmlns:v': XLMLNS.v,\n    'xmlns:o': XLMLNS.o,\n    'xmlns:x': XLMLNS.x,\n    'xmlns:mv': XLMLNS.mv\n  }).replace(/\\/>/, \">\"), writextag(\"o:shapelayout\", writextag(\"o:idmap\", null, {\n    'v:ext': \"edit\",\n    'data': rId\n  }), {\n    'v:ext': \"edit\"\n  }), writextag(\"v:shapetype\", [writextag(\"v:stroke\", null, {\n    joinstyle: \"miter\"\n  }), writextag(\"v:path\", null, {\n    gradientshapeok: \"t\",\n    'o:connecttype': \"rect\"\n  })].join(\"\"), {\n    id: \"_x0000_t202\",\n    'o:spt': 202,\n    coordsize: csize.join(\",\"),\n    path: bbox\n  })];\n\n  while (_shapeid < rId * 1000) _shapeid += 1000;\n\n  comments.forEach(function (x) {\n    var c = decode_cell(x[0]);\n    var fillopts =\n    /*::(*/\n    {\n      'color2': \"#BEFF82\",\n      'type': \"gradient\"\n    }\n    /*:: :any)*/\n    ;\n    if (fillopts.type == \"gradient\") fillopts.angle = \"-180\";\n    var fillparm = fillopts.type == \"gradient\" ? writextag(\"o:fill\", null, {\n      type: \"gradientUnscaled\",\n      'v:ext': \"view\"\n    }) : null;\n    var fillxml = writextag('v:fill', fillparm, fillopts);\n    var shadata = {\n      on: \"t\",\n      'obscured': \"t\"\n    }\n    /*:any*/\n    ;\n    ++_shapeid;\n    o = o.concat(['<v:shape' + wxt_helper({\n      id: '_x0000_s' + _shapeid,\n      type: \"#_x0000_t202\",\n      style: \"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10\" + (x[1].hidden ? \";visibility:hidden\" : \"\"),\n      fillcolor: \"#ECFAD4\",\n      strokecolor: \"#edeaa1\"\n    }) + '>', fillxml, writextag(\"v:shadow\", null, shadata), writextag(\"v:path\", null, {\n      'o:connecttype': \"none\"\n    }), '<v:textbox><div style=\"text-align:left\"></div></v:textbox>', '<x:ClientData ObjectType=\"Note\">', '<x:MoveWithCells/>', '<x:SizeWithCells/>',\n    /* Part 4 19.4.2.3 Anchor (Anchor) */\n    writetag('x:Anchor', [c.c + 1, 0, c.r + 1, 0, c.c + 3, 20, c.r + 5, 20].join(\",\")), writetag('x:AutoFill', \"False\"), writetag('x:Row', String(c.r)), writetag('x:Column', String(c.c)), x[1].hidden ? '' : '<x:Visible/>', '</x:ClientData>', '</v:shape>']);\n  });\n  o.push('</xml>');\n  return o.join(\"\");\n}\n\nfunction sheet_insert_comments(sheet, comments\n/*:Array<RawComment>*/\n, threaded\n/*:boolean*/\n, people\n/*:?Array<any>*/\n) {\n  var dense = Array.isArray(sheet);\n  var cell\n  /*:Cell*/\n  ;\n  comments.forEach(function (comment) {\n    var r = decode_cell(comment.ref);\n\n    if (dense) {\n      if (!sheet[r.r]) sheet[r.r] = [];\n      cell = sheet[r.r][r.c];\n    } else cell = sheet[comment.ref];\n\n    if (!cell) {\n      cell = {\n        t: \"z\"\n      }\n      /*:any*/\n      ;\n      if (dense) sheet[r.r][r.c] = cell;else sheet[comment.ref] = cell;\n      var range = safe_decode_range(sheet[\"!ref\"] || \"BDWGO1000001:A1\");\n      if (range.s.r > r.r) range.s.r = r.r;\n      if (range.e.r < r.r) range.e.r = r.r;\n      if (range.s.c > r.c) range.s.c = r.c;\n      if (range.e.c < r.c) range.e.c = r.c;\n      var encoded = encode_range(range);\n      if (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\n    }\n\n    if (!cell.c) cell.c = [];\n    var o\n    /*:Comment*/\n    = {\n      a: comment.author,\n      t: comment.t,\n      r: comment.r,\n      T: threaded\n    };\n    if (comment.h) o.h = comment.h;\n    /* threaded comments always override */\n\n    for (var i = cell.c.length - 1; i >= 0; --i) {\n      if (!threaded && cell.c[i].T) return;\n      if (threaded && !cell.c[i].T) cell.c.splice(i, 1);\n    }\n\n    if (threaded && people) for (i = 0; i < people.length; ++i) {\n      if (o.a == people[i].id) {\n        o.a = people[i].name || o.a;\n        break;\n      }\n    }\n    cell.c.push(o);\n  });\n}\n/* 18.7 Comments */\n\n\nfunction parse_comments_xml(data\n/*:string*/\n, opts)\n/*:Array<RawComment>*/\n{\n  /* 18.7.6 CT_Comments */\n  if (data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n  var authors\n  /*:Array<string>*/\n  = [];\n  var commentList\n  /*:Array<RawComment>*/\n  = [];\n  var authtag = data.match(/<(?:\\w+:)?authors>([\\s\\S]*)<\\/(?:\\w+:)?authors>/);\n  if (authtag && authtag[1]) authtag[1].split(/<\\/\\w*:?author>/).forEach(function (x) {\n    if (x === \"\" || x.trim() === \"\") return;\n    var a = x.match(/<(?:\\w+:)?author[^>]*>(.*)/);\n    if (a) authors.push(a[1]);\n  });\n  var cmnttag = data.match(/<(?:\\w+:)?commentList>([\\s\\S]*)<\\/(?:\\w+:)?commentList>/);\n  if (cmnttag && cmnttag[1]) cmnttag[1].split(/<\\/\\w*:?comment>/).forEach(function (x) {\n    if (x === \"\" || x.trim() === \"\") return;\n    var cm = x.match(/<(?:\\w+:)?comment[^>]*>/);\n    if (!cm) return;\n    var y = parsexmltag(cm[0]);\n    var comment\n    /*:RawComment*/\n    = {\n      author: y.authorId && authors[y.authorId] || \"sheetjsghost\",\n      ref: y.ref,\n      guid: y.guid\n    }\n    /*:any*/\n    ;\n    var cell = decode_cell(y.ref);\n    if (opts.sheetRows && opts.sheetRows <= cell.r) return;\n    var textMatch = x.match(/<(?:\\w+:)?text>([\\s\\S]*)<\\/(?:\\w+:)?text>/);\n    var rt = !!textMatch && !!textMatch[1] && parse_si(textMatch[1]) || {\n      r: \"\",\n      t: \"\",\n      h: \"\"\n    };\n    comment.r = rt.r;\n    if (rt.r == \"<t></t>\") rt.t = rt.h = \"\";\n    comment.t = (rt.t || \"\").replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n    if (opts.cellHTML) comment.h = rt.h;\n    commentList.push(comment);\n  });\n  return commentList;\n}\n\nfunction write_comments_xml(data\n/*::, opts*/\n) {\n  var o = [XML_HEADER, writextag('comments', null, {\n    'xmlns': XMLNS_main[0]\n  })];\n  var iauthor\n  /*:Array<string>*/\n  = [];\n  o.push(\"<authors>\");\n  data.forEach(function (x) {\n    x[1].forEach(function (w) {\n      var a = escapexml(w.a);\n\n      if (iauthor.indexOf(a) == -1) {\n        iauthor.push(a);\n        o.push(\"<author>\" + a + \"</author>\");\n      }\n\n      if (w.T && w.ID && iauthor.indexOf(\"tc=\" + w.ID) == -1) {\n        iauthor.push(\"tc=\" + w.ID);\n        o.push(\"<author>\" + \"tc=\" + w.ID + \"</author>\");\n      }\n    });\n  });\n\n  if (iauthor.length == 0) {\n    iauthor.push(\"SheetJ5\");\n    o.push(\"<author>SheetJ5</author>\");\n  }\n\n  o.push(\"</authors>\");\n  o.push(\"<commentList>\");\n  data.forEach(function (d) {\n    /* 18.7.3 CT_Comment */\n    var lastauthor = 0,\n        ts = [];\n    if (d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);else d[1].forEach(function (c) {\n      if (c.a) lastauthor = iauthor.indexOf(escapexml(c.a));\n      ts.push(c.t || \"\");\n    });\n    o.push('<comment ref=\"' + d[0] + '\" authorId=\"' + lastauthor + '\"><text>');\n    if (ts.length <= 1) o.push(writetag(\"t\", escapexml(ts[0] || \"\")));else {\n      /* based on Threaded Comments -> Comments projection */\n      var t = \"Comment:\\n    \" + ts[0] + \"\\n\";\n\n      for (var i = 1; i < ts.length; ++i) t += \"Reply:\\n    \" + ts[i] + \"\\n\";\n\n      o.push(writetag(\"t\", escapexml(t)));\n    }\n    o.push('</text></comment>');\n  });\n  o.push(\"</commentList>\");\n\n  if (o.length > 2) {\n    o[o.length] = '</comments>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* [MS-XLSX] 2.1.17 */\n\n\nfunction parse_tcmnt_xml(data\n/*:string*/\n, opts)\n/*:Array<RawComment>*/\n{\n  var out = [];\n  var pass = false,\n      comment = {},\n      tidx = 0;\n  data.replace(tagregex, function xml_tcmnt(x, idx) {\n    var y\n    /*:any*/\n    = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<?xml':\n        break;\n\n      /* 2.6.207 ThreadedComments CT_ThreadedComments */\n\n      case '<ThreadedComments':\n        break;\n\n      case '</ThreadedComments>':\n        break;\n\n      /* 2.6.205 threadedComment CT_ThreadedComment */\n\n      case '<threadedComment':\n        comment = {\n          author: y.personId,\n          guid: y.id,\n          ref: y.ref,\n          T: 1\n        };\n        break;\n\n      case '</threadedComment>':\n        if (comment.t != null) out.push(comment);\n        break;\n\n      case '<text>':\n      case '<text':\n        tidx = idx + x.length;\n        break;\n\n      case '</text>':\n        comment.t = data.slice(tidx, idx).replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n        break;\n\n      /* 2.6.206 mentions CT_ThreadedCommentMentions TODO */\n\n      case '<mentions':\n      case '<mentions>':\n        pass = true;\n        break;\n\n      case '</mentions>':\n        pass = false;\n        break;\n\n      /* 2.6.202 mention CT_Mention TODO */\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n      case '<extLst/>':\n        break;\n\n      /* 18.2.7  ext CT_Extension + */\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n    }\n\n    return x;\n  });\n  return out;\n}\n\nfunction write_tcmnt_xml(comments, people, opts) {\n  var o = [XML_HEADER, writextag('ThreadedComments', null, {\n    'xmlns': XMLNS.TCMNT\n  }).replace(/[\\/]>/, \">\")];\n  comments.forEach(function (carr) {\n    var rootid = \"\";\n    (carr[1] || []).forEach(function (c, idx) {\n      if (!c.T) {\n        delete c.ID;\n        return;\n      }\n\n      if (c.a && people.indexOf(c.a) == -1) people.push(c.a);\n      var tcopts = {\n        ref: carr[0],\n        id: \"{54EE7951-7262-4200-6969-\" + (\"000000000000\" + opts.tcid++).slice(-12) + \"}\"\n      };\n      if (idx == 0) rootid = tcopts.id;else tcopts.parentId = rootid;\n      c.ID = tcopts.id;\n      if (c.a) tcopts.personId = \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + people.indexOf(c.a)).slice(-12) + \"}\";\n      o.push(writextag('threadedComment', writetag('text', c.t || \"\"), tcopts));\n    });\n  });\n  o.push('</ThreadedComments>');\n  return o.join(\"\");\n}\n/* [MS-XLSX] 2.1.18 */\n\n\nfunction parse_people_xml(data\n/*:string*/\n, opts) {\n  var out = [];\n  var pass = false;\n  data.replace(tagregex, function xml_tcmnt(x) {\n    var y\n    /*:any*/\n    = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<?xml':\n        break;\n\n      /* 2.4.85 personList CT_PersonList */\n\n      case '<personList':\n        break;\n\n      case '</personList>':\n        break;\n\n      /* 2.6.203 person CT_Person TODO: providers */\n\n      case '<person':\n        out.push({\n          name: y.displayname,\n          id: y.id\n        });\n        break;\n\n      case '</person>':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n      case '<extLst/>':\n        break;\n\n      /* 18.2.7  ext CT_Extension + */\n\n      case '<ext':\n        pass = true;\n        break;\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      default:\n        if (!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n    }\n\n    return x;\n  });\n  return out;\n}\n\nfunction write_people_xml(people\n/*, opts*/\n) {\n  var o = [XML_HEADER, writextag('personList', null, {\n    'xmlns': XMLNS.TCMNT,\n    'xmlns:x': XMLNS_main[0]\n  }).replace(/[\\/]>/, \">\")];\n  people.forEach(function (person, idx) {\n    o.push(writextag('person', null, {\n      displayName: person,\n      id: \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + idx).slice(-12) + \"}\",\n      userId: person,\n      providerId: \"None\"\n    }));\n  });\n  o.push(\"</personList>\");\n  return o.join(\"\");\n}\n/* [MS-XLSB] 2.4.28 BrtBeginComment */\n\n\nfunction parse_BrtBeginComment(data) {\n  var out = {};\n  out.iauthor = data.read_shift(4);\n  var rfx = parse_UncheckedRfX(data, 16);\n  out.rfx = rfx.s;\n  out.ref = encode_cell(rfx.s);\n  data.l += 16;\n  /*var guid = parse_GUID(data); */\n\n  return out;\n}\n\nfunction write_BrtBeginComment(data, o) {\n  if (o == null) o = new_buf(36);\n  o.write_shift(4, data[1].iauthor);\n  write_UncheckedRfX(data[0]\n  /*:any*/\n  , o);\n  o.write_shift(4, 0);\n  o.write_shift(4, 0);\n  o.write_shift(4, 0);\n  o.write_shift(4, 0);\n  return o;\n}\n/* [MS-XLSB] 2.4.327 BrtCommentAuthor */\n\n\nvar parse_BrtCommentAuthor = parse_XLWideString;\n\nfunction write_BrtCommentAuthor(data) {\n  return write_XLWideString(data.slice(0, 54));\n}\n/* [MS-XLSB] 2.1.7.8 Comments */\n\n\nfunction parse_comments_bin(data, opts)\n/*:Array<RawComment>*/\n{\n  var out\n  /*:Array<RawComment>*/\n  = [];\n  var authors\n  /*:Array<string>*/\n  = [];\n  var c = {};\n  var pass = false;\n  recordhopper(data, function hopper_cmnt(val, R, RT) {\n    switch (RT) {\n      case 0x0278:\n        /* 'BrtCommentAuthor' */\n        authors.push(val);\n        break;\n\n      case 0x027B:\n        /* 'BrtBeginComment' */\n        c = val;\n        break;\n\n      case 0x027D:\n        /* 'BrtCommentText' */\n        c.t = val.t;\n        c.h = val.h;\n        c.r = val.r;\n        break;\n\n      case 0x027C:\n        /* 'BrtEndComment' */\n        c.author = authors[c.iauthor];\n        delete c\n        /*:any*/\n        .iauthor;\n        if (opts.sheetRows && c.rfx && opts.sheetRows <= c.rfx.r) break;\n        if (!c.t) c.t = \"\";\n        delete c.rfx;\n        out.push(c);\n        break;\n\n      case 0x0C00:\n        /* 'BrtUid' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* 'BrtACBegin' */\n        break;\n\n      case 0x0026:\n        /* 'BrtACEnd' */\n        break;\n\n      default:\n        if (R.T) {\n          /* empty */\n        } else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\n    }\n  });\n  return out;\n}\n\nfunction write_comments_bin(data\n/*::, opts*/\n) {\n  var ba = buf_array();\n  var iauthor\n  /*:Array<string>*/\n  = [];\n  write_record(ba, 0x0274\n  /* BrtBeginComments */\n  );\n  write_record(ba, 0x0276\n  /* BrtBeginCommentAuthors */\n  );\n  data.forEach(function (comment) {\n    comment[1].forEach(function (c) {\n      if (iauthor.indexOf(c.a) > -1) return;\n      iauthor.push(c.a.slice(0, 54));\n      write_record(ba, 0x0278\n      /* BrtCommentAuthor */\n      , write_BrtCommentAuthor(c.a));\n    });\n  });\n  write_record(ba, 0x0277\n  /* BrtEndCommentAuthors */\n  );\n  write_record(ba, 0x0279\n  /* BrtBeginCommentList */\n  );\n  data.forEach(function (comment) {\n    comment[1].forEach(function (c) {\n      c.iauthor = iauthor.indexOf(c.a);\n      var range = {\n        s: decode_cell(comment[0]),\n        e: decode_cell(comment[0])\n      };\n      write_record(ba, 0x027B\n      /* BrtBeginComment */\n      , write_BrtBeginComment([range, c]));\n      if (c.t && c.t.length > 0) write_record(ba, 0x027D\n      /* BrtCommentText */\n      , write_BrtCommentText(c));\n      write_record(ba, 0x027C\n      /* BrtEndComment */\n      );\n      delete c.iauthor;\n    });\n  });\n  write_record(ba, 0x027A\n  /* BrtEndCommentList */\n  );\n  write_record(ba, 0x0275\n  /* BrtEndComments */\n  );\n  return ba.end();\n}\n\nvar CT_VBA = \"application/vnd.ms-office.vbaProject\";\n\nfunction make_vba_xls(cfb) {\n  var newcfb = CFB.utils.cfb_new({\n    root: \"R\"\n  });\n  cfb.FullPaths.forEach(function (p, i) {\n    if (p.slice(-1) === \"/\" || !p.match(/_VBA_PROJECT_CUR/)) return;\n    var newpath = p.replace(/^[^\\/]*/, \"R\").replace(/\\/_VBA_PROJECT_CUR\\u0000*/, \"\");\n    CFB.utils.cfb_add(newcfb, newpath, cfb.FileIndex[i].content);\n  });\n  return CFB.write(newcfb);\n}\n\nfunction fill_vba_xls(cfb, vba) {\n  vba.FullPaths.forEach(function (p, i) {\n    if (i == 0) return;\n    var newpath = p.replace(/[^\\/]*[\\/]/, \"/_VBA_PROJECT_CUR/\");\n    if (newpath.slice(-1) !== \"/\") CFB.utils.cfb_add(cfb, newpath, vba.FileIndex[i].content);\n  });\n}\n\nvar VBAFMTS = [\"xlsb\", \"xlsm\", \"xlam\", \"biff8\", \"xla\"];\n/* macro and dialog sheet stubs */\n\nfunction\n  /*::data:any, opts, idx:number, rels, wb, themes, styles*/\nparse_ds_bin()\n/*:Worksheet*/\n{\n  return {\n    '!type': 'dialog'\n  };\n}\n\nfunction\n  /*::data:any, opts, idx:number, rels, wb, themes, styles*/\nparse_ds_xml()\n/*:Worksheet*/\n{\n  return {\n    '!type': 'dialog'\n  };\n}\n\nfunction\n  /*::data:any, opts, idx:number, rels, wb, themes, styles*/\nparse_ms_bin()\n/*:Worksheet*/\n{\n  return {\n    '!type': 'macro'\n  };\n}\n\nfunction\n  /*::data:any, opts, idx:number, rels, wb, themes, styles*/\nparse_ms_xml()\n/*:Worksheet*/\n{\n  return {\n    '!type': 'macro'\n  };\n}\n/* TODO: it will be useful to parse the function str */\n\n\nvar rc_to_a1 = /*#__PURE__*/function () {\n  var rcregex = /(^|[^A-Za-z_])R(\\[?-?\\d+\\]|[1-9]\\d*|)C(\\[?-?\\d+\\]|[1-9]\\d*|)(?![A-Za-z0-9_])/g;\n  var rcbase\n  /*:Cell*/\n  = {\n    r: 0,\n    c: 0\n  }\n  /*:any*/\n  ;\n\n  function rcfunc($$, $1, $2, $3) {\n    var cRel = false,\n        rRel = false;\n    if ($2.length == 0) rRel = true;else if ($2.charAt(0) == \"[\") {\n      rRel = true;\n      $2 = $2.slice(1, -1);\n    }\n    if ($3.length == 0) cRel = true;else if ($3.charAt(0) == \"[\") {\n      cRel = true;\n      $3 = $3.slice(1, -1);\n    }\n    var R = $2.length > 0 ? parseInt($2, 10) | 0 : 0,\n        C = $3.length > 0 ? parseInt($3, 10) | 0 : 0;\n    if (cRel) C += rcbase.c;else --C;\n    if (rRel) R += rcbase.r;else --R;\n    return $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\n  }\n\n  return function rc_to_a1(fstr\n  /*:string*/\n  , base\n  /*:Cell*/\n  )\n  /*:string*/\n  {\n    rcbase = base;\n    return fstr.replace(rcregex, rcfunc);\n  };\n}();\n\nvar crefregex = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})(?![_.\\(A-Za-z0-9])/g;\n\nvar a1_to_rc = /*#__PURE__*/function () {\n  return function a1_to_rc(fstr\n  /*:string*/\n  , base\n  /*:CellAddress*/\n  ) {\n    return fstr.replace(crefregex, function ($0, $1, $2, $3, $4, $5) {\n      var c = decode_col($3) - ($2 ? 0 : base.c);\n      var r = decode_row($5) - ($4 ? 0 : base.r);\n      var R = r == 0 ? \"\" : !$4 ? \"[\" + r + \"]\" : r + 1;\n      var C = c == 0 ? \"\" : !$2 ? \"[\" + c + \"]\" : c + 1;\n      return $1 + \"R\" + R + \"C\" + C;\n    });\n  };\n}();\n/* no defined name can collide with a valid cell address A1:XFD1048576 ... except LOG10! */\n\n\nfunction shift_formula_str(f\n/*:string*/\n, delta\n/*:Cell*/\n)\n/*:string*/\n{\n  return f.replace(crefregex, function ($0, $1, $2, $3, $4, $5) {\n    return $1 + ($2 == \"$\" ? $2 + $3 : encode_col(decode_col($3) + delta.c)) + ($4 == \"$\" ? $4 + $5 : encode_row(decode_row($5) + delta.r));\n  });\n}\n\nfunction shift_formula_xlsx(f\n/*:string*/\n, range\n/*:string*/\n, cell\n/*:string*/\n)\n/*:string*/\n{\n  var r = decode_range(range),\n      s = r.s,\n      c = decode_cell(cell);\n  var delta = {\n    r: c.r - s.r,\n    c: c.c - s.c\n  };\n  return shift_formula_str(f, delta);\n}\n/* TODO: parse formula */\n\n\nfunction fuzzyfmla(f\n/*:string*/\n)\n/*:boolean*/\n{\n  if (f.length == 1) return false;\n  return true;\n}\n\nfunction _xlfn(f\n/*:string*/\n)\n/*:string*/\n{\n  return f.replace(/_xlfn\\./g, \"\");\n}\n\nfunction parseread1(blob) {\n  blob.l += 1;\n  return;\n}\n/* [MS-XLS] 2.5.51 */\n\n\nfunction parse_ColRelU(blob, length) {\n  var c = blob.read_shift(length == 1 ? 1 : 2);\n  return [c & 0x3FFF, c >> 14 & 1, c >> 15 & 1];\n}\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.89 */\n\n\nfunction parse_RgceArea(blob, length, opts) {\n  var w = 2;\n\n  if (opts) {\n    if (opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);else if (opts.biff == 12) w = 4;\n  }\n\n  var r = blob.read_shift(w),\n      R = blob.read_shift(w);\n  var c = parse_ColRelU(blob, 2);\n  var C = parse_ColRelU(blob, 2);\n  return {\n    s: {\n      r: r,\n      c: c[0],\n      cRel: c[1],\n      rRel: c[2]\n    },\n    e: {\n      r: R,\n      c: C[0],\n      cRel: C[1],\n      rRel: C[2]\n    }\n  };\n}\n/* BIFF 2-5 encodes flags in the row field */\n\n\nfunction parse_RgceArea_BIFF2(blob\n/*::, length, opts*/\n) {\n  var r = parse_ColRelU(blob, 2),\n      R = parse_ColRelU(blob, 2);\n  var c = blob.read_shift(1);\n  var C = blob.read_shift(1);\n  return {\n    s: {\n      r: r[0],\n      c: c,\n      cRel: r[1],\n      rRel: r[2]\n    },\n    e: {\n      r: R[0],\n      c: C,\n      cRel: R[1],\n      rRel: R[2]\n    }\n  };\n}\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.90 */\n\n\nfunction parse_RgceAreaRel(blob, length, opts) {\n  if (opts.biff < 8) return parse_RgceArea_BIFF2(blob, length, opts);\n  var r = blob.read_shift(opts.biff == 12 ? 4 : 2),\n      R = blob.read_shift(opts.biff == 12 ? 4 : 2);\n  var c = parse_ColRelU(blob, 2);\n  var C = parse_ColRelU(blob, 2);\n  return {\n    s: {\n      r: r,\n      c: c[0],\n      cRel: c[1],\n      rRel: c[2]\n    },\n    e: {\n      r: R,\n      c: C[0],\n      cRel: C[1],\n      rRel: C[2]\n    }\n  };\n}\n/* [MS-XLS] 2.5.198.109 ; [MS-XLSB] 2.5.97.91 */\n\n\nfunction parse_RgceLoc(blob, length, opts) {\n  if (opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);\n  var r = blob.read_shift(opts && opts.biff == 12 ? 4 : 2);\n  var c = parse_ColRelU(blob, 2);\n  return {\n    r: r,\n    c: c[0],\n    cRel: c[1],\n    rRel: c[2]\n  };\n}\n\nfunction parse_RgceLoc_BIFF2(blob\n/*::, length, opts*/\n) {\n  var r = parse_ColRelU(blob, 2);\n  var c = blob.read_shift(1);\n  return {\n    r: r[0],\n    c: c,\n    cRel: r[1],\n    rRel: r[2]\n  };\n}\n/* [MS-XLS] 2.5.198.107, 2.5.47 */\n\n\nfunction parse_RgceElfLoc(blob\n/*::, length, opts*/\n) {\n  var r = blob.read_shift(2);\n  var c = blob.read_shift(2);\n  return {\n    r: r,\n    c: c & 0xFF,\n    fQuoted: !!(c & 0x4000),\n    cRel: c >> 15,\n    rRel: c >> 15\n  };\n}\n/* [MS-XLS] 2.5.198.111 ; [MS-XLSB] 2.5.97.92 TODO */\n\n\nfunction parse_RgceLocRel(blob, length, opts) {\n  var biff = opts && opts.biff ? opts.biff : 8;\n  if (biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);\n  var r = blob.read_shift(biff >= 12 ? 4 : 2);\n  var cl = blob.read_shift(2);\n  var cRel = (cl & 0x4000) >> 14,\n      rRel = (cl & 0x8000) >> 15;\n  cl &= 0x3FFF;\n  if (rRel == 1) while (r > 0x7FFFF) r -= 0x100000;\n  if (cRel == 1) while (cl > 0x1FFF) cl = cl - 0x4000;\n  return {\n    r: r,\n    c: cl,\n    cRel: cRel,\n    rRel: rRel\n  };\n}\n\nfunction parse_RgceLocRel_BIFF2(blob\n/*::, length:number, opts*/\n) {\n  var rl = blob.read_shift(2);\n  var c = blob.read_shift(1);\n  var rRel = (rl & 0x8000) >> 15,\n      cRel = (rl & 0x4000) >> 14;\n  rl &= 0x3FFF;\n  if (rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\n  if (cRel == 1 && c >= 0x80) c = c - 0x100;\n  return {\n    r: rl,\n    c: c,\n    cRel: cRel,\n    rRel: rRel\n  };\n}\n/* [MS-XLS] 2.5.198.27 ; [MS-XLSB] 2.5.97.18 */\n\n\nfunction parse_PtgArea(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\n  return [type, area];\n}\n/* [MS-XLS] 2.5.198.28 ; [MS-XLSB] 2.5.97.19 */\n\n\nfunction parse_PtgArea3d(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var ixti = blob.read_shift(2, 'i');\n  var w = 8;\n  if (opts) switch (opts.biff) {\n    case 5:\n      blob.l += 12;\n      w = 6;\n      break;\n\n    case 12:\n      w = 12;\n      break;\n  }\n  var area = parse_RgceArea(blob, w, opts);\n  return [type, ixti, area];\n}\n/* [MS-XLS] 2.5.198.29 ; [MS-XLSB] 2.5.97.20 */\n\n\nfunction parse_PtgAreaErr(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  blob.l += opts && opts.biff > 8 ? 12 : opts.biff < 8 ? 6 : 8;\n  return [type];\n}\n/* [MS-XLS] 2.5.198.30 ; [MS-XLSB] 2.5.97.21 */\n\n\nfunction parse_PtgAreaErr3d(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var ixti = blob.read_shift(2);\n  var w = 8;\n  if (opts) switch (opts.biff) {\n    case 5:\n      blob.l += 12;\n      w = 6;\n      break;\n\n    case 12:\n      w = 12;\n      break;\n  }\n  blob.l += w;\n  return [type, ixti];\n}\n/* [MS-XLS] 2.5.198.31 ; [MS-XLSB] 2.5.97.22 */\n\n\nfunction parse_PtgAreaN(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var area = parse_RgceAreaRel(blob, length - 1, opts);\n  return [type, area];\n}\n/* [MS-XLS] 2.5.198.32 ; [MS-XLSB] 2.5.97.23 */\n\n\nfunction parse_PtgArray(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  blob.l += opts.biff == 2 ? 6 : opts.biff == 12 ? 14 : 7;\n  return [type];\n}\n/* [MS-XLS] 2.5.198.33 ; [MS-XLSB] 2.5.97.24 */\n\n\nfunction parse_PtgAttrBaxcel(blob) {\n  var bitSemi = blob[blob.l + 1] & 0x01;\n  /* 1 = volatile */\n\n  var bitBaxcel = 1;\n  blob.l += 4;\n  return [bitSemi, bitBaxcel];\n}\n/* [MS-XLS] 2.5.198.34 ; [MS-XLSB] 2.5.97.25 */\n\n\nfunction parse_PtgAttrChoose(blob, length, opts)\n/*:Array<number>*/\n{\n  blob.l += 2;\n  var offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  var o\n  /*:Array<number>*/\n  = [];\n  /* offset is 1 less than the number of elements */\n\n  for (var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\n\n  return o;\n}\n/* [MS-XLS] 2.5.198.35 ; [MS-XLSB] 2.5.97.26 */\n\n\nfunction parse_PtgAttrGoto(blob, length, opts) {\n  var bitGoto = blob[blob.l + 1] & 0xFF ? 1 : 0;\n  blob.l += 2;\n  return [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n/* [MS-XLS] 2.5.198.36 ; [MS-XLSB] 2.5.97.27 */\n\n\nfunction parse_PtgAttrIf(blob, length, opts) {\n  var bitIf = blob[blob.l + 1] & 0xFF ? 1 : 0;\n  blob.l += 2;\n  return [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n/* [MS-XLSB] 2.5.97.28 */\n\n\nfunction parse_PtgAttrIfError(blob) {\n  var bitIf = blob[blob.l + 1] & 0xFF ? 1 : 0;\n  blob.l += 2;\n  return [bitIf, blob.read_shift(2)];\n}\n/* [MS-XLS] 2.5.198.37 ; [MS-XLSB] 2.5.97.29 */\n\n\nfunction parse_PtgAttrSemi(blob, length, opts) {\n  var bitSemi = blob[blob.l + 1] & 0xFF ? 1 : 0;\n  blob.l += opts && opts.biff == 2 ? 3 : 4;\n  return [bitSemi];\n}\n/* [MS-XLS] 2.5.198.40 ; [MS-XLSB] 2.5.97.32 */\n\n\nfunction parse_PtgAttrSpaceType(blob\n/*::, length*/\n) {\n  var type = blob.read_shift(1),\n      cch = blob.read_shift(1);\n  return [type, cch];\n}\n/* [MS-XLS] 2.5.198.38 ; [MS-XLSB] 2.5.97.30 */\n\n\nfunction parse_PtgAttrSpace(blob) {\n  blob.read_shift(2);\n  return parse_PtgAttrSpaceType(blob, 2);\n}\n/* [MS-XLS] 2.5.198.39 ; [MS-XLSB] 2.5.97.31 */\n\n\nfunction parse_PtgAttrSpaceSemi(blob) {\n  blob.read_shift(2);\n  return parse_PtgAttrSpaceType(blob, 2);\n}\n/* [MS-XLS] 2.5.198.84 ; [MS-XLSB] 2.5.97.68 TODO */\n\n\nfunction parse_PtgRef(blob, length, opts) {\n  //var ptg = blob[blob.l] & 0x1F;\n  var type = (blob[blob.l] & 0x60) >> 5;\n  blob.l += 1;\n  var loc = parse_RgceLoc(blob, 0, opts);\n  return [type, loc];\n}\n/* [MS-XLS] 2.5.198.88 ; [MS-XLSB] 2.5.97.72 TODO */\n\n\nfunction parse_PtgRefN(blob, length, opts) {\n  var type = (blob[blob.l] & 0x60) >> 5;\n  blob.l += 1;\n  var loc = parse_RgceLocRel(blob, 0, opts);\n  return [type, loc];\n}\n/* [MS-XLS] 2.5.198.85 ; [MS-XLSB] 2.5.97.69 TODO */\n\n\nfunction parse_PtgRef3d(blob, length, opts) {\n  var type = (blob[blob.l] & 0x60) >> 5;\n  blob.l += 1;\n  var ixti = blob.read_shift(2); // XtiIndex\n\n  if (opts && opts.biff == 5) blob.l += 12;\n  var loc = parse_RgceLoc(blob, 0, opts); // TODO: or RgceLocRel\n\n  return [type, ixti, loc];\n}\n/* [MS-XLS] 2.5.198.62 ; [MS-XLSB] 2.5.97.45 TODO */\n\n\nfunction parse_PtgFunc(blob, length, opts) {\n  //var ptg = blob[blob.l] & 0x1F;\n  var type = (blob[blob.l] & 0x60) >> 5;\n  blob.l += 1;\n  var iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\n  return [FtabArgc[iftab], Ftab[iftab], type];\n}\n/* [MS-XLS] 2.5.198.63 ; [MS-XLSB] 2.5.97.46 TODO */\n\n\nfunction parse_PtgFuncVar(blob, length, opts) {\n  var type = blob[blob.l++];\n  var cparams = blob.read_shift(1),\n      tab = opts && opts.biff <= 3 ? [type == 0x58 ? -1 : 0, blob.read_shift(1)] : parsetab(blob);\n  return [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n}\n\nfunction parsetab(blob) {\n  return [blob[blob.l + 1] >> 7, blob.read_shift(2) & 0x7FFF];\n}\n/* [MS-XLS] 2.5.198.41 ; [MS-XLSB] 2.5.97.33 */\n\n\nfunction parse_PtgAttrSum(blob, length, opts) {\n  blob.l += opts && opts.biff == 2 ? 3 : 4;\n  return;\n}\n/* [MS-XLS] 2.5.198.58 ; [MS-XLSB] 2.5.97.40 */\n\n\nfunction parse_PtgExp(blob, length, opts) {\n  blob.l++;\n  if (opts && opts.biff == 12) return [blob.read_shift(4, 'i'), 0];\n  var row = blob.read_shift(2);\n  var col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  return [row, col];\n}\n/* [MS-XLS] 2.5.198.57 ; [MS-XLSB] 2.5.97.39 */\n\n\nfunction parse_PtgErr(blob) {\n  blob.l++;\n  return BErr[blob.read_shift(1)];\n}\n/* [MS-XLS] 2.5.198.66 ; [MS-XLSB] 2.5.97.49 */\n\n\nfunction parse_PtgInt(blob) {\n  blob.l++;\n  return blob.read_shift(2);\n}\n/* [MS-XLS] 2.5.198.42 ; [MS-XLSB] 2.5.97.34 */\n\n\nfunction parse_PtgBool(blob) {\n  blob.l++;\n  return blob.read_shift(1) !== 0;\n}\n/* [MS-XLS] 2.5.198.79 ; [MS-XLSB] 2.5.97.63 */\n\n\nfunction parse_PtgNum(blob) {\n  blob.l++;\n  return parse_Xnum(blob, 8);\n}\n/* [MS-XLS] 2.5.198.89 ; [MS-XLSB] 2.5.97.74 */\n\n\nfunction parse_PtgStr(blob, length, opts) {\n  blob.l++;\n  return parse_ShortXLUnicodeString(blob, length - 1, opts);\n}\n/* [MS-XLS] 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n\n/* [MS-XLSB] 2.5.97.93 + 2.5.97.9{4,5,6,7} */\n\n\nfunction parse_SerAr(blob, biff\n/*:number*/\n) {\n  var val = [blob.read_shift(1)];\n  if (biff == 12) switch (val[0]) {\n    case 0x02:\n      val[0] = 0x04;\n      break;\n\n    /* SerBool */\n\n    case 0x04:\n      val[0] = 0x10;\n      break;\n\n    /* SerErr */\n\n    case 0x00:\n      val[0] = 0x01;\n      break;\n\n    /* SerNum */\n\n    case 0x01:\n      val[0] = 0x02;\n      break;\n\n    /* SerStr */\n  }\n\n  switch (val[0]) {\n    case 0x04:\n      /* SerBool -- boolean */\n      val[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n      if (biff != 12) blob.l += 7;\n      break;\n\n    case 0x25:\n    /* appears to be an alias */\n\n    case 0x10:\n      /* SerErr -- error */\n      val[1] = BErr[blob[blob.l]];\n      blob.l += biff == 12 ? 4 : 8;\n      break;\n\n    case 0x00:\n      /* SerNil -- honestly, I'm not sure how to reproduce this */\n      blob.l += 8;\n      break;\n\n    case 0x01:\n      /* SerNum -- Xnum */\n      val[1] = parse_Xnum(blob, 8);\n      break;\n\n    case 0x02:\n      /* SerStr -- XLUnicodeString (<256 chars) */\n      val[1] = parse_XLUnicodeString2(blob, 0, {\n        biff: biff > 0 && biff < 8 ? 2 : biff\n      });\n      break;\n\n    default:\n      throw new Error(\"Bad SerAr: \" + val[0]);\n\n    /* Unreachable */\n  }\n\n  return val;\n}\n/* [MS-XLS] 2.5.198.61 ; [MS-XLSB] 2.5.97.44 */\n\n\nfunction parse_PtgExtraMem(blob, cce, opts) {\n  var count = blob.read_shift(opts.biff == 12 ? 4 : 2);\n  var out\n  /*:Array<Range>*/\n  = [];\n\n  for (var i = 0; i != count; ++i) out.push((opts.biff == 12 ? parse_UncheckedRfX : parse_Ref8U)(blob, 8));\n\n  return out;\n}\n/* [MS-XLS] 2.5.198.59 ; [MS-XLSB] 2.5.97.41 */\n\n\nfunction parse_PtgExtraArray(blob, length, opts) {\n  var rows = 0,\n      cols = 0;\n\n  if (opts.biff == 12) {\n    rows = blob.read_shift(4); // DRw\n\n    cols = blob.read_shift(4); // DCol\n  } else {\n    cols = 1 + blob.read_shift(1); //DColByteU\n\n    rows = 1 + blob.read_shift(2); //DRw\n  }\n\n  if (opts.biff >= 2 && opts.biff < 8) {\n    --rows;\n    if (--cols == 0) cols = 0x100;\n  } // $FlowIgnore\n\n\n  for (var i = 0, o\n  /*:Array<Array<any>>*/\n  = []; i != rows && (o[i] = []); ++i) for (var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);\n\n  return o;\n}\n/* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 */\n\n\nfunction parse_PtgName(blob, length, opts) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var w = !opts || opts.biff >= 8 ? 4 : 2;\n  var nameindex = blob.read_shift(w);\n\n  switch (opts.biff) {\n    case 2:\n      blob.l += 5;\n      break;\n\n    case 3:\n    case 4:\n      blob.l += 8;\n      break;\n\n    case 5:\n      blob.l += 12;\n      break;\n  }\n\n  return [type, 0, nameindex];\n}\n/* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 */\n\n\nfunction parse_PtgNameX(blob, length, opts) {\n  if (opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var ixti = blob.read_shift(2); // XtiIndex\n\n  var nameindex = blob.read_shift(4);\n  return [type, ixti, nameindex];\n}\n\nfunction parse_PtgNameX_BIFF5(blob\n/*::, length, opts*/\n) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var ixti = blob.read_shift(2, 'i'); // XtiIndex\n\n  blob.l += 8;\n  var nameindex = blob.read_shift(2);\n  blob.l += 12;\n  return [type, ixti, nameindex];\n}\n/* [MS-XLS] 2.5.198.70 ; [MS-XLSB] 2.5.97.54 */\n\n\nfunction parse_PtgMemArea(blob, length, opts) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  blob.l += opts && opts.biff == 2 ? 3 : 4;\n  var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  return [type, cce];\n}\n/* [MS-XLS] 2.5.198.72 ; [MS-XLSB] 2.5.97.56 */\n\n\nfunction parse_PtgMemFunc(blob, length, opts) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n  return [type, cce];\n}\n/* [MS-XLS] 2.5.198.86 ; [MS-XLSB] 2.5.97.69 */\n\n\nfunction parse_PtgRefErr(blob, length, opts) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  blob.l += 4;\n  if (opts.biff < 8) blob.l--;\n  if (opts.biff == 12) blob.l += 2;\n  return [type];\n}\n/* [MS-XLS] 2.5.198.87 ; [MS-XLSB] 2.5.97.71 */\n\n\nfunction parse_PtgRefErr3d(blob, length, opts) {\n  var type = (blob[blob.l++] & 0x60) >> 5;\n  var ixti = blob.read_shift(2);\n  var w = 4;\n  if (opts) switch (opts.biff) {\n    case 5:\n      w = 15;\n      break;\n\n    case 12:\n      w = 6;\n      break;\n  }\n  blob.l += w;\n  return [type, ixti];\n}\n/* [MS-XLS] 2.5.198.71 ; [MS-XLSB] 2.5.97.55 */\n\n\nvar parse_PtgMemErr = parsenoop;\n/* [MS-XLS] 2.5.198.73  ; [MS-XLSB] 2.5.97.57 */\n\nvar parse_PtgMemNoMem = parsenoop;\n/* [MS-XLS] 2.5.198.92 */\n\nvar parse_PtgTbl = parsenoop;\n\nfunction parse_PtgElfLoc(blob, length, opts) {\n  blob.l += 2;\n  return [parse_RgceElfLoc(blob, 4, opts)];\n}\n\nfunction parse_PtgElfNoop(blob\n/*::, length, opts*/\n) {\n  blob.l += 6;\n  return [];\n}\n/* [MS-XLS] 2.5.198.46 */\n\n\nvar parse_PtgElfCol = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.47 */\n\nvar parse_PtgElfColS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.48 */\n\nvar parse_PtgElfColSV = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.49 */\n\nvar parse_PtgElfColV = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.50 */\n\nfunction parse_PtgElfLel(blob\n/*::, length, opts*/\n) {\n  blob.l += 2;\n  return [parseuint16(blob), blob.read_shift(2) & 0x01];\n}\n/* [MS-XLS] 2.5.198.51 */\n\n\nvar parse_PtgElfRadical = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.52 */\n\nvar parse_PtgElfRadicalLel = parse_PtgElfLel;\n/* [MS-XLS] 2.5.198.53 */\n\nvar parse_PtgElfRadicalS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.54 */\n\nvar parse_PtgElfRw = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.55 */\n\nvar parse_PtgElfRwV = parse_PtgElfLoc;\n/* [MS-XLSB] 2.5.97.52 TODO */\n\nvar PtgListRT = [\"Data\", \"All\", \"Headers\", \"??\", \"?Data2\", \"??\", \"?DataHeaders\", \"??\", \"Totals\", \"??\", \"??\", \"??\", \"?DataTotals\", \"??\", \"??\", \"??\", \"?Current\"];\n\nfunction parse_PtgList(blob\n/*::, length, opts*/\n) {\n  blob.l += 2;\n  var ixti = blob.read_shift(2);\n  var flags = blob.read_shift(2);\n  var idx = blob.read_shift(4);\n  var c = blob.read_shift(2);\n  var C = blob.read_shift(2);\n  var rt = PtgListRT[flags >> 2 & 0x1F];\n  return {\n    ixti: ixti,\n    coltype: flags & 0x3,\n    rt: rt,\n    idx: idx,\n    c: c,\n    C: C\n  };\n}\n/* [MS-XLS] 2.5.198.91 ; [MS-XLSB] 2.5.97.76 */\n\n\nfunction parse_PtgSxName(blob\n/*::, length, opts*/\n) {\n  blob.l += 2;\n  return [blob.read_shift(4)];\n}\n/* [XLS] old spec */\n\n\nfunction parse_PtgSheet(blob, length, opts) {\n  blob.l += 5;\n  blob.l += 2;\n  blob.l += opts.biff == 2 ? 1 : 4;\n  return [\"PTGSHEET\"];\n}\n\nfunction parse_PtgEndSheet(blob, length, opts) {\n  blob.l += opts.biff == 2 ? 4 : 5;\n  return [\"PTGENDSHEET\"];\n}\n\nfunction parse_PtgMemAreaN(blob\n/*::, length, opts*/\n) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var cce = blob.read_shift(2);\n  return [type, cce];\n}\n\nfunction parse_PtgMemNoMemN(blob\n/*::, length, opts*/\n) {\n  var type = blob.read_shift(1) >>> 5 & 0x03;\n  var cce = blob.read_shift(2);\n  return [type, cce];\n}\n\nfunction parse_PtgAttrNoop(blob\n/*::, length, opts*/\n) {\n  blob.l += 4;\n  return [0, 0];\n}\n/* [MS-XLS] 2.5.198.25 ; [MS-XLSB] 2.5.97.16 */\n\n\nvar PtgTypes = {\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'PtgExp',\n    f: parse_PtgExp\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'PtgTbl',\n    f: parse_PtgTbl\n  },\n\n  /*::[*/\n  0x03\n  /*::]*/\n  : {\n    n: 'PtgAdd',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : {\n    n: 'PtgSub',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x05\n  /*::]*/\n  : {\n    n: 'PtgMul',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : {\n    n: 'PtgDiv',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : {\n    n: 'PtgPower',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : {\n    n: 'PtgConcat',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x09\n  /*::]*/\n  : {\n    n: 'PtgLt',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0A\n  /*::]*/\n  : {\n    n: 'PtgLe',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0B\n  /*::]*/\n  : {\n    n: 'PtgEq',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0C\n  /*::]*/\n  : {\n    n: 'PtgGe',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0D\n  /*::]*/\n  : {\n    n: 'PtgGt',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0E\n  /*::]*/\n  : {\n    n: 'PtgNe',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : {\n    n: 'PtgIsect',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'PtgUnion',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x11\n  /*::]*/\n  : {\n    n: 'PtgRange',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x12\n  /*::]*/\n  : {\n    n: 'PtgUplus',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x13\n  /*::]*/\n  : {\n    n: 'PtgUminus',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x14\n  /*::]*/\n  : {\n    n: 'PtgPercent',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x15\n  /*::]*/\n  : {\n    n: 'PtgParen',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x16\n  /*::]*/\n  : {\n    n: 'PtgMissArg',\n    f: parseread1\n  },\n\n  /*::[*/\n  0x17\n  /*::]*/\n  : {\n    n: 'PtgStr',\n    f: parse_PtgStr\n  },\n\n  /*::[*/\n  0x1A\n  /*::]*/\n  : {\n    n: 'PtgSheet',\n    f: parse_PtgSheet\n  },\n\n  /*::[*/\n  0x1B\n  /*::]*/\n  : {\n    n: 'PtgEndSheet',\n    f: parse_PtgEndSheet\n  },\n\n  /*::[*/\n  0x1C\n  /*::]*/\n  : {\n    n: 'PtgErr',\n    f: parse_PtgErr\n  },\n\n  /*::[*/\n  0x1D\n  /*::]*/\n  : {\n    n: 'PtgBool',\n    f: parse_PtgBool\n  },\n\n  /*::[*/\n  0x1E\n  /*::]*/\n  : {\n    n: 'PtgInt',\n    f: parse_PtgInt\n  },\n\n  /*::[*/\n  0x1F\n  /*::]*/\n  : {\n    n: 'PtgNum',\n    f: parse_PtgNum\n  },\n\n  /*::[*/\n  0x20\n  /*::]*/\n  : {\n    n: 'PtgArray',\n    f: parse_PtgArray\n  },\n\n  /*::[*/\n  0x21\n  /*::]*/\n  : {\n    n: 'PtgFunc',\n    f: parse_PtgFunc\n  },\n\n  /*::[*/\n  0x22\n  /*::]*/\n  : {\n    n: 'PtgFuncVar',\n    f: parse_PtgFuncVar\n  },\n\n  /*::[*/\n  0x23\n  /*::]*/\n  : {\n    n: 'PtgName',\n    f: parse_PtgName\n  },\n\n  /*::[*/\n  0x24\n  /*::]*/\n  : {\n    n: 'PtgRef',\n    f: parse_PtgRef\n  },\n\n  /*::[*/\n  0x25\n  /*::]*/\n  : {\n    n: 'PtgArea',\n    f: parse_PtgArea\n  },\n\n  /*::[*/\n  0x26\n  /*::]*/\n  : {\n    n: 'PtgMemArea',\n    f: parse_PtgMemArea\n  },\n\n  /*::[*/\n  0x27\n  /*::]*/\n  : {\n    n: 'PtgMemErr',\n    f: parse_PtgMemErr\n  },\n\n  /*::[*/\n  0x28\n  /*::]*/\n  : {\n    n: 'PtgMemNoMem',\n    f: parse_PtgMemNoMem\n  },\n\n  /*::[*/\n  0x29\n  /*::]*/\n  : {\n    n: 'PtgMemFunc',\n    f: parse_PtgMemFunc\n  },\n\n  /*::[*/\n  0x2A\n  /*::]*/\n  : {\n    n: 'PtgRefErr',\n    f: parse_PtgRefErr\n  },\n\n  /*::[*/\n  0x2B\n  /*::]*/\n  : {\n    n: 'PtgAreaErr',\n    f: parse_PtgAreaErr\n  },\n\n  /*::[*/\n  0x2C\n  /*::]*/\n  : {\n    n: 'PtgRefN',\n    f: parse_PtgRefN\n  },\n\n  /*::[*/\n  0x2D\n  /*::]*/\n  : {\n    n: 'PtgAreaN',\n    f: parse_PtgAreaN\n  },\n\n  /*::[*/\n  0x2E\n  /*::]*/\n  : {\n    n: 'PtgMemAreaN',\n    f: parse_PtgMemAreaN\n  },\n\n  /*::[*/\n  0x2F\n  /*::]*/\n  : {\n    n: 'PtgMemNoMemN',\n    f: parse_PtgMemNoMemN\n  },\n\n  /*::[*/\n  0x39\n  /*::]*/\n  : {\n    n: 'PtgNameX',\n    f: parse_PtgNameX\n  },\n\n  /*::[*/\n  0x3A\n  /*::]*/\n  : {\n    n: 'PtgRef3d',\n    f: parse_PtgRef3d\n  },\n\n  /*::[*/\n  0x3B\n  /*::]*/\n  : {\n    n: 'PtgArea3d',\n    f: parse_PtgArea3d\n  },\n\n  /*::[*/\n  0x3C\n  /*::]*/\n  : {\n    n: 'PtgRefErr3d',\n    f: parse_PtgRefErr3d\n  },\n\n  /*::[*/\n  0x3D\n  /*::]*/\n  : {\n    n: 'PtgAreaErr3d',\n    f: parse_PtgAreaErr3d\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {}\n};\n/* These are duplicated in the PtgTypes table */\n\nvar PtgDupes = {\n  /*::[*/\n  0x40\n  /*::]*/\n  : 0x20,\n\n  /*::[*/\n  0x60\n  /*::]*/\n  : 0x20,\n\n  /*::[*/\n  0x41\n  /*::]*/\n  : 0x21,\n\n  /*::[*/\n  0x61\n  /*::]*/\n  : 0x21,\n\n  /*::[*/\n  0x42\n  /*::]*/\n  : 0x22,\n\n  /*::[*/\n  0x62\n  /*::]*/\n  : 0x22,\n\n  /*::[*/\n  0x43\n  /*::]*/\n  : 0x23,\n\n  /*::[*/\n  0x63\n  /*::]*/\n  : 0x23,\n\n  /*::[*/\n  0x44\n  /*::]*/\n  : 0x24,\n\n  /*::[*/\n  0x64\n  /*::]*/\n  : 0x24,\n\n  /*::[*/\n  0x45\n  /*::]*/\n  : 0x25,\n\n  /*::[*/\n  0x65\n  /*::]*/\n  : 0x25,\n\n  /*::[*/\n  0x46\n  /*::]*/\n  : 0x26,\n\n  /*::[*/\n  0x66\n  /*::]*/\n  : 0x26,\n\n  /*::[*/\n  0x47\n  /*::]*/\n  : 0x27,\n\n  /*::[*/\n  0x67\n  /*::]*/\n  : 0x27,\n\n  /*::[*/\n  0x48\n  /*::]*/\n  : 0x28,\n\n  /*::[*/\n  0x68\n  /*::]*/\n  : 0x28,\n\n  /*::[*/\n  0x49\n  /*::]*/\n  : 0x29,\n\n  /*::[*/\n  0x69\n  /*::]*/\n  : 0x29,\n\n  /*::[*/\n  0x4A\n  /*::]*/\n  : 0x2A,\n\n  /*::[*/\n  0x6A\n  /*::]*/\n  : 0x2A,\n\n  /*::[*/\n  0x4B\n  /*::]*/\n  : 0x2B,\n\n  /*::[*/\n  0x6B\n  /*::]*/\n  : 0x2B,\n\n  /*::[*/\n  0x4C\n  /*::]*/\n  : 0x2C,\n\n  /*::[*/\n  0x6C\n  /*::]*/\n  : 0x2C,\n\n  /*::[*/\n  0x4D\n  /*::]*/\n  : 0x2D,\n\n  /*::[*/\n  0x6D\n  /*::]*/\n  : 0x2D,\n\n  /*::[*/\n  0x4E\n  /*::]*/\n  : 0x2E,\n\n  /*::[*/\n  0x6E\n  /*::]*/\n  : 0x2E,\n\n  /*::[*/\n  0x4F\n  /*::]*/\n  : 0x2F,\n\n  /*::[*/\n  0x6F\n  /*::]*/\n  : 0x2F,\n\n  /*::[*/\n  0x58\n  /*::]*/\n  : 0x22,\n\n  /*::[*/\n  0x78\n  /*::]*/\n  : 0x22,\n\n  /*::[*/\n  0x59\n  /*::]*/\n  : 0x39,\n\n  /*::[*/\n  0x79\n  /*::]*/\n  : 0x39,\n\n  /*::[*/\n  0x5A\n  /*::]*/\n  : 0x3A,\n\n  /*::[*/\n  0x7A\n  /*::]*/\n  : 0x3A,\n\n  /*::[*/\n  0x5B\n  /*::]*/\n  : 0x3B,\n\n  /*::[*/\n  0x7B\n  /*::]*/\n  : 0x3B,\n\n  /*::[*/\n  0x5C\n  /*::]*/\n  : 0x3C,\n\n  /*::[*/\n  0x7C\n  /*::]*/\n  : 0x3C,\n\n  /*::[*/\n  0x5D\n  /*::]*/\n  : 0x3D,\n\n  /*::[*/\n  0x7D\n  /*::]*/\n  : 0x3D\n};\nvar Ptg18 = {\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'PtgElfLel',\n    f: parse_PtgElfLel\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'PtgElfRw',\n    f: parse_PtgElfRw\n  },\n\n  /*::[*/\n  0x03\n  /*::]*/\n  : {\n    n: 'PtgElfCol',\n    f: parse_PtgElfCol\n  },\n\n  /*::[*/\n  0x06\n  /*::]*/\n  : {\n    n: 'PtgElfRwV',\n    f: parse_PtgElfRwV\n  },\n\n  /*::[*/\n  0x07\n  /*::]*/\n  : {\n    n: 'PtgElfColV',\n    f: parse_PtgElfColV\n  },\n\n  /*::[*/\n  0x0A\n  /*::]*/\n  : {\n    n: 'PtgElfRadical',\n    f: parse_PtgElfRadical\n  },\n\n  /*::[*/\n  0x0B\n  /*::]*/\n  : {\n    n: 'PtgElfRadicalS',\n    f: parse_PtgElfRadicalS\n  },\n\n  /*::[*/\n  0x0D\n  /*::]*/\n  : {\n    n: 'PtgElfColS',\n    f: parse_PtgElfColS\n  },\n\n  /*::[*/\n  0x0F\n  /*::]*/\n  : {\n    n: 'PtgElfColSV',\n    f: parse_PtgElfColSV\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'PtgElfRadicalLel',\n    f: parse_PtgElfRadicalLel\n  },\n\n  /*::[*/\n  0x19\n  /*::]*/\n  : {\n    n: 'PtgList',\n    f: parse_PtgList\n  },\n\n  /*::[*/\n  0x1D\n  /*::]*/\n  : {\n    n: 'PtgSxName',\n    f: parse_PtgSxName\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {}\n};\nvar Ptg19 = {\n  /*::[*/\n  0x00\n  /*::]*/\n  : {\n    n: 'PtgAttrNoop',\n    f: parse_PtgAttrNoop\n  },\n\n  /*::[*/\n  0x01\n  /*::]*/\n  : {\n    n: 'PtgAttrSemi',\n    f: parse_PtgAttrSemi\n  },\n\n  /*::[*/\n  0x02\n  /*::]*/\n  : {\n    n: 'PtgAttrIf',\n    f: parse_PtgAttrIf\n  },\n\n  /*::[*/\n  0x04\n  /*::]*/\n  : {\n    n: 'PtgAttrChoose',\n    f: parse_PtgAttrChoose\n  },\n\n  /*::[*/\n  0x08\n  /*::]*/\n  : {\n    n: 'PtgAttrGoto',\n    f: parse_PtgAttrGoto\n  },\n\n  /*::[*/\n  0x10\n  /*::]*/\n  : {\n    n: 'PtgAttrSum',\n    f: parse_PtgAttrSum\n  },\n\n  /*::[*/\n  0x20\n  /*::]*/\n  : {\n    n: 'PtgAttrBaxcel',\n    f: parse_PtgAttrBaxcel\n  },\n\n  /*::[*/\n  0x21\n  /*::]*/\n  : {\n    n: 'PtgAttrBaxcel',\n    f: parse_PtgAttrBaxcel\n  },\n\n  /*::[*/\n  0x40\n  /*::]*/\n  : {\n    n: 'PtgAttrSpace',\n    f: parse_PtgAttrSpace\n  },\n\n  /*::[*/\n  0x41\n  /*::]*/\n  : {\n    n: 'PtgAttrSpaceSemi',\n    f: parse_PtgAttrSpaceSemi\n  },\n\n  /*::[*/\n  0x80\n  /*::]*/\n  : {\n    n: 'PtgAttrIfError',\n    f: parse_PtgAttrIfError\n  },\n\n  /*::[*/\n  0xFF\n  /*::]*/\n  : {}\n};\n/* [MS-XLS] 2.5.198.103 ; [MS-XLSB] 2.5.97.87 */\n\nfunction parse_RgbExtra(blob, length, rgce, opts) {\n  if (opts.biff < 8) return parsenoop(blob, length);\n  var target = blob.l + length;\n  var o = [];\n\n  for (var i = 0; i !== rgce.length; ++i) {\n    switch (rgce[i][0]) {\n      case 'PtgArray':\n        /* PtgArray -> PtgExtraArray */\n        rgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\n        o.push(rgce[i][1]);\n        break;\n\n      case 'PtgMemArea':\n        /* PtgMemArea -> PtgExtraMem */\n        rgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1], opts);\n        o.push(rgce[i][2]);\n        break;\n\n      case 'PtgExp':\n        /* PtgExp -> PtgExtraCol */\n        if (opts && opts.biff == 12) {\n          rgce[i][1][1] = blob.read_shift(4);\n          o.push(rgce[i][1]);\n        }\n\n        break;\n\n      case 'PtgList':\n      /* TODO: PtgList -> PtgExtraList */\n\n      case 'PtgElfRadicalS':\n      /* TODO: PtgElfRadicalS -> PtgExtraElf */\n\n      case 'PtgElfColS':\n      /* TODO: PtgElfColS -> PtgExtraElf */\n\n      case 'PtgElfColSV':\n        /* TODO: PtgElfColSV -> PtgExtraElf */\n        throw \"Unsupported \" + rgce[i][0];\n\n      default:\n        break;\n    }\n  }\n\n  length = target - blob.l;\n  /* note: this is technically an error but Excel disregards */\n  //if(target !== blob.l && blob.l !== target - length) throw new Error(target + \" != \" + blob.l);\n\n  if (length !== 0) o.push(parsenoop(blob, length));\n  return o;\n}\n/* [MS-XLS] 2.5.198.104 ; [MS-XLSB] 2.5.97.88 */\n\n\nfunction parse_Rgce(blob, length, opts) {\n  var target = blob.l + length;\n  var R,\n      id,\n      ptgs = [];\n\n  while (target != blob.l) {\n    length = target - blob.l;\n    id = blob[blob.l];\n    R = PtgTypes[id] || PtgTypes[PtgDupes[id]];\n    if (id === 0x18 || id === 0x19) R = (id === 0x18 ? Ptg18 : Ptg19)[blob[blob.l + 1]];\n\n    if (!R || !R.f) {\n      /*ptgs.push*/\n      parsenoop(blob, length);\n    } else {\n      ptgs.push([R.n, R.f(blob, length, opts)]);\n    }\n  }\n\n  return ptgs;\n}\n\nfunction stringify_array(f\n/*:Array<Array<string>>*/\n)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < f.length; ++i) {\n    var x = f[i],\n        r\n    /*:Array<string>*/\n    = [];\n\n    for (var j = 0; j < x.length; ++j) {\n      var y = x[j];\n      if (y) switch (y[0]) {\n        // TODO: handle embedded quotes\n        case 0x02:\n          /*:: if(typeof y[1] != 'string') throw \"unreachable\"; */\n          r.push('\"' + y[1].replace(/\"/g, '\"\"') + '\"');\n          break;\n\n        default:\n          r.push(y[1]);\n      } else r.push(\"\");\n    }\n\n    o.push(r.join(\",\"));\n  }\n\n  return o.join(\";\");\n}\n/* [MS-XLS] 2.2.2 ; [MS-XLSB] 2.2.2 TODO */\n\n\nvar PtgBinOp = {\n  PtgAdd: \"+\",\n  PtgConcat: \"&\",\n  PtgDiv: \"/\",\n  PtgEq: \"=\",\n  PtgGe: \">=\",\n  PtgGt: \">\",\n  PtgLe: \"<=\",\n  PtgLt: \"<\",\n  PtgMul: \"*\",\n  PtgNe: \"<>\",\n  PtgPower: \"^\",\n  PtgSub: \"-\"\n}; // List of invalid characters needs to be tested further\n\nfunction formula_quote_sheet_name(sname\n/*:string*/\n, opts)\n/*:string*/\n{\n  if (!sname && !(opts && opts.biff <= 5 && opts.biff >= 2)) throw new Error(\"empty sheet name\");\n  if (/[^\\w\\u4E00-\\u9FFF\\u3040-\\u30FF]/.test(sname)) return \"'\" + sname + \"'\";\n  return sname;\n}\n\nfunction get_ixti_raw(supbooks, ixti\n/*:number*/\n, opts)\n/*:string*/\n{\n  if (!supbooks) return \"SH33TJSERR0\";\n  if (opts.biff > 8 && (!supbooks.XTI || !supbooks.XTI[ixti])) return supbooks.SheetNames[ixti];\n  if (!supbooks.XTI) return \"SH33TJSERR6\";\n  var XTI = supbooks.XTI[ixti];\n\n  if (opts.biff < 8) {\n    if (ixti > 10000) ixti -= 65536;\n    if (ixti < 0) ixti = -ixti;\n    return ixti == 0 ? \"\" : supbooks.XTI[ixti - 1];\n  }\n\n  if (!XTI) return \"SH33TJSERR1\";\n  var o = \"\";\n  if (opts.biff > 8) switch (supbooks[XTI[0]][0]) {\n    case 0x0165:\n      /* 'BrtSupSelf' */\n      o = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]];\n      return XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\n    case 0x0166:\n      /* 'BrtSupSame' */\n      if (opts.SID != null) return supbooks.SheetNames[opts.SID];\n      return \"SH33TJSSAME\" + supbooks[XTI[0]][0];\n\n    case 0x0163:\n    /* 'BrtSupBookSrc' */\n\n    /* falls through */\n\n    default:\n      return \"SH33TJSSRC\" + supbooks[XTI[0]][0];\n  }\n\n  switch (supbooks[XTI[0]][0][0]) {\n    case 0x0401:\n      o = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]] || \"SH33TJSERR3\";\n      return XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\n    case 0x3A01:\n      return supbooks[XTI[0]].slice(1).map(function (name) {\n        return name.Name;\n      }).join(\";;\");\n    //return \"SH33TJSERR8\";\n\n    default:\n      if (!supbooks[XTI[0]][0][3]) return \"SH33TJSERR2\";\n      o = XTI[1] == -1 ? \"#REF\" : supbooks[XTI[0]][0][3][XTI[1]] || \"SH33TJSERR4\";\n      return XTI[1] == XTI[2] ? o : o + \":\" + supbooks[XTI[0]][0][3][XTI[2]];\n  }\n}\n\nfunction get_ixti(supbooks, ixti\n/*:number*/\n, opts)\n/*:string*/\n{\n  var ixtiraw = get_ixti_raw(supbooks, ixti, opts);\n  return ixtiraw == \"#REF\" ? ixtiraw : formula_quote_sheet_name(ixtiraw, opts);\n}\n\nfunction stringify_formula(formula\n/*Array<any>*/\n, range, cell\n/*:any*/\n, supbooks, opts)\n/*:string*/\n{\n  var biff = opts && opts.biff || 8;\n  var _range =\n  /*range != null ? range :*/\n  {\n    s: {\n      c: 0,\n      r: 0\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n  var stack\n  /*:Array<string>*/\n  = [],\n      e1,\n      e2,\n\n  /*::type,*/\n  c\n  /*:CellAddress*/\n  ,\n      ixti = 0,\n      nameidx = 0,\n      r,\n      sname = \"\";\n  if (!formula[0] || !formula[0][0]) return \"\";\n  var last_sp = -1,\n      sp = \"\";\n\n  for (var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n    var f = formula[0][ff];\n\n    switch (f[0]) {\n      case 'PtgUminus':\n        /* [MS-XLS] 2.5.198.93 */\n        stack.push(\"-\" + stack.pop());\n        break;\n\n      case 'PtgUplus':\n        /* [MS-XLS] 2.5.198.95 */\n        stack.push(\"+\" + stack.pop());\n        break;\n\n      case 'PtgPercent':\n        /* [MS-XLS] 2.5.198.81 */\n        stack.push(stack.pop() + \"%\");\n        break;\n\n      case 'PtgAdd':\n      /* [MS-XLS] 2.5.198.26 */\n\n      case 'PtgConcat':\n      /* [MS-XLS] 2.5.198.43 */\n\n      case 'PtgDiv':\n      /* [MS-XLS] 2.5.198.45 */\n\n      case 'PtgEq':\n      /* [MS-XLS] 2.5.198.56 */\n\n      case 'PtgGe':\n      /* [MS-XLS] 2.5.198.64 */\n\n      case 'PtgGt':\n      /* [MS-XLS] 2.5.198.65 */\n\n      case 'PtgLe':\n      /* [MS-XLS] 2.5.198.68 */\n\n      case 'PtgLt':\n      /* [MS-XLS] 2.5.198.69 */\n\n      case 'PtgMul':\n      /* [MS-XLS] 2.5.198.75 */\n\n      case 'PtgNe':\n      /* [MS-XLS] 2.5.198.78 */\n\n      case 'PtgPower':\n      /* [MS-XLS] 2.5.198.82 */\n\n      case 'PtgSub':\n        /* [MS-XLS] 2.5.198.90 */\n        e1 = stack.pop();\n        e2 = stack.pop();\n\n        if (last_sp >= 0) {\n          switch (formula[0][last_sp][1][0]) {\n            case 0:\n              // $FlowIgnore\n              sp = fill(\" \", formula[0][last_sp][1][1]);\n              break;\n\n            case 1:\n              // $FlowIgnore\n              sp = fill(\"\\r\", formula[0][last_sp][1][1]);\n              break;\n\n            default:\n              sp = \"\"; // $FlowIgnore\n\n              if (opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n          }\n\n          e2 = e2 + sp;\n          last_sp = -1;\n        }\n\n        stack.push(e2 + PtgBinOp[f[0]] + e1);\n        break;\n\n      case 'PtgIsect':\n        /* [MS-XLS] 2.5.198.67 */\n        e1 = stack.pop();\n        e2 = stack.pop();\n        stack.push(e2 + \" \" + e1);\n        break;\n\n      case 'PtgUnion':\n        /* [MS-XLS] 2.5.198.94 */\n        e1 = stack.pop();\n        e2 = stack.pop();\n        stack.push(e2 + \",\" + e1);\n        break;\n\n      case 'PtgRange':\n        /* [MS-XLS] 2.5.198.83 */\n        e1 = stack.pop();\n        e2 = stack.pop();\n        stack.push(e2 + \":\" + e1);\n        break;\n\n      case 'PtgAttrChoose':\n        /* [MS-XLS] 2.5.198.34 */\n        break;\n\n      case 'PtgAttrGoto':\n        /* [MS-XLS] 2.5.198.35 */\n        break;\n\n      case 'PtgAttrIf':\n        /* [MS-XLS] 2.5.198.36 */\n        break;\n\n      case 'PtgAttrIfError':\n        /* [MS-XLSB] 2.5.97.28 */\n        break;\n\n      case 'PtgRef':\n        /* [MS-XLS] 2.5.198.84 */\n\n        /*::type = f[1][0]; */\n        c = shift_cell_xls(f[1][1]\n        /*:any*/\n        , _range, opts);\n        stack.push(encode_cell_xls(c, biff));\n        break;\n\n      case 'PtgRefN':\n        /* [MS-XLS] 2.5.198.88 */\n\n        /*::type = f[1][0]; */\n        c = cell ? shift_cell_xls(f[1][1]\n        /*:any*/\n        , cell, opts) : f[1][1]\n        /*:any*/\n        ;\n        stack.push(encode_cell_xls(c, biff));\n        break;\n\n      case 'PtgRef3d':\n        /* [MS-XLS] 2.5.198.85 */\n\n        /*::type = f[1][0]; */\n        ixti =\n        /*::Number(*/\n        f[1][1]\n        /*::)*/\n        ;\n        c = shift_cell_xls(f[1][2]\n        /*:any*/\n        , _range, opts);\n        sname = get_ixti(supbooks, ixti, opts);\n        var w = sname;\n        /* IE9 fails on defined names */\n        // eslint-disable-line no-unused-vars\n\n        stack.push(sname + \"!\" + encode_cell_xls(c, biff));\n        break;\n\n      case 'PtgFunc':\n      /* [MS-XLS] 2.5.198.62 */\n\n      case 'PtgFuncVar':\n        /* [MS-XLS] 2.5.198.63 */\n\n        /* f[1] = [argc, func, type] */\n        var argc\n        /*:number*/\n        = f[1][0]\n        /*:any*/\n        ,\n            func\n        /*:string*/\n        = f[1][1]\n        /*:any*/\n        ;\n        if (!argc) argc = 0;\n        argc &= 0x7F;\n        var args = argc == 0 ? [] : stack.slice(-argc);\n        stack.length -= argc;\n        if (func === 'User') func = args.shift();\n        stack.push(func + \"(\" + args.join(\",\") + \")\");\n        break;\n\n      case 'PtgBool':\n        /* [MS-XLS] 2.5.198.42 */\n        stack.push(f[1] ? \"TRUE\" : \"FALSE\");\n        break;\n\n      case 'PtgInt':\n        /* [MS-XLS] 2.5.198.66 */\n        stack.push(\n        /*::String(*/\n        f[1]\n        /*::)*/\n        );\n        break;\n\n      case 'PtgNum':\n        /* [MS-XLS] 2.5.198.79 TODO: precision? */\n        stack.push(String(f[1]));\n        break;\n\n      case 'PtgStr':\n        /* [MS-XLS] 2.5.198.89 */\n        // $FlowIgnore\n        stack.push('\"' + f[1].replace(/\"/g, '\"\"') + '\"');\n        break;\n\n      case 'PtgErr':\n        /* [MS-XLS] 2.5.198.57 */\n        stack.push(\n        /*::String(*/\n        f[1]\n        /*::)*/\n        );\n        break;\n\n      case 'PtgAreaN':\n        /* [MS-XLS] 2.5.198.31 TODO */\n\n        /*::type = f[1][0]; */\n        r = shift_range_xls(f[1][1], cell ? {\n          s: cell\n        } : _range, opts);\n        stack.push(encode_range_xls(r\n        /*:any*/\n        , opts));\n        break;\n\n      case 'PtgArea':\n        /* [MS-XLS] 2.5.198.27 TODO: fixed points */\n\n        /*::type = f[1][0]; */\n        r = shift_range_xls(f[1][1], _range, opts);\n        stack.push(encode_range_xls(r\n        /*:any*/\n        , opts));\n        break;\n\n      case 'PtgArea3d':\n        /* [MS-XLS] 2.5.198.28 TODO */\n\n        /*::type = f[1][0]; */\n        ixti =\n        /*::Number(*/\n        f[1][1]\n        /*::)*/\n        ;\n        r = f[1][2];\n        sname = get_ixti(supbooks, ixti, opts);\n        stack.push(sname + \"!\" + encode_range_xls(r\n        /*:any*/\n        , opts));\n        break;\n\n      case 'PtgAttrSum':\n        /* [MS-XLS] 2.5.198.41 */\n        stack.push(\"SUM(\" + stack.pop() + \")\");\n        break;\n\n      case 'PtgAttrBaxcel':\n      /* [MS-XLS] 2.5.198.33 */\n\n      case 'PtgAttrSemi':\n        /* [MS-XLS] 2.5.198.37 */\n        break;\n\n      case 'PtgName':\n        /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 TODO: revisions */\n\n        /* f[1] = type, 0, nameindex */\n        nameidx = f[1][2]\n        /*:any*/\n        ;\n        var lbl = (supbooks.names || [])[nameidx - 1] || (supbooks[0] || [])[nameidx];\n        var name = lbl ? lbl.Name : \"SH33TJSNAME\" + String(nameidx);\n        /* [MS-XLSB] 2.5.97.10 Ftab -- last verified 20220204 */\n\n        if (name && name.slice(0, 6) == \"_xlfn.\" && !opts.xlfn) name = name.slice(6);\n        stack.push(name);\n        break;\n\n      case 'PtgNameX':\n        /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 TODO: revisions */\n\n        /* f[1] = type, ixti, nameindex */\n        var bookidx\n        /*:number*/\n        = f[1][1]\n        /*:any*/\n        ;\n        nameidx = f[1][2]\n        /*:any*/\n        ;\n        var externbook;\n        /* TODO: Properly handle missing values -- this should be using get_ixti_raw primarily */\n\n        if (opts.biff <= 5) {\n          if (bookidx < 0) bookidx = -bookidx;\n          if (supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\n        } else {\n          var o = \"\";\n\n          if (((supbooks[bookidx] || [])[0] || [])[0] == 0x3A01) {\n            /* empty */\n          } else if (((supbooks[bookidx] || [])[0] || [])[0] == 0x0401) {\n            if (supbooks[bookidx][nameidx] && supbooks[bookidx][nameidx].itab > 0) {\n              o = supbooks.SheetNames[supbooks[bookidx][nameidx].itab - 1] + \"!\";\n            }\n          } else o = supbooks.SheetNames[nameidx - 1] + \"!\";\n\n          if (supbooks[bookidx] && supbooks[bookidx][nameidx]) o += supbooks[bookidx][nameidx].Name;else if (supbooks[0] && supbooks[0][nameidx]) o += supbooks[0][nameidx].Name;else {\n            var ixtidata = (get_ixti_raw(supbooks, bookidx, opts) || \"\").split(\";;\");\n            if (ixtidata[nameidx - 1]) o = ixtidata[nameidx - 1]; // TODO: confirm this is correct\n            else o += \"SH33TJSERRX\";\n          }\n          stack.push(o);\n          break;\n        }\n\n        if (!externbook) externbook = {\n          Name: \"SH33TJSERRY\"\n        };\n        stack.push(externbook.Name);\n        break;\n\n      case 'PtgParen':\n        /* [MS-XLS] 2.5.198.80 */\n        var lp = '(',\n            rp = ')';\n\n        if (last_sp >= 0) {\n          sp = \"\";\n\n          switch (formula[0][last_sp][1][0]) {\n            // $FlowIgnore\n            case 2:\n              lp = fill(\" \", formula[0][last_sp][1][1]) + lp;\n              break;\n            // $FlowIgnore\n\n            case 3:\n              lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp;\n              break;\n            // $FlowIgnore\n\n            case 4:\n              rp = fill(\" \", formula[0][last_sp][1][1]) + rp;\n              break;\n            // $FlowIgnore\n\n            case 5:\n              rp = fill(\"\\r\", formula[0][last_sp][1][1]) + rp;\n              break;\n\n            default:\n              // $FlowIgnore\n              if (opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n          }\n\n          last_sp = -1;\n        }\n\n        stack.push(lp + stack.pop() + rp);\n        break;\n\n      case 'PtgRefErr':\n        /* [MS-XLS] 2.5.198.86 */\n        stack.push('#REF!');\n        break;\n\n      case 'PtgRefErr3d':\n        /* [MS-XLS] 2.5.198.87 */\n        stack.push('#REF!');\n        break;\n\n      case 'PtgExp':\n        /* [MS-XLS] 2.5.198.58 TODO */\n        c = {\n          c: f[1][1]\n          /*:any*/\n          ,\n          r: f[1][0]\n          /*:any*/\n\n        };\n        var q = {\n          c: cell.c,\n          r: cell.r\n        }\n        /*:any*/\n        ;\n\n        if (supbooks.sharedf[encode_cell(c)]) {\n          var parsedf = supbooks.sharedf[encode_cell(c)];\n          stack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n        } else {\n          var fnd = false;\n\n          for (e1 = 0; e1 != supbooks.arrayf.length; ++e1) {\n            /* TODO: should be something like range_has */\n            e2 = supbooks.arrayf[e1];\n            if (c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n            if (c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n            stack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n            fnd = true;\n            break;\n          }\n\n          if (!fnd) stack.push(\n          /*::String(*/\n          f[1]\n          /*::)*/\n          );\n        }\n\n        break;\n\n      case 'PtgArray':\n        /* [MS-XLS] 2.5.198.32 TODO */\n        stack.push(\"{\" + stringify_array(\n        /*::(*/\n        f[1]\n        /*:: :any)*/\n        ) + \"}\");\n        break;\n\n      case 'PtgMemArea':\n        /* [MS-XLS] 2.5.198.70 TODO: confirm this is a non-display */\n        //stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n        break;\n\n      case 'PtgAttrSpace':\n      /* [MS-XLS] 2.5.198.38 */\n\n      case 'PtgAttrSpaceSemi':\n        /* [MS-XLS] 2.5.198.39 */\n        last_sp = ff;\n        break;\n\n      case 'PtgTbl':\n        /* [MS-XLS] 2.5.198.92 TODO */\n        break;\n\n      case 'PtgMemErr':\n        /* [MS-XLS] 2.5.198.71 */\n        break;\n\n      case 'PtgMissArg':\n        /* [MS-XLS] 2.5.198.74 */\n        stack.push(\"\");\n        break;\n\n      case 'PtgAreaErr':\n        /* [MS-XLS] 2.5.198.29 */\n        stack.push(\"#REF!\");\n        break;\n\n      case 'PtgAreaErr3d':\n        /* [MS-XLS] 2.5.198.30 */\n        stack.push(\"#REF!\");\n        break;\n\n      case 'PtgList':\n        /* [MS-XLSB] 2.5.97.52 */\n        // $FlowIgnore\n        stack.push(\"Table\" + f[1].idx + \"[#\" + f[1].rt + \"]\");\n        break;\n\n      case 'PtgMemAreaN':\n      case 'PtgMemNoMemN':\n      case 'PtgAttrNoop':\n      case 'PtgSheet':\n      case 'PtgEndSheet':\n        break;\n\n      case 'PtgMemFunc':\n        /* [MS-XLS] 2.5.198.72 TODO */\n        break;\n\n      case 'PtgMemNoMem':\n        /* [MS-XLS] 2.5.198.73 TODO */\n        break;\n\n      case 'PtgElfCol':\n      /* [MS-XLS] 2.5.198.46 */\n\n      case 'PtgElfColS':\n      /* [MS-XLS] 2.5.198.47 */\n\n      case 'PtgElfColSV':\n      /* [MS-XLS] 2.5.198.48 */\n\n      case 'PtgElfColV':\n      /* [MS-XLS] 2.5.198.49 */\n\n      case 'PtgElfLel':\n      /* [MS-XLS] 2.5.198.50 */\n\n      case 'PtgElfRadical':\n      /* [MS-XLS] 2.5.198.51 */\n\n      case 'PtgElfRadicalLel':\n      /* [MS-XLS] 2.5.198.52 */\n\n      case 'PtgElfRadicalS':\n      /* [MS-XLS] 2.5.198.53 */\n\n      case 'PtgElfRw':\n      /* [MS-XLS] 2.5.198.54 */\n\n      case 'PtgElfRwV':\n        /* [MS-XLS] 2.5.198.55 */\n        throw new Error(\"Unsupported ELFs\");\n\n      case 'PtgSxName':\n        /* [MS-XLS] 2.5.198.91 TODO -- find a test case */\n        throw new Error('Unrecognized Formula Token: ' + String(f));\n\n      default:\n        throw new Error('Unrecognized Formula Token: ' + String(f));\n    }\n\n    var PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\n    if (opts.biff != 3) if (last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\n      f = formula[0][last_sp];\n      var _left = true;\n\n      switch (f[1][0]) {\n        /* note: some bad XLSB files omit the PtgParen */\n        case 4:\n          _left = false;\n\n        /* falls through */\n\n        case 0:\n          // $FlowIgnore\n          sp = fill(\" \", f[1][1]);\n          break;\n\n        case 5:\n          _left = false;\n\n        /* falls through */\n\n        case 1:\n          // $FlowIgnore\n          sp = fill(\"\\r\", f[1][1]);\n          break;\n\n        default:\n          sp = \"\"; // $FlowIgnore\n\n          if (opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + f[1][0]);\n      }\n\n      stack.push((_left ? sp : \"\") + stack.pop() + (_left ? \"\" : sp));\n      last_sp = -1;\n    }\n  }\n\n  if (stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\n  return stack[0];\n}\n/* [MS-XLS] 2.5.198.1 TODO */\n\n\nfunction parse_ArrayParsedFormula(blob, length, opts\n/*::, ref*/\n) {\n  var target = blob.l + length,\n      len = opts.biff == 2 ? 1 : 2;\n  var rgcb,\n      cce = blob.read_shift(len); // length of rgce\n\n  if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n  var rgce = parse_Rgce(blob, cce, opts);\n  if (length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n  blob.l = target;\n  return [rgce, rgcb];\n}\n/* [MS-XLS] 2.5.198.3 TODO */\n\n\nfunction parse_XLSCellParsedFormula(blob, length, opts) {\n  var target = blob.l + length,\n      len = opts.biff == 2 ? 1 : 2;\n  var rgcb,\n      cce = blob.read_shift(len); // length of rgce\n\n  if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n  var rgce = parse_Rgce(blob, cce, opts);\n  if (length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n  blob.l = target;\n  return [rgce, rgcb];\n}\n/* [MS-XLS] 2.5.198.21 */\n\n\nfunction parse_NameParsedFormula(blob, length, opts, cce) {\n  var target = blob.l + length;\n  var rgce = parse_Rgce(blob, cce, opts);\n  var rgcb;\n  if (target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n  return [rgce, rgcb];\n}\n/* [MS-XLS] 2.5.198.118 TODO */\n\n\nfunction parse_SharedParsedFormula(blob, length, opts) {\n  var target = blob.l + length;\n  var rgcb,\n      cce = blob.read_shift(2); // length of rgce\n\n  var rgce = parse_Rgce(blob, cce, opts);\n  if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n  if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n  return [rgce, rgcb];\n}\n/* [MS-XLS] 2.5.133 TODO: how to emit empty strings? */\n\n\nfunction parse_FormulaValue(blob\n/*::, length*/\n) {\n  var b;\n  if (__readUInt16LE(blob, blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob), 'n'];\n\n  switch (blob[blob.l]) {\n    case 0x00:\n      blob.l += 8;\n      return [\"String\", 's'];\n\n    case 0x01:\n      b = blob[blob.l + 2] === 0x1;\n      blob.l += 8;\n      return [b, 'b'];\n\n    case 0x02:\n      b = blob[blob.l + 2];\n      blob.l += 8;\n      return [b, 'e'];\n\n    case 0x03:\n      blob.l += 8;\n      return [\"\", 's'];\n  }\n\n  return [];\n}\n\nfunction write_FormulaValue(value) {\n  if (value == null) {\n    // Blank String Value\n    var o = new_buf(8);\n    o.write_shift(1, 0x03);\n    o.write_shift(1, 0);\n    o.write_shift(2, 0);\n    o.write_shift(2, 0);\n    o.write_shift(2, 0xFFFF);\n    return o;\n  } else if (typeof value == \"number\") return write_Xnum(value);\n\n  return write_Xnum(0);\n}\n/* [MS-XLS] 2.4.127 TODO */\n\n\nfunction parse_Formula(blob, length, opts) {\n  var end = blob.l + length;\n  var cell = parse_XLSCell(blob, 6);\n  if (opts.biff == 2) ++blob.l;\n  var val = parse_FormulaValue(blob, 8);\n  var flags = blob.read_shift(1);\n\n  if (opts.biff != 2) {\n    blob.read_shift(1);\n\n    if (opts.biff >= 5) {\n      /*var chn = */\n      blob.read_shift(4);\n    }\n  }\n\n  var cbf = parse_XLSCellParsedFormula(blob, end - blob.l, opts);\n  return {\n    cell: cell,\n    val: val[0],\n    formula: cbf,\n    shared: flags >> 3 & 1,\n    tt: val[1]\n  };\n}\n\nfunction write_Formula(cell\n/*:Cell*/\n, R\n/*:number*/\n, C\n/*:number*/\n, opts, os\n/*:number*/\n) {\n  // Cell\n  var o1 = write_XLSCell(R, C, os); // FormulaValue\n\n  var o2 = write_FormulaValue(cell.v); // flags + cache\n\n  var o3 = new_buf(6);\n  var flags = 0x01 | 0x20;\n  o3.write_shift(2, flags);\n  o3.write_shift(4, 0); // CellParsedFormula\n\n  var bf = new_buf(cell.bf.length);\n\n  for (var i = 0; i < cell.bf.length; ++i) bf[i] = cell.bf[i];\n\n  var out = bconcat([o1, o2, o3, bf]);\n  return out;\n}\n/* XLSB Parsed Formula records have the same shape */\n\n\nfunction parse_XLSBParsedFormula(data, length, opts) {\n  var cce = data.read_shift(4);\n  var rgce = parse_Rgce(data, cce, opts);\n  var cb = data.read_shift(4);\n  var rgcb = cb > 0 ? parse_RgbExtra(data, cb, rgce, opts) : null;\n  return [rgce, rgcb];\n}\n/* [MS-XLSB] 2.5.97.1 ArrayParsedFormula */\n\n\nvar parse_XLSBArrayParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.4 CellParsedFormula */\n\nvar parse_XLSBCellParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.8 DVParsedFormula */\n//var parse_XLSBDVParsedFormula = parse_XLSBParsedFormula;\n\n/* [MS-XLSB] 2.5.97.9 FRTParsedFormula */\n//var parse_XLSBFRTParsedFormula = parse_XLSBParsedFormula2;\n\n/* [MS-XLSB] 2.5.97.12 NameParsedFormula */\n\nvar parse_XLSBNameParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.98 SharedParsedFormula */\n\nvar parse_XLSBSharedParsedFormula = parse_XLSBParsedFormula;\nvar Cetab = {\n  0: \"BEEP\",\n  1: \"OPEN\",\n  2: \"OPEN.LINKS\",\n  3: \"CLOSE.ALL\",\n  4: \"SAVE\",\n  5: \"SAVE.AS\",\n  6: \"FILE.DELETE\",\n  7: \"PAGE.SETUP\",\n  8: \"PRINT\",\n  9: \"PRINTER.SETUP\",\n  10: \"QUIT\",\n  11: \"NEW.WINDOW\",\n  12: \"ARRANGE.ALL\",\n  13: \"WINDOW.SIZE\",\n  14: \"WINDOW.MOVE\",\n  15: \"FULL\",\n  16: \"CLOSE\",\n  17: \"RUN\",\n  22: \"SET.PRINT.AREA\",\n  23: \"SET.PRINT.TITLES\",\n  24: \"SET.PAGE.BREAK\",\n  25: \"REMOVE.PAGE.BREAK\",\n  26: \"FONT\",\n  27: \"DISPLAY\",\n  28: \"PROTECT.DOCUMENT\",\n  29: \"PRECISION\",\n  30: \"A1.R1C1\",\n  31: \"CALCULATE.NOW\",\n  32: \"CALCULATION\",\n  34: \"DATA.FIND\",\n  35: \"EXTRACT\",\n  36: \"DATA.DELETE\",\n  37: \"SET.DATABASE\",\n  38: \"SET.CRITERIA\",\n  39: \"SORT\",\n  40: \"DATA.SERIES\",\n  41: \"TABLE\",\n  42: \"FORMAT.NUMBER\",\n  43: \"ALIGNMENT\",\n  44: \"STYLE\",\n  45: \"BORDER\",\n  46: \"CELL.PROTECTION\",\n  47: \"COLUMN.WIDTH\",\n  48: \"UNDO\",\n  49: \"CUT\",\n  50: \"COPY\",\n  51: \"PASTE\",\n  52: \"CLEAR\",\n  53: \"PASTE.SPECIAL\",\n  54: \"EDIT.DELETE\",\n  55: \"INSERT\",\n  56: \"FILL.RIGHT\",\n  57: \"FILL.DOWN\",\n  61: \"DEFINE.NAME\",\n  62: \"CREATE.NAMES\",\n  63: \"FORMULA.GOTO\",\n  64: \"FORMULA.FIND\",\n  65: \"SELECT.LAST.CELL\",\n  66: \"SHOW.ACTIVE.CELL\",\n  67: \"GALLERY.AREA\",\n  68: \"GALLERY.BAR\",\n  69: \"GALLERY.COLUMN\",\n  70: \"GALLERY.LINE\",\n  71: \"GALLERY.PIE\",\n  72: \"GALLERY.SCATTER\",\n  73: \"COMBINATION\",\n  74: \"PREFERRED\",\n  75: \"ADD.OVERLAY\",\n  76: \"GRIDLINES\",\n  77: \"SET.PREFERRED\",\n  78: \"AXES\",\n  79: \"LEGEND\",\n  80: \"ATTACH.TEXT\",\n  81: \"ADD.ARROW\",\n  82: \"SELECT.CHART\",\n  83: \"SELECT.PLOT.AREA\",\n  84: \"PATTERNS\",\n  85: \"MAIN.CHART\",\n  86: \"OVERLAY\",\n  87: \"SCALE\",\n  88: \"FORMAT.LEGEND\",\n  89: \"FORMAT.TEXT\",\n  90: \"EDIT.REPEAT\",\n  91: \"PARSE\",\n  92: \"JUSTIFY\",\n  93: \"HIDE\",\n  94: \"UNHIDE\",\n  95: \"WORKSPACE\",\n  96: \"FORMULA\",\n  97: \"FORMULA.FILL\",\n  98: \"FORMULA.ARRAY\",\n  99: \"DATA.FIND.NEXT\",\n  100: \"DATA.FIND.PREV\",\n  101: \"FORMULA.FIND.NEXT\",\n  102: \"FORMULA.FIND.PREV\",\n  103: \"ACTIVATE\",\n  104: \"ACTIVATE.NEXT\",\n  105: \"ACTIVATE.PREV\",\n  106: \"UNLOCKED.NEXT\",\n  107: \"UNLOCKED.PREV\",\n  108: \"COPY.PICTURE\",\n  109: \"SELECT\",\n  110: \"DELETE.NAME\",\n  111: \"DELETE.FORMAT\",\n  112: \"VLINE\",\n  113: \"HLINE\",\n  114: \"VPAGE\",\n  115: \"HPAGE\",\n  116: \"VSCROLL\",\n  117: \"HSCROLL\",\n  118: \"ALERT\",\n  119: \"NEW\",\n  120: \"CANCEL.COPY\",\n  121: \"SHOW.CLIPBOARD\",\n  122: \"MESSAGE\",\n  124: \"PASTE.LINK\",\n  125: \"APP.ACTIVATE\",\n  126: \"DELETE.ARROW\",\n  127: \"ROW.HEIGHT\",\n  128: \"FORMAT.MOVE\",\n  129: \"FORMAT.SIZE\",\n  130: \"FORMULA.REPLACE\",\n  131: \"SEND.KEYS\",\n  132: \"SELECT.SPECIAL\",\n  133: \"APPLY.NAMES\",\n  134: \"REPLACE.FONT\",\n  135: \"FREEZE.PANES\",\n  136: \"SHOW.INFO\",\n  137: \"SPLIT\",\n  138: \"ON.WINDOW\",\n  139: \"ON.DATA\",\n  140: \"DISABLE.INPUT\",\n  142: \"OUTLINE\",\n  143: \"LIST.NAMES\",\n  144: \"FILE.CLOSE\",\n  145: \"SAVE.WORKBOOK\",\n  146: \"DATA.FORM\",\n  147: \"COPY.CHART\",\n  148: \"ON.TIME\",\n  149: \"WAIT\",\n  150: \"FORMAT.FONT\",\n  151: \"FILL.UP\",\n  152: \"FILL.LEFT\",\n  153: \"DELETE.OVERLAY\",\n  155: \"SHORT.MENUS\",\n  159: \"SET.UPDATE.STATUS\",\n  161: \"COLOR.PALETTE\",\n  162: \"DELETE.STYLE\",\n  163: \"WINDOW.RESTORE\",\n  164: \"WINDOW.MAXIMIZE\",\n  166: \"CHANGE.LINK\",\n  167: \"CALCULATE.DOCUMENT\",\n  168: \"ON.KEY\",\n  169: \"APP.RESTORE\",\n  170: \"APP.MOVE\",\n  171: \"APP.SIZE\",\n  172: \"APP.MINIMIZE\",\n  173: \"APP.MAXIMIZE\",\n  174: \"BRING.TO.FRONT\",\n  175: \"SEND.TO.BACK\",\n  185: \"MAIN.CHART.TYPE\",\n  186: \"OVERLAY.CHART.TYPE\",\n  187: \"SELECT.END\",\n  188: \"OPEN.MAIL\",\n  189: \"SEND.MAIL\",\n  190: \"STANDARD.FONT\",\n  191: \"CONSOLIDATE\",\n  192: \"SORT.SPECIAL\",\n  193: \"GALLERY.3D.AREA\",\n  194: \"GALLERY.3D.COLUMN\",\n  195: \"GALLERY.3D.LINE\",\n  196: \"GALLERY.3D.PIE\",\n  197: \"VIEW.3D\",\n  198: \"GOAL.SEEK\",\n  199: \"WORKGROUP\",\n  200: \"FILL.GROUP\",\n  201: \"UPDATE.LINK\",\n  202: \"PROMOTE\",\n  203: \"DEMOTE\",\n  204: \"SHOW.DETAIL\",\n  206: \"UNGROUP\",\n  207: \"OBJECT.PROPERTIES\",\n  208: \"SAVE.NEW.OBJECT\",\n  209: \"SHARE\",\n  210: \"SHARE.NAME\",\n  211: \"DUPLICATE\",\n  212: \"APPLY.STYLE\",\n  213: \"ASSIGN.TO.OBJECT\",\n  214: \"OBJECT.PROTECTION\",\n  215: \"HIDE.OBJECT\",\n  216: \"SET.EXTRACT\",\n  217: \"CREATE.PUBLISHER\",\n  218: \"SUBSCRIBE.TO\",\n  219: \"ATTRIBUTES\",\n  220: \"SHOW.TOOLBAR\",\n  222: \"PRINT.PREVIEW\",\n  223: \"EDIT.COLOR\",\n  224: \"SHOW.LEVELS\",\n  225: \"FORMAT.MAIN\",\n  226: \"FORMAT.OVERLAY\",\n  227: \"ON.RECALC\",\n  228: \"EDIT.SERIES\",\n  229: \"DEFINE.STYLE\",\n  240: \"LINE.PRINT\",\n  243: \"ENTER.DATA\",\n  249: \"GALLERY.RADAR\",\n  250: \"MERGE.STYLES\",\n  251: \"EDITION.OPTIONS\",\n  252: \"PASTE.PICTURE\",\n  253: \"PASTE.PICTURE.LINK\",\n  254: \"SPELLING\",\n  256: \"ZOOM\",\n  259: \"INSERT.OBJECT\",\n  260: \"WINDOW.MINIMIZE\",\n  265: \"SOUND.NOTE\",\n  266: \"SOUND.PLAY\",\n  267: \"FORMAT.SHAPE\",\n  268: \"EXTEND.POLYGON\",\n  269: \"FORMAT.AUTO\",\n  272: \"GALLERY.3D.BAR\",\n  273: \"GALLERY.3D.SURFACE\",\n  274: \"FILL.AUTO\",\n  276: \"CUSTOMIZE.TOOLBAR\",\n  277: \"ADD.TOOL\",\n  278: \"EDIT.OBJECT\",\n  279: \"ON.DOUBLECLICK\",\n  280: \"ON.ENTRY\",\n  281: \"WORKBOOK.ADD\",\n  282: \"WORKBOOK.MOVE\",\n  283: \"WORKBOOK.COPY\",\n  284: \"WORKBOOK.OPTIONS\",\n  285: \"SAVE.WORKSPACE\",\n  288: \"CHART.WIZARD\",\n  289: \"DELETE.TOOL\",\n  290: \"MOVE.TOOL\",\n  291: \"WORKBOOK.SELECT\",\n  292: \"WORKBOOK.ACTIVATE\",\n  293: \"ASSIGN.TO.TOOL\",\n  295: \"COPY.TOOL\",\n  296: \"RESET.TOOL\",\n  297: \"CONSTRAIN.NUMERIC\",\n  298: \"PASTE.TOOL\",\n  302: \"WORKBOOK.NEW\",\n  305: \"SCENARIO.CELLS\",\n  306: \"SCENARIO.DELETE\",\n  307: \"SCENARIO.ADD\",\n  308: \"SCENARIO.EDIT\",\n  309: \"SCENARIO.SHOW\",\n  310: \"SCENARIO.SHOW.NEXT\",\n  311: \"SCENARIO.SUMMARY\",\n  312: \"PIVOT.TABLE.WIZARD\",\n  313: \"PIVOT.FIELD.PROPERTIES\",\n  314: \"PIVOT.FIELD\",\n  315: \"PIVOT.ITEM\",\n  316: \"PIVOT.ADD.FIELDS\",\n  318: \"OPTIONS.CALCULATION\",\n  319: \"OPTIONS.EDIT\",\n  320: \"OPTIONS.VIEW\",\n  321: \"ADDIN.MANAGER\",\n  322: \"MENU.EDITOR\",\n  323: \"ATTACH.TOOLBARS\",\n  324: \"VBAActivate\",\n  325: \"OPTIONS.CHART\",\n  328: \"VBA.INSERT.FILE\",\n  330: \"VBA.PROCEDURE.DEFINITION\",\n  336: \"ROUTING.SLIP\",\n  338: \"ROUTE.DOCUMENT\",\n  339: \"MAIL.LOGON\",\n  342: \"INSERT.PICTURE\",\n  343: \"EDIT.TOOL\",\n  344: \"GALLERY.DOUGHNUT\",\n  350: \"CHART.TREND\",\n  352: \"PIVOT.ITEM.PROPERTIES\",\n  354: \"WORKBOOK.INSERT\",\n  355: \"OPTIONS.TRANSITION\",\n  356: \"OPTIONS.GENERAL\",\n  370: \"FILTER.ADVANCED\",\n  373: \"MAIL.ADD.MAILER\",\n  374: \"MAIL.DELETE.MAILER\",\n  375: \"MAIL.REPLY\",\n  376: \"MAIL.REPLY.ALL\",\n  377: \"MAIL.FORWARD\",\n  378: \"MAIL.NEXT.LETTER\",\n  379: \"DATA.LABEL\",\n  380: \"INSERT.TITLE\",\n  381: \"FONT.PROPERTIES\",\n  382: \"MACRO.OPTIONS\",\n  383: \"WORKBOOK.HIDE\",\n  384: \"WORKBOOK.UNHIDE\",\n  385: \"WORKBOOK.DELETE\",\n  386: \"WORKBOOK.NAME\",\n  388: \"GALLERY.CUSTOM\",\n  390: \"ADD.CHART.AUTOFORMAT\",\n  391: \"DELETE.CHART.AUTOFORMAT\",\n  392: \"CHART.ADD.DATA\",\n  393: \"AUTO.OUTLINE\",\n  394: \"TAB.ORDER\",\n  395: \"SHOW.DIALOG\",\n  396: \"SELECT.ALL\",\n  397: \"UNGROUP.SHEETS\",\n  398: \"SUBTOTAL.CREATE\",\n  399: \"SUBTOTAL.REMOVE\",\n  400: \"RENAME.OBJECT\",\n  412: \"WORKBOOK.SCROLL\",\n  413: \"WORKBOOK.NEXT\",\n  414: \"WORKBOOK.PREV\",\n  415: \"WORKBOOK.TAB.SPLIT\",\n  416: \"FULL.SCREEN\",\n  417: \"WORKBOOK.PROTECT\",\n  420: \"SCROLLBAR.PROPERTIES\",\n  421: \"PIVOT.SHOW.PAGES\",\n  422: \"TEXT.TO.COLUMNS\",\n  423: \"FORMAT.CHARTTYPE\",\n  424: \"LINK.FORMAT\",\n  425: \"TRACER.DISPLAY\",\n  430: \"TRACER.NAVIGATE\",\n  431: \"TRACER.CLEAR\",\n  432: \"TRACER.ERROR\",\n  433: \"PIVOT.FIELD.GROUP\",\n  434: \"PIVOT.FIELD.UNGROUP\",\n  435: \"CHECKBOX.PROPERTIES\",\n  436: \"LABEL.PROPERTIES\",\n  437: \"LISTBOX.PROPERTIES\",\n  438: \"EDITBOX.PROPERTIES\",\n  439: \"PIVOT.REFRESH\",\n  440: \"LINK.COMBO\",\n  441: \"OPEN.TEXT\",\n  442: \"HIDE.DIALOG\",\n  443: \"SET.DIALOG.FOCUS\",\n  444: \"ENABLE.OBJECT\",\n  445: \"PUSHBUTTON.PROPERTIES\",\n  446: \"SET.DIALOG.DEFAULT\",\n  447: \"FILTER\",\n  448: \"FILTER.SHOW.ALL\",\n  449: \"CLEAR.OUTLINE\",\n  450: \"FUNCTION.WIZARD\",\n  451: \"ADD.LIST.ITEM\",\n  452: \"SET.LIST.ITEM\",\n  453: \"REMOVE.LIST.ITEM\",\n  454: \"SELECT.LIST.ITEM\",\n  455: \"SET.CONTROL.VALUE\",\n  456: \"SAVE.COPY.AS\",\n  458: \"OPTIONS.LISTS.ADD\",\n  459: \"OPTIONS.LISTS.DELETE\",\n  460: \"SERIES.AXES\",\n  461: \"SERIES.X\",\n  462: \"SERIES.Y\",\n  463: \"ERRORBAR.X\",\n  464: \"ERRORBAR.Y\",\n  465: \"FORMAT.CHART\",\n  466: \"SERIES.ORDER\",\n  467: \"MAIL.LOGOFF\",\n  468: \"CLEAR.ROUTING.SLIP\",\n  469: \"APP.ACTIVATE.MICROSOFT\",\n  470: \"MAIL.EDIT.MAILER\",\n  471: \"ON.SHEET\",\n  472: \"STANDARD.WIDTH\",\n  473: \"SCENARIO.MERGE\",\n  474: \"SUMMARY.INFO\",\n  475: \"FIND.FILE\",\n  476: \"ACTIVE.CELL.FONT\",\n  477: \"ENABLE.TIPWIZARD\",\n  478: \"VBA.MAKE.ADDIN\",\n  480: \"INSERTDATATABLE\",\n  481: \"WORKGROUP.OPTIONS\",\n  482: \"MAIL.SEND.MAILER\",\n  485: \"AUTOCORRECT\",\n  489: \"POST.DOCUMENT\",\n  491: \"PICKLIST\",\n  493: \"VIEW.SHOW\",\n  494: \"VIEW.DEFINE\",\n  495: \"VIEW.DELETE\",\n  509: \"SHEET.BACKGROUND\",\n  510: \"INSERT.MAP.OBJECT\",\n  511: \"OPTIONS.MENONO\",\n  517: \"MSOCHECKS\",\n  518: \"NORMAL\",\n  519: \"LAYOUT\",\n  520: \"RM.PRINT.AREA\",\n  521: \"CLEAR.PRINT.AREA\",\n  522: \"ADD.PRINT.AREA\",\n  523: \"MOVE.BRK\",\n  545: \"HIDECURR.NOTE\",\n  546: \"HIDEALL.NOTES\",\n  547: \"DELETE.NOTE\",\n  548: \"TRAVERSE.NOTES\",\n  549: \"ACTIVATE.NOTES\",\n  620: \"PROTECT.REVISIONS\",\n  621: \"UNPROTECT.REVISIONS\",\n  647: \"OPTIONS.ME\",\n  653: \"WEB.PUBLISH\",\n  667: \"NEWWEBQUERY\",\n  673: \"PIVOT.TABLE.CHART\",\n  753: \"OPTIONS.SAVE\",\n  755: \"OPTIONS.SPELL\",\n  808: \"HIDEALL.INKANNOTS\"\n};\nvar Ftab = {\n  0: \"COUNT\",\n  1: \"IF\",\n  2: \"ISNA\",\n  3: \"ISERROR\",\n  4: \"SUM\",\n  5: \"AVERAGE\",\n  6: \"MIN\",\n  7: \"MAX\",\n  8: \"ROW\",\n  9: \"COLUMN\",\n  10: \"NA\",\n  11: \"NPV\",\n  12: \"STDEV\",\n  13: \"DOLLAR\",\n  14: \"FIXED\",\n  15: \"SIN\",\n  16: \"COS\",\n  17: \"TAN\",\n  18: \"ATAN\",\n  19: \"PI\",\n  20: \"SQRT\",\n  21: \"EXP\",\n  22: \"LN\",\n  23: \"LOG10\",\n  24: \"ABS\",\n  25: \"INT\",\n  26: \"SIGN\",\n  27: \"ROUND\",\n  28: \"LOOKUP\",\n  29: \"INDEX\",\n  30: \"REPT\",\n  31: \"MID\",\n  32: \"LEN\",\n  33: \"VALUE\",\n  34: \"TRUE\",\n  35: \"FALSE\",\n  36: \"AND\",\n  37: \"OR\",\n  38: \"NOT\",\n  39: \"MOD\",\n  40: \"DCOUNT\",\n  41: \"DSUM\",\n  42: \"DAVERAGE\",\n  43: \"DMIN\",\n  44: \"DMAX\",\n  45: \"DSTDEV\",\n  46: \"VAR\",\n  47: \"DVAR\",\n  48: \"TEXT\",\n  49: \"LINEST\",\n  50: \"TREND\",\n  51: \"LOGEST\",\n  52: \"GROWTH\",\n  53: \"GOTO\",\n  54: \"HALT\",\n  55: \"RETURN\",\n  56: \"PV\",\n  57: \"FV\",\n  58: \"NPER\",\n  59: \"PMT\",\n  60: \"RATE\",\n  61: \"MIRR\",\n  62: \"IRR\",\n  63: \"RAND\",\n  64: \"MATCH\",\n  65: \"DATE\",\n  66: \"TIME\",\n  67: \"DAY\",\n  68: \"MONTH\",\n  69: \"YEAR\",\n  70: \"WEEKDAY\",\n  71: \"HOUR\",\n  72: \"MINUTE\",\n  73: \"SECOND\",\n  74: \"NOW\",\n  75: \"AREAS\",\n  76: \"ROWS\",\n  77: \"COLUMNS\",\n  78: \"OFFSET\",\n  79: \"ABSREF\",\n  80: \"RELREF\",\n  81: \"ARGUMENT\",\n  82: \"SEARCH\",\n  83: \"TRANSPOSE\",\n  84: \"ERROR\",\n  85: \"STEP\",\n  86: \"TYPE\",\n  87: \"ECHO\",\n  88: \"SET.NAME\",\n  89: \"CALLER\",\n  90: \"DEREF\",\n  91: \"WINDOWS\",\n  92: \"SERIES\",\n  93: \"DOCUMENTS\",\n  94: \"ACTIVE.CELL\",\n  95: \"SELECTION\",\n  96: \"RESULT\",\n  97: \"ATAN2\",\n  98: \"ASIN\",\n  99: \"ACOS\",\n  100: \"CHOOSE\",\n  101: \"HLOOKUP\",\n  102: \"VLOOKUP\",\n  103: \"LINKS\",\n  104: \"INPUT\",\n  105: \"ISREF\",\n  106: \"GET.FORMULA\",\n  107: \"GET.NAME\",\n  108: \"SET.VALUE\",\n  109: \"LOG\",\n  110: \"EXEC\",\n  111: \"CHAR\",\n  112: \"LOWER\",\n  113: \"UPPER\",\n  114: \"PROPER\",\n  115: \"LEFT\",\n  116: \"RIGHT\",\n  117: \"EXACT\",\n  118: \"TRIM\",\n  119: \"REPLACE\",\n  120: \"SUBSTITUTE\",\n  121: \"CODE\",\n  122: \"NAMES\",\n  123: \"DIRECTORY\",\n  124: \"FIND\",\n  125: \"CELL\",\n  126: \"ISERR\",\n  127: \"ISTEXT\",\n  128: \"ISNUMBER\",\n  129: \"ISBLANK\",\n  130: \"T\",\n  131: \"N\",\n  132: \"FOPEN\",\n  133: \"FCLOSE\",\n  134: \"FSIZE\",\n  135: \"FREADLN\",\n  136: \"FREAD\",\n  137: \"FWRITELN\",\n  138: \"FWRITE\",\n  139: \"FPOS\",\n  140: \"DATEVALUE\",\n  141: \"TIMEVALUE\",\n  142: \"SLN\",\n  143: \"SYD\",\n  144: \"DDB\",\n  145: \"GET.DEF\",\n  146: \"REFTEXT\",\n  147: \"TEXTREF\",\n  148: \"INDIRECT\",\n  149: \"REGISTER\",\n  150: \"CALL\",\n  151: \"ADD.BAR\",\n  152: \"ADD.MENU\",\n  153: \"ADD.COMMAND\",\n  154: \"ENABLE.COMMAND\",\n  155: \"CHECK.COMMAND\",\n  156: \"RENAME.COMMAND\",\n  157: \"SHOW.BAR\",\n  158: \"DELETE.MENU\",\n  159: \"DELETE.COMMAND\",\n  160: \"GET.CHART.ITEM\",\n  161: \"DIALOG.BOX\",\n  162: \"CLEAN\",\n  163: \"MDETERM\",\n  164: \"MINVERSE\",\n  165: \"MMULT\",\n  166: \"FILES\",\n  167: \"IPMT\",\n  168: \"PPMT\",\n  169: \"COUNTA\",\n  170: \"CANCEL.KEY\",\n  171: \"FOR\",\n  172: \"WHILE\",\n  173: \"BREAK\",\n  174: \"NEXT\",\n  175: \"INITIATE\",\n  176: \"REQUEST\",\n  177: \"POKE\",\n  178: \"EXECUTE\",\n  179: \"TERMINATE\",\n  180: \"RESTART\",\n  181: \"HELP\",\n  182: \"GET.BAR\",\n  183: \"PRODUCT\",\n  184: \"FACT\",\n  185: \"GET.CELL\",\n  186: \"GET.WORKSPACE\",\n  187: \"GET.WINDOW\",\n  188: \"GET.DOCUMENT\",\n  189: \"DPRODUCT\",\n  190: \"ISNONTEXT\",\n  191: \"GET.NOTE\",\n  192: \"NOTE\",\n  193: \"STDEVP\",\n  194: \"VARP\",\n  195: \"DSTDEVP\",\n  196: \"DVARP\",\n  197: \"TRUNC\",\n  198: \"ISLOGICAL\",\n  199: \"DCOUNTA\",\n  200: \"DELETE.BAR\",\n  201: \"UNREGISTER\",\n  204: \"USDOLLAR\",\n  205: \"FINDB\",\n  206: \"SEARCHB\",\n  207: \"REPLACEB\",\n  208: \"LEFTB\",\n  209: \"RIGHTB\",\n  210: \"MIDB\",\n  211: \"LENB\",\n  212: \"ROUNDUP\",\n  213: \"ROUNDDOWN\",\n  214: \"ASC\",\n  215: \"DBCS\",\n  216: \"RANK\",\n  219: \"ADDRESS\",\n  220: \"DAYS360\",\n  221: \"TODAY\",\n  222: \"VDB\",\n  223: \"ELSE\",\n  224: \"ELSE.IF\",\n  225: \"END.IF\",\n  226: \"FOR.CELL\",\n  227: \"MEDIAN\",\n  228: \"SUMPRODUCT\",\n  229: \"SINH\",\n  230: \"COSH\",\n  231: \"TANH\",\n  232: \"ASINH\",\n  233: \"ACOSH\",\n  234: \"ATANH\",\n  235: \"DGET\",\n  236: \"CREATE.OBJECT\",\n  237: \"VOLATILE\",\n  238: \"LAST.ERROR\",\n  239: \"CUSTOM.UNDO\",\n  240: \"CUSTOM.REPEAT\",\n  241: \"FORMULA.CONVERT\",\n  242: \"GET.LINK.INFO\",\n  243: \"TEXT.BOX\",\n  244: \"INFO\",\n  245: \"GROUP\",\n  246: \"GET.OBJECT\",\n  247: \"DB\",\n  248: \"PAUSE\",\n  251: \"RESUME\",\n  252: \"FREQUENCY\",\n  253: \"ADD.TOOLBAR\",\n  254: \"DELETE.TOOLBAR\",\n  255: \"User\",\n  256: \"RESET.TOOLBAR\",\n  257: \"EVALUATE\",\n  258: \"GET.TOOLBAR\",\n  259: \"GET.TOOL\",\n  260: \"SPELLING.CHECK\",\n  261: \"ERROR.TYPE\",\n  262: \"APP.TITLE\",\n  263: \"WINDOW.TITLE\",\n  264: \"SAVE.TOOLBAR\",\n  265: \"ENABLE.TOOL\",\n  266: \"PRESS.TOOL\",\n  267: \"REGISTER.ID\",\n  268: \"GET.WORKBOOK\",\n  269: \"AVEDEV\",\n  270: \"BETADIST\",\n  271: \"GAMMALN\",\n  272: \"BETAINV\",\n  273: \"BINOMDIST\",\n  274: \"CHIDIST\",\n  275: \"CHIINV\",\n  276: \"COMBIN\",\n  277: \"CONFIDENCE\",\n  278: \"CRITBINOM\",\n  279: \"EVEN\",\n  280: \"EXPONDIST\",\n  281: \"FDIST\",\n  282: \"FINV\",\n  283: \"FISHER\",\n  284: \"FISHERINV\",\n  285: \"FLOOR\",\n  286: \"GAMMADIST\",\n  287: \"GAMMAINV\",\n  288: \"CEILING\",\n  289: \"HYPGEOMDIST\",\n  290: \"LOGNORMDIST\",\n  291: \"LOGINV\",\n  292: \"NEGBINOMDIST\",\n  293: \"NORMDIST\",\n  294: \"NORMSDIST\",\n  295: \"NORMINV\",\n  296: \"NORMSINV\",\n  297: \"STANDARDIZE\",\n  298: \"ODD\",\n  299: \"PERMUT\",\n  300: \"POISSON\",\n  301: \"TDIST\",\n  302: \"WEIBULL\",\n  303: \"SUMXMY2\",\n  304: \"SUMX2MY2\",\n  305: \"SUMX2PY2\",\n  306: \"CHITEST\",\n  307: \"CORREL\",\n  308: \"COVAR\",\n  309: \"FORECAST\",\n  310: \"FTEST\",\n  311: \"INTERCEPT\",\n  312: \"PEARSON\",\n  313: \"RSQ\",\n  314: \"STEYX\",\n  315: \"SLOPE\",\n  316: \"TTEST\",\n  317: \"PROB\",\n  318: \"DEVSQ\",\n  319: \"GEOMEAN\",\n  320: \"HARMEAN\",\n  321: \"SUMSQ\",\n  322: \"KURT\",\n  323: \"SKEW\",\n  324: \"ZTEST\",\n  325: \"LARGE\",\n  326: \"SMALL\",\n  327: \"QUARTILE\",\n  328: \"PERCENTILE\",\n  329: \"PERCENTRANK\",\n  330: \"MODE\",\n  331: \"TRIMMEAN\",\n  332: \"TINV\",\n  334: \"MOVIE.COMMAND\",\n  335: \"GET.MOVIE\",\n  336: \"CONCATENATE\",\n  337: \"POWER\",\n  338: \"PIVOT.ADD.DATA\",\n  339: \"GET.PIVOT.TABLE\",\n  340: \"GET.PIVOT.FIELD\",\n  341: \"GET.PIVOT.ITEM\",\n  342: \"RADIANS\",\n  343: \"DEGREES\",\n  344: \"SUBTOTAL\",\n  345: \"SUMIF\",\n  346: \"COUNTIF\",\n  347: \"COUNTBLANK\",\n  348: \"SCENARIO.GET\",\n  349: \"OPTIONS.LISTS.GET\",\n  350: \"ISPMT\",\n  351: \"DATEDIF\",\n  352: \"DATESTRING\",\n  353: \"NUMBERSTRING\",\n  354: \"ROMAN\",\n  355: \"OPEN.DIALOG\",\n  356: \"SAVE.DIALOG\",\n  357: \"VIEW.GET\",\n  358: \"GETPIVOTDATA\",\n  359: \"HYPERLINK\",\n  360: \"PHONETIC\",\n  361: \"AVERAGEA\",\n  362: \"MAXA\",\n  363: \"MINA\",\n  364: \"STDEVPA\",\n  365: \"VARPA\",\n  366: \"STDEVA\",\n  367: \"VARA\",\n  368: \"BAHTTEXT\",\n  369: \"THAIDAYOFWEEK\",\n  370: \"THAIDIGIT\",\n  371: \"THAIMONTHOFYEAR\",\n  372: \"THAINUMSOUND\",\n  373: \"THAINUMSTRING\",\n  374: \"THAISTRINGLENGTH\",\n  375: \"ISTHAIDIGIT\",\n  376: \"ROUNDBAHTDOWN\",\n  377: \"ROUNDBAHTUP\",\n  378: \"THAIYEAR\",\n  379: \"RTD\",\n  380: \"CUBEVALUE\",\n  381: \"CUBEMEMBER\",\n  382: \"CUBEMEMBERPROPERTY\",\n  383: \"CUBERANKEDMEMBER\",\n  384: \"HEX2BIN\",\n  385: \"HEX2DEC\",\n  386: \"HEX2OCT\",\n  387: \"DEC2BIN\",\n  388: \"DEC2HEX\",\n  389: \"DEC2OCT\",\n  390: \"OCT2BIN\",\n  391: \"OCT2HEX\",\n  392: \"OCT2DEC\",\n  393: \"BIN2DEC\",\n  394: \"BIN2OCT\",\n  395: \"BIN2HEX\",\n  396: \"IMSUB\",\n  397: \"IMDIV\",\n  398: \"IMPOWER\",\n  399: \"IMABS\",\n  400: \"IMSQRT\",\n  401: \"IMLN\",\n  402: \"IMLOG2\",\n  403: \"IMLOG10\",\n  404: \"IMSIN\",\n  405: \"IMCOS\",\n  406: \"IMEXP\",\n  407: \"IMARGUMENT\",\n  408: \"IMCONJUGATE\",\n  409: \"IMAGINARY\",\n  410: \"IMREAL\",\n  411: \"COMPLEX\",\n  412: \"IMSUM\",\n  413: \"IMPRODUCT\",\n  414: \"SERIESSUM\",\n  415: \"FACTDOUBLE\",\n  416: \"SQRTPI\",\n  417: \"QUOTIENT\",\n  418: \"DELTA\",\n  419: \"GESTEP\",\n  420: \"ISEVEN\",\n  421: \"ISODD\",\n  422: \"MROUND\",\n  423: \"ERF\",\n  424: \"ERFC\",\n  425: \"BESSELJ\",\n  426: \"BESSELK\",\n  427: \"BESSELY\",\n  428: \"BESSELI\",\n  429: \"XIRR\",\n  430: \"XNPV\",\n  431: \"PRICEMAT\",\n  432: \"YIELDMAT\",\n  433: \"INTRATE\",\n  434: \"RECEIVED\",\n  435: \"DISC\",\n  436: \"PRICEDISC\",\n  437: \"YIELDDISC\",\n  438: \"TBILLEQ\",\n  439: \"TBILLPRICE\",\n  440: \"TBILLYIELD\",\n  441: \"PRICE\",\n  442: \"YIELD\",\n  443: \"DOLLARDE\",\n  444: \"DOLLARFR\",\n  445: \"NOMINAL\",\n  446: \"EFFECT\",\n  447: \"CUMPRINC\",\n  448: \"CUMIPMT\",\n  449: \"EDATE\",\n  450: \"EOMONTH\",\n  451: \"YEARFRAC\",\n  452: \"COUPDAYBS\",\n  453: \"COUPDAYS\",\n  454: \"COUPDAYSNC\",\n  455: \"COUPNCD\",\n  456: \"COUPNUM\",\n  457: \"COUPPCD\",\n  458: \"DURATION\",\n  459: \"MDURATION\",\n  460: \"ODDLPRICE\",\n  461: \"ODDLYIELD\",\n  462: \"ODDFPRICE\",\n  463: \"ODDFYIELD\",\n  464: \"RANDBETWEEN\",\n  465: \"WEEKNUM\",\n  466: \"AMORDEGRC\",\n  467: \"AMORLINC\",\n  468: \"CONVERT\",\n  724: \"SHEETJS\",\n  469: \"ACCRINT\",\n  470: \"ACCRINTM\",\n  471: \"WORKDAY\",\n  472: \"NETWORKDAYS\",\n  473: \"GCD\",\n  474: \"MULTINOMIAL\",\n  475: \"LCM\",\n  476: \"FVSCHEDULE\",\n  477: \"CUBEKPIMEMBER\",\n  478: \"CUBESET\",\n  479: \"CUBESETCOUNT\",\n  480: \"IFERROR\",\n  481: \"COUNTIFS\",\n  482: \"SUMIFS\",\n  483: \"AVERAGEIF\",\n  484: \"AVERAGEIFS\"\n};\nvar FtabArgc = {\n  2: 1,\n  3: 1,\n  10: 0,\n  15: 1,\n  16: 1,\n  17: 1,\n  18: 1,\n  19: 0,\n  20: 1,\n  21: 1,\n  22: 1,\n  23: 1,\n  24: 1,\n  25: 1,\n  26: 1,\n  27: 2,\n  30: 2,\n  31: 3,\n  32: 1,\n  33: 1,\n  34: 0,\n  35: 0,\n  38: 1,\n  39: 2,\n  40: 3,\n  41: 3,\n  42: 3,\n  43: 3,\n  44: 3,\n  45: 3,\n  47: 3,\n  48: 2,\n  53: 1,\n  61: 3,\n  63: 0,\n  65: 3,\n  66: 3,\n  67: 1,\n  68: 1,\n  69: 1,\n  70: 1,\n  71: 1,\n  72: 1,\n  73: 1,\n  74: 0,\n  75: 1,\n  76: 1,\n  77: 1,\n  79: 2,\n  80: 2,\n  83: 1,\n  85: 0,\n  86: 1,\n  89: 0,\n  90: 1,\n  94: 0,\n  95: 0,\n  97: 2,\n  98: 1,\n  99: 1,\n  101: 3,\n  102: 3,\n  105: 1,\n  106: 1,\n  108: 2,\n  111: 1,\n  112: 1,\n  113: 1,\n  114: 1,\n  117: 2,\n  118: 1,\n  119: 4,\n  121: 1,\n  126: 1,\n  127: 1,\n  128: 1,\n  129: 1,\n  130: 1,\n  131: 1,\n  133: 1,\n  134: 1,\n  135: 1,\n  136: 2,\n  137: 2,\n  138: 2,\n  140: 1,\n  141: 1,\n  142: 3,\n  143: 4,\n  144: 4,\n  161: 1,\n  162: 1,\n  163: 1,\n  164: 1,\n  165: 2,\n  172: 1,\n  175: 2,\n  176: 2,\n  177: 3,\n  178: 2,\n  179: 1,\n  184: 1,\n  186: 1,\n  189: 3,\n  190: 1,\n  195: 3,\n  196: 3,\n  197: 1,\n  198: 1,\n  199: 3,\n  201: 1,\n  207: 4,\n  210: 3,\n  211: 1,\n  212: 2,\n  213: 2,\n  214: 1,\n  215: 1,\n  225: 0,\n  229: 1,\n  230: 1,\n  231: 1,\n  232: 1,\n  233: 1,\n  234: 1,\n  235: 3,\n  244: 1,\n  247: 4,\n  252: 2,\n  257: 1,\n  261: 1,\n  271: 1,\n  273: 4,\n  274: 2,\n  275: 2,\n  276: 2,\n  277: 3,\n  278: 3,\n  279: 1,\n  280: 3,\n  281: 3,\n  282: 3,\n  283: 1,\n  284: 1,\n  285: 2,\n  286: 4,\n  287: 3,\n  288: 2,\n  289: 4,\n  290: 3,\n  291: 3,\n  292: 3,\n  293: 4,\n  294: 1,\n  295: 3,\n  296: 1,\n  297: 3,\n  298: 1,\n  299: 2,\n  300: 3,\n  301: 3,\n  302: 4,\n  303: 2,\n  304: 2,\n  305: 2,\n  306: 2,\n  307: 2,\n  308: 2,\n  309: 3,\n  310: 2,\n  311: 2,\n  312: 2,\n  313: 2,\n  314: 2,\n  315: 2,\n  316: 4,\n  325: 2,\n  326: 2,\n  327: 2,\n  328: 2,\n  331: 2,\n  332: 2,\n  337: 2,\n  342: 1,\n  343: 1,\n  346: 2,\n  347: 1,\n  350: 4,\n  351: 3,\n  352: 1,\n  353: 2,\n  360: 1,\n  368: 1,\n  369: 1,\n  370: 1,\n  371: 1,\n  372: 1,\n  373: 1,\n  374: 1,\n  375: 1,\n  376: 1,\n  377: 1,\n  378: 1,\n  382: 3,\n  385: 1,\n  392: 1,\n  393: 1,\n  396: 2,\n  397: 2,\n  398: 2,\n  399: 1,\n  400: 1,\n  401: 1,\n  402: 1,\n  403: 1,\n  404: 1,\n  405: 1,\n  406: 1,\n  407: 1,\n  408: 1,\n  409: 1,\n  410: 1,\n  414: 4,\n  415: 1,\n  416: 1,\n  417: 2,\n  420: 1,\n  421: 1,\n  422: 2,\n  424: 1,\n  425: 2,\n  426: 2,\n  427: 2,\n  428: 2,\n  430: 3,\n  438: 3,\n  439: 3,\n  440: 3,\n  443: 2,\n  444: 2,\n  445: 2,\n  446: 2,\n  447: 6,\n  448: 6,\n  449: 2,\n  450: 2,\n  464: 2,\n  468: 3,\n  476: 2,\n  479: 1,\n  480: 2,\n  65535: 0\n};\n/* Part 3 TODO: actually parse formulae */\n\nfunction ods_to_csf_formula(f\n/*:string*/\n)\n/*:string*/\n{\n  if (f.slice(0, 3) == \"of:\") f = f.slice(3);\n  /* 5.2 Basic Expressions */\n\n  if (f.charCodeAt(0) == 61) {\n    f = f.slice(1);\n    if (f.charCodeAt(0) == 61) f = f.slice(1);\n  }\n\n  f = f.replace(/COM\\.MICROSOFT\\./g, \"\");\n  /* Part 3 Section 5.8 References */\n\n  f = f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, function ($$, $1) {\n    return $1.replace(/\\./g, \"\");\n  });\n  /* TODO: something other than this */\n\n  f = f.replace(/\\[.(#[A-Z]*[?!])\\]/g, \"$1\");\n  return f.replace(/[;~]/g, \",\").replace(/\\|/g, \";\");\n}\n\nfunction csf_to_ods_formula(f\n/*:string*/\n)\n/*:string*/\n{\n  var o = \"of:=\" + f.replace(crefregex, \"$1[.$2$3$4$5]\").replace(/\\]:\\[/g, \":\");\n  /* TODO: something other than this */\n\n  return o.replace(/;/g, \"|\").replace(/,/g, \";\");\n}\n\nfunction ods_to_csf_3D(r\n/*:string*/\n)\n/*:[string, string]*/\n{\n  var a = r.split(\":\");\n  var s = a[0].split(\".\")[0];\n  return [s, a[0].split(\".\")[1] + (a.length > 1 ? \":\" + (a[1].split(\".\")[1] || a[1].split(\".\")[0]) : \"\")];\n}\n\nfunction csf_to_ods_3D(r\n/*:string*/\n)\n/*:string*/\n{\n  return r.replace(/\\./, \"!\");\n}\n\nvar strs = {}; // shared strings\n\nvar _ssfopts = {}; // spreadsheet formatting options\n\n/*global Map */\n\nvar browser_has_Map = typeof Map !== 'undefined';\n\nfunction get_sst_id(sst\n/*:SST*/\n, str\n/*:string*/\n, rev)\n/*:number*/\n{\n  var i = 0,\n      len = sst.length;\n\n  if (rev) {\n    if (browser_has_Map ? rev.has(str) : Object.prototype.hasOwnProperty.call(rev, str)) {\n      var revarr = browser_has_Map ? rev.get(str) : rev[str];\n\n      for (; i < revarr.length; ++i) {\n        if (sst[revarr[i]].t === str) {\n          sst.Count++;\n          return revarr[i];\n        }\n      }\n    }\n  } else for (; i < len; ++i) {\n    if (sst[i].t === str) {\n      sst.Count++;\n      return i;\n    }\n  }\n\n  sst[len] = {\n    t: str\n  }\n  /*:any*/\n  ;\n  sst.Count++;\n  sst.Unique++;\n\n  if (rev) {\n    if (browser_has_Map) {\n      if (!rev.has(str)) rev.set(str, []);\n      rev.get(str).push(len);\n    } else {\n      if (!Object.prototype.hasOwnProperty.call(rev, str)) rev[str] = [];\n      rev[str].push(len);\n    }\n  }\n\n  return len;\n}\n\nfunction col_obj_w(C\n/*:number*/\n, col) {\n  var p = {\n    min: C + 1,\n    max: C + 1\n  }\n  /*:any*/\n  ;\n  /* wch (chars), wpx (pixels) */\n\n  var wch = -1;\n  if (col.MDW) MDW = col.MDW;\n  if (col.width != null) p.customWidth = 1;else if (col.wpx != null) wch = px2char(col.wpx);else if (col.wch != null) wch = col.wch;\n\n  if (wch > -1) {\n    p.width = char2width(wch);\n    p.customWidth = 1;\n  } else if (col.width != null) p.width = col.width;\n\n  if (col.hidden) p.hidden = true;\n\n  if (col.level != null) {\n    p.outlineLevel = p.level = col.level;\n  }\n\n  return p;\n}\n\nfunction default_margins(margins\n/*:Margins*/\n, mode\n/*:?string*/\n) {\n  if (!margins) return;\n  var defs = [0.7, 0.7, 0.75, 0.75, 0.3, 0.3];\n  if (mode == 'xlml') defs = [1, 1, 1, 1, 0.5, 0.5];\n  if (margins.left == null) margins.left = defs[0];\n  if (margins.right == null) margins.right = defs[1];\n  if (margins.top == null) margins.top = defs[2];\n  if (margins.bottom == null) margins.bottom = defs[3];\n  if (margins.header == null) margins.header = defs[4];\n  if (margins.footer == null) margins.footer = defs[5];\n}\n\nfunction get_cell_style(styles\n/*:Array<any>*/\n, cell\n/*:Cell*/\n, opts) {\n  var z = opts.revssf[cell.z != null ? cell.z : \"General\"];\n  var i = 0x3c,\n      len = styles.length;\n\n  if (z == null && opts.ssf) {\n    for (; i < 0x188; ++i) if (opts.ssf[i] == null) {\n      SSF_load(cell.z, i); // $FlowIgnore\n\n      opts.ssf[i] = cell.z;\n      opts.revssf[cell.z] = z = i;\n      break;\n    }\n  }\n\n  for (i = 0; i != len; ++i) if (styles[i].numFmtId === z) return i;\n\n  styles[len] = {\n    numFmtId: z,\n    fontId: 0,\n    fillId: 0,\n    borderId: 0,\n    xfId: 0,\n    applyNumberFormat: 1\n  };\n  return len;\n}\n\nfunction safe_format(p\n/*:Cell*/\n, fmtid\n/*:number*/\n, fillid\n/*:?number*/\n, opts, themes, styles) {\n  try {\n    if (opts.cellNF) p.z = table_fmt[fmtid];\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n\n  if (p.t === 'z' && !opts.cellStyles) return;\n  if (p.t === 'd' && typeof p.v === 'string') p.v = parseDate(p.v);\n  if ((!opts || opts.cellText !== false) && p.t !== 'z') try {\n    if (table_fmt[fmtid] == null) SSF_load(SSFImplicit[fmtid] || \"General\", fmtid);\n    if (p.t === 'e') p.w = p.w || BErr[p.v];else if (fmtid === 0) {\n      if (p.t === 'n') {\n        if ((p.v | 0) === p.v) p.w = p.v.toString(10);else p.w = SSF_general_num(p.v);\n      } else if (p.t === 'd') {\n        var dd = datenum(p.v);\n        if ((dd | 0) === dd) p.w = dd.toString(10);else p.w = SSF_general_num(dd);\n      } else if (p.v === undefined) return \"\";else p.w = SSF_general(p.v, _ssfopts);\n    } else if (p.t === 'd') p.w = SSF_format(fmtid, datenum(p.v), _ssfopts);else p.w = SSF_format(fmtid, p.v, _ssfopts);\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n  if (!opts.cellStyles) return;\n  if (fillid != null) try {\n    p.s = styles.Fills[fillid];\n\n    if (p.s.fgColor && p.s.fgColor.theme && !p.s.fgColor.rgb) {\n      p.s.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.fgColor.theme].rgb, p.s.fgColor.tint || 0);\n      if (opts.WTF) p.s.fgColor.raw_rgb = themes.themeElements.clrScheme[p.s.fgColor.theme].rgb;\n    }\n\n    if (p.s.bgColor && p.s.bgColor.theme) {\n      p.s.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.bgColor.theme].rgb, p.s.bgColor.tint || 0);\n      if (opts.WTF) p.s.bgColor.raw_rgb = themes.themeElements.clrScheme[p.s.bgColor.theme].rgb;\n    }\n  } catch (e) {\n    if (opts.WTF && styles.Fills) throw e;\n  }\n}\n\nfunction check_ws(ws\n/*:Worksheet*/\n, sname\n/*:string*/\n, i\n/*:number*/\n) {\n  if (ws && ws['!ref']) {\n    var range = safe_decode_range(ws['!ref']);\n    if (range.e.c < range.s.c || range.e.r < range.s.r) throw new Error(\"Bad range (\" + i + \"): \" + ws['!ref']);\n  }\n}\n\nfunction parse_ws_xml_dim(ws\n/*:Worksheet*/\n, s\n/*:string*/\n) {\n  var d = safe_decode_range(s);\n  if (d.s.r <= d.e.r && d.s.c <= d.e.c && d.s.r >= 0 && d.s.c >= 0) ws[\"!ref\"] = encode_range(d);\n}\n\nvar mergecregex = /<(?:\\w:)?mergeCell ref=\"[A-Z0-9:]+\"\\s*[\\/]?>/g;\nvar sheetdataregex = /<(?:\\w+:)?sheetData[^>]*>([\\s\\S]*)<\\/(?:\\w+:)?sheetData>/;\nvar hlinkregex = /<(?:\\w:)?hyperlink [^>]*>/mg;\nvar dimregex = /\"(\\w*:\\w*)\"/;\nvar colregex = /<(?:\\w:)?col\\b[^>]*[\\/]?>/g;\nvar afregex = /<(?:\\w:)?autoFilter[^>]*([\\/]|>([\\s\\S]*)<\\/(?:\\w:)?autoFilter)>/g;\nvar marginregex = /<(?:\\w:)?pageMargins[^>]*\\/>/g;\nvar sheetprregex = /<(?:\\w:)?sheetPr\\b(?:[^>a-z][^>]*)?\\/>/;\nvar sheetprregex2 = /<(?:\\w:)?sheetPr[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetPr)>/;\nvar svsregex = /<(?:\\w:)?sheetViews[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetViews)>/;\n/* 18.3 Worksheets */\n\nfunction parse_ws_xml(data\n/*:?string*/\n, opts, idx\n/*:number*/\n, rels, wb\n/*:WBWBProps*/\n, themes, styles)\n/*:Worksheet*/\n{\n  if (!data) return data;\n  if (!rels) rels = {\n    '!id': {}\n  };\n  if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n  /* 18.3.1.99 worksheet CT_Worksheet */\n\n  var s = opts.dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  ;\n  var refguess\n  /*:Range*/\n  = {\n    s: {\n      r: 2000000,\n      c: 2000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  }\n  /*:any*/\n  ;\n  var data1 = \"\",\n      data2 = \"\";\n  var mtch\n  /*:?any*/\n  = data.match(sheetdataregex);\n\n  if (mtch) {\n    data1 = data.slice(0, mtch.index);\n    data2 = data.slice(mtch.index + mtch[0].length);\n  } else data1 = data2 = data;\n  /* 18.3.1.82 sheetPr CT_SheetPr */\n\n\n  var sheetPr = data1.match(sheetprregex);\n  if (sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);else if (sheetPr = data1.match(sheetprregex2)) parse_ws_xml_sheetpr2(sheetPr[0], sheetPr[1] || \"\", s, wb, idx, styles, themes);\n  /* 18.3.1.35 dimension CT_SheetDimension */\n\n  var ridx = (data1.match(/<(?:\\w*:)?dimension/) || {\n    index: -1\n  }).index;\n\n  if (ridx > 0) {\n    var ref = data1.slice(ridx, ridx + 50).match(dimregex);\n    if (ref) parse_ws_xml_dim(s, ref[1]);\n  }\n  /* 18.3.1.88 sheetViews CT_SheetViews */\n\n\n  var svs = data1.match(svsregex);\n  if (svs && svs[1]) parse_ws_xml_sheetviews(svs[1], wb);\n  /* 18.3.1.17 cols CT_Cols */\n\n  var columns\n  /*:Array<ColInfo>*/\n  = [];\n\n  if (opts.cellStyles) {\n    /* 18.3.1.13 col CT_Col */\n    var cols = data1.match(colregex);\n    if (cols) parse_ws_xml_cols(columns, cols);\n  }\n  /* 18.3.1.80 sheetData CT_SheetData ? */\n\n\n  if (mtch) parse_ws_xml_data(mtch[1], s, opts, refguess, themes, styles);\n  /* 18.3.1.2  autoFilter CT_AutoFilter */\n\n  var afilter = data2.match(afregex);\n  if (afilter) s['!autofilter'] = parse_ws_xml_autofilter(afilter[0]);\n  /* 18.3.1.55 mergeCells CT_MergeCells */\n\n  var merges\n  /*:Array<Range>*/\n  = [];\n\n  var _merge = data2.match(mergecregex);\n\n  if (_merge) for (ridx = 0; ridx != _merge.length; ++ridx) merges[ridx] = safe_decode_range(_merge[ridx].slice(_merge[ridx].indexOf(\"\\\"\") + 1));\n  /* 18.3.1.48 hyperlinks CT_Hyperlinks */\n\n  var hlink = data2.match(hlinkregex);\n  if (hlink) parse_ws_xml_hlinks(s, hlink, rels);\n  /* 18.3.1.62 pageMargins CT_PageMargins */\n\n  var margins = data2.match(marginregex);\n  if (margins) s['!margins'] = parse_ws_xml_margins(parsexmltag(margins[0]));\n  if (!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n\n  if (opts.sheetRows > 0 && s[\"!ref\"]) {\n    var tmpref = safe_decode_range(s[\"!ref\"]);\n\n    if (opts.sheetRows <= +tmpref.e.r) {\n      tmpref.e.r = opts.sheetRows - 1;\n      if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n      if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n      if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n      if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n      s[\"!fullref\"] = s[\"!ref\"];\n      s[\"!ref\"] = encode_range(tmpref);\n    }\n  }\n\n  if (columns.length > 0) s[\"!cols\"] = columns;\n  if (merges.length > 0) s[\"!merges\"] = merges;\n  return s;\n}\n\nfunction write_ws_xml_merges(merges\n/*:Array<Range>*/\n)\n/*:string*/\n{\n  if (merges.length === 0) return \"\";\n  var o = '<mergeCells count=\"' + merges.length + '\">';\n\n  for (var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\n\n  return o + '</mergeCells>';\n}\n/* 18.3.1.82-3 sheetPr CT_ChartsheetPr / CT_SheetPr */\n\n\nfunction parse_ws_xml_sheetpr(sheetPr\n/*:string*/\n, s, wb\n/*:WBWBProps*/\n, idx\n/*:number*/\n) {\n  var data = parsexmltag(sheetPr);\n  if (!wb.Sheets[idx]) wb.Sheets[idx] = {};\n  if (data.codeName) wb.Sheets[idx].CodeName = unescapexml(utf8read(data.codeName));\n}\n\nfunction parse_ws_xml_sheetpr2(sheetPr\n/*:string*/\n, body\n/*:string*/\n, s, wb\n/*:WBWBProps*/\n, idx\n/*:number*/\n) {\n  parse_ws_xml_sheetpr(sheetPr.slice(0, sheetPr.indexOf(\">\")), s, wb, idx);\n}\n\nfunction write_ws_xml_sheetpr(ws, wb, idx, opts, o) {\n  var needed = false;\n  var props = {},\n      payload = null;\n\n  if (opts.bookType !== 'xlsx' && wb.vbaraw) {\n    var cname = wb.SheetNames[idx];\n\n    try {\n      if (wb.Workbook) cname = wb.Workbook.Sheets[idx].CodeName || cname;\n    } catch (e) {}\n\n    needed = true;\n    props.codeName = utf8write(escapexml(cname));\n  }\n\n  if (ws && ws[\"!outline\"]) {\n    var outlineprops = {\n      summaryBelow: 1,\n      summaryRight: 1\n    };\n    if (ws[\"!outline\"].above) outlineprops.summaryBelow = 0;\n    if (ws[\"!outline\"].left) outlineprops.summaryRight = 0;\n    payload = (payload || \"\") + writextag('outlinePr', null, outlineprops);\n  }\n\n  if (!needed && !payload) return;\n  o[o.length] = writextag('sheetPr', payload, props);\n}\n/* 18.3.1.85 sheetProtection CT_SheetProtection */\n\n\nvar sheetprot_deffalse = [\"objects\", \"scenarios\", \"selectLockedCells\", \"selectUnlockedCells\"];\nvar sheetprot_deftrue = [\"formatColumns\", \"formatRows\", \"formatCells\", \"insertColumns\", \"insertRows\", \"insertHyperlinks\", \"deleteColumns\", \"deleteRows\", \"sort\", \"autoFilter\", \"pivotTables\"];\n\nfunction write_ws_xml_protection(sp)\n/*:string*/\n{\n  // algorithmName, hashValue, saltValue, spinCount\n  var o = {\n    sheet: 1\n  }\n  /*:any*/\n  ;\n  sheetprot_deffalse.forEach(function (n) {\n    if (sp[n] != null && sp[n]) o[n] = \"1\";\n  });\n  sheetprot_deftrue.forEach(function (n) {\n    if (sp[n] != null && !sp[n]) o[n] = \"0\";\n  });\n  /* TODO: algorithm */\n\n  if (sp.password) o.password = crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase();\n  return writextag('sheetProtection', null, o);\n}\n\nfunction parse_ws_xml_hlinks(s, data\n/*:Array<string>*/\n, rels) {\n  var dense = Array.isArray(s);\n\n  for (var i = 0; i != data.length; ++i) {\n    var val = parsexmltag(utf8read(data[i]), true);\n    if (!val.ref) return;\n    var rel = ((rels || {})['!id'] || [])[val.id];\n\n    if (rel) {\n      val.Target = rel.Target;\n      if (val.location) val.Target += \"#\" + unescapexml(val.location);\n    } else {\n      val.Target = \"#\" + unescapexml(val.location);\n      rel = {\n        Target: val.Target,\n        TargetMode: 'Internal'\n      };\n    }\n\n    val.Rel = rel;\n\n    if (val.tooltip) {\n      val.Tooltip = val.tooltip;\n      delete val.tooltip;\n    }\n\n    var rng = safe_decode_range(val.ref);\n\n    for (var R = rng.s.r; R <= rng.e.r; ++R) for (var C = rng.s.c; C <= rng.e.c; ++C) {\n      var addr = encode_cell({\n        c: C,\n        r: R\n      });\n\n      if (dense) {\n        if (!s[R]) s[R] = [];\n        if (!s[R][C]) s[R][C] = {\n          t: \"z\",\n          v: undefined\n        };\n        s[R][C].l = val;\n      } else {\n        if (!s[addr]) s[addr] = {\n          t: \"z\",\n          v: undefined\n        };\n        s[addr].l = val;\n      }\n    }\n  }\n}\n\nfunction parse_ws_xml_margins(margin) {\n  var o = {};\n  [\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"].forEach(function (k) {\n    if (margin[k]) o[k] = parseFloat(margin[k]);\n  });\n  return o;\n}\n\nfunction write_ws_xml_margins(margin)\n/*:string*/\n{\n  default_margins(margin);\n  return writextag('pageMargins', null, margin);\n}\n\nfunction parse_ws_xml_cols(columns, cols) {\n  var seencol = false;\n\n  for (var coli = 0; coli != cols.length; ++coli) {\n    var coll = parsexmltag(cols[coli], true);\n    if (coll.hidden) coll.hidden = parsexmlbool(coll.hidden);\n    var colm = parseInt(coll.min, 10) - 1,\n        colM = parseInt(coll.max, 10) - 1;\n    if (coll.outlineLevel) coll.level = +coll.outlineLevel || 0;\n    delete coll.min;\n    delete coll.max;\n    coll.width = +coll.width;\n\n    if (!seencol && coll.width) {\n      seencol = true;\n      find_mdw_colw(coll.width);\n    }\n\n    process_col(coll);\n\n    while (colm <= colM) columns[colm++] = dup(coll);\n  }\n}\n\nfunction write_ws_xml_cols(ws, cols)\n/*:string*/\n{\n  var o = [\"<cols>\"],\n      col;\n\n  for (var i = 0; i != cols.length; ++i) {\n    if (!(col = cols[i])) continue;\n    o[o.length] = writextag('col', null, col_obj_w(i, col));\n  }\n\n  o[o.length] = \"</cols>\";\n  return o.join(\"\");\n}\n\nfunction parse_ws_xml_autofilter(data\n/*:string*/\n) {\n  var o = {\n    ref: (data.match(/ref=\"([^\"]*)\"/) || [])[1]\n  };\n  return o;\n}\n\nfunction write_ws_xml_autofilter(data, ws, wb, idx)\n/*:string*/\n{\n  var ref = typeof data.ref == \"string\" ? data.ref : encode_range(data.ref);\n  if (!wb.Workbook) wb.Workbook = {\n    Sheets: []\n  }\n  /*:any*/\n  ;\n  if (!wb.Workbook.Names) wb.Workbook.Names = [];\n  var names\n  /*: Array<any> */\n  = wb.Workbook.Names;\n  var range = decode_range(ref);\n\n  if (range.s.r == range.e.r) {\n    range.e.r = decode_range(ws[\"!ref\"]).e.r;\n    ref = encode_range(range);\n  }\n\n  for (var i = 0; i < names.length; ++i) {\n    var name = names[i];\n    if (name.Name != '_xlnm._FilterDatabase') continue;\n    if (name.Sheet != idx) continue;\n    name.Ref = \"'\" + wb.SheetNames[idx] + \"'!\" + ref;\n    break;\n  }\n\n  if (i == names.length) names.push({\n    Name: '_xlnm._FilterDatabase',\n    Sheet: idx,\n    Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref\n  });\n  return writextag(\"autoFilter\", null, {\n    ref: ref\n  });\n}\n/* 18.3.1.88 sheetViews CT_SheetViews */\n\n/* 18.3.1.87 sheetView CT_SheetView */\n\n\nvar sviewregex = /<(?:\\w:)?sheetView(?:[^>a-z][^>]*)?\\/?>/;\n\nfunction parse_ws_xml_sheetviews(data, wb\n/*:WBWBProps*/\n) {\n  if (!wb.Views) wb.Views = [{}];\n  (data.match(sviewregex) || []).forEach(function (r\n  /*:string*/\n  , i\n  /*:number*/\n  ) {\n    var tag = parsexmltag(r); // $FlowIgnore\n\n    if (!wb.Views[i]) wb.Views[i] = {}; // $FlowIgnore\n\n    if (+tag.zoomScale) wb.Views[i].zoom = +tag.zoomScale; // $FlowIgnore\n\n    if (parsexmlbool(tag.rightToLeft)) wb.Views[i].RTL = true;\n  });\n}\n\nfunction write_ws_xml_sheetviews(ws, opts, idx, wb)\n/*:string*/\n{\n  var sview = {\n    workbookViewId: \"0\"\n  }\n  /*:any*/\n  ; // $FlowIgnore\n\n  if ((((wb || {}).Workbook || {}).Views || [])[0]) sview.rightToLeft = wb.Workbook.Views[0].RTL ? \"1\" : \"0\";\n  return writextag(\"sheetViews\", writextag(\"sheetView\", null, sview), {});\n}\n\nfunction write_ws_xml_cell(cell\n/*:Cell*/\n, ref, ws, opts\n/*::, idx, wb*/\n)\n/*:string*/\n{\n  if (cell.c) ws['!comments'].push([ref, cell.c]);\n  if (cell.v === undefined && typeof cell.f !== \"string\" || cell.t === 'z' && !cell.f) return \"\";\n  var vv = \"\";\n  var oldt = cell.t,\n      oldv = cell.v;\n  if (cell.t !== \"z\") switch (cell.t) {\n    case 'b':\n      vv = cell.v ? \"1\" : \"0\";\n      break;\n\n    case 'n':\n      vv = '' + cell.v;\n      break;\n\n    case 'e':\n      vv = BErr[cell.v];\n      break;\n\n    case 'd':\n      if (opts && opts.cellDates) vv = parseDate(cell.v, -1).toISOString();else {\n        cell = dup(cell);\n        cell.t = 'n';\n        vv = '' + (cell.v = datenum(parseDate(cell.v)));\n      }\n      if (typeof cell.z === 'undefined') cell.z = table_fmt[14];\n      break;\n\n    default:\n      vv = cell.v;\n      break;\n  }\n  var v = writetag('v', escapexml(vv)),\n      o = {\n    r: ref\n  }\n  /*:any*/\n  ;\n  /* TODO: cell style */\n\n  var os = get_cell_style(opts.cellXfs, cell, opts);\n  if (os !== 0) o.s = os;\n\n  switch (cell.t) {\n    case 'n':\n      break;\n\n    case 'd':\n      o.t = \"d\";\n      break;\n\n    case 'b':\n      o.t = \"b\";\n      break;\n\n    case 'e':\n      o.t = \"e\";\n      break;\n\n    case 'z':\n      break;\n\n    default:\n      if (cell.v == null) {\n        delete cell.t;\n        break;\n      }\n\n      if (cell.v.length > 32767) throw new Error(\"Text length must not exceed 32767 characters\");\n\n      if (opts && opts.bookSST) {\n        v = writetag('v', '' + get_sst_id(opts.Strings, cell.v, opts.revStrings));\n        o.t = \"s\";\n        break;\n      }\n\n      o.t = \"str\";\n      break;\n  }\n\n  if (cell.t != oldt) {\n    cell.t = oldt;\n    cell.v = oldv;\n  }\n\n  if (typeof cell.f == \"string\" && cell.f) {\n    var ff = cell.F && cell.F.slice(0, ref.length) == ref ? {\n      t: \"array\",\n      ref: cell.F\n    } : null;\n    v = writextag('f', escapexml(cell.f), ff) + (cell.v != null ? v : \"\");\n  }\n\n  if (cell.l) ws['!links'].push([ref, cell.l]);\n  if (cell.D) o.cm = 1;\n  return writextag('c', v, o);\n}\n\nvar parse_ws_xml_data = /*#__PURE__*/function () {\n  var cellregex = /<(?:\\w+:)?c[ \\/>]/,\n      rowregex = /<\\/(?:\\w+:)?row>/;\n  var rregex = /r=[\"']([^\"']*)[\"']/,\n      isregex = /<(?:\\w+:)?is>([\\S\\s]*?)<\\/(?:\\w+:)?is>/;\n  var refregex = /ref=[\"']([^\"']*)[\"']/;\n  var match_v = matchtag(\"v\"),\n      match_f = matchtag(\"f\");\n  return function parse_ws_xml_data(sdata\n  /*:string*/\n  , s, opts, guess\n  /*:Range*/\n  , themes, styles) {\n    var ri = 0,\n        x = \"\",\n        cells\n    /*:Array<string>*/\n    = [],\n        cref\n    /*:?Array<string>*/\n    = [],\n        idx = 0,\n        i = 0,\n        cc = 0,\n        d = \"\",\n        p\n    /*:any*/\n    ;\n    var tag,\n        tagr = 0,\n        tagc = 0;\n    var sstr, ftag;\n    var fmtid = 0,\n        fillid = 0;\n    var do_format = Array.isArray(styles.CellXf),\n        cf;\n    var arrayf\n    /*:Array<[Range, string]>*/\n    = [];\n    var sharedf = [];\n    var dense = Array.isArray(s);\n    var rows\n    /*:Array<RowInfo>*/\n    = [],\n        rowobj = {},\n        rowrite = false;\n    var sheetStubs = !!opts.sheetStubs;\n\n    for (var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n      x = marr[mt].trim();\n      var xlen = x.length;\n      if (xlen === 0) continue;\n      /* 18.3.1.73 row CT_Row */\n\n      var rstarti = 0;\n\n      outa: for (ri = 0; ri < xlen; ++ri) switch (\n      /*x.charCodeAt(ri)*/\n      x[ri]) {\n        case \">\"\n        /*62*/\n        :\n          if (\n          /*x.charCodeAt(ri-1) != 47*/\n          x[ri - 1] != \"/\") {\n            ++ri;\n            break outa;\n          }\n\n          if (opts && opts.cellStyles) {\n            // TODO: avoid duplication\n            tag = parsexmltag(x.slice(rstarti, ri), true);\n            tagr = tag.r != null ? parseInt(tag.r, 10) : tagr + 1;\n            tagc = -1;\n            if (opts.sheetRows && opts.sheetRows < tagr) continue;\n            rowobj = {};\n            rowrite = false;\n\n            if (tag.ht) {\n              rowrite = true;\n              rowobj.hpt = parseFloat(tag.ht);\n              rowobj.hpx = pt2px(rowobj.hpt);\n            }\n\n            if (tag.hidden == \"1\") {\n              rowrite = true;\n              rowobj.hidden = true;\n            }\n\n            if (tag.outlineLevel != null) {\n              rowrite = true;\n              rowobj.level = +tag.outlineLevel;\n            }\n\n            if (rowrite) rows[tagr - 1] = rowobj;\n          }\n\n          break;\n\n        case \"<\"\n        /*60*/\n        :\n          rstarti = ri;\n          break;\n      }\n\n      if (rstarti >= ri) break;\n      tag = parsexmltag(x.slice(rstarti, ri), true);\n      tagr = tag.r != null ? parseInt(tag.r, 10) : tagr + 1;\n      tagc = -1;\n      if (opts.sheetRows && opts.sheetRows < tagr) continue;\n      if (guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n      if (guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n\n      if (opts && opts.cellStyles) {\n        rowobj = {};\n        rowrite = false;\n\n        if (tag.ht) {\n          rowrite = true;\n          rowobj.hpt = parseFloat(tag.ht);\n          rowobj.hpx = pt2px(rowobj.hpt);\n        }\n\n        if (tag.hidden == \"1\") {\n          rowrite = true;\n          rowobj.hidden = true;\n        }\n\n        if (tag.outlineLevel != null) {\n          rowrite = true;\n          rowobj.level = +tag.outlineLevel;\n        }\n\n        if (rowrite) rows[tagr - 1] = rowobj;\n      }\n      /* 18.3.1.4 c CT_Cell */\n\n\n      cells = x.slice(ri).split(cellregex);\n\n      for (var rslice = 0; rslice != cells.length; ++rslice) if (cells[rslice].trim().charAt(0) != \"<\") break;\n\n      cells = cells.slice(rslice);\n\n      for (ri = 0; ri != cells.length; ++ri) {\n        x = cells[ri].trim();\n        if (x.length === 0) continue;\n        cref = x.match(rregex);\n        idx = ri;\n        i = 0;\n        cc = 0;\n        x = \"<c \" + (x.slice(0, 1) == \"<\" ? \">\" : \"\") + x;\n\n        if (cref != null && cref.length === 2) {\n          idx = 0;\n          d = cref[1];\n\n          for (i = 0; i != d.length; ++i) {\n            if ((cc = d.charCodeAt(i) - 64) < 1 || cc > 26) break;\n            idx = 26 * idx + cc;\n          }\n\n          --idx;\n          tagc = idx;\n        } else ++tagc;\n\n        for (i = 0; i != x.length; ++i) if (x.charCodeAt(i) === 62) break;\n\n        ++i;\n        tag = parsexmltag(x.slice(0, i), true);\n        if (!tag.r) tag.r = encode_cell({\n          r: tagr - 1,\n          c: tagc\n        });\n        d = x.slice(i);\n        p = {\n          t: \"\"\n        }\n        /*:any*/\n        ;\n        if ((cref = d.match(match_v)) != null &&\n        /*::cref != null && */\n        cref[1] !== '') p.v = unescapexml(cref[1]);\n\n        if (opts.cellFormula) {\n          if ((cref = d.match(match_f)) != null &&\n          /*::cref != null && */\n          cref[1] !== '') {\n            /* TODO: match against XLSXFutureFunctions */\n            p.f = unescapexml(utf8read(cref[1])).replace(/\\r\\n/g, \"\\n\");\n            if (!opts.xlfn) p.f = _xlfn(p.f);\n\n            if (\n            /*::cref != null && cref[0] != null && */\n            cref[0].indexOf('t=\"array\"') > -1) {\n              p.F = (d.match(refregex) || [])[1];\n              if (p.F.indexOf(\":\") > -1) arrayf.push([safe_decode_range(p.F), p.F]);\n            } else if (\n            /*::cref != null && cref[0] != null && */\n            cref[0].indexOf('t=\"shared\"') > -1) {\n              // TODO: parse formula\n              ftag = parsexmltag(cref[0]);\n\n              var ___f = unescapexml(utf8read(cref[1]));\n\n              if (!opts.xlfn) ___f = _xlfn(___f);\n              sharedf[parseInt(ftag.si, 10)] = [ftag, ___f, tag.r];\n            }\n          } else if (cref = d.match(/<f[^>]*\\/>/)) {\n            ftag = parsexmltag(cref[0]);\n            if (sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2]\n            /*[0].ref*/\n            , tag.r);\n          }\n          /* TODO: factor out contains logic */\n\n\n          var _tag = decode_cell(tag.r);\n\n          for (i = 0; i < arrayf.length; ++i) if (_tag.r >= arrayf[i][0].s.r && _tag.r <= arrayf[i][0].e.r) if (_tag.c >= arrayf[i][0].s.c && _tag.c <= arrayf[i][0].e.c) p.F = arrayf[i][1];\n        }\n\n        if (tag.t == null && p.v === undefined) {\n          if (p.f || p.F) {\n            p.v = 0;\n            p.t = \"n\";\n          } else if (!sheetStubs) continue;else p.t = \"z\";\n        } else p.t = tag.t || \"n\";\n\n        if (guess.s.c > tagc) guess.s.c = tagc;\n        if (guess.e.c < tagc) guess.e.c = tagc;\n        /* 18.18.11 t ST_CellType */\n\n        switch (p.t) {\n          case 'n':\n            if (p.v == \"\" || p.v == null) {\n              if (!sheetStubs) continue;\n              p.t = 'z';\n            } else p.v = parseFloat(p.v);\n\n            break;\n\n          case 's':\n            if (typeof p.v == 'undefined') {\n              if (!sheetStubs) continue;\n              p.t = 'z';\n            } else {\n              sstr = strs[parseInt(p.v, 10)];\n              p.v = sstr.t;\n              p.r = sstr.r;\n              if (opts.cellHTML) p.h = sstr.h;\n            }\n\n            break;\n\n          case 'str':\n            p.t = \"s\";\n            p.v = p.v != null ? utf8read(p.v) : '';\n            if (opts.cellHTML) p.h = escapehtml(p.v);\n            break;\n\n          case 'inlineStr':\n            cref = d.match(isregex);\n            p.t = 's';\n\n            if (cref != null && (sstr = parse_si(cref[1]))) {\n              p.v = sstr.t;\n              if (opts.cellHTML) p.h = sstr.h;\n            } else p.v = \"\";\n\n            break;\n\n          case 'b':\n            p.v = parsexmlbool(p.v);\n            break;\n\n          case 'd':\n            if (opts.cellDates) p.v = parseDate(p.v, 1);else {\n              p.v = datenum(parseDate(p.v, 1));\n              p.t = 'n';\n            }\n            break;\n\n          /* error string in .w, number in .v */\n\n          case 'e':\n            if (!opts || opts.cellText !== false) p.w = p.v;\n            p.v = RBErr[p.v];\n            break;\n        }\n        /* formatting */\n\n\n        fmtid = fillid = 0;\n        cf = null;\n\n        if (do_format && tag.s !== undefined) {\n          cf = styles.CellXf[tag.s];\n\n          if (cf != null) {\n            if (cf.numFmtId != null) fmtid = cf.numFmtId;\n\n            if (opts.cellStyles) {\n              if (cf.fillId != null) fillid = cf.fillId;\n            }\n          }\n        }\n\n        safe_format(p, fmtid, fillid, opts, themes, styles);\n\n        if (opts.cellDates && do_format && p.t == 'n' && fmt_is_date(table_fmt[fmtid])) {\n          p.t = 'd';\n          p.v = numdate(p.v);\n        }\n\n        if (tag.cm && opts.xlmeta) {\n          var cm = (opts.xlmeta.Cell || [])[+tag.cm - 1];\n          if (cm && cm.type == 'XLDAPR') p.D = true;\n        }\n\n        if (dense) {\n          var _r = decode_cell(tag.r);\n\n          if (!s[_r.r]) s[_r.r] = [];\n          s[_r.r][_r.c] = p;\n        } else s[tag.r] = p;\n      }\n    }\n\n    if (rows.length > 0) s['!rows'] = rows;\n  };\n}();\n\nfunction write_ws_xml_data(ws\n/*:Worksheet*/\n, opts, idx\n/*:number*/\n, wb\n/*:Workbook*/\n\n/*::, rels*/\n)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [],\n      r\n  /*:Array<string>*/\n  = [],\n      range = safe_decode_range(ws['!ref']),\n      cell = \"\",\n      ref,\n      rr = \"\",\n      cols\n  /*:Array<string>*/\n  = [],\n      R = 0,\n      C = 0,\n      rows = ws['!rows'];\n  var dense = Array.isArray(ws);\n  var params = {\n    r: rr\n  }\n  /*:any*/\n  ,\n      row\n  /*:RowInfo*/\n  ,\n      height = -1;\n\n  for (C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\n  for (R = range.s.r; R <= range.e.r; ++R) {\n    r = [];\n    rr = encode_row(R);\n\n    for (C = range.s.c; C <= range.e.c; ++C) {\n      ref = cols[C] + rr;\n\n      var _cell = dense ? (ws[R] || [])[C] : ws[ref];\n\n      if (_cell === undefined) continue;\n      if ((cell = write_ws_xml_cell(_cell, ref, ws, opts, idx, wb)) != null) r.push(cell);\n    }\n\n    if (r.length > 0 || rows && rows[R]) {\n      params = {\n        r: rr\n      }\n      /*:any*/\n      ;\n\n      if (rows && rows[R]) {\n        row = rows[R];\n        if (row.hidden) params.hidden = 1;\n        height = -1;\n        if (row.hpx) height = px2pt(row.hpx);else if (row.hpt) height = row.hpt;\n\n        if (height > -1) {\n          params.ht = height;\n          params.customHeight = 1;\n        }\n\n        if (row.level) {\n          params.outlineLevel = row.level;\n        }\n      }\n\n      o[o.length] = writextag('row', r.join(\"\"), params);\n    }\n  }\n\n  if (rows) for (; R < rows.length; ++R) {\n    if (rows && rows[R]) {\n      params = {\n        r: R + 1\n      }\n      /*:any*/\n      ;\n      row = rows[R];\n      if (row.hidden) params.hidden = 1;\n      height = -1;\n      if (row.hpx) height = px2pt(row.hpx);else if (row.hpt) height = row.hpt;\n\n      if (height > -1) {\n        params.ht = height;\n        params.customHeight = 1;\n      }\n\n      if (row.level) {\n        params.outlineLevel = row.level;\n      }\n\n      o[o.length] = writextag('row', \"\", params);\n    }\n  }\n  return o.join(\"\");\n}\n\nfunction write_ws_xml(idx\n/*:number*/\n, opts, wb\n/*:Workbook*/\n, rels)\n/*:string*/\n{\n  var o = [XML_HEADER, writextag('worksheet', null, {\n    'xmlns': XMLNS_main[0],\n    'xmlns:r': XMLNS.r\n  })];\n  var s = wb.SheetNames[idx],\n      sidx = 0,\n      rdata = \"\";\n  var ws = wb.Sheets[s];\n  if (ws == null) ws = {};\n  var ref = ws['!ref'] || 'A1';\n  var range = safe_decode_range(ref);\n\n  if (range.e.c > 0x3FFF || range.e.r > 0xFFFFF) {\n    if (opts.WTF) throw new Error(\"Range \" + ref + \" exceeds format limit A1:XFD1048576\");\n    range.e.c = Math.min(range.e.c, 0x3FFF);\n    range.e.r = Math.min(range.e.c, 0xFFFFF);\n    ref = encode_range(range);\n  }\n\n  if (!rels) rels = {};\n  ws['!comments'] = [];\n  var _drawing = [];\n  write_ws_xml_sheetpr(ws, wb, idx, opts, o);\n  o[o.length] = writextag('dimension', null, {\n    'ref': ref\n  });\n  o[o.length] = write_ws_xml_sheetviews(ws, opts, idx, wb);\n  /* TODO: store in WB, process styles */\n\n  if (opts.sheetFormat) o[o.length] = writextag('sheetFormatPr', null, {\n    defaultRowHeight: opts.sheetFormat.defaultRowHeight || '16',\n    baseColWidth: opts.sheetFormat.baseColWidth || '10',\n    outlineLevelRow: opts.sheetFormat.outlineLevelRow || '7'\n  });\n  if (ws['!cols'] != null && ws['!cols'].length > 0) o[o.length] = write_ws_xml_cols(ws, ws['!cols']);\n  o[sidx = o.length] = '<sheetData/>';\n  ws['!links'] = [];\n\n  if (ws['!ref'] != null) {\n    rdata = write_ws_xml_data(ws, opts, idx, wb, rels);\n    if (rdata.length > 0) o[o.length] = rdata;\n  }\n\n  if (o.length > sidx + 1) {\n    o[o.length] = '</sheetData>';\n    o[sidx] = o[sidx].replace(\"/>\", \">\");\n  }\n  /* sheetCalcPr */\n\n\n  if (ws['!protect']) o[o.length] = write_ws_xml_protection(ws['!protect']);\n  /* protectedRanges */\n\n  /* scenarios */\n\n  if (ws['!autofilter'] != null) o[o.length] = write_ws_xml_autofilter(ws['!autofilter'], ws, wb, idx);\n  /* sortState */\n\n  /* dataConsolidate */\n\n  /* customSheetViews */\n\n  if (ws['!merges'] != null && ws['!merges'].length > 0) o[o.length] = write_ws_xml_merges(ws['!merges']);\n  /* phoneticPr */\n\n  /* conditionalFormatting */\n\n  /* dataValidations */\n\n  var relc = -1,\n      rel,\n      rId = -1;\n\n  if (\n  /*::(*/\n  ws['!links']\n  /*::||[])*/\n  .length > 0) {\n    o[o.length] = \"<hyperlinks>\";\n    /*::(*/\n\n    ws['!links']\n    /*::||[])*/\n    .forEach(function (l) {\n      if (!l[1].Target) return;\n      rel = {\n        \"ref\": l[0]\n      }\n      /*:any*/\n      ;\n\n      if (l[1].Target.charAt(0) != \"#\") {\n        rId = add_rels(rels, -1, escapexml(l[1].Target).replace(/#.*$/, \"\"), RELS.HLINK);\n        rel[\"r:id\"] = \"rId\" + rId;\n      }\n\n      if ((relc = l[1].Target.indexOf(\"#\")) > -1) rel.location = escapexml(l[1].Target.slice(relc + 1));\n      if (l[1].Tooltip) rel.tooltip = escapexml(l[1].Tooltip);\n      o[o.length] = writextag(\"hyperlink\", null, rel);\n    });\n    o[o.length] = \"</hyperlinks>\";\n  }\n\n  delete ws['!links'];\n  /* printOptions */\n\n  if (ws['!margins'] != null) o[o.length] = write_ws_xml_margins(ws['!margins']);\n  /* pageSetup */\n\n  /* headerFooter */\n\n  /* rowBreaks */\n\n  /* colBreaks */\n\n  /* customProperties */\n\n  /* cellWatches */\n\n  if (!opts || opts.ignoreEC || opts.ignoreEC == void 0) o[o.length] = writetag(\"ignoredErrors\", writextag(\"ignoredError\", null, {\n    numberStoredAsText: 1,\n    sqref: ref\n  }));\n  /* smartTags */\n\n  if (_drawing.length > 0) {\n    rId = add_rels(rels, -1, \"../drawings/drawing\" + (idx + 1) + \".xml\", RELS.DRAW);\n    o[o.length] = writextag(\"drawing\", null, {\n      \"r:id\": \"rId\" + rId\n    });\n    ws['!drawing'] = _drawing;\n  }\n\n  if (ws['!comments'].length > 0) {\n    rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx + 1) + \".vml\", RELS.VML);\n    o[o.length] = writextag(\"legacyDrawing\", null, {\n      \"r:id\": \"rId\" + rId\n    });\n    ws['!legacy'] = rId;\n  }\n  /* legacyDrawingHF */\n\n  /* picture */\n\n  /* oleObjects */\n\n  /* controls */\n\n  /* webPublishItems */\n\n  /* tableParts */\n\n  /* extLst */\n\n\n  if (o.length > 1) {\n    o[o.length] = '</worksheet>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* [MS-XLSB] 2.4.726 BrtRowHdr */\n\n\nfunction parse_BrtRowHdr(data, length) {\n  var z = {}\n  /*:any*/\n  ;\n  var tgt = data.l + length;\n  z.r = data.read_shift(4);\n  data.l += 4; // TODO: ixfe\n\n  var miyRw = data.read_shift(2);\n  data.l += 1; // TODO: top/bot padding\n\n  var flags = data.read_shift(1);\n  data.l = tgt;\n  if (flags & 0x07) z.level = flags & 0x07;\n  if (flags & 0x10) z.hidden = true;\n  if (flags & 0x20) z.hpt = miyRw / 20;\n  return z;\n}\n\nfunction write_BrtRowHdr(R\n/*:number*/\n, range, ws) {\n  var o = new_buf(17 + 8 * 16);\n  var row = (ws['!rows'] || [])[R] || {};\n  o.write_shift(4, R);\n  o.write_shift(4, 0);\n  /* TODO: ixfe */\n\n  var miyRw = 0x0140;\n  if (row.hpx) miyRw = px2pt(row.hpx) * 20;else if (row.hpt) miyRw = row.hpt * 20;\n  o.write_shift(2, miyRw);\n  o.write_shift(1, 0);\n  /* top/bot padding */\n\n  var flags = 0x0;\n  if (row.level) flags |= row.level;\n  if (row.hidden) flags |= 0x10;\n  if (row.hpx || row.hpt) flags |= 0x20;\n  o.write_shift(1, flags);\n  o.write_shift(1, 0);\n  /* phonetic guide */\n\n  /* [MS-XLSB] 2.5.8 BrtColSpan explains the mechanism */\n\n  var ncolspan = 0,\n      lcs = o.l;\n  o.l += 4;\n  var caddr = {\n    r: R,\n    c: 0\n  };\n\n  for (var i = 0; i < 16; ++i) {\n    if (range.s.c > i + 1 << 10 || range.e.c < i << 10) continue;\n    var first = -1,\n        last = -1;\n\n    for (var j = i << 10; j < i + 1 << 10; ++j) {\n      caddr.c = j;\n      var cell = Array.isArray(ws) ? (ws[caddr.r] || [])[caddr.c] : ws[encode_cell(caddr)];\n\n      if (cell) {\n        if (first < 0) first = j;\n        last = j;\n      }\n    }\n\n    if (first < 0) continue;\n    ++ncolspan;\n    o.write_shift(4, first);\n    o.write_shift(4, last);\n  }\n\n  var l = o.l;\n  o.l = lcs;\n  o.write_shift(4, ncolspan);\n  o.l = l;\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n\nfunction write_row_header(ba, ws, range, R) {\n  var o = write_BrtRowHdr(R, range, ws);\n  if (o.length > 17 || (ws['!rows'] || [])[R]) write_record(ba, 0x0000\n  /* BrtRowHdr */\n  , o);\n}\n/* [MS-XLSB] 2.4.820 BrtWsDim */\n\n\nvar parse_BrtWsDim = parse_UncheckedRfX;\nvar write_BrtWsDim = write_UncheckedRfX;\n/* [MS-XLSB] 2.4.821 BrtWsFmtInfo */\n\nfunction\n  /*::data, length*/\nparse_BrtWsFmtInfo() {} //function write_BrtWsFmtInfo(ws, o) { }\n\n/* [MS-XLSB] 2.4.823 BrtWsProp */\n\n\nfunction parse_BrtWsProp(data, length) {\n  var z = {};\n  var f = data[data.l];\n  ++data.l;\n  z.above = !(f & 0x40);\n  z.left = !(f & 0x80);\n  /* TODO: pull flags */\n\n  data.l += 18;\n  z.name = parse_XLSBCodeName(data, length - 19);\n  return z;\n}\n\nfunction write_BrtWsProp(str, outl, o) {\n  if (o == null) o = new_buf(84 + 4 * str.length);\n  var f = 0xC0;\n\n  if (outl) {\n    if (outl.above) f &= ~0x40;\n    if (outl.left) f &= ~0x80;\n  }\n\n  o.write_shift(1, f);\n\n  for (var i = 1; i < 3; ++i) o.write_shift(1, 0);\n\n  write_BrtColor({\n    auto: 1\n  }, o);\n  o.write_shift(-4, -1);\n  o.write_shift(-4, -1);\n  write_XLSBCodeName(str, o);\n  return o.slice(0, o.l);\n}\n/* [MS-XLSB] 2.4.306 BrtCellBlank */\n\n\nfunction parse_BrtCellBlank(data) {\n  var cell = parse_XLSBCell(data);\n  return [cell];\n}\n\nfunction write_BrtCellBlank(cell, ncell, o) {\n  if (o == null) o = new_buf(8);\n  return write_XLSBCell(ncell, o);\n}\n\nfunction parse_BrtShortBlank(data) {\n  var cell = parse_XLSBShortCell(data);\n  return [cell];\n}\n\nfunction write_BrtShortBlank(cell, ncell, o) {\n  if (o == null) o = new_buf(4);\n  return write_XLSBShortCell(ncell, o);\n}\n/* [MS-XLSB] 2.4.307 BrtCellBool */\n\n\nfunction parse_BrtCellBool(data) {\n  var cell = parse_XLSBCell(data);\n  var fBool = data.read_shift(1);\n  return [cell, fBool, 'b'];\n}\n\nfunction write_BrtCellBool(cell, ncell, o) {\n  if (o == null) o = new_buf(9);\n  write_XLSBCell(ncell, o);\n  o.write_shift(1, cell.v ? 1 : 0);\n  return o;\n}\n\nfunction parse_BrtShortBool(data) {\n  var cell = parse_XLSBShortCell(data);\n  var fBool = data.read_shift(1);\n  return [cell, fBool, 'b'];\n}\n\nfunction write_BrtShortBool(cell, ncell, o) {\n  if (o == null) o = new_buf(5);\n  write_XLSBShortCell(ncell, o);\n  o.write_shift(1, cell.v ? 1 : 0);\n  return o;\n}\n/* [MS-XLSB] 2.4.308 BrtCellError */\n\n\nfunction parse_BrtCellError(data) {\n  var cell = parse_XLSBCell(data);\n  var bError = data.read_shift(1);\n  return [cell, bError, 'e'];\n}\n\nfunction write_BrtCellError(cell, ncell, o) {\n  if (o == null) o = new_buf(9);\n  write_XLSBCell(ncell, o);\n  o.write_shift(1, cell.v);\n  return o;\n}\n\nfunction parse_BrtShortError(data) {\n  var cell = parse_XLSBShortCell(data);\n  var bError = data.read_shift(1);\n  return [cell, bError, 'e'];\n}\n\nfunction write_BrtShortError(cell, ncell, o) {\n  if (o == null) o = new_buf(8);\n  write_XLSBShortCell(ncell, o);\n  o.write_shift(1, cell.v);\n  o.write_shift(2, 0);\n  o.write_shift(1, 0);\n  return o;\n}\n/* [MS-XLSB] 2.4.311 BrtCellIsst */\n\n\nfunction parse_BrtCellIsst(data) {\n  var cell = parse_XLSBCell(data);\n  var isst = data.read_shift(4);\n  return [cell, isst, 's'];\n}\n\nfunction write_BrtCellIsst(cell, ncell, o) {\n  if (o == null) o = new_buf(12);\n  write_XLSBCell(ncell, o);\n  o.write_shift(4, ncell.v);\n  return o;\n}\n\nfunction parse_BrtShortIsst(data) {\n  var cell = parse_XLSBShortCell(data);\n  var isst = data.read_shift(4);\n  return [cell, isst, 's'];\n}\n\nfunction write_BrtShortIsst(cell, ncell, o) {\n  if (o == null) o = new_buf(8);\n  write_XLSBShortCell(ncell, o);\n  o.write_shift(4, ncell.v);\n  return o;\n}\n/* [MS-XLSB] 2.4.313 BrtCellReal */\n\n\nfunction parse_BrtCellReal(data) {\n  var cell = parse_XLSBCell(data);\n  var value = parse_Xnum(data);\n  return [cell, value, 'n'];\n}\n\nfunction write_BrtCellReal(cell, ncell, o) {\n  if (o == null) o = new_buf(16);\n  write_XLSBCell(ncell, o);\n  write_Xnum(cell.v, o);\n  return o;\n}\n\nfunction parse_BrtShortReal(data) {\n  var cell = parse_XLSBShortCell(data);\n  var value = parse_Xnum(data);\n  return [cell, value, 'n'];\n}\n\nfunction write_BrtShortReal(cell, ncell, o) {\n  if (o == null) o = new_buf(12);\n  write_XLSBShortCell(ncell, o);\n  write_Xnum(cell.v, o);\n  return o;\n}\n/* [MS-XLSB] 2.4.314 BrtCellRk */\n\n\nfunction parse_BrtCellRk(data) {\n  var cell = parse_XLSBCell(data);\n  var value = parse_RkNumber(data);\n  return [cell, value, 'n'];\n}\n\nfunction write_BrtCellRk(cell, ncell, o) {\n  if (o == null) o = new_buf(12);\n  write_XLSBCell(ncell, o);\n  write_RkNumber(cell.v, o);\n  return o;\n}\n\nfunction parse_BrtShortRk(data) {\n  var cell = parse_XLSBShortCell(data);\n  var value = parse_RkNumber(data);\n  return [cell, value, 'n'];\n}\n\nfunction write_BrtShortRk(cell, ncell, o) {\n  if (o == null) o = new_buf(8);\n  write_XLSBShortCell(ncell, o);\n  write_RkNumber(cell.v, o);\n  return o;\n}\n/* [MS-XLSB] 2.4.323 BrtCellRString */\n\n\nfunction parse_BrtCellRString(data) {\n  var cell = parse_XLSBCell(data);\n  var value = parse_RichStr(data);\n  return [cell, value, 'is'];\n}\n/* [MS-XLSB] 2.4.317 BrtCellSt */\n\n\nfunction parse_BrtCellSt(data) {\n  var cell = parse_XLSBCell(data);\n  var value = parse_XLWideString(data);\n  return [cell, value, 'str'];\n}\n\nfunction write_BrtCellSt(cell, ncell, o) {\n  if (o == null) o = new_buf(12 + 4 * cell.v.length);\n  write_XLSBCell(ncell, o);\n  write_XLWideString(cell.v, o);\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n\nfunction parse_BrtShortSt(data) {\n  var cell = parse_XLSBShortCell(data);\n  var value = parse_XLWideString(data);\n  return [cell, value, 'str'];\n}\n\nfunction write_BrtShortSt(cell, ncell, o) {\n  if (o == null) o = new_buf(8 + 4 * cell.v.length);\n  write_XLSBShortCell(ncell, o);\n  write_XLWideString(cell.v, o);\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.653 BrtFmlaBool */\n\n\nfunction parse_BrtFmlaBool(data, length, opts) {\n  var end = data.l + length;\n  var cell = parse_XLSBCell(data);\n  cell.r = opts['!row'];\n  var value = data.read_shift(1);\n  var o = [cell, value, 'b'];\n\n  if (opts.cellFormula) {\n    data.l += 2;\n    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n    o[3] = stringify_formula(formula, null\n    /*range*/\n    , cell, opts.supbooks, opts);\n    /* TODO */\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.654 BrtFmlaError */\n\n\nfunction parse_BrtFmlaError(data, length, opts) {\n  var end = data.l + length;\n  var cell = parse_XLSBCell(data);\n  cell.r = opts['!row'];\n  var value = data.read_shift(1);\n  var o = [cell, value, 'e'];\n\n  if (opts.cellFormula) {\n    data.l += 2;\n    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n    o[3] = stringify_formula(formula, null\n    /*range*/\n    , cell, opts.supbooks, opts);\n    /* TODO */\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.655 BrtFmlaNum */\n\n\nfunction parse_BrtFmlaNum(data, length, opts) {\n  var end = data.l + length;\n  var cell = parse_XLSBCell(data);\n  cell.r = opts['!row'];\n  var value = parse_Xnum(data);\n  var o = [cell, value, 'n'];\n\n  if (opts.cellFormula) {\n    data.l += 2;\n    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n    o[3] = stringify_formula(formula, null\n    /*range*/\n    , cell, opts.supbooks, opts);\n    /* TODO */\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.656 BrtFmlaString */\n\n\nfunction parse_BrtFmlaString(data, length, opts) {\n  var end = data.l + length;\n  var cell = parse_XLSBCell(data);\n  cell.r = opts['!row'];\n  var value = parse_XLWideString(data);\n  var o = [cell, value, 'str'];\n\n  if (opts.cellFormula) {\n    data.l += 2;\n    var formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n    o[3] = stringify_formula(formula, null\n    /*range*/\n    , cell, opts.supbooks, opts);\n    /* TODO */\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.682 BrtMergeCell */\n\n\nvar parse_BrtMergeCell = parse_UncheckedRfX;\nvar write_BrtMergeCell = write_UncheckedRfX;\n/* [MS-XLSB] 2.4.107 BrtBeginMergeCells */\n\nfunction write_BrtBeginMergeCells(cnt, o) {\n  if (o == null) o = new_buf(4);\n  o.write_shift(4, cnt);\n  return o;\n}\n/* [MS-XLSB] 2.4.662 BrtHLink */\n\n\nfunction parse_BrtHLink(data, length\n/*::, opts*/\n) {\n  var end = data.l + length;\n  var rfx = parse_UncheckedRfX(data, 16);\n  var relId = parse_XLNullableWideString(data);\n  var loc = parse_XLWideString(data);\n  var tooltip = parse_XLWideString(data);\n  var display = parse_XLWideString(data);\n  data.l = end;\n  var o = {\n    rfx: rfx,\n    relId: relId,\n    loc: loc,\n    display: display\n  }\n  /*:any*/\n  ;\n  if (tooltip) o.Tooltip = tooltip;\n  return o;\n}\n\nfunction write_BrtHLink(l, rId) {\n  var o = new_buf(50 + 4 * (l[1].Target.length + (l[1].Tooltip || \"\").length));\n  write_UncheckedRfX({\n    s: decode_cell(l[0]),\n    e: decode_cell(l[0])\n  }, o);\n  write_RelID(\"rId\" + rId, o);\n  var locidx = l[1].Target.indexOf(\"#\");\n  var loc = locidx == -1 ? \"\" : l[1].Target.slice(locidx + 1);\n  write_XLWideString(loc || \"\", o);\n  write_XLWideString(l[1].Tooltip || \"\", o);\n  write_XLWideString(\"\", o);\n  return o.slice(0, o.l);\n}\n/* [MS-XLSB] 2.4.692 BrtPane */\n\n\nfunction\n  /*data, length, opts*/\nparse_BrtPane() {}\n/* [MS-XLSB] 2.4.6 BrtArrFmla */\n\n\nfunction parse_BrtArrFmla(data, length, opts) {\n  var end = data.l + length;\n  var rfx = parse_RfX(data, 16);\n  var fAlwaysCalc = data.read_shift(1);\n  var o = [rfx];\n  o[2] = fAlwaysCalc;\n\n  if (opts.cellFormula) {\n    var formula = parse_XLSBArrayParsedFormula(data, end - data.l, opts);\n    o[1] = formula;\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.750 BrtShrFmla */\n\n\nfunction parse_BrtShrFmla(data, length, opts) {\n  var end = data.l + length;\n  var rfx = parse_UncheckedRfX(data, 16);\n  var o = [rfx];\n\n  if (opts.cellFormula) {\n    var formula = parse_XLSBSharedParsedFormula(data, end - data.l, opts);\n    o[1] = formula;\n    data.l = end;\n  } else data.l = end;\n\n  return o;\n}\n/* [MS-XLSB] 2.4.323 BrtColInfo */\n\n/* TODO: once XLS ColInfo is set, combine the functions */\n\n\nfunction write_BrtColInfo(C\n/*:number*/\n, col, o) {\n  if (o == null) o = new_buf(18);\n  var p = col_obj_w(C, col);\n  o.write_shift(-4, C);\n  o.write_shift(-4, C);\n  o.write_shift(4, (p.width || 10) * 256);\n  o.write_shift(4, 0\n  /*ixfe*/\n  ); // style\n\n  var flags = 0;\n  if (col.hidden) flags |= 0x01;\n  if (typeof p.width == 'number') flags |= 0x02;\n  if (col.level) flags |= col.level << 8;\n  o.write_shift(2, flags); // bit flag\n\n  return o;\n}\n/* [MS-XLSB] 2.4.678 BrtMargins */\n\n\nvar BrtMarginKeys = [\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"];\n\nfunction parse_BrtMargins(data\n/*::, length, opts*/\n)\n/*:Margins*/\n{\n  var margins = {}\n  /*:any*/\n  ;\n  BrtMarginKeys.forEach(function (k) {\n    margins[k] = parse_Xnum(data, 8);\n  });\n  return margins;\n}\n\nfunction write_BrtMargins(margins\n/*:Margins*/\n, o) {\n  if (o == null) o = new_buf(6 * 8);\n  default_margins(margins);\n  BrtMarginKeys.forEach(function (k) {\n    write_Xnum(margins\n    /*:any*/\n    [k], o);\n  });\n  return o;\n}\n/* [MS-XLSB] 2.4.299 BrtBeginWsView */\n\n\nfunction parse_BrtBeginWsView(data\n/*::, length, opts*/\n) {\n  var f = data.read_shift(2);\n  data.l += 28;\n  return {\n    RTL: f & 0x20\n  };\n}\n\nfunction write_BrtBeginWsView(ws, Workbook, o) {\n  if (o == null) o = new_buf(30);\n  var f = 0x39c;\n  if ((((Workbook || {}).Views || [])[0] || {}).RTL) f |= 0x20;\n  o.write_shift(2, f); // bit flag\n\n  o.write_shift(4, 0);\n  o.write_shift(4, 0); // view first row\n\n  o.write_shift(4, 0); // view first col\n\n  o.write_shift(1, 0); // gridline color ICV\n\n  o.write_shift(1, 0);\n  o.write_shift(2, 0);\n  o.write_shift(2, 100); // zoom scale\n\n  o.write_shift(2, 0);\n  o.write_shift(2, 0);\n  o.write_shift(2, 0);\n  o.write_shift(4, 0); // workbook view id\n\n  return o;\n}\n/* [MS-XLSB] 2.4.309 BrtCellIgnoreEC */\n\n\nfunction write_BrtCellIgnoreEC(ref) {\n  var o = new_buf(24);\n  o.write_shift(4, 4);\n  o.write_shift(4, 1);\n  write_UncheckedRfX(ref, o);\n  return o;\n}\n/* [MS-XLSB] 2.4.748 BrtSheetProtection */\n\n\nfunction write_BrtSheetProtection(sp, o) {\n  if (o == null) o = new_buf(16 * 4 + 2);\n  o.write_shift(2, sp.password ? crypto_CreatePasswordVerifier_Method1(sp.password) : 0);\n  o.write_shift(4, 1); // this record should not be written if no protection\n\n  [[\"objects\", false], // fObjects\n  [\"scenarios\", false], // fScenarios\n  [\"formatCells\", true], // fFormatCells\n  [\"formatColumns\", true], // fFormatColumns\n  [\"formatRows\", true], // fFormatRows\n  [\"insertColumns\", true], // fInsertColumns\n  [\"insertRows\", true], // fInsertRows\n  [\"insertHyperlinks\", true], // fInsertHyperlinks\n  [\"deleteColumns\", true], // fDeleteColumns\n  [\"deleteRows\", true], // fDeleteRows\n  [\"selectLockedCells\", false], // fSelLockedCells\n  [\"sort\", true], // fSort\n  [\"autoFilter\", true], // fAutoFilter\n  [\"pivotTables\", true], // fPivotTables\n  [\"selectUnlockedCells\", false] // fSelUnlockedCells\n  ].forEach(function (n) {\n    /*:: if(o == null) throw \"unreachable\"; */\n    if (n[1]) o.write_shift(4, sp[n[0]] != null && !sp[n[0]] ? 1 : 0);else o.write_shift(4, sp[n[0]] != null && sp[n[0]] ? 0 : 1);\n  });\n  return o;\n}\n\nfunction\n  /*data, length, opts*/\nparse_BrtDVal() {}\n\nfunction\n  /*data, length, opts*/\nparse_BrtDVal14() {}\n/* [MS-XLSB] 2.1.7.61 Worksheet */\n\n\nfunction parse_ws_bin(data, _opts, idx, rels, wb\n/*:WBWBProps*/\n, themes, styles)\n/*:Worksheet*/\n{\n  if (!data) return data;\n  var opts = _opts || {};\n  if (!rels) rels = {\n    '!id': {}\n  };\n  if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n  var s\n  /*:Worksheet*/\n  = opts.dense ? [] : {};\n  var ref;\n  var refguess = {\n    s: {\n      r: 2000000,\n      c: 2000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var state\n  /*:Array<string>*/\n  = [];\n  var pass = false,\n      end = false;\n  var row, p, cf, R, C, addr, sstr, rr, cell\n  /*:Cell*/\n  ;\n  var merges\n  /*:Array<Range>*/\n  = [];\n  opts.biff = 12;\n  opts['!row'] = 0;\n  var ai = 0,\n      af = false;\n  var arrayf\n  /*:Array<[Range, string]>*/\n  = [];\n  var sharedf = {};\n  var supbooks = opts.supbooks ||\n  /*::(*/\n  wb\n  /*:: :any)*/\n  .supbooks || [[]]\n  /*:any*/\n  ;\n  supbooks.sharedf = sharedf;\n  supbooks.arrayf = arrayf;\n  supbooks.SheetNames = wb.SheetNames || wb.Sheets.map(function (x) {\n    return x.name;\n  });\n\n  if (!opts.supbooks) {\n    opts.supbooks = supbooks;\n    if (wb.Names) for (var i = 0; i < wb.Names.length; ++i) supbooks[0][i + 1] = wb.Names[i];\n  }\n\n  var colinfo\n  /*:Array<ColInfo>*/\n  = [],\n      rowinfo\n  /*:Array<RowInfo>*/\n  = [];\n  var seencol = false;\n  XLSBRecordEnum[0x0010] = {\n    n: \"BrtShortReal\",\n    f: parse_BrtShortReal\n  };\n  var cm, vm;\n  recordhopper(data, function ws_parse(val, RR, RT) {\n    if (end) return;\n\n    switch (RT) {\n      case 0x0094:\n        /* 'BrtWsDim' */\n        ref = val;\n        break;\n\n      case 0x0000:\n        /* 'BrtRowHdr' */\n        row = val;\n        if (opts.sheetRows && opts.sheetRows <= row.r) end = true;\n        rr = encode_row(R = row.r);\n        opts['!row'] = row.r;\n\n        if (val.hidden || val.hpt || val.level != null) {\n          if (val.hpt) val.hpx = pt2px(val.hpt);\n          rowinfo[val.r] = val;\n        }\n\n        break;\n\n      case 0x0002:\n      /* 'BrtCellRk' */\n\n      case 0x0003:\n      /* 'BrtCellError' */\n\n      case 0x0004:\n      /* 'BrtCellBool' */\n\n      case 0x0005:\n      /* 'BrtCellReal' */\n\n      case 0x0006:\n      /* 'BrtCellSt' */\n\n      case 0x0007:\n      /* 'BrtCellIsst' */\n\n      case 0x0008:\n      /* 'BrtFmlaString' */\n\n      case 0x0009:\n      /* 'BrtFmlaNum' */\n\n      case 0x000A:\n      /* 'BrtFmlaBool' */\n\n      case 0x000B:\n      /* 'BrtFmlaError' */\n\n      case 0x000D:\n      /* 'BrtShortRk' */\n\n      case 0x000E:\n      /* 'BrtShortError' */\n\n      case 0x000F:\n      /* 'BrtShortBool' */\n\n      case 0x0010:\n      /* 'BrtShortReal' */\n\n      case 0x0011:\n      /* 'BrtShortSt' */\n\n      case 0x0012:\n      /* 'BrtShortIsst' */\n\n      case 0x003E:\n        /* 'BrtCellRString' */\n        p = {\n          t: val[2]\n        }\n        /*:any*/\n        ;\n\n        switch (val[2]) {\n          case 'n':\n            p.v = val[1];\n            break;\n\n          case 's':\n            sstr = strs[val[1]];\n            p.v = sstr.t;\n            p.r = sstr.r;\n            break;\n\n          case 'b':\n            p.v = val[1] ? true : false;\n            break;\n\n          case 'e':\n            p.v = val[1];\n            if (opts.cellText !== false) p.w = BErr[p.v];\n            break;\n\n          case 'str':\n            p.t = 's';\n            p.v = val[1];\n            break;\n\n          case 'is':\n            p.t = 's';\n            p.v = val[1].t;\n            break;\n        }\n\n        if (cf = styles.CellXf[val[0].iStyleRef]) safe_format(p, cf.numFmtId, null, opts, themes, styles);\n        C = val[0].c == -1 ? C + 1 : val[0].c;\n\n        if (opts.dense) {\n          if (!s[R]) s[R] = [];\n          s[R][C] = p;\n        } else s[encode_col(C) + rr] = p;\n\n        if (opts.cellFormula) {\n          af = false;\n\n          for (ai = 0; ai < arrayf.length; ++ai) {\n            var aii = arrayf[ai];\n            if (row.r >= aii[0].s.r && row.r <= aii[0].e.r) if (C >= aii[0].s.c && C <= aii[0].e.c) {\n              p.F = encode_range(aii[0]);\n              af = true;\n            }\n          }\n\n          if (!af && val.length > 3) p.f = val[3];\n        }\n\n        if (refguess.s.r > row.r) refguess.s.r = row.r;\n        if (refguess.s.c > C) refguess.s.c = C;\n        if (refguess.e.r < row.r) refguess.e.r = row.r;\n        if (refguess.e.c < C) refguess.e.c = C;\n\n        if (opts.cellDates && cf && p.t == 'n' && fmt_is_date(table_fmt[cf.numFmtId])) {\n          var _d = SSF_parse_date_code(p.v);\n\n          if (_d) {\n            p.t = 'd';\n            p.v = new Date(_d.y, _d.m - 1, _d.d, _d.H, _d.M, _d.S, _d.u);\n          }\n        }\n\n        if (cm) {\n          if (cm.type == 'XLDAPR') p.D = true;\n          cm = void 0;\n        }\n\n        if (vm) vm = void 0;\n        break;\n\n      case 0x0001:\n      /* 'BrtCellBlank' */\n\n      case 0x000C:\n        /* 'BrtShortBlank' */\n        if (!opts.sheetStubs || pass) break;\n        p = {\n          t: 'z',\n          v: void 0\n        }\n        /*:any*/\n        ;\n        C = val[0].c == -1 ? C + 1 : val[0].c;\n\n        if (opts.dense) {\n          if (!s[R]) s[R] = [];\n          s[R][C] = p;\n        } else s[encode_col(C) + rr] = p;\n\n        if (refguess.s.r > row.r) refguess.s.r = row.r;\n        if (refguess.s.c > C) refguess.s.c = C;\n        if (refguess.e.r < row.r) refguess.e.r = row.r;\n        if (refguess.e.c < C) refguess.e.c = C;\n\n        if (cm) {\n          if (cm.type == 'XLDAPR') p.D = true;\n          cm = void 0;\n        }\n\n        if (vm) vm = void 0;\n        break;\n\n      case 0x00B0:\n        /* 'BrtMergeCell' */\n        merges.push(val);\n        break;\n\n      case 0x0031:\n        {\n          /* 'BrtCellMeta' */\n          cm = ((opts.xlmeta || {}).Cell || [])[val - 1];\n        }\n        break;\n\n      case 0x01EE:\n        /* 'BrtHLink' */\n        var rel = rels['!id'][val.relId];\n\n        if (rel) {\n          val.Target = rel.Target;\n          if (val.loc) val.Target += \"#\" + val.loc;\n          val.Rel = rel;\n        } else if (val.relId == '') {\n          val.Target = \"#\" + val.loc;\n        }\n\n        for (R = val.rfx.s.r; R <= val.rfx.e.r; ++R) for (C = val.rfx.s.c; C <= val.rfx.e.c; ++C) {\n          if (opts.dense) {\n            if (!s[R]) s[R] = [];\n            if (!s[R][C]) s[R][C] = {\n              t: 'z',\n              v: undefined\n            };\n            s[R][C].l = val;\n          } else {\n            addr = encode_cell({\n              c: C,\n              r: R\n            });\n            if (!s[addr]) s[addr] = {\n              t: 'z',\n              v: undefined\n            };\n            s[addr].l = val;\n          }\n        }\n\n        break;\n\n      case 0x01AA:\n        /* 'BrtArrFmla' */\n        if (!opts.cellFormula) break;\n        arrayf.push(val);\n        cell = opts.dense ? s[R][C] : s[encode_col(C) + rr]\n        /*:any*/\n        ;\n        cell.f = stringify_formula(val[1], refguess, {\n          r: row.r,\n          c: C\n        }, supbooks, opts);\n        cell.F = encode_range(val[0]);\n        break;\n\n      case 0x01AB:\n        /* 'BrtShrFmla' */\n        if (!opts.cellFormula) break;\n        sharedf[encode_cell(val[0].s)] = val[1];\n        cell = opts.dense ? s[R][C] : s[encode_col(C) + rr];\n        cell.f = stringify_formula(val[1], refguess, {\n          r: row.r,\n          c: C\n        }, supbooks, opts);\n        break;\n\n      /* identical to 'ColInfo' in XLS */\n\n      case 0x003C:\n        /* 'BrtColInfo' */\n        if (!opts.cellStyles) break;\n\n        while (val.e >= val.s) {\n          colinfo[val.e--] = {\n            width: val.w / 256,\n            hidden: !!(val.flags & 0x01),\n            level: val.level\n          };\n\n          if (!seencol) {\n            seencol = true;\n            find_mdw_colw(val.w / 256);\n          }\n\n          process_col(colinfo[val.e + 1]);\n        }\n\n        break;\n\n      case 0x00A1:\n        /* 'BrtBeginAFilter' */\n        s['!autofilter'] = {\n          ref: encode_range(val)\n        };\n        break;\n\n      case 0x01DC:\n        /* 'BrtMargins' */\n        s['!margins'] = val;\n        break;\n\n      case 0x0093:\n        /* 'BrtWsProp' */\n        if (!wb.Sheets[idx]) wb.Sheets[idx] = {};\n        if (val.name) wb.Sheets[idx].CodeName = val.name;\n        if (val.above || val.left) s['!outline'] = {\n          above: val.above,\n          left: val.left\n        };\n        break;\n\n      case 0x0089:\n        /* 'BrtBeginWsView' */\n        if (!wb.Views) wb.Views = [{}];\n        if (!wb.Views[0]) wb.Views[0] = {};\n        if (val.RTL) wb.Views[0].RTL = true;\n        break;\n\n      case 0x01E5:\n        /* 'BrtWsFmtInfo' */\n        break;\n\n      case 0x0040:\n      /* 'BrtDVal' */\n\n      case 0x041D:\n        /* 'BrtDVal14' */\n        break;\n\n      case 0x0097:\n        /* 'BrtPane' */\n        break;\n\n      case 0x0098:\n      /* 'BrtSel' */\n\n      case 0x00AF:\n      /* 'BrtAFilterDateGroupItem' */\n\n      case 0x0284:\n      /* 'BrtActiveX' */\n\n      case 0x0271:\n      /* 'BrtBigName' */\n\n      case 0x0232:\n      /* 'BrtBkHim' */\n\n      case 0x018C:\n      /* 'BrtBrk' */\n\n      case 0x0458:\n      /* 'BrtCFIcon' */\n\n      case 0x047A:\n      /* 'BrtCFRuleExt' */\n\n      case 0x01D7:\n      /* 'BrtCFVO' */\n\n      case 0x041A:\n      /* 'BrtCFVO14' */\n\n      case 0x0289:\n      /* 'BrtCellIgnoreEC' */\n\n      case 0x0451:\n      /* 'BrtCellIgnoreEC14' */\n\n      case 0x024D:\n      /* 'BrtCellSmartTagProperty' */\n\n      case 0x025F:\n      /* 'BrtCellWatch' */\n\n      case 0x0234:\n      /* 'BrtColor' */\n\n      case 0x041F:\n      /* 'BrtColor14' */\n\n      case 0x00A8:\n      /* 'BrtColorFilter' */\n\n      case 0x00AE:\n      /* 'BrtCustomFilter' */\n\n      case 0x049C:\n      /* 'BrtCustomFilter14' */\n\n      case 0x01F3:\n      /* 'BrtDRef' */\n\n      case 0x01FB:\n      /* 'BrtDXF' */\n\n      case 0x0226:\n      /* 'BrtDrawing' */\n\n      case 0x00AB:\n      /* 'BrtDynamicFilter' */\n\n      case 0x00A7:\n      /* 'BrtFilter' */\n\n      case 0x0499:\n      /* 'BrtFilter14' */\n\n      case 0x00A9:\n      /* 'BrtIconFilter' */\n\n      case 0x049D:\n      /* 'BrtIconFilter14' */\n\n      case 0x0227:\n      /* 'BrtLegacyDrawing' */\n\n      case 0x0228:\n      /* 'BrtLegacyDrawingHF' */\n\n      case 0x0295:\n      /* 'BrtListPart' */\n\n      case 0x027F:\n      /* 'BrtOleObject' */\n\n      case 0x01DE:\n      /* 'BrtPageSetup' */\n\n      case 0x0219:\n      /* 'BrtPhoneticInfo' */\n\n      case 0x01DD:\n      /* 'BrtPrintOptions' */\n\n      case 0x0218:\n      /* 'BrtRangeProtection' */\n\n      case 0x044F:\n      /* 'BrtRangeProtection14' */\n\n      case 0x02A8:\n      /* 'BrtRangeProtectionIso' */\n\n      case 0x0450:\n      /* 'BrtRangeProtectionIso14' */\n\n      case 0x0400:\n      /* 'BrtRwDescent' */\n\n      case 0x0297:\n      /* 'BrtSheetCalcProp' */\n\n      case 0x0217:\n      /* 'BrtSheetProtection' */\n\n      case 0x02A6:\n      /* 'BrtSheetProtectionIso' */\n\n      case 0x01F8:\n      /* 'BrtSlc' */\n\n      case 0x0413:\n      /* 'BrtSparkline' */\n\n      case 0x01AC:\n      /* 'BrtTable' */\n\n      case 0x00AA:\n      /* 'BrtTop10Filter' */\n\n      case 0x0C00:\n      /* 'BrtUid' */\n\n      case 0x0032:\n      /* 'BrtValueMeta' */\n\n      case 0x0816:\n      /* 'BrtWebExtension' */\n\n      case 0x0415:\n        /* 'BrtWsFmtInfoEx14' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* 'BrtACBegin' */\n        state.push(RT);\n        pass = true;\n        break;\n\n      case 0x0026:\n        /* 'BrtACEnd' */\n        state.pop();\n        pass = false;\n        break;\n\n      default:\n        if (RR.T) {\n          /* empty */\n        } else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\n    }\n  }, opts);\n  delete opts.supbooks;\n  delete opts['!row'];\n  if (!s[\"!ref\"] && (refguess.s.r < 2000000 || ref && (ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0))) s[\"!ref\"] = encode_range(ref || refguess);\n\n  if (opts.sheetRows && s[\"!ref\"]) {\n    var tmpref = safe_decode_range(s[\"!ref\"]);\n\n    if (opts.sheetRows <= +tmpref.e.r) {\n      tmpref.e.r = opts.sheetRows - 1;\n      if (tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n      if (tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n      if (tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n      if (tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n      s[\"!fullref\"] = s[\"!ref\"];\n      s[\"!ref\"] = encode_range(tmpref);\n    }\n  }\n\n  if (merges.length > 0) s[\"!merges\"] = merges;\n  if (colinfo.length > 0) s[\"!cols\"] = colinfo;\n  if (rowinfo.length > 0) s[\"!rows\"] = rowinfo;\n  return s;\n}\n/* TODO: something useful -- this is a stub */\n\n\nfunction write_ws_bin_cell(ba\n/*:BufArray*/\n, cell\n/*:Cell*/\n, R\n/*:number*/\n, C\n/*:number*/\n, opts, ws\n/*:Worksheet*/\n, last_seen\n/*:boolean*/\n)\n/*:boolean*/\n{\n  if (cell.v === undefined) return false;\n  var vv = \"\";\n\n  switch (cell.t) {\n    case 'b':\n      vv = cell.v ? \"1\" : \"0\";\n      break;\n\n    case 'd':\n      // no BrtCellDate :(\n      cell = dup(cell);\n      cell.z = cell.z || table_fmt[14];\n      cell.v = datenum(parseDate(cell.v));\n      cell.t = 'n';\n      break;\n\n    /* falls through */\n\n    case 'n':\n    case 'e':\n      vv = '' + cell.v;\n      break;\n\n    default:\n      vv = cell.v;\n      break;\n  }\n\n  var o\n  /*:any*/\n  = {\n    r: R,\n    c: C\n  }\n  /*:any*/\n  ;\n  /* TODO: cell style */\n\n  o.s = get_cell_style(opts.cellXfs, cell, opts);\n  if (cell.l) ws['!links'].push([encode_cell(o), cell.l]);\n  if (cell.c) ws['!comments'].push([encode_cell(o), cell.c]);\n\n  switch (cell.t) {\n    case 's':\n    case 'str':\n      if (opts.bookSST) {\n        vv = get_sst_id(opts.Strings, cell.v\n        /*:any*/\n        , opts.revStrings);\n        o.t = \"s\";\n        o.v = vv;\n        if (last_seen) write_record(ba, 0x0012\n        /* BrtShortIsst */\n        , write_BrtShortIsst(cell, o));else write_record(ba, 0x0007\n        /* BrtCellIsst */\n        , write_BrtCellIsst(cell, o));\n      } else {\n        o.t = \"str\";\n        if (last_seen) write_record(ba, 0x0011\n        /* BrtShortSt */\n        , write_BrtShortSt(cell, o));else write_record(ba, 0x0006\n        /* BrtCellSt */\n        , write_BrtCellSt(cell, o));\n      }\n\n      return true;\n\n    case 'n':\n      /* TODO: determine threshold for Real vs RK */\n      if (cell.v == (cell.v | 0) && cell.v > -1000 && cell.v < 1000) {\n        if (last_seen) write_record(ba, 0x000D\n        /* BrtShortRk */\n        , write_BrtShortRk(cell, o));else write_record(ba, 0x0002\n        /* BrtCellRk */\n        , write_BrtCellRk(cell, o));\n      } else {\n        if (last_seen) write_record(ba, 0x0010\n        /* BrtShortReal */\n        , write_BrtShortReal(cell, o));else write_record(ba, 0x0005\n        /* BrtCellReal */\n        , write_BrtCellReal(cell, o));\n      }\n\n      return true;\n\n    case 'b':\n      o.t = \"b\";\n      if (last_seen) write_record(ba, 0x000F\n      /* BrtShortBool */\n      , write_BrtShortBool(cell, o));else write_record(ba, 0x0004\n      /* BrtCellBool */\n      , write_BrtCellBool(cell, o));\n      return true;\n\n    case 'e':\n      o.t = \"e\";\n      if (last_seen) write_record(ba, 0x000E\n      /* BrtShortError */\n      , write_BrtShortError(cell, o));else write_record(ba, 0x0003\n      /* BrtCellError */\n      , write_BrtCellError(cell, o));\n      return true;\n  }\n\n  if (last_seen) write_record(ba, 0x000C\n  /* BrtShortBlank */\n  , write_BrtShortBlank(cell, o));else write_record(ba, 0x0001\n  /* BrtCellBlank */\n  , write_BrtCellBlank(cell, o));\n  return true;\n}\n\nfunction write_CELLTABLE(ba, ws\n/*:Worksheet*/\n, idx\n/*:number*/\n, opts\n/*::, wb:Workbook*/\n) {\n  var range = safe_decode_range(ws['!ref'] || \"A1\"),\n      ref,\n      rr = \"\",\n      cols\n  /*:Array<string>*/\n  = [];\n  write_record(ba, 0x0091\n  /* BrtBeginSheetData */\n  );\n  var dense = Array.isArray(ws);\n  var cap = range.e.r;\n  if (ws['!rows']) cap = Math.max(range.e.r, ws['!rows'].length - 1);\n\n  for (var R = range.s.r; R <= cap; ++R) {\n    rr = encode_row(R);\n    /* [ACCELLTABLE] */\n\n    /* BrtRowHdr */\n\n    write_row_header(ba, ws, range, R);\n    var last_seen = false;\n    if (R <= range.e.r) for (var C = range.s.c; C <= range.e.c; ++C) {\n      /* *16384CELL */\n      if (R === range.s.r) cols[C] = encode_col(C);\n      ref = cols[C] + rr;\n      var cell = dense ? (ws[R] || [])[C] : ws[ref];\n\n      if (!cell) {\n        last_seen = false;\n        continue;\n      }\n      /* write cell */\n\n\n      last_seen = write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen);\n    }\n  }\n\n  write_record(ba, 0x0092\n  /* BrtEndSheetData */\n  );\n}\n\nfunction write_MERGECELLS(ba, ws\n/*:Worksheet*/\n) {\n  if (!ws || !ws['!merges']) return;\n  write_record(ba, 0x00B1\n  /* BrtBeginMergeCells */\n  , write_BrtBeginMergeCells(ws['!merges'].length));\n  ws['!merges'].forEach(function (m) {\n    write_record(ba, 0x00B0\n    /* BrtMergeCell */\n    , write_BrtMergeCell(m));\n  });\n  write_record(ba, 0x00B2\n  /* BrtEndMergeCells */\n  );\n}\n\nfunction write_COLINFOS(ba, ws\n/*:Worksheet*/\n\n/*::, idx:number, opts, wb:Workbook*/\n) {\n  if (!ws || !ws['!cols']) return;\n  write_record(ba, 0x0186\n  /* BrtBeginColInfos */\n  );\n  ws['!cols'].forEach(function (m, i) {\n    if (m) write_record(ba, 0x003C\n    /* 'BrtColInfo' */\n    , write_BrtColInfo(i, m));\n  });\n  write_record(ba, 0x0187\n  /* BrtEndColInfos */\n  );\n}\n\nfunction write_IGNOREECS(ba, ws\n/*:Worksheet*/\n) {\n  if (!ws || !ws['!ref']) return;\n  write_record(ba, 0x0288\n  /* BrtBeginCellIgnoreECs */\n  );\n  write_record(ba, 0x0289\n  /* BrtCellIgnoreEC */\n  , write_BrtCellIgnoreEC(safe_decode_range(ws['!ref'])));\n  write_record(ba, 0x028A\n  /* BrtEndCellIgnoreECs */\n  );\n}\n\nfunction write_HLINKS(ba, ws\n/*:Worksheet*/\n, rels) {\n  /* *BrtHLink */\n  ws['!links'].forEach(function (l) {\n    if (!l[1].Target) return;\n    var rId = add_rels(rels, -1, l[1].Target.replace(/#.*$/, \"\"), RELS.HLINK);\n    write_record(ba, 0x01EE\n    /* BrtHLink */\n    , write_BrtHLink(l, rId));\n  });\n  delete ws['!links'];\n}\n\nfunction write_LEGACYDRAWING(ba, ws\n/*:Worksheet*/\n, idx\n/*:number*/\n, rels) {\n  /* [BrtLegacyDrawing] */\n  if (ws['!comments'].length > 0) {\n    var rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx + 1) + \".vml\", RELS.VML);\n    write_record(ba, 0x0227\n    /* BrtLegacyDrawing */\n    , write_RelID(\"rId\" + rId));\n    ws['!legacy'] = rId;\n  }\n}\n\nfunction write_AUTOFILTER(ba, ws, wb, idx) {\n  if (!ws['!autofilter']) return;\n  var data = ws['!autofilter'];\n  var ref = typeof data.ref === \"string\" ? data.ref : encode_range(data.ref);\n  /* Update FilterDatabase defined name for the worksheet */\n\n  if (!wb.Workbook) wb.Workbook = {\n    Sheets: []\n  }\n  /*:any*/\n  ;\n  if (!wb.Workbook.Names) wb.Workbook.Names = [];\n  var names\n  /*: Array<any> */\n  = wb.Workbook.Names;\n  var range = decode_range(ref);\n\n  if (range.s.r == range.e.r) {\n    range.e.r = decode_range(ws[\"!ref\"]).e.r;\n    ref = encode_range(range);\n  }\n\n  for (var i = 0; i < names.length; ++i) {\n    var name = names[i];\n    if (name.Name != '_xlnm._FilterDatabase') continue;\n    if (name.Sheet != idx) continue;\n    name.Ref = \"'\" + wb.SheetNames[idx] + \"'!\" + ref;\n    break;\n  }\n\n  if (i == names.length) names.push({\n    Name: '_xlnm._FilterDatabase',\n    Sheet: idx,\n    Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref\n  });\n  write_record(ba, 0x00A1\n  /* BrtBeginAFilter */\n  , write_UncheckedRfX(safe_decode_range(ref)));\n  /* *FILTERCOLUMN */\n\n  /* [SORTSTATE] */\n\n  /* BrtEndAFilter */\n\n  write_record(ba, 0x00A2\n  /* BrtEndAFilter */\n  );\n}\n\nfunction write_WSVIEWS2(ba, ws, Workbook) {\n  write_record(ba, 0x0085\n  /* BrtBeginWsViews */\n  );\n  {\n    /* 1*WSVIEW2 */\n\n    /* [ACUID] */\n    write_record(ba, 0x0089\n    /* BrtBeginWsView */\n    , write_BrtBeginWsView(ws, Workbook));\n    /* [BrtPane] */\n\n    /* *4BrtSel */\n\n    /* *4SXSELECT */\n\n    /* *FRT */\n\n    write_record(ba, 0x008A\n    /* BrtEndWsView */\n    );\n  }\n  /* *FRT */\n\n  write_record(ba, 0x0086\n  /* BrtEndWsViews */\n  );\n}\n\nfunction\n  /*::ba, ws*/\nwrite_WSFMTINFO() {\n  /* [ACWSFMTINFO] */\n  // write_record(ba, 0x01E5 /* BrtWsFmtInfo */, write_BrtWsFmtInfo(ws));\n}\n\nfunction write_SHEETPROTECT(ba, ws) {\n  if (!ws['!protect']) return;\n  /* [BrtSheetProtectionIso] */\n\n  write_record(ba, 0x0217\n  /* BrtSheetProtection */\n  , write_BrtSheetProtection(ws['!protect']));\n}\n\nfunction write_ws_bin(idx\n/*:number*/\n, opts, wb\n/*:Workbook*/\n, rels) {\n  var ba = buf_array();\n  var s = wb.SheetNames[idx],\n      ws = wb.Sheets[s] || {};\n  var c\n  /*:string*/\n  = s;\n\n  try {\n    if (wb && wb.Workbook) c = wb.Workbook.Sheets[idx].CodeName || c;\n  } catch (e) {}\n\n  var r = safe_decode_range(ws['!ref'] || \"A1\");\n\n  if (r.e.c > 0x3FFF || r.e.r > 0xFFFFF) {\n    if (opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:XFD1048576\");\n    r.e.c = Math.min(r.e.c, 0x3FFF);\n    r.e.r = Math.min(r.e.c, 0xFFFFF);\n  }\n\n  ws['!links'] = [];\n  /* passed back to write_zip and removed there */\n\n  ws['!comments'] = [];\n  write_record(ba, 0x0081\n  /* BrtBeginSheet */\n  );\n  if (wb.vbaraw || ws['!outline']) write_record(ba, 0x0093\n  /* BrtWsProp */\n  , write_BrtWsProp(c, ws['!outline']));\n  write_record(ba, 0x0094\n  /* BrtWsDim */\n  , write_BrtWsDim(r));\n  write_WSVIEWS2(ba, ws, wb.Workbook);\n  write_WSFMTINFO(ba, ws);\n  write_COLINFOS(ba, ws, idx, opts, wb);\n  write_CELLTABLE(ba, ws, idx, opts, wb);\n  /* [BrtSheetCalcProp] */\n\n  write_SHEETPROTECT(ba, ws);\n  /* *([BrtRangeProtectionIso] BrtRangeProtection) */\n\n  /* [SCENMAN] */\n\n  write_AUTOFILTER(ba, ws, wb, idx);\n  /* [SORTSTATE] */\n\n  /* [DCON] */\n\n  /* [USERSHVIEWS] */\n\n  write_MERGECELLS(ba, ws);\n  /* [BrtPhoneticInfo] */\n\n  /* *CONDITIONALFORMATTING */\n\n  /* [DVALS] */\n\n  write_HLINKS(ba, ws, rels);\n  /* [BrtPrintOptions] */\n\n  if (ws['!margins']) write_record(ba, 0x01DC\n  /* BrtMargins */\n  , write_BrtMargins(ws['!margins']));\n  /* [BrtPageSetup] */\n\n  /* [HEADERFOOTER] */\n\n  /* [RWBRK] */\n\n  /* [COLBRK] */\n\n  /* *BrtBigName */\n\n  /* [CELLWATCHES] */\n\n  if (!opts || opts.ignoreEC || opts.ignoreEC == void 0) write_IGNOREECS(ba, ws);\n  /* [SMARTTAGS] */\n\n  /* [BrtDrawing] */\n\n  write_LEGACYDRAWING(ba, ws, idx, rels);\n  /* [BrtLegacyDrawingHF] */\n\n  /* [BrtBkHim] */\n\n  /* [OLEOBJECTS] */\n\n  /* [ACTIVEXCONTROLS] */\n\n  /* [WEBPUBITEMS] */\n\n  /* [LISTPARTS] */\n\n  /* FRTWORKSHEET */\n\n  write_record(ba, 0x0082\n  /* BrtEndSheet */\n  );\n  return ba.end();\n}\n\nfunction parse_Cache(data\n/*:string*/\n)\n/*:[Array<number|string>, string, ?string]*/\n{\n  var col\n  /*:Array<number|string>*/\n  = [];\n  var num = data.match(/^<c:numCache>/);\n  var f;\n  /* 21.2.2.150 pt CT_NumVal */\n\n  (data.match(/<c:pt idx=\"(\\d*)\">(.*?)<\\/c:pt>/mg) || []).forEach(function (pt) {\n    var q = pt.match(/<c:pt idx=\"(\\d*?)\"><c:v>(.*)<\\/c:v><\\/c:pt>/);\n    if (!q) return;\n    col[+q[1]] = num ? +q[2] : q[2];\n  });\n  /* 21.2.2.71 formatCode CT_Xstring */\n\n  var nf = unescapexml((data.match(/<c:formatCode>([\\s\\S]*?)<\\/c:formatCode>/) || [\"\", \"General\"])[1]);\n  (data.match(/<c:f>(.*?)<\\/c:f>/mg) || []).forEach(function (F) {\n    f = F.replace(/<.*?>/g, \"\");\n  });\n  return [col, nf, f];\n}\n/* 21.2 DrawingML - Charts */\n\n\nfunction parse_chart(data\n/*:?string*/\n, name\n/*:string*/\n, opts, rels, wb, csheet) {\n  var cs\n  /*:Worksheet*/\n  = csheet || {\n    \"!type\": \"chart\"\n  }\n  /*:any*/\n  ;\n  if (!data) return csheet;\n  /* 21.2.2.27 chart CT_Chart */\n\n  var C = 0,\n      R = 0,\n      col = \"A\";\n  var refguess = {\n    s: {\n      r: 2000000,\n      c: 2000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  /* 21.2.2.120 numCache CT_NumData */\n\n  (data.match(/<c:numCache>[\\s\\S]*?<\\/c:numCache>/gm) || []).forEach(function (nc) {\n    var cache = parse_Cache(nc);\n    refguess.s.r = refguess.s.c = 0;\n    refguess.e.c = C;\n    col = encode_col(C);\n    cache[0].forEach(function (n, i) {\n      cs[col + encode_row(i)] = {\n        t: 'n',\n        v: n,\n        z: cache[1]\n      };\n      R = i;\n    });\n    if (refguess.e.r < R) refguess.e.r = R;\n    ++C;\n  });\n  if (C > 0) cs[\"!ref\"] = encode_range(refguess);\n  return cs;\n}\n/* 18.3 Worksheets also covers Chartsheets */\n\n\nfunction parse_cs_xml(data\n/*:?string*/\n, opts, idx\n/*:number*/\n, rels, wb\n/*::, themes, styles*/\n)\n/*:Worksheet*/\n{\n  if (!data) return data;\n  /* 18.3.1.12 chartsheet CT_ChartSheet */\n\n  if (!rels) rels = {\n    '!id': {}\n  };\n  var s = {\n    '!type': \"chart\",\n    '!drawel': null,\n    '!rel': \"\"\n  }\n  /*:any*/\n  ;\n  var m;\n  /* 18.3.1.83 sheetPr CT_ChartsheetPr */\n\n  var sheetPr = data.match(sheetprregex);\n  if (sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n  /* 18.3.1.36 drawing CT_Drawing */\n\n  if (m = data.match(/drawing r:id=\"(.*?)\"/)) s['!rel'] = m[1];\n  if (rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n  return s;\n}\n\nfunction write_cs_xml(idx\n/*:number*/\n, opts, wb\n/*:Workbook*/\n, rels)\n/*:string*/\n{\n  var o = [XML_HEADER, writextag('chartsheet', null, {\n    'xmlns': XMLNS_main[0],\n    'xmlns:r': XMLNS.r\n  })];\n  o[o.length] = writextag(\"drawing\", null, {\n    \"r:id\": \"rId1\"\n  });\n  add_rels(rels, -1, \"../drawings/drawing\" + (idx + 1) + \".xml\", RELS.DRAW);\n\n  if (o.length > 2) {\n    o[o.length] = '</chartsheet>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* [MS-XLSB] 2.4.331 BrtCsProp */\n\n\nfunction parse_BrtCsProp(data, length\n/*:number*/\n) {\n  data.l += 10;\n  var name = parse_XLWideString(data, length - 10);\n  return {\n    name: name\n  };\n}\n/* [MS-XLSB] 2.1.7.7 Chart Sheet */\n\n\nfunction parse_cs_bin(data, opts, idx\n/*:number*/\n, rels, wb\n/*::, themes, styles*/\n)\n/*:Worksheet*/\n{\n  if (!data) return data;\n  if (!rels) rels = {\n    '!id': {}\n  };\n  var s = {\n    '!type': \"chart\",\n    '!drawel': null,\n    '!rel': \"\"\n  };\n  var state\n  /*:Array<string>*/\n  = [];\n  var pass = false;\n  recordhopper(data, function cs_parse(val, R, RT) {\n    switch (RT) {\n      case 0x0226:\n        /* 'BrtDrawing' */\n        s['!rel'] = val;\n        break;\n\n      case 0x028B:\n        /* 'BrtCsProp' */\n        if (!wb.Sheets[idx]) wb.Sheets[idx] = {};\n        if (val.name) wb.Sheets[idx].CodeName = val.name;\n        break;\n\n      case 0x0232:\n      /* 'BrtBkHim' */\n\n      case 0x028C:\n      /* 'BrtCsPageSetup' */\n\n      case 0x029D:\n      /* 'BrtCsProtection' */\n\n      case 0x02A7:\n      /* 'BrtCsProtectionIso' */\n\n      case 0x0227:\n      /* 'BrtLegacyDrawing' */\n\n      case 0x0228:\n      /* 'BrtLegacyDrawingHF' */\n\n      case 0x01DC:\n      /* 'BrtMargins' */\n\n      case 0x0C00:\n        /* 'BrtUid' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* 'BrtACBegin' */\n        state.push(RT);\n        break;\n\n      case 0x0026:\n        /* 'BrtACEnd' */\n        state.pop();\n        break;\n\n      default:\n        if (R.T > 0) state.push(RT);else if (R.T < 0) state.pop();else if (!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  }, opts);\n  if (rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n  return s;\n}\n\nfunction\n  /*::idx:number, opts, wb:Workbook, rels*/\nwrite_cs_bin() {\n  var ba = buf_array();\n  write_record(ba, 0x0081\n  /* BrtBeginSheet */\n  );\n  /* [BrtCsProp] */\n\n  /* CSVIEWS */\n\n  /* [[BrtCsProtectionIso] BrtCsProtection] */\n\n  /* [USERCSVIEWS] */\n\n  /* [BrtMargins] */\n\n  /* [BrtCsPageSetup] */\n\n  /* [HEADERFOOTER] */\n\n  /* BrtDrawing */\n\n  /* [BrtLegacyDrawing] */\n\n  /* [BrtLegacyDrawingHF] */\n\n  /* [BrtBkHim] */\n\n  /* [WEBPUBITEMS] */\n\n  /* FRTCHARTSHEET */\n\n  write_record(ba, 0x0082\n  /* BrtEndSheet */\n  );\n  return ba.end();\n}\n/* 18.2.28 (CT_WorkbookProtection) Defaults */\n\n\nvar WBPropsDef = [['allowRefreshQuery', false, \"bool\"], ['autoCompressPictures', true, \"bool\"], ['backupFile', false, \"bool\"], ['checkCompatibility', false, \"bool\"], ['CodeName', ''], ['date1904', false, \"bool\"], ['defaultThemeVersion', 0, \"int\"], ['filterPrivacy', false, \"bool\"], ['hidePivotFieldList', false, \"bool\"], ['promptedSolutions', false, \"bool\"], ['publishItems', false, \"bool\"], ['refreshAllConnections', false, \"bool\"], ['saveExternalLinkValues', true, \"bool\"], ['showBorderUnselectedTables', true, \"bool\"], ['showInkAnnotation', true, \"bool\"], ['showObjects', 'all'], ['showPivotChartFilter', false, \"bool\"], ['updateLinks', 'userSet']];\n/* 18.2.30 (CT_BookView) Defaults */\n\nvar WBViewDef = [['activeTab', 0, \"int\"], ['autoFilterDateGrouping', true, \"bool\"], ['firstSheet', 0, \"int\"], ['minimized', false, \"bool\"], ['showHorizontalScroll', true, \"bool\"], ['showSheetTabs', true, \"bool\"], ['showVerticalScroll', true, \"bool\"], ['tabRatio', 600, \"int\"], ['visibility', 'visible'] //window{Height,Width}, {x,y}Window\n];\n/* 18.2.19 (CT_Sheet) Defaults */\n\nvar SheetDef = [//['state', 'visible']\n];\n/* 18.2.2  (CT_CalcPr) Defaults */\n\nvar CalcPrDef = [['calcCompleted', 'true'], ['calcMode', 'auto'], ['calcOnSave', 'true'], ['concurrentCalc', 'true'], ['fullCalcOnLoad', 'false'], ['fullPrecision', 'true'], ['iterate', 'false'], ['iterateCount', '100'], ['iterateDelta', '0.001'], ['refMode', 'A1']];\n/* 18.2.3 (CT_CustomWorkbookView) Defaults */\n\n/*var CustomWBViewDef = [\n\t['autoUpdate', 'false'],\n\t['changesSavedWin', 'false'],\n\t['includeHiddenRowCol', 'true'],\n\t['includePrintSettings', 'true'],\n\t['maximized', 'false'],\n\t['minimized', 'false'],\n\t['onlySync', 'false'],\n\t['personalView', 'false'],\n\t['showComments', 'commIndicator'],\n\t['showFormulaBar', 'true'],\n\t['showHorizontalScroll', 'true'],\n\t['showObjects', 'all'],\n\t['showSheetTabs', 'true'],\n\t['showStatusbar', 'true'],\n\t['showVerticalScroll', 'true'],\n\t['tabRatio', '600'],\n\t['xWindow', '0'],\n\t['yWindow', '0']\n];*/\n\nfunction push_defaults_array(target, defaults) {\n  for (var j = 0; j != target.length; ++j) {\n    var w = target[j];\n\n    for (var i = 0; i != defaults.length; ++i) {\n      var z = defaults[i];\n      if (w[z[0]] == null) w[z[0]] = z[1];else switch (z[2]) {\n        case \"bool\":\n          if (typeof w[z[0]] == \"string\") w[z[0]] = parsexmlbool(w[z[0]]);\n          break;\n\n        case \"int\":\n          if (typeof w[z[0]] == \"string\") w[z[0]] = parseInt(w[z[0]], 10);\n          break;\n      }\n    }\n  }\n}\n\nfunction push_defaults(target, defaults) {\n  for (var i = 0; i != defaults.length; ++i) {\n    var z = defaults[i];\n    if (target[z[0]] == null) target[z[0]] = z[1];else switch (z[2]) {\n      case \"bool\":\n        if (typeof target[z[0]] == \"string\") target[z[0]] = parsexmlbool(target[z[0]]);\n        break;\n\n      case \"int\":\n        if (typeof target[z[0]] == \"string\") target[z[0]] = parseInt(target[z[0]], 10);\n        break;\n    }\n  }\n}\n\nfunction parse_wb_defaults(wb) {\n  push_defaults(wb.WBProps, WBPropsDef);\n  push_defaults(wb.CalcPr, CalcPrDef);\n  push_defaults_array(wb.WBView, WBViewDef);\n  push_defaults_array(wb.Sheets, SheetDef);\n  _ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904);\n}\n\nfunction safe1904(wb\n/*:Workbook*/\n)\n/*:string*/\n{\n  /* TODO: store date1904 somewhere else */\n  if (!wb.Workbook) return \"false\";\n  if (!wb.Workbook.WBProps) return \"false\";\n  return parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\n}\n\nvar badchars = /*#__PURE__*/\"][*?\\/\\\\\".split(\"\");\n\nfunction check_ws_name(n\n/*:string*/\n, safe\n/*:?boolean*/\n)\n/*:boolean*/\n{\n  if (n.length > 31) {\n    if (safe) return false;\n    throw new Error(\"Sheet names cannot exceed 31 chars\");\n  }\n\n  var _good = true;\n  badchars.forEach(function (c) {\n    if (n.indexOf(c) == -1) return;\n    if (!safe) throw new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");\n    _good = false;\n  });\n  return _good;\n}\n\nfunction check_wb_names(N, S, codes) {\n  N.forEach(function (n, i) {\n    check_ws_name(n);\n\n    for (var j = 0; j < i; ++j) if (n == N[j]) throw new Error(\"Duplicate Sheet Name: \" + n);\n\n    if (codes) {\n      var cn = S && S[i] && S[i].CodeName || n;\n      if (cn.charCodeAt(0) == 95 && cn.length > 22) throw new Error(\"Bad Code Name: Worksheet\" + cn);\n    }\n  });\n}\n\nfunction check_wb(wb) {\n  if (!wb || !wb.SheetNames || !wb.Sheets) throw new Error(\"Invalid Workbook\");\n  if (!wb.SheetNames.length) throw new Error(\"Workbook is empty\");\n  var Sheets = wb.Workbook && wb.Workbook.Sheets || [];\n  check_wb_names(wb.SheetNames, Sheets, !!wb.vbaraw);\n\n  for (var i = 0; i < wb.SheetNames.length; ++i) check_ws(wb.Sheets[wb.SheetNames[i]], wb.SheetNames[i], i);\n  /* TODO: validate workbook */\n\n}\n/* 18.2 Workbook */\n\n\nvar wbnsregex = /<\\w+:workbook/;\n\nfunction parse_wb_xml(data, opts)\n/*:WorkbookFile*/\n{\n  if (!data) throw new Error(\"Could not find file\");\n  var wb =\n  /*::(*/\n  {\n    AppVersion: {},\n    WBProps: {},\n    WBView: [],\n    Sheets: [],\n    CalcPr: {},\n    Names: [],\n    xmlns: \"\"\n  }\n  /*::)*/\n  ;\n  var pass = false,\n      xmlns = \"xmlns\";\n  var dname = {},\n      dnstart = 0;\n  data.replace(tagregex, function xml_wb(x, idx) {\n    var y\n    /*:any*/\n    = parsexmltag(x);\n\n    switch (strip_ns(y[0])) {\n      case '<?xml':\n        break;\n\n      /* 18.2.27 workbook CT_Workbook 1 */\n\n      case '<workbook':\n        if (x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n        wb.xmlns = y[xmlns];\n        break;\n\n      case '</workbook>':\n        break;\n\n      /* 18.2.13 fileVersion CT_FileVersion ? */\n\n      case '<fileVersion':\n        delete y[0];\n        wb.AppVersion = y;\n        break;\n\n      case '<fileVersion/>':\n      case '</fileVersion>':\n        break;\n\n      /* 18.2.12 fileSharing CT_FileSharing ? */\n\n      case '<fileSharing':\n        break;\n\n      case '<fileSharing/>':\n        break;\n\n      /* 18.2.28 workbookPr CT_WorkbookPr ? */\n\n      case '<workbookPr':\n      case '<workbookPr/>':\n        WBPropsDef.forEach(function (w) {\n          if (y[w[0]] == null) return;\n\n          switch (w[2]) {\n            case \"bool\":\n              wb.WBProps[w[0]] = parsexmlbool(y[w[0]]);\n              break;\n\n            case \"int\":\n              wb.WBProps[w[0]] = parseInt(y[w[0]], 10);\n              break;\n\n            default:\n              wb.WBProps[w[0]] = y[w[0]];\n          }\n        });\n        if (y.codeName) wb.WBProps.CodeName = utf8read(y.codeName);\n        break;\n\n      case '</workbookPr>':\n        break;\n\n      /* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n\n      case '<workbookProtection':\n        break;\n\n      case '<workbookProtection/>':\n        break;\n\n      /* 18.2.1  bookViews CT_BookViews ? */\n\n      case '<bookViews':\n      case '<bookViews>':\n      case '</bookViews>':\n        break;\n\n      /* 18.2.30   workbookView CT_BookView + */\n\n      case '<workbookView':\n      case '<workbookView/>':\n        delete y[0];\n        wb.WBView.push(y);\n        break;\n\n      case '</workbookView>':\n        break;\n\n      /* 18.2.20 sheets CT_Sheets 1 */\n\n      case '<sheets':\n      case '<sheets>':\n      case '</sheets>':\n        break;\n      // aggregate sheet\n\n      /* 18.2.19   sheet CT_Sheet + */\n\n      case '<sheet':\n        switch (y.state) {\n          case \"hidden\":\n            y.Hidden = 1;\n            break;\n\n          case \"veryHidden\":\n            y.Hidden = 2;\n            break;\n\n          default:\n            y.Hidden = 0;\n        }\n\n        delete y.state;\n        y.name = unescapexml(utf8read(y.name));\n        delete y[0];\n        wb.Sheets.push(y);\n        break;\n\n      case '</sheet>':\n        break;\n\n      /* 18.2.15 functionGroups CT_FunctionGroups ? */\n\n      case '<functionGroups':\n      case '<functionGroups/>':\n        break;\n\n      /* 18.2.14   functionGroup CT_FunctionGroup + */\n\n      case '<functionGroup':\n        break;\n\n      /* 18.2.9  externalReferences CT_ExternalReferences ? */\n\n      case '<externalReferences':\n      case '</externalReferences>':\n      case '<externalReferences>':\n        break;\n\n      /* 18.2.8    externalReference CT_ExternalReference + */\n\n      case '<externalReference':\n        break;\n\n      /* 18.2.6  definedNames CT_DefinedNames ? */\n\n      case '<definedNames/>':\n        break;\n\n      case '<definedNames>':\n      case '<definedNames':\n        pass = true;\n        break;\n\n      case '</definedNames>':\n        pass = false;\n        break;\n\n      /* 18.2.5    definedName CT_DefinedName + */\n\n      case '<definedName':\n        {\n          dname = {};\n          dname.Name = utf8read(y.name);\n          if (y.comment) dname.Comment = y.comment;\n          if (y.localSheetId) dname.Sheet = +y.localSheetId;\n          if (parsexmlbool(y.hidden || \"0\")) dname.Hidden = true;\n          dnstart = idx + x.length;\n        }\n        break;\n\n      case '</definedName>':\n        {\n          dname.Ref = unescapexml(utf8read(data.slice(dnstart, idx)));\n          wb.Names.push(dname);\n        }\n        break;\n\n      case '<definedName/>':\n        break;\n\n      /* 18.2.2  calcPr CT_CalcPr ? */\n\n      case '<calcPr':\n        delete y[0];\n        wb.CalcPr = y;\n        break;\n\n      case '<calcPr/>':\n        delete y[0];\n        wb.CalcPr = y;\n        break;\n\n      case '</calcPr>':\n        break;\n\n      /* 18.2.16 oleSize CT_OleSize ? (ref required) */\n\n      case '<oleSize':\n        break;\n\n      /* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n\n      case '<customWorkbookViews>':\n      case '</customWorkbookViews>':\n      case '<customWorkbookViews':\n        break;\n\n      /* 18.2.3  customWorkbookView CT_CustomWorkbookView + */\n\n      case '<customWorkbookView':\n      case '</customWorkbookView>':\n        break;\n\n      /* 18.2.18 pivotCaches CT_PivotCaches ? */\n\n      case '<pivotCaches>':\n      case '</pivotCaches>':\n      case '<pivotCaches':\n        break;\n\n      /* 18.2.17 pivotCache CT_PivotCache ? */\n\n      case '<pivotCache':\n        break;\n\n      /* 18.2.21 smartTagPr CT_SmartTagPr ? */\n\n      case '<smartTagPr':\n      case '<smartTagPr/>':\n        break;\n\n      /* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n\n      case '<smartTagTypes':\n      case '<smartTagTypes>':\n      case '</smartTagTypes>':\n        break;\n\n      /* 18.2.22 smartTagType CT_SmartTagType ? */\n\n      case '<smartTagType':\n        break;\n\n      /* 18.2.24 webPublishing CT_WebPublishing ? */\n\n      case '<webPublishing':\n      case '<webPublishing/>':\n        break;\n\n      /* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n\n      case '<fileRecoveryPr':\n      case '<fileRecoveryPr/>':\n        break;\n\n      /* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n\n      case '<webPublishObjects>':\n      case '<webPublishObjects':\n      case '</webPublishObjects>':\n        break;\n\n      /* 18.2.25 webPublishObject CT_WebPublishObject ? */\n\n      case '<webPublishObject':\n        break;\n\n      /* 18.2.10 extLst CT_ExtensionList ? */\n\n      case '<extLst':\n      case '<extLst>':\n      case '</extLst>':\n      case '<extLst/>':\n        break;\n\n      /* 18.2.7  ext CT_Extension + */\n\n      case '<ext':\n        pass = true;\n        break;\n      //TODO: check with versions of excel\n\n      case '</ext>':\n        pass = false;\n        break;\n\n      /* Others */\n\n      case '<ArchID':\n        break;\n\n      case '<AlternateContent':\n      case '<AlternateContent>':\n        pass = true;\n        break;\n\n      case '</AlternateContent>':\n        pass = false;\n        break;\n\n      /* TODO */\n\n      case '<revisionPtr':\n        break;\n\n      default:\n        if (!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in workbook');\n    }\n\n    return x;\n  });\n  if (XMLNS_main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n  parse_wb_defaults(wb);\n  return wb;\n}\n\nfunction write_wb_xml(wb\n/*:Workbook*/\n\n/*::, opts:?WriteOpts*/\n)\n/*:string*/\n{\n  var o = [XML_HEADER];\n  o[o.length] = writextag('workbook', null, {\n    'xmlns': XMLNS_main[0],\n    //'xmlns:mx': XMLNS.mx,\n    //'xmlns:s': XMLNS_main[0],\n    'xmlns:r': XMLNS.r\n  });\n  var write_names = wb.Workbook && (wb.Workbook.Names || []).length > 0;\n  /* fileVersion */\n\n  /* fileSharing */\n\n  var workbookPr\n  /*:any*/\n  = {\n    codeName: \"ThisWorkbook\"\n  }\n  /*:any*/\n  ;\n\n  if (wb.Workbook && wb.Workbook.WBProps) {\n    WBPropsDef.forEach(function (x) {\n      /*:: if(!wb.Workbook || !wb.Workbook.WBProps) throw \"unreachable\"; */\n      if (wb.Workbook.WBProps[x[0]]\n      /*:any*/\n      == null) return;\n      if (wb.Workbook.WBProps[x[0]]\n      /*:any*/\n      == x[1]) return;\n      workbookPr[x[0]] = wb.Workbook.WBProps[x[0]]\n      /*:any*/\n      ;\n    });\n    /*:: if(!wb.Workbook || !wb.Workbook.WBProps) throw \"unreachable\"; */\n\n    if (wb.Workbook.WBProps.CodeName) {\n      workbookPr.codeName = wb.Workbook.WBProps.CodeName;\n      delete workbookPr.CodeName;\n    }\n  }\n\n  o[o.length] = writextag('workbookPr', null, workbookPr);\n  /* workbookProtection */\n\n  var sheets = wb.Workbook && wb.Workbook.Sheets || [];\n  var i = 0;\n  /* bookViews only written if first worksheet is hidden */\n\n  if (sheets && sheets[0] && !!sheets[0].Hidden) {\n    o[o.length] = \"<bookViews>\";\n\n    for (i = 0; i != wb.SheetNames.length; ++i) {\n      if (!sheets[i]) break;\n      if (!sheets[i].Hidden) break;\n    }\n\n    if (i == wb.SheetNames.length) i = 0;\n    o[o.length] = '<workbookView firstSheet=\"' + i + '\" activeTab=\"' + i + '\"/>';\n    o[o.length] = \"</bookViews>\";\n  }\n\n  o[o.length] = \"<sheets>\";\n\n  for (i = 0; i != wb.SheetNames.length; ++i) {\n    var sht = {\n      name: escapexml(wb.SheetNames[i].slice(0, 31))\n    }\n    /*:any*/\n    ;\n    sht.sheetId = \"\" + (i + 1);\n    sht[\"r:id\"] = \"rId\" + (i + 1);\n    if (sheets[i]) switch (sheets[i].Hidden) {\n      case 1:\n        sht.state = \"hidden\";\n        break;\n\n      case 2:\n        sht.state = \"veryHidden\";\n        break;\n    }\n    o[o.length] = writextag('sheet', null, sht);\n  }\n\n  o[o.length] = \"</sheets>\";\n  /* functionGroups */\n\n  /* externalReferences */\n\n  if (write_names) {\n    o[o.length] = \"<definedNames>\";\n    if (wb.Workbook && wb.Workbook.Names) wb.Workbook.Names.forEach(function (n) {\n      var d\n      /*:any*/\n      = {\n        name: n.Name\n      };\n      if (n.Comment) d.comment = n.Comment;\n      if (n.Sheet != null) d.localSheetId = \"\" + n.Sheet;\n      if (n.Hidden) d.hidden = \"1\";\n      if (!n.Ref) return;\n      o[o.length] = writextag('definedName', escapexml(n.Ref), d);\n    });\n    o[o.length] = \"</definedNames>\";\n  }\n  /* calcPr */\n\n  /* oleSize */\n\n  /* customWorkbookViews */\n\n  /* pivotCaches */\n\n  /* smartTagPr */\n\n  /* smartTagTypes */\n\n  /* webPublishing */\n\n  /* fileRecoveryPr */\n\n  /* webPublishObjects */\n\n  /* extLst */\n\n\n  if (o.length > 2) {\n    o[o.length] = '</workbook>';\n    o[1] = o[1].replace(\"/>\", \">\");\n  }\n\n  return o.join(\"\");\n}\n/* [MS-XLSB] 2.4.304 BrtBundleSh */\n\n\nfunction parse_BrtBundleSh(data, length\n/*:number*/\n) {\n  var z = {};\n  z.Hidden = data.read_shift(4); //hsState ST_SheetState\n\n  z.iTabID = data.read_shift(4);\n  z.strRelID = parse_RelID(data, length - 8);\n  z.name = parse_XLWideString(data);\n  return z;\n}\n\nfunction write_BrtBundleSh(data, o) {\n  if (!o) o = new_buf(127);\n  o.write_shift(4, data.Hidden);\n  o.write_shift(4, data.iTabID);\n  write_RelID(data.strRelID, o);\n  write_XLWideString(data.name.slice(0, 31), o);\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.815 BrtWbProp */\n\n\nfunction parse_BrtWbProp(data, length)\n/*:WBProps*/\n{\n  var o\n  /*:WBProps*/\n  = {}\n  /*:any*/\n  ;\n  var flags = data.read_shift(4);\n  o.defaultThemeVersion = data.read_shift(4);\n  var strName = length > 8 ? parse_XLWideString(data) : \"\";\n  if (strName.length > 0) o.CodeName = strName;\n  o.autoCompressPictures = !!(flags & 0x10000);\n  o.backupFile = !!(flags & 0x40);\n  o.checkCompatibility = !!(flags & 0x1000);\n  o.date1904 = !!(flags & 0x01);\n  o.filterPrivacy = !!(flags & 0x08);\n  o.hidePivotFieldList = !!(flags & 0x400);\n  o.promptedSolutions = !!(flags & 0x10);\n  o.publishItems = !!(flags & 0x800);\n  o.refreshAllConnections = !!(flags & 0x40000);\n  o.saveExternalLinkValues = !!(flags & 0x80);\n  o.showBorderUnselectedTables = !!(flags & 0x04);\n  o.showInkAnnotation = !!(flags & 0x20);\n  o.showObjects = [\"all\", \"placeholders\", \"none\"][flags >> 13 & 0x03];\n  o.showPivotChartFilter = !!(flags & 0x8000);\n  o.updateLinks = [\"userSet\", \"never\", \"always\"][flags >> 8 & 0x03];\n  return o;\n}\n\nfunction write_BrtWbProp(data\n/*:?WBProps*/\n, o) {\n  if (!o) o = new_buf(72);\n  var flags = 0;\n\n  if (data) {\n    /* TODO: mirror parse_BrtWbProp fields */\n    if (data.filterPrivacy) flags |= 0x08;\n  }\n\n  o.write_shift(4, flags);\n  o.write_shift(4, 0);\n  write_XLSBCodeName(data && data.CodeName || \"ThisWorkbook\", o);\n  return o.slice(0, o.l);\n}\n\nfunction parse_BrtFRTArchID$(data, length) {\n  var o = {};\n  data.read_shift(4);\n  o.ArchID = data.read_shift(4);\n  data.l += length - 8;\n  return o;\n}\n/* [MS-XLSB] 2.4.687 BrtName */\n\n\nfunction parse_BrtName(data, length, opts) {\n  var end = data.l + length;\n  data.l += 4; //var flags = data.read_shift(4);\n\n  data.l += 1; //var chKey = data.read_shift(1);\n\n  var itab = data.read_shift(4);\n  var name = parse_XLNameWideString(data);\n  var formula = parse_XLSBNameParsedFormula(data, 0, opts);\n  var comment = parse_XLNullableWideString(data); //if(0 /* fProc */) {\n  // unusedstring1: XLNullableWideString\n  // description: XLNullableWideString\n  // helpTopic: XLNullableWideString\n  // unusedstring2: XLNullableWideString\n  //}\n\n  data.l = end;\n  var out = {\n    Name: name,\n    Ptg: formula\n  }\n  /*:any*/\n  ;\n  if (itab < 0xFFFFFFF) out.Sheet = itab;\n  if (comment) out.Comment = comment;\n  return out;\n}\n/* [MS-XLSB] 2.1.7.61 Workbook */\n\n\nfunction parse_wb_bin(data, opts)\n/*:WorkbookFile*/\n{\n  var wb = {\n    AppVersion: {},\n    WBProps: {},\n    WBView: [],\n    Sheets: [],\n    CalcPr: {},\n    xmlns: \"\"\n  };\n  var state\n  /*:Array<string>*/\n  = [];\n  var pass = false;\n  if (!opts) opts = {};\n  opts.biff = 12;\n  var Names = [];\n  var supbooks = [[]]\n  /*:any*/\n  ;\n  supbooks.SheetNames = [];\n  supbooks.XTI = [];\n  XLSBRecordEnum[0x0010] = {\n    n: \"BrtFRTArchID$\",\n    f: parse_BrtFRTArchID$\n  };\n  recordhopper(data, function hopper_wb(val, R, RT) {\n    switch (RT) {\n      case 0x009C:\n        /* 'BrtBundleSh' */\n        supbooks.SheetNames.push(val.name);\n        wb.Sheets.push(val);\n        break;\n\n      case 0x0099:\n        /* 'BrtWbProp' */\n        wb.WBProps = val;\n        break;\n\n      case 0x0027:\n        /* 'BrtName' */\n        if (val.Sheet != null) opts.SID = val.Sheet;\n        val.Ref = stringify_formula(val.Ptg, null, null, supbooks, opts);\n        delete opts.SID;\n        delete val.Ptg;\n        Names.push(val);\n        break;\n\n      case 0x040C:\n        /* 'BrtNameExt' */\n        break;\n\n      case 0x0165:\n      /* 'BrtSupSelf' */\n\n      case 0x0166:\n      /* 'BrtSupSame' */\n\n      case 0x0163:\n      /* 'BrtSupBookSrc' */\n\n      case 0x029B:\n        /* 'BrtSupAddin' */\n        if (!supbooks[0].length) supbooks[0] = [RT, val];else supbooks.push([RT, val]);\n        supbooks[supbooks.length - 1].XTI = [];\n        break;\n\n      case 0x016A:\n        /* 'BrtExternSheet' */\n        if (supbooks.length === 0) {\n          supbooks[0] = [];\n          supbooks[0].XTI = [];\n        }\n\n        supbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n        supbooks.XTI = supbooks.XTI.concat(val);\n        break;\n\n      case 0x0169:\n        /* 'BrtPlaceholderName' */\n        break;\n\n      case 0x0817:\n      /* 'BrtAbsPath15' */\n\n      case 0x009E:\n      /* 'BrtBookView' */\n\n      case 0x008F:\n      /* 'BrtBeginBundleShs' */\n\n      case 0x0298:\n      /* 'BrtBeginFnGroup' */\n\n      case 0x0161:\n        /* 'BrtBeginExternals' */\n        break;\n\n      /* case 'BrtModelTimeGroupingCalcCol' */\n\n      case 0x0C00:\n      /* 'BrtUid' */\n\n      case 0x0C01:\n      /* 'BrtRevisionPtr' */\n\n      case 0x0216:\n      /* 'BrtBookProtection' */\n\n      case 0x02A5:\n      /* 'BrtBookProtectionIso' */\n\n      case 0x009D:\n      /* 'BrtCalcProp' */\n\n      case 0x0262:\n      /* 'BrtCrashRecErr' */\n\n      case 0x0802:\n      /* 'BrtDecoupledPivotCacheID' */\n\n      case 0x009B:\n      /* 'BrtFileRecover' */\n\n      case 0x0224:\n      /* 'BrtFileSharing' */\n\n      case 0x02A4:\n      /* 'BrtFileSharingIso' */\n\n      case 0x0080:\n      /* 'BrtFileVersion' */\n\n      case 0x0299:\n      /* 'BrtFnGroup' */\n\n      case 0x0850:\n      /* 'BrtModelRelationship' */\n\n      case 0x084D:\n      /* 'BrtModelTable' */\n\n      case 0x0225:\n      /* 'BrtOleSize' */\n\n      case 0x0805:\n      /* 'BrtPivotTableRef' */\n\n      case 0x0254:\n      /* 'BrtSmartTagType' */\n\n      case 0x081C:\n      /* 'BrtTableSlicerCacheID' */\n\n      case 0x081B:\n      /* 'BrtTableSlicerCacheIDs' */\n\n      case 0x0822:\n      /* 'BrtTimelineCachePivotCacheID' */\n\n      case 0x018D:\n      /* 'BrtUserBookView' */\n\n      case 0x009A:\n      /* 'BrtWbFactoid' */\n\n      case 0x045D:\n      /* 'BrtWbProp14' */\n\n      case 0x0229:\n      /* 'BrtWebOpt' */\n\n      case 0x082B:\n        /* 'BrtWorkBookPr15' */\n        break;\n\n      case 0x0023:\n        /* 'BrtFRTBegin' */\n        state.push(RT);\n        pass = true;\n        break;\n\n      case 0x0024:\n        /* 'BrtFRTEnd' */\n        state.pop();\n        pass = false;\n        break;\n\n      case 0x0025:\n        /* 'BrtACBegin' */\n        state.push(RT);\n        pass = true;\n        break;\n\n      case 0x0026:\n        /* 'BrtACEnd' */\n        state.pop();\n        pass = false;\n        break;\n\n      case 0x0010:\n        /* 'BrtFRTArchID$' */\n        break;\n\n      default:\n        if (R.T) {\n          /* empty */\n        } else if (!pass || opts.WTF && state[state.length - 1] != 0x0025\n        /* BrtACBegin */\n        && state[state.length - 1] != 0x0023\n        /* BrtFRTBegin */\n        ) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\n    }\n  }, opts);\n  parse_wb_defaults(wb); // $FlowIgnore\n\n  wb.Names = Names;\n  wb\n  /*:any*/\n  .supbooks = supbooks;\n  return wb;\n}\n\nfunction write_BUNDLESHS(ba, wb\n/*::, opts*/\n) {\n  write_record(ba, 0x008F\n  /* BrtBeginBundleShs */\n  );\n\n  for (var idx = 0; idx != wb.SheetNames.length; ++idx) {\n    var viz = wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx] && wb.Workbook.Sheets[idx].Hidden || 0;\n    var d = {\n      Hidden: viz,\n      iTabID: idx + 1,\n      strRelID: 'rId' + (idx + 1),\n      name: wb.SheetNames[idx]\n    };\n    write_record(ba, 0x009C\n    /* BrtBundleSh */\n    , write_BrtBundleSh(d));\n  }\n\n  write_record(ba, 0x0090\n  /* BrtEndBundleShs */\n  );\n}\n/* [MS-XLSB] 2.4.649 BrtFileVersion */\n\n\nfunction write_BrtFileVersion(data, o) {\n  if (!o) o = new_buf(127);\n\n  for (var i = 0; i != 4; ++i) o.write_shift(4, 0);\n\n  write_XLWideString(\"SheetJS\", o);\n  write_XLWideString(XLSX.version, o);\n  write_XLWideString(XLSX.version, o);\n  write_XLWideString(\"7262\", o);\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.301 BrtBookView */\n\n\nfunction write_BrtBookView(idx, o) {\n  if (!o) o = new_buf(29);\n  o.write_shift(-4, 0);\n  o.write_shift(-4, 460);\n  o.write_shift(4, 28800);\n  o.write_shift(4, 17600);\n  o.write_shift(4, 500);\n  o.write_shift(4, idx);\n  o.write_shift(4, idx);\n  var flags = 0x78;\n  o.write_shift(1, flags);\n  return o.length > o.l ? o.slice(0, o.l) : o;\n}\n\nfunction write_BOOKVIEWS(ba, wb\n/*::, opts*/\n) {\n  /* required if hidden tab appears before visible tab */\n  if (!wb.Workbook || !wb.Workbook.Sheets) return;\n  var sheets = wb.Workbook.Sheets;\n  var i = 0,\n      vistab = -1,\n      hidden = -1;\n\n  for (; i < sheets.length; ++i) {\n    if (!sheets[i] || !sheets[i].Hidden && vistab == -1) vistab = i;else if (sheets[i].Hidden == 1 && hidden == -1) hidden = i;\n  }\n\n  if (hidden > vistab) return;\n  write_record(ba, 0x0087\n  /* BrtBeginBookViews */\n  );\n  write_record(ba, 0x009E\n  /* BrtBookView */\n  , write_BrtBookView(vistab));\n  /* 1*(BrtBookView *FRT) */\n\n  write_record(ba, 0x0088\n  /* BrtEndBookViews */\n  );\n}\n/* [MS-XLSB] 2.4.305 BrtCalcProp */\n\n/*function write_BrtCalcProp(data, o) {\n\tif(!o) o = new_buf(26);\n\to.write_shift(4,0); // force recalc\n\to.write_shift(4,1);\n\to.write_shift(4,0);\n\twrite_Xnum(0, o);\n\to.write_shift(-4, 1023);\n\to.write_shift(1, 0x33);\n\to.write_shift(1, 0x00);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.4.646 BrtFileRecover */\n\n/*function write_BrtFileRecover(data, o) {\n\tif(!o) o = new_buf(1);\n\to.write_shift(1,0);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.1.7.61 Workbook */\n\n\nfunction write_wb_bin(wb, opts) {\n  var ba = buf_array();\n  write_record(ba, 0x0083\n  /* BrtBeginBook */\n  );\n  write_record(ba, 0x0080\n  /* BrtFileVersion */\n  , write_BrtFileVersion());\n  /* [[BrtFileSharingIso] BrtFileSharing] */\n\n  write_record(ba, 0x0099\n  /* BrtWbProp */\n  , write_BrtWbProp(wb.Workbook && wb.Workbook.WBProps || null));\n  /* [ACABSPATH] */\n\n  /* [[BrtBookProtectionIso] BrtBookProtection] */\n\n  write_BOOKVIEWS(ba, wb, opts);\n  write_BUNDLESHS(ba, wb, opts);\n  /* [FNGROUP] */\n\n  /* [EXTERNALS] */\n\n  /* *BrtName */\n\n  /* write_record(ba, 0x009D BrtCalcProp, write_BrtCalcProp()); */\n\n  /* [BrtOleSize] */\n\n  /* *(BrtUserBookView *FRT) */\n\n  /* [PIVOTCACHEIDS] */\n\n  /* [BrtWbFactoid] */\n\n  /* [SMARTTAGTYPES] */\n\n  /* [BrtWebOpt] */\n\n  /* write_record(ba, 0x009B BrtFileRecover, write_BrtFileRecover()); */\n\n  /* [WEBPUBITEMS] */\n\n  /* [CRERRS] */\n\n  /* FRTWORKBOOK */\n\n  write_record(ba, 0x0084\n  /* BrtEndBook */\n  );\n  return ba.end();\n}\n\nfunction parse_wb(data, name\n/*:string*/\n, opts)\n/*:WorkbookFile*/\n{\n  if (name.slice(-4) === \".bin\") return parse_wb_bin(data\n  /*:any*/\n  , opts);\n  return parse_wb_xml(data\n  /*:any*/\n  , opts);\n}\n\nfunction parse_ws(data, name\n/*:string*/\n, idx\n/*:number*/\n, opts, rels, wb, themes, styles)\n/*:Worksheet*/\n{\n  if (name.slice(-4) === \".bin\") return parse_ws_bin(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n  return parse_ws_xml(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_cs(data, name\n/*:string*/\n, idx\n/*:number*/\n, opts, rels, wb, themes, styles)\n/*:Worksheet*/\n{\n  if (name.slice(-4) === \".bin\") return parse_cs_bin(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n  return parse_cs_xml(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ms(data, name\n/*:string*/\n, idx\n/*:number*/\n, opts, rels, wb, themes, styles)\n/*:Worksheet*/\n{\n  if (name.slice(-4) === \".bin\") return parse_ms_bin(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n  return parse_ms_xml(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ds(data, name\n/*:string*/\n, idx\n/*:number*/\n, opts, rels, wb, themes, styles)\n/*:Worksheet*/\n{\n  if (name.slice(-4) === \".bin\") return parse_ds_bin(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n  return parse_ds_xml(data\n  /*:any*/\n  , opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_sty(data, name\n/*:string*/\n, themes, opts) {\n  if (name.slice(-4) === \".bin\") return parse_sty_bin(data\n  /*:any*/\n  , themes, opts);\n  return parse_sty_xml(data\n  /*:any*/\n  , themes, opts);\n}\n\nfunction parse_theme(data\n/*:string*/\n, name\n/*:string*/\n, opts) {\n  return parse_theme_xml(data, opts);\n}\n\nfunction parse_sst(data, name\n/*:string*/\n, opts)\n/*:SST*/\n{\n  if (name.slice(-4) === \".bin\") return parse_sst_bin(data\n  /*:any*/\n  , opts);\n  return parse_sst_xml(data\n  /*:any*/\n  , opts);\n}\n\nfunction parse_cmnt(data, name\n/*:string*/\n, opts)\n/*:Array<RawComment>*/\n{\n  if (name.slice(-4) === \".bin\") return parse_comments_bin(data\n  /*:any*/\n  , opts);\n  return parse_comments_xml(data\n  /*:any*/\n  , opts);\n}\n\nfunction parse_cc(data, name\n/*:string*/\n, opts) {\n  if (name.slice(-4) === \".bin\") return parse_cc_bin(data\n  /*:any*/\n  , name, opts);\n  return parse_cc_xml(data\n  /*:any*/\n  , name, opts);\n}\n\nfunction parse_xlink(data, rel, name\n/*:string*/\n, opts) {\n  if (name.slice(-4) === \".bin\") return parse_xlink_bin(data\n  /*:any*/\n  , rel, name, opts);\n  return parse_xlink_xml(data\n  /*:any*/\n  , rel, name, opts);\n}\n\nfunction parse_xlmeta(data, name\n/*:string*/\n, opts) {\n  if (name.slice(-4) === \".bin\") return parse_xlmeta_bin(data\n  /*:any*/\n  , name, opts);\n  return parse_xlmeta_xml(data\n  /*:any*/\n  , name, opts);\n}\n\nfunction write_wb(wb, name\n/*:string*/\n, opts) {\n  return (name.slice(-4) === \".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\n}\n\nfunction write_ws(data\n/*:number*/\n, name\n/*:string*/\n, opts, wb\n/*:Workbook*/\n, rels) {\n  return (name.slice(-4) === \".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb, rels);\n} // eslint-disable-next-line no-unused-vars\n\n\nfunction write_cs(data\n/*:number*/\n, name\n/*:string*/\n, opts, wb\n/*:Workbook*/\n, rels) {\n  return (name.slice(-4) === \".bin\" ? write_cs_bin : write_cs_xml)(data, opts, wb, rels);\n}\n\nfunction write_sty(data, name\n/*:string*/\n, opts) {\n  return (name.slice(-4) === \".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\n}\n\nfunction write_sst(data\n/*:SST*/\n, name\n/*:string*/\n, opts) {\n  return (name.slice(-4) === \".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\n}\n\nfunction write_cmnt(data\n/*:Array<any>*/\n, name\n/*:string*/\n, opts) {\n  return (name.slice(-4) === \".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\n}\n/*\nfunction write_cc(data, name:string, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\n}\n*/\n\n\nfunction write_xlmeta(name\n/*:string*/\n) {\n  return (name.slice(-4) === \".bin\" ? write_xlmeta_bin : write_xlmeta_xml)();\n}\n\nvar attregexg2 = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\nvar attregex2 = /([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\n\nfunction xlml_parsexmltag(tag\n/*:string*/\n, skip_root\n/*:?boolean*/\n) {\n  var words = tag.split(/\\s+/);\n  var z\n  /*:any*/\n  = []\n  /*:any*/\n  ;\n  if (!skip_root) z[0] = words[0];\n  if (words.length === 1) return z;\n  var m = tag.match(attregexg2),\n      y,\n      j,\n      w,\n      i;\n  if (m) for (i = 0; i != m.length; ++i) {\n    y = m[i].match(attregex2);\n    /*:: if(!y || !y[2]) continue; */\n\n    if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1, y[2].length - 1);else {\n      if (y[1].slice(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].slice(6);else w = y[1].slice(j + 1);\n      z[w] = y[2].slice(1, y[2].length - 1);\n    }\n  }\n  return z;\n}\n\nfunction xlml_parsexmltagobj(tag\n/*:string*/\n) {\n  var words = tag.split(/\\s+/);\n  var z = {};\n  if (words.length === 1) return z;\n  var m = tag.match(attregexg2),\n      y,\n      j,\n      w,\n      i;\n  if (m) for (i = 0; i != m.length; ++i) {\n    y = m[i].match(attregex2);\n    /*:: if(!y || !y[2]) continue; */\n\n    if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1, y[2].length - 1);else {\n      if (y[1].slice(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].slice(6);else w = y[1].slice(j + 1);\n      z[w] = y[2].slice(1, y[2].length - 1);\n    }\n  }\n  return z;\n} // ----\n\n/* map from xlml named formats to SSF TODO: localize */\n\n\nvar XLMLFormatMap\n/*: {[string]:string}*/\n;\n\nfunction xlml_format(format, value)\n/*:string*/\n{\n  var fmt = XLMLFormatMap[format] || unescapexml(format);\n  if (fmt === \"General\") return SSF_general(value);\n  return SSF_format(fmt, value);\n}\n\nfunction xlml_set_custprop(Custprops, key, cp, val\n/*:string*/\n) {\n  var oval\n  /*:any*/\n  = val;\n\n  switch ((cp[0].match(/dt:dt=\"([\\w.]+)\"/) || [\"\", \"\"])[1]) {\n    case \"boolean\":\n      oval = parsexmlbool(val);\n      break;\n\n    case \"i2\":\n    case \"int\":\n      oval = parseInt(val, 10);\n      break;\n\n    case \"r4\":\n    case \"float\":\n      oval = parseFloat(val);\n      break;\n\n    case \"date\":\n    case \"dateTime.tz\":\n      oval = parseDate(val);\n      break;\n\n    case \"i8\":\n    case \"string\":\n    case \"fixed\":\n    case \"uuid\":\n    case \"bin.base64\":\n      break;\n\n    default:\n      throw new Error(\"bad custprop:\" + cp[0]);\n  }\n\n  Custprops[unescapexml(key)] = oval;\n}\n\nfunction safe_format_xlml(cell\n/*:Cell*/\n, nf, o) {\n  if (cell.t === 'z') return;\n  if (!o || o.cellText !== false) try {\n    if (cell.t === 'e') {\n      cell.w = cell.w || BErr[cell.v];\n    } else if (nf === \"General\") {\n      if (cell.t === 'n') {\n        if ((cell.v | 0) === cell.v) cell.w = cell.v.toString(10);else cell.w = SSF_general_num(cell.v);\n      } else cell.w = SSF_general(cell.v);\n    } else cell.w = xlml_format(nf || \"General\", cell.v);\n  } catch (e) {\n    if (o.WTF) throw e;\n  }\n\n  try {\n    var z = XLMLFormatMap[nf] || nf || \"General\";\n    if (o.cellNF) cell.z = z;\n\n    if (o.cellDates && cell.t == 'n' && fmt_is_date(z)) {\n      var _d = SSF_parse_date_code(cell.v);\n\n      if (_d) {\n        cell.t = 'd';\n        cell.v = new Date(_d.y, _d.m - 1, _d.d, _d.H, _d.M, _d.S, _d.u);\n      }\n    }\n  } catch (e) {\n    if (o.WTF) throw e;\n  }\n}\n\nfunction process_style_xlml(styles, stag, opts) {\n  if (opts.cellStyles) {\n    if (stag.Interior) {\n      var I = stag.Interior;\n      if (I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n    }\n  }\n\n  styles[stag.ID] = stag;\n}\n/* TODO: there must exist some form of OSP-blessed spec */\n\n\nfunction parse_xlml_data(xml, ss, data, cell\n/*:any*/\n, base, styles, csty, row, arrayf, o) {\n  var nf = \"General\",\n      sid = cell.StyleID,\n      S = {};\n  o = o || {};\n  var interiors = [];\n  var i = 0;\n  if (sid === undefined && row) sid = row.StyleID;\n  if (sid === undefined && csty) sid = csty.StyleID;\n\n  while (styles[sid] !== undefined) {\n    if (styles[sid].nf) nf = styles[sid].nf;\n    if (styles[sid].Interior) interiors.push(styles[sid].Interior);\n    if (!styles[sid].Parent) break;\n    sid = styles[sid].Parent;\n  }\n\n  switch (data.Type) {\n    case 'Boolean':\n      cell.t = 'b';\n      cell.v = parsexmlbool(xml);\n      break;\n\n    case 'String':\n      cell.t = 's';\n      cell.r = xlml_fixstr(unescapexml(xml));\n      cell.v = xml.indexOf(\"<\") > -1 ? unescapexml(ss || xml).replace(/<.*?>/g, \"\") : cell.r; // todo: BR etc\n\n      break;\n\n    case 'DateTime':\n      if (xml.slice(-1) != \"Z\") xml += \"Z\";\n      cell.v = (parseDate(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n      if (cell.v !== cell.v) cell.v = unescapexml(xml);else if (cell.v < 60) cell.v = cell.v - 1;\n      if (!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\n    /* falls through */\n\n    case 'Number':\n      if (cell.v === undefined) cell.v = +xml;\n      if (!cell.t) cell.t = 'n';\n      break;\n\n    case 'Error':\n      cell.t = 'e';\n      cell.v = RBErr[xml];\n      if (o.cellText !== false) cell.w = xml;\n      break;\n\n    default:\n      if (xml == \"\" && ss == \"\") {\n        cell.t = 'z';\n      } else {\n        cell.t = 's';\n        cell.v = xlml_fixstr(ss || xml);\n      }\n\n      break;\n  }\n\n  safe_format_xlml(cell, nf, o);\n\n  if (o.cellFormula !== false) {\n    if (cell.Formula) {\n      var fstr = unescapexml(cell.Formula);\n      /* strictly speaking, the leading = is required but some writers omit */\n\n      if (fstr.charCodeAt(0) == 61\n      /* = */\n      ) fstr = fstr.slice(1);\n      cell.f = rc_to_a1(fstr, base);\n      delete cell.Formula;\n      if (cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);else if (cell.ArrayRange) {\n        cell.F = rc_to_a1(cell.ArrayRange, base);\n        arrayf.push([safe_decode_range(cell.F), cell.F]);\n      }\n    } else {\n      for (i = 0; i < arrayf.length; ++i) if (base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r) if (base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c) cell.F = arrayf[i][1];\n    }\n  }\n\n  if (o.cellStyles) {\n    interiors.forEach(function (x) {\n      if (!S.patternType && x.patternType) S.patternType = x.patternType;\n    });\n    cell.s = S;\n  }\n\n  if (cell.StyleID !== undefined) cell.ixfe = cell.StyleID;\n}\n\nfunction xlml_clean_comment(comment\n/*:any*/\n) {\n  comment.t = comment.v || \"\";\n  comment.t = comment.t.replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\");\n  comment.v = comment.w = comment.ixfe = undefined;\n}\n/* TODO: Everything */\n\n\nfunction parse_xlml_xml(d, _opts)\n/*:Workbook*/\n{\n  var opts = _opts || {};\n  make_ssf();\n  var str = debom(xlml_normalize(d));\n\n  if (opts.type == 'binary' || opts.type == 'array' || opts.type == 'base64') {\n    if (typeof $cptable !== 'undefined') str = $cptable.utils.decode(65001, char_codes(str));else str = utf8read(str);\n  }\n\n  var opening = str.slice(0, 1024).toLowerCase(),\n      ishtml = false;\n  opening = opening.replace(/\".*?\"/g, \"\");\n\n  if ((opening.indexOf(\">\") & 1023) > Math.min(opening.indexOf(\",\") & 1023, opening.indexOf(\";\") & 1023)) {\n    var _o = dup(opts);\n\n    _o.type = \"string\";\n    return PRN.to_workbook(str, _o);\n  }\n\n  if (opening.indexOf(\"<?xml\") == -1) [\"html\", \"table\", \"head\", \"meta\", \"script\", \"style\", \"div\"].forEach(function (tag) {\n    if (opening.indexOf(\"<\" + tag) >= 0) ishtml = true;\n  });\n  if (ishtml) return html_to_workbook(str, opts);\n  XLMLFormatMap = {\n    \"General Number\": \"General\",\n    \"General Date\": table_fmt[22],\n    \"Long Date\": \"dddd, mmmm dd, yyyy\",\n    \"Medium Date\": table_fmt[15],\n    \"Short Date\": table_fmt[14],\n    \"Long Time\": table_fmt[19],\n    \"Medium Time\": table_fmt[18],\n    \"Short Time\": table_fmt[20],\n    \"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n    \"Fixed\": table_fmt[2],\n    \"Standard\": table_fmt[4],\n    \"Percent\": table_fmt[10],\n    \"Scientific\": table_fmt[11],\n    \"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n    \"True/False\": '\"True\";\"True\";\"False\";@',\n    \"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n  }\n  /*:any*/\n  ;\n  var Rn;\n  var state = [],\n      tmp;\n  if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n  var sheets = {},\n      sheetnames\n  /*:Array<string>*/\n  = [],\n      cursheet\n  /*:Worksheet*/\n  = opts.dense ? [] : {},\n      sheetname = \"\";\n  var cell = {}\n  /*:any*/\n  ,\n      row = {}; // eslint-disable-line no-unused-vars\n\n  var dtag = xlml_parsexmltag('<Data ss:Type=\"String\">'),\n      didx = 0;\n  var c = 0,\n      r = 0;\n  var refguess\n  /*:Range*/\n  = {\n    s: {\n      r: 2000000,\n      c: 2000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var styles = {},\n      stag = {};\n  var ss = \"\",\n      fidx = 0;\n  var merges\n  /*:Array<Range>*/\n  = [];\n  var Props = {},\n      Custprops = {},\n      pidx = 0,\n      cp = [];\n  var comments\n  /*:Array<Comment>*/\n  = [],\n      comment\n  /*:Comment*/\n  = {}\n  /*:any*/\n  ;\n  var cstys = [],\n      csty,\n      seencol = false;\n  var arrayf\n  /*:Array<[Range, string]>*/\n  = [];\n  var rowinfo\n  /*:Array<RowInfo>*/\n  = [],\n      rowobj = {},\n      cc = 0,\n      rr = 0;\n  var Workbook\n  /*:WBWBProps*/\n  = {\n    Sheets: [],\n    WBProps: {\n      date1904: false\n    }\n  }\n  /*:any*/\n  ,\n      wsprops = {};\n  xlmlregex.lastIndex = 0;\n  str = str.replace(/<!--([\\s\\S]*?)-->/mg, \"\");\n  var raw_Rn3 = \"\";\n\n  while (Rn = xlmlregex.exec(str)) switch (Rn[3] = (raw_Rn3 = Rn[3]).toLowerCase()) {\n    case 'data'\n    /*case 'Data'*/\n    :\n      if (raw_Rn3 == \"data\") {\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n\n        break;\n      }\n\n      if (state[state.length - 1][1]) break;\n      if (Rn[1] === '/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length - 1][0] ==\n      /*\"Comment\"*/\n      \"comment\" ? comment : cell, {\n        c: c,\n        r: r\n      }, styles, cstys[c], row, arrayf, opts);else {\n        ss = \"\";\n        dtag = xlml_parsexmltag(Rn[0]);\n        didx = Rn.index + Rn[0].length;\n      }\n      break;\n\n    case 'cell'\n    /*case 'Cell'*/\n    :\n      if (Rn[1] === '/') {\n        if (comments.length > 0) cell.c = comments;\n\n        if ((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) {\n          if (opts.dense) {\n            if (!cursheet[r]) cursheet[r] = [];\n            cursheet[r][c] = cell;\n          } else cursheet[encode_col(c) + encode_row(r)] = cell;\n        }\n\n        if (cell.HRef) {\n          cell.l = {\n            Target: unescapexml(cell.HRef)\n          }\n          /*:any*/\n          ;\n          if (cell.HRefScreenTip) cell.l.Tooltip = cell.HRefScreenTip;\n          delete cell.HRef;\n          delete cell.HRefScreenTip;\n        }\n\n        if (cell.MergeAcross || cell.MergeDown) {\n          cc = c + (parseInt(cell.MergeAcross, 10) | 0);\n          rr = r + (parseInt(cell.MergeDown, 10) | 0);\n          merges.push({\n            s: {\n              c: c,\n              r: r\n            },\n            e: {\n              c: cc,\n              r: rr\n            }\n          });\n        }\n\n        if (!opts.sheetStubs) {\n          if (cell.MergeAcross) c = cc + 1;else ++c;\n        } else if (cell.MergeAcross || cell.MergeDown) {\n          /*:: if(!cc) cc = 0; if(!rr) rr = 0; */\n          for (var cma = c; cma <= cc; ++cma) {\n            for (var cmd = r; cmd <= rr; ++cmd) {\n              if (cma > c || cmd > r) {\n                if (opts.dense) {\n                  if (!cursheet[cmd]) cursheet[cmd] = [];\n                  cursheet[cmd][cma] = {\n                    t: 'z'\n                  };\n                } else cursheet[encode_col(cma) + encode_row(cmd)] = {\n                  t: 'z'\n                };\n              }\n            }\n          }\n\n          c = cc + 1;\n        } else ++c;\n      } else {\n        cell = xlml_parsexmltagobj(Rn[0]);\n        if (cell.Index) c = +cell.Index - 1;\n        if (c < refguess.s.c) refguess.s.c = c;\n        if (c > refguess.e.c) refguess.e.c = c;\n        if (Rn[0].slice(-2) === \"/>\") ++c;\n        comments = [];\n      }\n\n      break;\n\n    case 'row'\n    /*case 'Row'*/\n    :\n      if (Rn[1] === '/' || Rn[0].slice(-2) === \"/>\") {\n        if (r < refguess.s.r) refguess.s.r = r;\n        if (r > refguess.e.r) refguess.e.r = r;\n\n        if (Rn[0].slice(-2) === \"/>\") {\n          row = xlml_parsexmltag(Rn[0]);\n          if (row.Index) r = +row.Index - 1;\n        }\n\n        c = 0;\n        ++r;\n      } else {\n        row = xlml_parsexmltag(Rn[0]);\n        if (row.Index) r = +row.Index - 1;\n        rowobj = {};\n\n        if (row.AutoFitHeight == \"0\" || row.Height) {\n          rowobj.hpx = parseInt(row.Height, 10);\n          rowobj.hpt = px2pt(rowobj.hpx);\n          rowinfo[r] = rowobj;\n        }\n\n        if (row.Hidden == \"1\") {\n          rowobj.hidden = true;\n          rowinfo[r] = rowobj;\n        }\n      }\n\n      break;\n\n    case 'worksheet'\n    /*case 'Worksheet'*/\n    :\n      /* TODO: read range from FullRows/FullColumns */\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        sheetnames.push(sheetname);\n\n        if (refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) {\n          cursheet[\"!ref\"] = encode_range(refguess);\n\n          if (opts.sheetRows && opts.sheetRows <= refguess.e.r) {\n            cursheet[\"!fullref\"] = cursheet[\"!ref\"];\n            refguess.e.r = opts.sheetRows - 1;\n            cursheet[\"!ref\"] = encode_range(refguess);\n          }\n        }\n\n        if (merges.length) cursheet[\"!merges\"] = merges;\n        if (cstys.length > 0) cursheet[\"!cols\"] = cstys;\n        if (rowinfo.length > 0) cursheet[\"!rows\"] = rowinfo;\n        sheets[sheetname] = cursheet;\n      } else {\n        refguess = {\n          s: {\n            r: 2000000,\n            c: 2000000\n          },\n          e: {\n            r: 0,\n            c: 0\n          }\n        };\n        r = c = 0;\n        state.push([Rn[3], false]);\n        tmp = xlml_parsexmltag(Rn[0]);\n        sheetname = unescapexml(tmp.Name);\n        cursheet = opts.dense ? [] : {};\n        merges = [];\n        arrayf = [];\n        rowinfo = [];\n        wsprops = {\n          name: sheetname,\n          Hidden: 0\n        };\n        Workbook.Sheets.push(wsprops);\n      }\n\n      break;\n\n    case 'table'\n    /*case 'Table'*/\n    :\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n      } else if (Rn[0].slice(-2) == \"/>\") break;else {\n        state.push([Rn[3], false]);\n        cstys = [];\n        seencol = false;\n      }\n\n      break;\n\n    case 'style'\n    /*case 'Style'*/\n    :\n      if (Rn[1] === '/') process_style_xlml(styles, stag, opts);else stag = xlml_parsexmltag(Rn[0]);\n      break;\n\n    case 'numberformat'\n    /*case 'NumberFormat'*/\n    :\n      stag.nf = unescapexml(xlml_parsexmltag(Rn[0]).Format || \"General\");\n      if (XLMLFormatMap[stag.nf]) stag.nf = XLMLFormatMap[stag.nf];\n\n      for (var ssfidx = 0; ssfidx != 0x188; ++ssfidx) if (table_fmt[ssfidx] == stag.nf) break;\n\n      if (ssfidx == 0x188) for (ssfidx = 0x39; ssfidx != 0x188; ++ssfidx) if (table_fmt[ssfidx] == null) {\n        SSF_load(stag.nf, ssfidx);\n        break;\n      }\n      break;\n\n    case 'column'\n    /*case 'Column'*/\n    :\n      if (state[state.length - 1][0] !==\n      /*'Table'*/\n      'table') break;\n      csty = xlml_parsexmltag(Rn[0]);\n\n      if (csty.Hidden) {\n        csty.hidden = true;\n        delete csty.Hidden;\n      }\n\n      if (csty.Width) csty.wpx = parseInt(csty.Width, 10);\n\n      if (!seencol && csty.wpx > 10) {\n        seencol = true;\n        MDW = DEF_MDW; //find_mdw_wpx(csty.wpx);\n\n        for (var _col = 0; _col < cstys.length; ++_col) if (cstys[_col]) process_col(cstys[_col]);\n      }\n\n      if (seencol) process_col(csty);\n      cstys[csty.Index - 1 || cstys.length] = csty;\n\n      for (var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = dup(csty);\n\n      break;\n\n    case 'namedrange'\n    /*case 'NamedRange'*/\n    :\n      if (Rn[1] === '/') break;\n      if (!Workbook.Names) Workbook.Names = [];\n\n      var _NamedRange = parsexmltag(Rn[0]);\n\n      var _DefinedName\n      /*:DefinedName*/\n      = {\n        Name: _NamedRange.Name,\n        Ref: rc_to_a1(_NamedRange.RefersTo.slice(1), {\n          r: 0,\n          c: 0\n        })\n      }\n      /*:any*/\n      ;\n      if (Workbook.Sheets.length > 0) _DefinedName.Sheet = Workbook.Sheets.length - 1;\n      /*:: if(Workbook.Names) */\n\n      Workbook.Names.push(_DefinedName);\n      break;\n\n    case 'namedcell'\n    /*case 'NamedCell'*/\n    :\n      break;\n\n    case 'b'\n    /*case 'B'*/\n    :\n      break;\n\n    case 'i'\n    /*case 'I'*/\n    :\n      break;\n\n    case 'u'\n    /*case 'U'*/\n    :\n      break;\n\n    case 's'\n    /*case 'S'*/\n    :\n      break;\n\n    case 'em'\n    /*case 'EM'*/\n    :\n      break;\n\n    case 'h2'\n    /*case 'H2'*/\n    :\n      break;\n\n    case 'h3'\n    /*case 'H3'*/\n    :\n      break;\n\n    case 'sub'\n    /*case 'Sub'*/\n    :\n      break;\n\n    case 'sup'\n    /*case 'Sup'*/\n    :\n      break;\n\n    case 'span'\n    /*case 'Span'*/\n    :\n      break;\n\n    case 'alignment'\n    /*case 'Alignment'*/\n    :\n      break;\n\n    case 'borders'\n    /*case 'Borders'*/\n    :\n      break;\n\n    case 'border'\n    /*case 'Border'*/\n    :\n      break;\n\n    case 'font'\n    /*case 'Font'*/\n    :\n      if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") ss += str.slice(fidx, Rn.index);else fidx = Rn.index + Rn[0].length;\n      break;\n\n    case 'interior'\n    /*case 'Interior'*/\n    :\n      if (!opts.cellStyles) break;\n      stag.Interior = xlml_parsexmltag(Rn[0]);\n      break;\n\n    case 'protection'\n    /*case 'Protection'*/\n    :\n      break;\n\n    case 'author'\n    /*case 'Author'*/\n    :\n    case 'title'\n    /*case 'Title'*/\n    :\n    case 'description'\n    /*case 'Description'*/\n    :\n    case 'created'\n    /*case 'Created'*/\n    :\n    case 'keywords'\n    /*case 'Keywords'*/\n    :\n    case 'subject'\n    /*case 'Subject'*/\n    :\n    case 'category'\n    /*case 'Category'*/\n    :\n    case 'company'\n    /*case 'Company'*/\n    :\n    case 'lastauthor'\n    /*case 'LastAuthor'*/\n    :\n    case 'lastsaved'\n    /*case 'LastSaved'*/\n    :\n    case 'lastprinted'\n    /*case 'LastPrinted'*/\n    :\n    case 'version'\n    /*case 'Version'*/\n    :\n    case 'revision'\n    /*case 'Revision'*/\n    :\n    case 'totaltime'\n    /*case 'TotalTime'*/\n    :\n    case 'hyperlinkbase'\n    /*case 'HyperlinkBase'*/\n    :\n    case 'manager'\n    /*case 'Manager'*/\n    :\n    case 'contentstatus'\n    /*case 'ContentStatus'*/\n    :\n    case 'identifier'\n    /*case 'Identifier'*/\n    :\n    case 'language'\n    /*case 'Language'*/\n    :\n    case 'appname'\n    /*case 'AppName'*/\n    :\n      if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_prop(Props, raw_Rn3, str.slice(pidx, Rn.index));else pidx = Rn.index + Rn[0].length;\n      break;\n\n    case 'paragraphs'\n    /*case 'Paragraphs'*/\n    :\n      break;\n\n    case 'styles'\n    /*case 'Styles'*/\n    :\n    case 'workbook'\n    /*case 'Workbook'*/\n    :\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n      } else state.push([Rn[3], false]);\n\n      break;\n\n    case 'comment'\n    /*case 'Comment'*/\n    :\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n        xlml_clean_comment(comment);\n        comments.push(comment);\n      } else {\n        state.push([Rn[3], false]);\n        tmp = xlml_parsexmltag(Rn[0]);\n        comment = {\n          a: tmp.Author\n        }\n        /*:any*/\n        ;\n      }\n\n      break;\n\n    case 'autofilter'\n    /*case 'AutoFilter'*/\n    :\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n      } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n        var AutoFilter = xlml_parsexmltag(Rn[0]);\n        cursheet['!autofilter'] = {\n          ref: rc_to_a1(AutoFilter.Range).replace(/\\$/g, \"\")\n        };\n        state.push([Rn[3], true]);\n      }\n\n      break;\n\n    case 'name'\n    /*case 'Name'*/\n    :\n      break;\n\n    case 'datavalidation'\n    /*case 'DataValidation'*/\n    :\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n      } else {\n        if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n      }\n\n      break;\n\n    case 'pixelsperinch'\n    /*case 'PixelsPerInch'*/\n    :\n      break;\n\n    case 'componentoptions'\n    /*case 'ComponentOptions'*/\n    :\n    case 'documentproperties'\n    /*case 'DocumentProperties'*/\n    :\n    case 'customdocumentproperties'\n    /*case 'CustomDocumentProperties'*/\n    :\n    case 'officedocumentsettings'\n    /*case 'OfficeDocumentSettings'*/\n    :\n    case 'pivottable'\n    /*case 'PivotTable'*/\n    :\n    case 'pivotcache'\n    /*case 'PivotCache'*/\n    :\n    case 'names'\n    /*case 'Names'*/\n    :\n    case 'mapinfo'\n    /*case 'MapInfo'*/\n    :\n    case 'pagebreaks'\n    /*case 'PageBreaks'*/\n    :\n    case 'querytable'\n    /*case 'QueryTable'*/\n    :\n    case 'sorting'\n    /*case 'Sorting'*/\n    :\n    case 'schema'\n    /*case 'Schema'*/\n    : //case 'data' /*case 'data'*/:\n\n    case 'conditionalformatting'\n    /*case 'ConditionalFormatting'*/\n    :\n    case 'smarttagtype'\n    /*case 'SmartTagType'*/\n    :\n    case 'smarttags'\n    /*case 'SmartTags'*/\n    :\n    case 'excelworkbook'\n    /*case 'ExcelWorkbook'*/\n    :\n    case 'workbookoptions'\n    /*case 'WorkbookOptions'*/\n    :\n    case 'worksheetoptions'\n    /*case 'WorksheetOptions'*/\n    :\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw new Error(\"Bad state: \" + tmp.join(\"|\"));\n      } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n\n      break;\n\n    case 'null'\n    /*case 'Null'*/\n    :\n      break;\n\n    default:\n      /* FODS file root is <office:document> */\n      if (state.length == 0 && Rn[3] == \"document\") return parse_fods(str, opts);\n      /* UOS file root is <uof:UOF> */\n\n      if (state.length == 0 && Rn[3] == \"uof\"\n      /*\"UOF\"*/\n      ) return parse_fods(str, opts);\n      var seen = true;\n\n      switch (state[state.length - 1][0]) {\n        /* OfficeDocumentSettings */\n        case 'officedocumentsettings'\n        /*case 'OfficeDocumentSettings'*/\n        :\n          switch (Rn[3]) {\n            case 'allowpng'\n            /*case 'AllowPNG'*/\n            :\n              break;\n\n            case 'removepersonalinformation'\n            /*case 'RemovePersonalInformation'*/\n            :\n              break;\n\n            case 'downloadcomponents'\n            /*case 'DownloadComponents'*/\n            :\n              break;\n\n            case 'locationofcomponents'\n            /*case 'LocationOfComponents'*/\n            :\n              break;\n\n            case 'colors'\n            /*case 'Colors'*/\n            :\n              break;\n\n            case 'color'\n            /*case 'Color'*/\n            :\n              break;\n\n            case 'index'\n            /*case 'Index'*/\n            :\n              break;\n\n            case 'rgb'\n            /*case 'RGB'*/\n            :\n              break;\n\n            case 'targetscreensize'\n            /*case 'TargetScreenSize'*/\n            :\n              break;\n\n            case 'readonlyrecommended'\n            /*case 'ReadOnlyRecommended'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* ComponentOptions */\n\n        case 'componentoptions'\n        /*case 'ComponentOptions'*/\n        :\n          switch (Rn[3]) {\n            case 'toolbar'\n            /*case 'Toolbar'*/\n            :\n              break;\n\n            case 'hideofficelogo'\n            /*case 'HideOfficeLogo'*/\n            :\n              break;\n\n            case 'spreadsheetautofit'\n            /*case 'SpreadsheetAutoFit'*/\n            :\n              break;\n\n            case 'label'\n            /*case 'Label'*/\n            :\n              break;\n\n            case 'caption'\n            /*case 'Caption'*/\n            :\n              break;\n\n            case 'maxheight'\n            /*case 'MaxHeight'*/\n            :\n              break;\n\n            case 'maxwidth'\n            /*case 'MaxWidth'*/\n            :\n              break;\n\n            case 'nextsheetnumber'\n            /*case 'NextSheetNumber'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* ExcelWorkbook */\n\n        case 'excelworkbook'\n        /*case 'ExcelWorkbook'*/\n        :\n          switch (Rn[3]) {\n            case 'date1904'\n            /*case 'Date1904'*/\n            :\n              /*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n              Workbook.WBProps.date1904 = true;\n              break;\n\n            case 'windowheight'\n            /*case 'WindowHeight'*/\n            :\n              break;\n\n            case 'windowwidth'\n            /*case 'WindowWidth'*/\n            :\n              break;\n\n            case 'windowtopx'\n            /*case 'WindowTopX'*/\n            :\n              break;\n\n            case 'windowtopy'\n            /*case 'WindowTopY'*/\n            :\n              break;\n\n            case 'tabratio'\n            /*case 'TabRatio'*/\n            :\n              break;\n\n            case 'protectstructure'\n            /*case 'ProtectStructure'*/\n            :\n              break;\n\n            case 'protectwindow'\n            /*case 'ProtectWindow'*/\n            :\n              break;\n\n            case 'protectwindows'\n            /*case 'ProtectWindows'*/\n            :\n              break;\n\n            case 'activesheet'\n            /*case 'ActiveSheet'*/\n            :\n              break;\n\n            case 'displayinknotes'\n            /*case 'DisplayInkNotes'*/\n            :\n              break;\n\n            case 'firstvisiblesheet'\n            /*case 'FirstVisibleSheet'*/\n            :\n              break;\n\n            case 'supbook'\n            /*case 'SupBook'*/\n            :\n              break;\n\n            case 'sheetname'\n            /*case 'SheetName'*/\n            :\n              break;\n\n            case 'sheetindex'\n            /*case 'SheetIndex'*/\n            :\n              break;\n\n            case 'sheetindexfirst'\n            /*case 'SheetIndexFirst'*/\n            :\n              break;\n\n            case 'sheetindexlast'\n            /*case 'SheetIndexLast'*/\n            :\n              break;\n\n            case 'dll'\n            /*case 'Dll'*/\n            :\n              break;\n\n            case 'acceptlabelsinformulas'\n            /*case 'AcceptLabelsInFormulas'*/\n            :\n              break;\n\n            case 'donotsavelinkvalues'\n            /*case 'DoNotSaveLinkValues'*/\n            :\n              break;\n\n            case 'iteration'\n            /*case 'Iteration'*/\n            :\n              break;\n\n            case 'maxiterations'\n            /*case 'MaxIterations'*/\n            :\n              break;\n\n            case 'maxchange'\n            /*case 'MaxChange'*/\n            :\n              break;\n\n            case 'path'\n            /*case 'Path'*/\n            :\n              break;\n\n            case 'xct'\n            /*case 'Xct'*/\n            :\n              break;\n\n            case 'count'\n            /*case 'Count'*/\n            :\n              break;\n\n            case 'selectedsheets'\n            /*case 'SelectedSheets'*/\n            :\n              break;\n\n            case 'calculation'\n            /*case 'Calculation'*/\n            :\n              break;\n\n            case 'uncalced'\n            /*case 'Uncalced'*/\n            :\n              break;\n\n            case 'startupprompt'\n            /*case 'StartupPrompt'*/\n            :\n              break;\n\n            case 'crn'\n            /*case 'Crn'*/\n            :\n              break;\n\n            case 'externname'\n            /*case 'ExternName'*/\n            :\n              break;\n\n            case 'formula'\n            /*case 'Formula'*/\n            :\n              break;\n\n            case 'colfirst'\n            /*case 'ColFirst'*/\n            :\n              break;\n\n            case 'collast'\n            /*case 'ColLast'*/\n            :\n              break;\n\n            case 'wantadvise'\n            /*case 'WantAdvise'*/\n            :\n              break;\n\n            case 'boolean'\n            /*case 'Boolean'*/\n            :\n              break;\n\n            case 'error'\n            /*case 'Error'*/\n            :\n              break;\n\n            case 'text'\n            /*case 'Text'*/\n            :\n              break;\n\n            case 'ole'\n            /*case 'OLE'*/\n            :\n              break;\n\n            case 'noautorecover'\n            /*case 'NoAutoRecover'*/\n            :\n              break;\n\n            case 'publishobjects'\n            /*case 'PublishObjects'*/\n            :\n              break;\n\n            case 'donotcalculatebeforesave'\n            /*case 'DoNotCalculateBeforeSave'*/\n            :\n              break;\n\n            case 'number'\n            /*case 'Number'*/\n            :\n              break;\n\n            case 'refmoder1c1'\n            /*case 'RefModeR1C1'*/\n            :\n              break;\n\n            case 'embedsavesmarttags'\n            /*case 'EmbedSaveSmartTags'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* WorkbookOptions */\n\n        case 'workbookoptions'\n        /*case 'WorkbookOptions'*/\n        :\n          switch (Rn[3]) {\n            case 'owcversion'\n            /*case 'OWCVersion'*/\n            :\n              break;\n\n            case 'height'\n            /*case 'Height'*/\n            :\n              break;\n\n            case 'width'\n            /*case 'Width'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* WorksheetOptions */\n\n        case 'worksheetoptions'\n        /*case 'WorksheetOptions'*/\n        :\n          switch (Rn[3]) {\n            case 'visible'\n            /*case 'Visible'*/\n            :\n              if (Rn[0].slice(-2) === \"/>\") {\n                /* empty */\n              } else if (Rn[1] === \"/\") switch (str.slice(pidx, Rn.index)) {\n                case \"SheetHidden\":\n                  wsprops.Hidden = 1;\n                  break;\n\n                case \"SheetVeryHidden\":\n                  wsprops.Hidden = 2;\n                  break;\n              } else pidx = Rn.index + Rn[0].length;\n\n              break;\n\n            case 'header'\n            /*case 'Header'*/\n            :\n              if (!cursheet['!margins']) default_margins(cursheet['!margins'] = {}, 'xlml');\n              if (!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].header = +parsexmltag(Rn[0]).Margin;\n              break;\n\n            case 'footer'\n            /*case 'Footer'*/\n            :\n              if (!cursheet['!margins']) default_margins(cursheet['!margins'] = {}, 'xlml');\n              if (!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].footer = +parsexmltag(Rn[0]).Margin;\n              break;\n\n            case 'pagemargins'\n            /*case 'PageMargins'*/\n            :\n              var pagemargins = parsexmltag(Rn[0]);\n              if (!cursheet['!margins']) default_margins(cursheet['!margins'] = {}, 'xlml');\n              if (!isNaN(+pagemargins.Top)) cursheet['!margins'].top = +pagemargins.Top;\n              if (!isNaN(+pagemargins.Left)) cursheet['!margins'].left = +pagemargins.Left;\n              if (!isNaN(+pagemargins.Right)) cursheet['!margins'].right = +pagemargins.Right;\n              if (!isNaN(+pagemargins.Bottom)) cursheet['!margins'].bottom = +pagemargins.Bottom;\n              break;\n\n            case 'displayrighttoleft'\n            /*case 'DisplayRightToLeft'*/\n            :\n              if (!Workbook.Views) Workbook.Views = [];\n              if (!Workbook.Views[0]) Workbook.Views[0] = {};\n              Workbook.Views[0].RTL = true;\n              break;\n\n            case 'freezepanes'\n            /*case 'FreezePanes'*/\n            :\n              break;\n\n            case 'frozennosplit'\n            /*case 'FrozenNoSplit'*/\n            :\n              break;\n\n            case 'splithorizontal'\n            /*case 'SplitHorizontal'*/\n            :\n            case 'splitvertical'\n            /*case 'SplitVertical'*/\n            :\n              break;\n\n            case 'donotdisplaygridlines'\n            /*case 'DoNotDisplayGridlines'*/\n            :\n              break;\n\n            case 'activerow'\n            /*case 'ActiveRow'*/\n            :\n              break;\n\n            case 'activecol'\n            /*case 'ActiveCol'*/\n            :\n              break;\n\n            case 'toprowbottompane'\n            /*case 'TopRowBottomPane'*/\n            :\n              break;\n\n            case 'leftcolumnrightpane'\n            /*case 'LeftColumnRightPane'*/\n            :\n              break;\n\n            case 'unsynced'\n            /*case 'Unsynced'*/\n            :\n              break;\n\n            case 'print'\n            /*case 'Print'*/\n            :\n              break;\n\n            case 'printerrors'\n            /*case 'PrintErrors'*/\n            :\n              break;\n\n            case 'panes'\n            /*case 'Panes'*/\n            :\n              break;\n\n            case 'scale'\n            /*case 'Scale'*/\n            :\n              break;\n\n            case 'pane'\n            /*case 'Pane'*/\n            :\n              break;\n\n            case 'number'\n            /*case 'Number'*/\n            :\n              break;\n\n            case 'layout'\n            /*case 'Layout'*/\n            :\n              break;\n\n            case 'pagesetup'\n            /*case 'PageSetup'*/\n            :\n              break;\n\n            case 'selected'\n            /*case 'Selected'*/\n            :\n              break;\n\n            case 'protectobjects'\n            /*case 'ProtectObjects'*/\n            :\n              break;\n\n            case 'enableselection'\n            /*case 'EnableSelection'*/\n            :\n              break;\n\n            case 'protectscenarios'\n            /*case 'ProtectScenarios'*/\n            :\n              break;\n\n            case 'validprinterinfo'\n            /*case 'ValidPrinterInfo'*/\n            :\n              break;\n\n            case 'horizontalresolution'\n            /*case 'HorizontalResolution'*/\n            :\n              break;\n\n            case 'verticalresolution'\n            /*case 'VerticalResolution'*/\n            :\n              break;\n\n            case 'numberofcopies'\n            /*case 'NumberofCopies'*/\n            :\n              break;\n\n            case 'activepane'\n            /*case 'ActivePane'*/\n            :\n              break;\n\n            case 'toprowvisible'\n            /*case 'TopRowVisible'*/\n            :\n              break;\n\n            case 'leftcolumnvisible'\n            /*case 'LeftColumnVisible'*/\n            :\n              break;\n\n            case 'fittopage'\n            /*case 'FitToPage'*/\n            :\n              break;\n\n            case 'rangeselection'\n            /*case 'RangeSelection'*/\n            :\n              break;\n\n            case 'papersizeindex'\n            /*case 'PaperSizeIndex'*/\n            :\n              break;\n\n            case 'pagelayoutzoom'\n            /*case 'PageLayoutZoom'*/\n            :\n              break;\n\n            case 'pagebreakzoom'\n            /*case 'PageBreakZoom'*/\n            :\n              break;\n\n            case 'filteron'\n            /*case 'FilterOn'*/\n            :\n              break;\n\n            case 'fitwidth'\n            /*case 'FitWidth'*/\n            :\n              break;\n\n            case 'fitheight'\n            /*case 'FitHeight'*/\n            :\n              break;\n\n            case 'commentslayout'\n            /*case 'CommentsLayout'*/\n            :\n              break;\n\n            case 'zoom'\n            /*case 'Zoom'*/\n            :\n              break;\n\n            case 'lefttoright'\n            /*case 'LeftToRight'*/\n            :\n              break;\n\n            case 'gridlines'\n            /*case 'Gridlines'*/\n            :\n              break;\n\n            case 'allowsort'\n            /*case 'AllowSort'*/\n            :\n              break;\n\n            case 'allowfilter'\n            /*case 'AllowFilter'*/\n            :\n              break;\n\n            case 'allowinsertrows'\n            /*case 'AllowInsertRows'*/\n            :\n              break;\n\n            case 'allowdeleterows'\n            /*case 'AllowDeleteRows'*/\n            :\n              break;\n\n            case 'allowinsertcols'\n            /*case 'AllowInsertCols'*/\n            :\n              break;\n\n            case 'allowdeletecols'\n            /*case 'AllowDeleteCols'*/\n            :\n              break;\n\n            case 'allowinserthyperlinks'\n            /*case 'AllowInsertHyperlinks'*/\n            :\n              break;\n\n            case 'allowformatcells'\n            /*case 'AllowFormatCells'*/\n            :\n              break;\n\n            case 'allowsizecols'\n            /*case 'AllowSizeCols'*/\n            :\n              break;\n\n            case 'allowsizerows'\n            /*case 'AllowSizeRows'*/\n            :\n              break;\n\n            case 'nosummaryrowsbelowdetail'\n            /*case 'NoSummaryRowsBelowDetail'*/\n            :\n              if (!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n              cursheet[\"!outline\"].above = true;\n              break;\n\n            case 'tabcolorindex'\n            /*case 'TabColorIndex'*/\n            :\n              break;\n\n            case 'donotdisplayheadings'\n            /*case 'DoNotDisplayHeadings'*/\n            :\n              break;\n\n            case 'showpagelayoutzoom'\n            /*case 'ShowPageLayoutZoom'*/\n            :\n              break;\n\n            case 'nosummarycolumnsrightdetail'\n            /*case 'NoSummaryColumnsRightDetail'*/\n            :\n              if (!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n              cursheet[\"!outline\"].left = true;\n              break;\n\n            case 'blackandwhite'\n            /*case 'BlackAndWhite'*/\n            :\n              break;\n\n            case 'donotdisplayzeros'\n            /*case 'DoNotDisplayZeros'*/\n            :\n              break;\n\n            case 'displaypagebreak'\n            /*case 'DisplayPageBreak'*/\n            :\n              break;\n\n            case 'rowcolheadings'\n            /*case 'RowColHeadings'*/\n            :\n              break;\n\n            case 'donotdisplayoutline'\n            /*case 'DoNotDisplayOutline'*/\n            :\n              break;\n\n            case 'noorientation'\n            /*case 'NoOrientation'*/\n            :\n              break;\n\n            case 'allowusepivottables'\n            /*case 'AllowUsePivotTables'*/\n            :\n              break;\n\n            case 'zeroheight'\n            /*case 'ZeroHeight'*/\n            :\n              break;\n\n            case 'viewablerange'\n            /*case 'ViewableRange'*/\n            :\n              break;\n\n            case 'selection'\n            /*case 'Selection'*/\n            :\n              break;\n\n            case 'protectcontents'\n            /*case 'ProtectContents'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* PivotTable */\n\n        case 'pivottable'\n        /*case 'PivotTable'*/\n        :\n        case 'pivotcache'\n        /*case 'PivotCache'*/\n        :\n          switch (Rn[3]) {\n            case 'immediateitemsondrop'\n            /*case 'ImmediateItemsOnDrop'*/\n            :\n              break;\n\n            case 'showpagemultipleitemlabel'\n            /*case 'ShowPageMultipleItemLabel'*/\n            :\n              break;\n\n            case 'compactrowindent'\n            /*case 'CompactRowIndent'*/\n            :\n              break;\n\n            case 'location'\n            /*case 'Location'*/\n            :\n              break;\n\n            case 'pivotfield'\n            /*case 'PivotField'*/\n            :\n              break;\n\n            case 'orientation'\n            /*case 'Orientation'*/\n            :\n              break;\n\n            case 'layoutform'\n            /*case 'LayoutForm'*/\n            :\n              break;\n\n            case 'layoutsubtotallocation'\n            /*case 'LayoutSubtotalLocation'*/\n            :\n              break;\n\n            case 'layoutcompactrow'\n            /*case 'LayoutCompactRow'*/\n            :\n              break;\n\n            case 'position'\n            /*case 'Position'*/\n            :\n              break;\n\n            case 'pivotitem'\n            /*case 'PivotItem'*/\n            :\n              break;\n\n            case 'datatype'\n            /*case 'DataType'*/\n            :\n              break;\n\n            case 'datafield'\n            /*case 'DataField'*/\n            :\n              break;\n\n            case 'sourcename'\n            /*case 'SourceName'*/\n            :\n              break;\n\n            case 'parentfield'\n            /*case 'ParentField'*/\n            :\n              break;\n\n            case 'ptlineitems'\n            /*case 'PTLineItems'*/\n            :\n              break;\n\n            case 'ptlineitem'\n            /*case 'PTLineItem'*/\n            :\n              break;\n\n            case 'countofsameitems'\n            /*case 'CountOfSameItems'*/\n            :\n              break;\n\n            case 'item'\n            /*case 'Item'*/\n            :\n              break;\n\n            case 'itemtype'\n            /*case 'ItemType'*/\n            :\n              break;\n\n            case 'ptsource'\n            /*case 'PTSource'*/\n            :\n              break;\n\n            case 'cacheindex'\n            /*case 'CacheIndex'*/\n            :\n              break;\n\n            case 'consolidationreference'\n            /*case 'ConsolidationReference'*/\n            :\n              break;\n\n            case 'filename'\n            /*case 'FileName'*/\n            :\n              break;\n\n            case 'reference'\n            /*case 'Reference'*/\n            :\n              break;\n\n            case 'nocolumngrand'\n            /*case 'NoColumnGrand'*/\n            :\n              break;\n\n            case 'norowgrand'\n            /*case 'NoRowGrand'*/\n            :\n              break;\n\n            case 'blanklineafteritems'\n            /*case 'BlankLineAfterItems'*/\n            :\n              break;\n\n            case 'hidden'\n            /*case 'Hidden'*/\n            :\n              break;\n\n            case 'subtotal'\n            /*case 'Subtotal'*/\n            :\n              break;\n\n            case 'basefield'\n            /*case 'BaseField'*/\n            :\n              break;\n\n            case 'mapchilditems'\n            /*case 'MapChildItems'*/\n            :\n              break;\n\n            case 'function'\n            /*case 'Function'*/\n            :\n              break;\n\n            case 'refreshonfileopen'\n            /*case 'RefreshOnFileOpen'*/\n            :\n              break;\n\n            case 'printsettitles'\n            /*case 'PrintSetTitles'*/\n            :\n              break;\n\n            case 'mergelabels'\n            /*case 'MergeLabels'*/\n            :\n              break;\n\n            case 'defaultversion'\n            /*case 'DefaultVersion'*/\n            :\n              break;\n\n            case 'refreshname'\n            /*case 'RefreshName'*/\n            :\n              break;\n\n            case 'refreshdate'\n            /*case 'RefreshDate'*/\n            :\n              break;\n\n            case 'refreshdatecopy'\n            /*case 'RefreshDateCopy'*/\n            :\n              break;\n\n            case 'versionlastrefresh'\n            /*case 'VersionLastRefresh'*/\n            :\n              break;\n\n            case 'versionlastupdate'\n            /*case 'VersionLastUpdate'*/\n            :\n              break;\n\n            case 'versionupdateablemin'\n            /*case 'VersionUpdateableMin'*/\n            :\n              break;\n\n            case 'versionrefreshablemin'\n            /*case 'VersionRefreshableMin'*/\n            :\n              break;\n\n            case 'calculation'\n            /*case 'Calculation'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* PageBreaks */\n\n        case 'pagebreaks'\n        /*case 'PageBreaks'*/\n        :\n          switch (Rn[3]) {\n            case 'colbreaks'\n            /*case 'ColBreaks'*/\n            :\n              break;\n\n            case 'colbreak'\n            /*case 'ColBreak'*/\n            :\n              break;\n\n            case 'rowbreaks'\n            /*case 'RowBreaks'*/\n            :\n              break;\n\n            case 'rowbreak'\n            /*case 'RowBreak'*/\n            :\n              break;\n\n            case 'colstart'\n            /*case 'ColStart'*/\n            :\n              break;\n\n            case 'colend'\n            /*case 'ColEnd'*/\n            :\n              break;\n\n            case 'rowend'\n            /*case 'RowEnd'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* AutoFilter */\n\n        case 'autofilter'\n        /*case 'AutoFilter'*/\n        :\n          switch (Rn[3]) {\n            case 'autofiltercolumn'\n            /*case 'AutoFilterColumn'*/\n            :\n              break;\n\n            case 'autofiltercondition'\n            /*case 'AutoFilterCondition'*/\n            :\n              break;\n\n            case 'autofilterand'\n            /*case 'AutoFilterAnd'*/\n            :\n              break;\n\n            case 'autofilteror'\n            /*case 'AutoFilterOr'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* QueryTable */\n\n        case 'querytable'\n        /*case 'QueryTable'*/\n        :\n          switch (Rn[3]) {\n            case 'id'\n            /*case 'Id'*/\n            :\n              break;\n\n            case 'autoformatfont'\n            /*case 'AutoFormatFont'*/\n            :\n              break;\n\n            case 'autoformatpattern'\n            /*case 'AutoFormatPattern'*/\n            :\n              break;\n\n            case 'querysource'\n            /*case 'QuerySource'*/\n            :\n              break;\n\n            case 'querytype'\n            /*case 'QueryType'*/\n            :\n              break;\n\n            case 'enableredirections'\n            /*case 'EnableRedirections'*/\n            :\n              break;\n\n            case 'refreshedinxl9'\n            /*case 'RefreshedInXl9'*/\n            :\n              break;\n\n            case 'urlstring'\n            /*case 'URLString'*/\n            :\n              break;\n\n            case 'htmltables'\n            /*case 'HTMLTables'*/\n            :\n              break;\n\n            case 'connection'\n            /*case 'Connection'*/\n            :\n              break;\n\n            case 'commandtext'\n            /*case 'CommandText'*/\n            :\n              break;\n\n            case 'refreshinfo'\n            /*case 'RefreshInfo'*/\n            :\n              break;\n\n            case 'notitles'\n            /*case 'NoTitles'*/\n            :\n              break;\n\n            case 'nextid'\n            /*case 'NextId'*/\n            :\n              break;\n\n            case 'columninfo'\n            /*case 'ColumnInfo'*/\n            :\n              break;\n\n            case 'overwritecells'\n            /*case 'OverwriteCells'*/\n            :\n              break;\n\n            case 'donotpromptforfile'\n            /*case 'DoNotPromptForFile'*/\n            :\n              break;\n\n            case 'textwizardsettings'\n            /*case 'TextWizardSettings'*/\n            :\n              break;\n\n            case 'source'\n            /*case 'Source'*/\n            :\n              break;\n\n            case 'number'\n            /*case 'Number'*/\n            :\n              break;\n\n            case 'decimal'\n            /*case 'Decimal'*/\n            :\n              break;\n\n            case 'thousandseparator'\n            /*case 'ThousandSeparator'*/\n            :\n              break;\n\n            case 'trailingminusnumbers'\n            /*case 'TrailingMinusNumbers'*/\n            :\n              break;\n\n            case 'formatsettings'\n            /*case 'FormatSettings'*/\n            :\n              break;\n\n            case 'fieldtype'\n            /*case 'FieldType'*/\n            :\n              break;\n\n            case 'delimiters'\n            /*case 'Delimiters'*/\n            :\n              break;\n\n            case 'tab'\n            /*case 'Tab'*/\n            :\n              break;\n\n            case 'comma'\n            /*case 'Comma'*/\n            :\n              break;\n\n            case 'autoformatname'\n            /*case 'AutoFormatName'*/\n            :\n              break;\n\n            case 'versionlastedit'\n            /*case 'VersionLastEdit'*/\n            :\n              break;\n\n            case 'versionlastrefresh'\n            /*case 'VersionLastRefresh'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        case 'datavalidation'\n        /*case 'DataValidation'*/\n        :\n          switch (Rn[3]) {\n            case 'range'\n            /*case 'Range'*/\n            :\n              break;\n\n            case 'type'\n            /*case 'Type'*/\n            :\n              break;\n\n            case 'min'\n            /*case 'Min'*/\n            :\n              break;\n\n            case 'max'\n            /*case 'Max'*/\n            :\n              break;\n\n            case 'sort'\n            /*case 'Sort'*/\n            :\n              break;\n\n            case 'descending'\n            /*case 'Descending'*/\n            :\n              break;\n\n            case 'order'\n            /*case 'Order'*/\n            :\n              break;\n\n            case 'casesensitive'\n            /*case 'CaseSensitive'*/\n            :\n              break;\n\n            case 'value'\n            /*case 'Value'*/\n            :\n              break;\n\n            case 'errorstyle'\n            /*case 'ErrorStyle'*/\n            :\n              break;\n\n            case 'errormessage'\n            /*case 'ErrorMessage'*/\n            :\n              break;\n\n            case 'errortitle'\n            /*case 'ErrorTitle'*/\n            :\n              break;\n\n            case 'inputmessage'\n            /*case 'InputMessage'*/\n            :\n              break;\n\n            case 'inputtitle'\n            /*case 'InputTitle'*/\n            :\n              break;\n\n            case 'combohide'\n            /*case 'ComboHide'*/\n            :\n              break;\n\n            case 'inputhide'\n            /*case 'InputHide'*/\n            :\n              break;\n\n            case 'condition'\n            /*case 'Condition'*/\n            :\n              break;\n\n            case 'qualifier'\n            /*case 'Qualifier'*/\n            :\n              break;\n\n            case 'useblank'\n            /*case 'UseBlank'*/\n            :\n              break;\n\n            case 'value1'\n            /*case 'Value1'*/\n            :\n              break;\n\n            case 'value2'\n            /*case 'Value2'*/\n            :\n              break;\n\n            case 'format'\n            /*case 'Format'*/\n            :\n              break;\n\n            case 'cellrangelist'\n            /*case 'CellRangeList'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        case 'sorting'\n        /*case 'Sorting'*/\n        :\n        case 'conditionalformatting'\n        /*case 'ConditionalFormatting'*/\n        :\n          switch (Rn[3]) {\n            case 'range'\n            /*case 'Range'*/\n            :\n              break;\n\n            case 'type'\n            /*case 'Type'*/\n            :\n              break;\n\n            case 'min'\n            /*case 'Min'*/\n            :\n              break;\n\n            case 'max'\n            /*case 'Max'*/\n            :\n              break;\n\n            case 'sort'\n            /*case 'Sort'*/\n            :\n              break;\n\n            case 'descending'\n            /*case 'Descending'*/\n            :\n              break;\n\n            case 'order'\n            /*case 'Order'*/\n            :\n              break;\n\n            case 'casesensitive'\n            /*case 'CaseSensitive'*/\n            :\n              break;\n\n            case 'value'\n            /*case 'Value'*/\n            :\n              break;\n\n            case 'errorstyle'\n            /*case 'ErrorStyle'*/\n            :\n              break;\n\n            case 'errormessage'\n            /*case 'ErrorMessage'*/\n            :\n              break;\n\n            case 'errortitle'\n            /*case 'ErrorTitle'*/\n            :\n              break;\n\n            case 'cellrangelist'\n            /*case 'CellRangeList'*/\n            :\n              break;\n\n            case 'inputmessage'\n            /*case 'InputMessage'*/\n            :\n              break;\n\n            case 'inputtitle'\n            /*case 'InputTitle'*/\n            :\n              break;\n\n            case 'combohide'\n            /*case 'ComboHide'*/\n            :\n              break;\n\n            case 'inputhide'\n            /*case 'InputHide'*/\n            :\n              break;\n\n            case 'condition'\n            /*case 'Condition'*/\n            :\n              break;\n\n            case 'qualifier'\n            /*case 'Qualifier'*/\n            :\n              break;\n\n            case 'useblank'\n            /*case 'UseBlank'*/\n            :\n              break;\n\n            case 'value1'\n            /*case 'Value1'*/\n            :\n              break;\n\n            case 'value2'\n            /*case 'Value2'*/\n            :\n              break;\n\n            case 'format'\n            /*case 'Format'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* MapInfo (schema) */\n\n        case 'mapinfo'\n        /*case 'MapInfo'*/\n        :\n        case 'schema'\n        /*case 'Schema'*/\n        :\n        case 'data'\n        /*case 'data'*/\n        :\n          switch (Rn[3]) {\n            case 'map'\n            /*case 'Map'*/\n            :\n              break;\n\n            case 'entry'\n            /*case 'Entry'*/\n            :\n              break;\n\n            case 'range'\n            /*case 'Range'*/\n            :\n              break;\n\n            case 'xpath'\n            /*case 'XPath'*/\n            :\n              break;\n\n            case 'field'\n            /*case 'Field'*/\n            :\n              break;\n\n            case 'xsdtype'\n            /*case 'XSDType'*/\n            :\n              break;\n\n            case 'filteron'\n            /*case 'FilterOn'*/\n            :\n              break;\n\n            case 'aggregate'\n            /*case 'Aggregate'*/\n            :\n              break;\n\n            case 'elementtype'\n            /*case 'ElementType'*/\n            :\n              break;\n\n            case 'attributetype'\n            /*case 'AttributeType'*/\n            :\n              break;\n\n            /* These are from xsd (XML Schema Definition) */\n\n            case 'schema'\n            /*case 'schema'*/\n            :\n            case 'element'\n            /*case 'element'*/\n            :\n            case 'complextype'\n            /*case 'complexType'*/\n            :\n            case 'datatype'\n            /*case 'datatype'*/\n            :\n            case 'all'\n            /*case 'all'*/\n            :\n            case 'attribute'\n            /*case 'attribute'*/\n            :\n            case 'extends'\n            /*case 'extends'*/\n            :\n              break;\n\n            case 'row'\n            /*case 'row'*/\n            :\n              break;\n\n            default:\n              seen = false;\n          }\n\n          break;\n\n        /* SmartTags (can be anything) */\n\n        case 'smarttags'\n        /*case 'SmartTags'*/\n        :\n          break;\n\n        default:\n          seen = false;\n          break;\n      }\n\n      if (seen) break;\n      /* CustomDocumentProperties */\n\n      if (Rn[3].match(/!\\[CDATA/)) break;\n      if (!state[state.length - 1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\n      if (state[state.length - 1][0] ===\n      /*'CustomDocumentProperties'*/\n      'customdocumentproperties') {\n        if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_custprop(Custprops, raw_Rn3, cp, str.slice(pidx, Rn.index));else {\n          cp = Rn;\n          pidx = Rn.index + Rn[0].length;\n        }\n        break;\n      }\n\n      if (opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n  }\n\n  var out = {}\n  /*:any*/\n  ;\n  if (!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n  out.SheetNames = sheetnames;\n  out.Workbook = Workbook;\n  out.SSF = dup(table_fmt);\n  out.Props = Props;\n  out.Custprops = Custprops;\n  return out;\n}\n\nfunction parse_xlml(data\n/*:RawBytes|string*/\n, opts)\n/*:Workbook*/\n{\n  fix_read_opts(opts = opts || {});\n\n  switch (opts.type || \"base64\") {\n    case \"base64\":\n      return parse_xlml_xml(Base64_decode(data), opts);\n\n    case \"binary\":\n    case \"buffer\":\n    case \"file\":\n      return parse_xlml_xml(data, opts);\n\n    case \"array\":\n      return parse_xlml_xml(a2s(data), opts);\n  }\n  /*:: throw new Error(\"unsupported type \" + opts.type); */\n\n}\n/* TODO */\n\n\nfunction write_props_xlml(wb\n/*:Workbook*/\n, opts)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n  /* DocumentProperties */\n\n  if (wb.Props) o.push(xlml_write_docprops(wb.Props, opts));\n  /* CustomDocumentProperties */\n\n  if (wb.Custprops) o.push(xlml_write_custprops(wb.Props, wb.Custprops, opts));\n  return o.join(\"\");\n}\n/* TODO */\n\n\nfunction\n  /*::wb, opts*/\nwrite_wb_xlml()\n/*:string*/\n{\n  /* OfficeDocumentSettings */\n\n  /* ExcelWorkbook */\n  return \"\";\n}\n/* TODO */\n\n\nfunction write_sty_xlml(wb, opts)\n/*:string*/\n{\n  /* Styles */\n  var styles\n  /*:Array<string>*/\n  = ['<Style ss:ID=\"Default\" ss:Name=\"Normal\"><NumberFormat/></Style>'];\n  opts.cellXfs.forEach(function (xf, id) {\n    var payload\n    /*:Array<string>*/\n    = [];\n    payload.push(writextag('NumberFormat', null, {\n      \"ss:Format\": escapexml(table_fmt[xf.numFmtId])\n    }));\n    var o =\n    /*::(*/\n    {\n      \"ss:ID\": \"s\" + (21 + id)\n    }\n    /*:: :any)*/\n    ;\n    styles.push(writextag('Style', payload.join(\"\"), o));\n  });\n  return writextag(\"Styles\", styles.join(\"\"));\n}\n\nfunction write_name_xlml(n) {\n  return writextag(\"NamedRange\", null, {\n    \"ss:Name\": n.Name,\n    \"ss:RefersTo\": \"=\" + a1_to_rc(n.Ref, {\n      r: 0,\n      c: 0\n    })\n  });\n}\n\nfunction write_names_xlml(wb\n/*::, opts*/\n)\n/*:string*/\n{\n  if (!((wb || {}).Workbook || {}).Names) return \"\";\n  /*:: if(!wb || !wb.Workbook || !wb.Workbook.Names) throw new Error(\"unreachable\"); */\n\n  var names\n  /*:Array<any>*/\n  = wb.Workbook.Names;\n  var out\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < names.length; ++i) {\n    var n = names[i];\n    if (n.Sheet != null) continue;\n    if (n.Name.match(/^_xlfn\\./)) continue;\n    out.push(write_name_xlml(n));\n  }\n\n  return writextag(\"Names\", out.join(\"\"));\n}\n\nfunction write_ws_xlml_names(ws\n/*:Worksheet*/\n, opts, idx\n/*:number*/\n, wb\n/*:Workbook*/\n)\n/*:string*/\n{\n  if (!ws) return \"\";\n  if (!((wb || {}).Workbook || {}).Names) return \"\";\n  /*:: if(!wb || !wb.Workbook || !wb.Workbook.Names) throw new Error(\"unreachable\"); */\n\n  var names\n  /*:Array<any>*/\n  = wb.Workbook.Names;\n  var out\n  /*:Array<string>*/\n  = [];\n\n  for (var i = 0; i < names.length; ++i) {\n    var n = names[i];\n    if (n.Sheet != idx) continue;\n    /*switch(n.Name) {\n    \tcase \"_\": continue;\n    }*/\n\n    if (n.Name.match(/^_xlfn\\./)) continue;\n    out.push(write_name_xlml(n));\n  }\n\n  return out.join(\"\");\n}\n/* WorksheetOptions */\n\n\nfunction write_ws_xlml_wsopts(ws\n/*:Worksheet*/\n, opts, idx\n/*:number*/\n, wb\n/*:Workbook*/\n)\n/*:string*/\n{\n  if (!ws) return \"\";\n  var o\n  /*:Array<string>*/\n  = [];\n  /* NOTE: spec technically allows any order, but stick with implied order */\n\n  /* FitToPage */\n\n  /* DoNotDisplayColHeaders */\n\n  /* DoNotDisplayRowHeaders */\n\n  /* ViewableRange */\n\n  /* Selection */\n\n  /* GridlineColor */\n\n  /* Name */\n\n  /* ExcelWorksheetType */\n\n  /* IntlMacro */\n\n  /* Unsynced */\n\n  /* Selected */\n\n  /* CodeName */\n\n  if (ws['!margins']) {\n    o.push(\"<PageSetup>\");\n    if (ws['!margins'].header) o.push(writextag(\"Header\", null, {\n      'x:Margin': ws['!margins'].header\n    }));\n    if (ws['!margins'].footer) o.push(writextag(\"Footer\", null, {\n      'x:Margin': ws['!margins'].footer\n    }));\n    o.push(writextag(\"PageMargins\", null, {\n      'x:Bottom': ws['!margins'].bottom || \"0.75\",\n      'x:Left': ws['!margins'].left || \"0.7\",\n      'x:Right': ws['!margins'].right || \"0.7\",\n      'x:Top': ws['!margins'].top || \"0.75\"\n    }));\n    o.push(\"</PageSetup>\");\n  }\n  /* PageSetup */\n\n  /* DisplayPageBreak */\n\n  /* TransitionExpressionEvaluation */\n\n  /* TransitionFormulaEntry */\n\n  /* Print */\n\n  /* Zoom */\n\n  /* PageLayoutZoom */\n\n  /* PageBreakZoom */\n\n  /* ShowPageBreakZoom */\n\n  /* DefaultRowHeight */\n\n  /* DefaultColumnWidth */\n\n  /* StandardWidth */\n\n\n  if (wb && wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx]) {\n    /* Visible */\n    if (wb.Workbook.Sheets[idx].Hidden) o.push(writextag(\"Visible\", wb.Workbook.Sheets[idx].Hidden == 1 ? \"SheetHidden\" : \"SheetVeryHidden\", {}));else {\n      /* Selected */\n      for (var i = 0; i < idx; ++i) if (wb.Workbook.Sheets[i] && !wb.Workbook.Sheets[i].Hidden) break;\n\n      if (i == idx) o.push(\"<Selected/>\");\n    }\n  }\n  /* LeftColumnVisible */\n\n\n  if (((((wb || {}).Workbook || {}).Views || [])[0] || {}).RTL) o.push(\"<DisplayRightToLeft/>\");\n  /* GridlineColorIndex */\n\n  /* DisplayFormulas */\n\n  /* DoNotDisplayGridlines */\n\n  /* DoNotDisplayHeadings */\n\n  /* DoNotDisplayOutline */\n\n  /* ApplyAutomaticOutlineStyles */\n\n  /* NoSummaryRowsBelowDetail */\n\n  /* NoSummaryColumnsRightDetail */\n\n  /* DoNotDisplayZeros */\n\n  /* ActiveRow */\n\n  /* ActiveColumn */\n\n  /* FilterOn */\n\n  /* RangeSelection */\n\n  /* TopRowVisible */\n\n  /* TopRowBottomPane */\n\n  /* LeftColumnRightPane */\n\n  /* ActivePane */\n\n  /* SplitHorizontal */\n\n  /* SplitVertical */\n\n  /* FreezePanes */\n\n  /* FrozenNoSplit */\n\n  /* TabColorIndex */\n\n  /* Panes */\n\n  /* NOTE: Password not supported in XLML Format */\n\n  if (ws['!protect']) {\n    o.push(writetag(\"ProtectContents\", \"True\"));\n    if (ws['!protect'].objects) o.push(writetag(\"ProtectObjects\", \"True\"));\n    if (ws['!protect'].scenarios) o.push(writetag(\"ProtectScenarios\", \"True\"));\n    if (ws['!protect'].selectLockedCells != null && !ws['!protect'].selectLockedCells) o.push(writetag(\"EnableSelection\", \"NoSelection\"));else if (ws['!protect'].selectUnlockedCells != null && !ws['!protect'].selectUnlockedCells) o.push(writetag(\"EnableSelection\", \"UnlockedCells\"));\n    [[\"formatCells\", \"AllowFormatCells\"], [\"formatColumns\", \"AllowSizeCols\"], [\"formatRows\", \"AllowSizeRows\"], [\"insertColumns\", \"AllowInsertCols\"], [\"insertRows\", \"AllowInsertRows\"], [\"insertHyperlinks\", \"AllowInsertHyperlinks\"], [\"deleteColumns\", \"AllowDeleteCols\"], [\"deleteRows\", \"AllowDeleteRows\"], [\"sort\", \"AllowSort\"], [\"autoFilter\", \"AllowFilter\"], [\"pivotTables\", \"AllowUsePivotTables\"]].forEach(function (x) {\n      if (ws['!protect'][x[0]]) o.push(\"<\" + x[1] + \"/>\");\n    });\n  }\n\n  if (o.length == 0) return \"\";\n  return writextag(\"WorksheetOptions\", o.join(\"\"), {\n    xmlns: XLMLNS.x\n  });\n}\n\nfunction write_ws_xlml_comment(comments\n/*:Array<any>*/\n)\n/*:string*/\n{\n  return comments.map(function (c) {\n    // TODO: formatted text\n    var t = xlml_unfixstr(c.t || \"\");\n    var d = writextag(\"ss:Data\", t, {\n      \"xmlns\": \"http://www.w3.org/TR/REC-html40\"\n    });\n    return writextag(\"Comment\", d, {\n      \"ss:Author\": c.a\n    });\n  }).join(\"\");\n}\n\nfunction write_ws_xlml_cell(cell, ref\n/*:string*/\n, ws, opts, idx\n/*:number*/\n, wb, addr)\n/*:string*/\n{\n  if (!cell || cell.v == undefined && cell.f == undefined) return \"\";\n  var attr = {};\n  if (cell.f) attr[\"ss:Formula\"] = \"=\" + escapexml(a1_to_rc(cell.f, addr));\n\n  if (cell.F && cell.F.slice(0, ref.length) == ref) {\n    var end = decode_cell(cell.F.slice(ref.length + 1));\n    attr[\"ss:ArrayRange\"] = \"RC:R\" + (end.r == addr.r ? \"\" : \"[\" + (end.r - addr.r) + \"]\") + \"C\" + (end.c == addr.c ? \"\" : \"[\" + (end.c - addr.c) + \"]\");\n  }\n\n  if (cell.l && cell.l.Target) {\n    attr[\"ss:HRef\"] = escapexml(cell.l.Target);\n    if (cell.l.Tooltip) attr[\"x:HRefScreenTip\"] = escapexml(cell.l.Tooltip);\n  }\n\n  if (ws['!merges']) {\n    var marr = ws['!merges'];\n\n    for (var mi = 0; mi != marr.length; ++mi) {\n      if (marr[mi].s.c != addr.c || marr[mi].s.r != addr.r) continue;\n      if (marr[mi].e.c > marr[mi].s.c) attr['ss:MergeAcross'] = marr[mi].e.c - marr[mi].s.c;\n      if (marr[mi].e.r > marr[mi].s.r) attr['ss:MergeDown'] = marr[mi].e.r - marr[mi].s.r;\n    }\n  }\n\n  var t = \"\",\n      p = \"\";\n\n  switch (cell.t) {\n    case 'z':\n      if (!opts.sheetStubs) return \"\";\n      break;\n\n    case 'n':\n      t = 'Number';\n      p = String(cell.v);\n      break;\n\n    case 'b':\n      t = 'Boolean';\n      p = cell.v ? \"1\" : \"0\";\n      break;\n\n    case 'e':\n      t = 'Error';\n      p = BErr[cell.v];\n      break;\n\n    case 'd':\n      t = 'DateTime';\n      p = new Date(cell.v).toISOString();\n      if (cell.z == null) cell.z = cell.z || table_fmt[14];\n      break;\n\n    case 's':\n      t = 'String';\n      p = escapexlml(cell.v || \"\");\n      break;\n  }\n  /* TODO: cell style */\n\n\n  var os = get_cell_style(opts.cellXfs, cell, opts);\n  attr[\"ss:StyleID\"] = \"s\" + (21 + os);\n  attr[\"ss:Index\"] = addr.c + 1;\n\n  var _v = cell.v != null ? p : \"\";\n\n  var m = cell.t == 'z' ? \"\" : '<Data ss:Type=\"' + t + '\">' + _v + '</Data>';\n  if ((cell.c || []).length > 0) m += write_ws_xlml_comment(cell.c);\n  return writextag(\"Cell\", m, attr);\n}\n\nfunction write_ws_xlml_row(R\n/*:number*/\n, row)\n/*:string*/\n{\n  var o = '<Row ss:Index=\"' + (R + 1) + '\"';\n\n  if (row) {\n    if (row.hpt && !row.hpx) row.hpx = pt2px(row.hpt);\n    if (row.hpx) o += ' ss:AutoFitHeight=\"0\" ss:Height=\"' + row.hpx + '\"';\n    if (row.hidden) o += ' ss:Hidden=\"1\"';\n  }\n\n  return o + '>';\n}\n/* TODO */\n\n\nfunction write_ws_xlml_table(ws\n/*:Worksheet*/\n, opts, idx\n/*:number*/\n, wb\n/*:Workbook*/\n)\n/*:string*/\n{\n  if (!ws['!ref']) return \"\";\n  var range\n  /*:Range*/\n  = safe_decode_range(ws['!ref']);\n  var marr\n  /*:Array<Range>*/\n  = ws['!merges'] || [],\n      mi = 0;\n  var o\n  /*:Array<string>*/\n  = [];\n  if (ws['!cols']) ws['!cols'].forEach(function (n, i) {\n    process_col(n);\n    var w = !!n.width;\n    var p = col_obj_w(i, n);\n    var k\n    /*:any*/\n    = {\n      \"ss:Index\": i + 1\n    };\n    if (w) k['ss:Width'] = width2px(p.width);\n    if (n.hidden) k['ss:Hidden'] = \"1\";\n    o.push(writextag(\"Column\", null, k));\n  });\n  var dense = Array.isArray(ws);\n\n  for (var R = range.s.r; R <= range.e.r; ++R) {\n    var row = [write_ws_xlml_row(R, (ws['!rows'] || [])[R])];\n\n    for (var C = range.s.c; C <= range.e.c; ++C) {\n      var skip = false;\n\n      for (mi = 0; mi != marr.length; ++mi) {\n        if (marr[mi].s.c > C) continue;\n        if (marr[mi].s.r > R) continue;\n        if (marr[mi].e.c < C) continue;\n        if (marr[mi].e.r < R) continue;\n        if (marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n        break;\n      }\n\n      if (skip) continue;\n      var addr = {\n        r: R,\n        c: C\n      };\n      var ref = encode_cell(addr),\n          cell = dense ? (ws[R] || [])[C] : ws[ref];\n      row.push(write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr));\n    }\n\n    row.push(\"</Row>\");\n    if (row.length > 2) o.push(row.join(\"\"));\n  }\n\n  return o.join(\"\");\n}\n\nfunction write_ws_xlml(idx\n/*:number*/\n, opts, wb\n/*:Workbook*/\n)\n/*:string*/\n{\n  var o\n  /*:Array<string>*/\n  = [];\n  var s = wb.SheetNames[idx];\n  var ws = wb.Sheets[s];\n  var t\n  /*:string*/\n  = ws ? write_ws_xlml_names(ws, opts, idx, wb) : \"\";\n  if (t.length > 0) o.push(\"<Names>\" + t + \"</Names>\");\n  /* Table */\n\n  t = ws ? write_ws_xlml_table(ws, opts, idx, wb) : \"\";\n  if (t.length > 0) o.push(\"<Table>\" + t + \"</Table>\");\n  /* WorksheetOptions */\n\n  o.push(write_ws_xlml_wsopts(ws, opts, idx, wb));\n  return o.join(\"\");\n}\n\nfunction write_xlml(wb, opts)\n/*:string*/\n{\n  if (!opts) opts = {};\n  if (!wb.SSF) wb.SSF = dup(table_fmt);\n\n  if (wb.SSF) {\n    make_ssf();\n    SSF_load_table(wb.SSF); // $FlowIgnore\n\n    opts.revssf = evert_num(wb.SSF);\n    opts.revssf[wb.SSF[65535]] = 0;\n    opts.ssf = wb.SSF;\n    opts.cellXfs = [];\n    get_cell_style(opts.cellXfs, {}, {\n      revssf: {\n        \"General\": 0\n      }\n    });\n  }\n\n  var d\n  /*:Array<string>*/\n  = [];\n  d.push(write_props_xlml(wb, opts));\n  d.push(write_wb_xlml(wb, opts));\n  d.push(\"\");\n  d.push(\"\");\n\n  for (var i = 0; i < wb.SheetNames.length; ++i) d.push(writextag(\"Worksheet\", write_ws_xlml(i, opts, wb), {\n    \"ss:Name\": escapexml(wb.SheetNames[i])\n  }));\n\n  d[2] = write_sty_xlml(wb, opts);\n  d[3] = write_names_xlml(wb, opts);\n  return XML_HEADER + writextag(\"Workbook\", d.join(\"\"), {\n    'xmlns': XLMLNS.ss,\n    'xmlns:o': XLMLNS.o,\n    'xmlns:x': XLMLNS.x,\n    'xmlns:ss': XLMLNS.ss,\n    'xmlns:dt': XLMLNS.dt,\n    'xmlns:html': XLMLNS.html\n  });\n}\n/* [MS-OLEDS] 2.3.8 CompObjStream */\n\n\nfunction parse_compobj(obj\n/*:CFBEntry*/\n) {\n  var v = {};\n  var o = obj.content;\n  /*:: if(o == null) return; */\n\n  /* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\n  o.l = 28;\n  v.AnsiUserType = o.read_shift(0, \"lpstr-ansi\");\n  v.AnsiClipboardFormat = parse_ClipboardFormatOrAnsiString(o);\n  if (o.length - o.l <= 4) return v;\n  var m\n  /*:number*/\n  = o.read_shift(4);\n  if (m == 0 || m > 40) return v;\n  o.l -= 4;\n  v.Reserved1 = o.read_shift(0, \"lpstr-ansi\");\n  if (o.length - o.l <= 4) return v;\n  m = o.read_shift(4);\n  if (m !== 0x71b239f4) return v;\n  v.UnicodeClipboardFormat = parse_ClipboardFormatOrUnicodeString(o);\n  m = o.read_shift(4);\n  if (m == 0 || m > 40) return v;\n  o.l -= 4;\n  v.Reserved2 = o.read_shift(0, \"lpwstr\");\n}\n/*\n\tContinue logic for:\n\t- 2.4.58 Continue          0x003c\n\t- 2.4.59 ContinueBigName   0x043c\n\t- 2.4.60 ContinueFrt       0x0812\n\t- 2.4.61 ContinueFrt11     0x0875\n\t- 2.4.62 ContinueFrt12     0x087f\n*/\n\n\nvar CONTINUE_RT = [0x003c, 0x043c, 0x0812, 0x0875, 0x087f];\n\nfunction slurp(RecordType, R, blob, length\n/*:number*/\n, opts)\n/*:any*/\n{\n  var l = length;\n  var bufs = [];\n  var d = blob.slice(blob.l, blob.l + l);\n  if (opts && opts.enc && opts.enc.insitu && d.length > 0) switch (RecordType) {\n    case 0x0009:\n    case 0x0209:\n    case 0x0409:\n    case 0x0809\n    /* BOF */\n    :\n    case 0x002f\n    /* FilePass */\n    :\n    case 0x0195\n    /* FileLock */\n    :\n    case 0x00e1\n    /* InterfaceHdr */\n    :\n    case 0x0196\n    /* RRDInfo */\n    :\n    case 0x0138\n    /* RRDHead */\n    :\n    case 0x0194\n    /* UsrExcl */\n    :\n    case 0x000a\n    /* EOF */\n    :\n      break;\n\n    case 0x0085\n    /* BoundSheet8 */\n    :\n      break;\n\n    default:\n      opts.enc.insitu(d);\n  }\n  bufs.push(d);\n  blob.l += l;\n\n  var nextrt = __readUInt16LE(blob, blob.l),\n      next = XLSRecordEnum[nextrt];\n\n  var start = 0;\n\n  while (next != null && CONTINUE_RT.indexOf(nextrt) > -1) {\n    l = __readUInt16LE(blob, blob.l + 2);\n    start = blob.l + 4;\n    if (nextrt == 0x0812\n    /* ContinueFrt */\n    ) start += 4;else if (nextrt == 0x0875 || nextrt == 0x087f) {\n      start += 12;\n    }\n    d = blob.slice(start, blob.l + 4 + l);\n    bufs.push(d);\n    blob.l += 4 + l;\n    next = XLSRecordEnum[nextrt = __readUInt16LE(blob, blob.l)];\n  }\n\n  var b = bconcat(bufs)\n  /*:any*/\n  ;\n  prep_blob(b, 0);\n  var ll = 0;\n  b.lens = [];\n\n  for (var j = 0; j < bufs.length; ++j) {\n    b.lens.push(ll);\n    ll += bufs[j].length;\n  }\n\n  if (b.length < length) throw \"XLS Record 0x\" + RecordType.toString(16) + \" Truncated: \" + b.length + \" < \" + length;\n  return R.f(b, b.length, opts);\n}\n\nfunction safe_format_xf(p\n/*:any*/\n, opts\n/*:ParseOpts*/\n, date1904\n/*:?boolean*/\n) {\n  if (p.t === 'z') return;\n  if (!p.XF) return;\n  var fmtid = 0;\n\n  try {\n    fmtid = p.z || p.XF.numFmtId || 0;\n    if (opts.cellNF) p.z = table_fmt[fmtid];\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n\n  if (!opts || opts.cellText !== false) try {\n    if (p.t === 'e') {\n      p.w = p.w || BErr[p.v];\n    } else if (fmtid === 0 || fmtid == \"General\") {\n      if (p.t === 'n') {\n        if ((p.v | 0) === p.v) p.w = p.v.toString(10);else p.w = SSF_general_num(p.v);\n      } else p.w = SSF_general(p.v);\n    } else p.w = SSF_format(fmtid, p.v, {\n      date1904: !!date1904,\n      dateNF: opts && opts.dateNF\n    });\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n\n  if (opts.cellDates && fmtid && p.t == 'n' && fmt_is_date(table_fmt[fmtid] || String(fmtid))) {\n    var _d = SSF_parse_date_code(p.v);\n\n    if (_d) {\n      p.t = 'd';\n      p.v = new Date(_d.y, _d.m - 1, _d.d, _d.H, _d.M, _d.S, _d.u);\n    }\n  }\n}\n\nfunction make_cell(val, ixfe, t)\n/*:Cell*/\n{\n  return {\n    v: val,\n    ixfe: ixfe,\n    t: t\n  }\n  /*:any*/\n  ;\n} // 2.3.2\n\n\nfunction parse_workbook(blob, options\n/*:ParseOpts*/\n)\n/*:Workbook*/\n{\n  var wb = {\n    opts: {}\n  }\n  /*:any*/\n  ;\n  var Sheets = {};\n  if (DENSE != null && options.dense == null) options.dense = DENSE;\n  var out\n  /*:Worksheet*/\n  = options.dense ? [] : {}\n  /*:any*/\n  ;\n  var Directory = {};\n  var range\n  /*:Range*/\n  = {}\n  /*:any*/\n  ;\n  var last_formula = null;\n  var sst\n  /*:SST*/\n  = []\n  /*:any*/\n  ;\n  var cur_sheet = \"\";\n  var Preamble = {};\n  var lastcell,\n      last_cell = \"\",\n      cc\n  /*:Cell*/\n  ,\n      cmnt,\n      rngC,\n      rngR;\n  var sharedf = {};\n  var arrayf\n  /*:Array<[Range, string]>*/\n  = [];\n  var temp_val\n  /*:Cell*/\n  ;\n  var country;\n  var XFs = [];\n  /* XF records */\n\n  var palette\n  /*:Array<[number, number, number]>*/\n  = [];\n  var Workbook\n  /*:WBWBProps*/\n  = {\n    Sheets: [],\n    WBProps: {\n      date1904: false\n    },\n    Views: [{}]\n  }\n  /*:any*/\n  ,\n      wsprops = {};\n\n  var get_rgb = function getrgb(icv\n  /*:number*/\n  )\n  /*:[number, number, number]*/\n  {\n    if (icv < 8) return XLSIcv[icv];\n    if (icv < 64) return palette[icv - 8] || XLSIcv[icv];\n    return XLSIcv[icv];\n  };\n\n  var process_cell_style = function pcs(cell, line\n  /*:any*/\n  , options) {\n    var xfd = line.XF.data;\n    if (!xfd || !xfd.patternType || !options || !options.cellStyles) return;\n    line.s = {}\n    /*:any*/\n    ;\n    line.s.patternType = xfd.patternType;\n    var t;\n\n    if (t = rgb2Hex(get_rgb(xfd.icvFore))) {\n      line.s.fgColor = {\n        rgb: t\n      };\n    }\n\n    if (t = rgb2Hex(get_rgb(xfd.icvBack))) {\n      line.s.bgColor = {\n        rgb: t\n      };\n    }\n  };\n\n  var addcell = function addcell(cell\n  /*:any*/\n  , line\n  /*:any*/\n  , options\n  /*:any*/\n  ) {\n    if (file_depth > 1) return;\n    if (options.sheetRows && cell.r >= options.sheetRows) return;\n    if (options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line, options);\n    delete line.ixfe;\n    delete line.XF;\n    lastcell = cell;\n    last_cell = encode_cell(cell);\n    if (!range || !range.s || !range.e) range = {\n      s: {\n        r: 0,\n        c: 0\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    if (cell.r < range.s.r) range.s.r = cell.r;\n    if (cell.c < range.s.c) range.s.c = cell.c;\n    if (cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n    if (cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n\n    if (options.cellFormula && line.f) {\n      for (var afi = 0; afi < arrayf.length; ++afi) {\n        if (arrayf[afi][0].s.c > cell.c || arrayf[afi][0].s.r > cell.r) continue;\n        if (arrayf[afi][0].e.c < cell.c || arrayf[afi][0].e.r < cell.r) continue;\n        line.F = encode_range(arrayf[afi][0]);\n        if (arrayf[afi][0].s.c != cell.c || arrayf[afi][0].s.r != cell.r) delete line.f;\n        if (line.f) line.f = \"\" + stringify_formula(arrayf[afi][1], range, cell, supbooks, opts);\n        break;\n      }\n    }\n\n    {\n      if (options.dense) {\n        if (!out[cell.r]) out[cell.r] = [];\n        out[cell.r][cell.c] = line;\n      } else out[last_cell] = line;\n    }\n  };\n\n  var opts = {\n    enc: false,\n    // encrypted\n    sbcch: 0,\n    // cch in the preceding SupBook\n    snames: [],\n    // sheetnames\n    sharedf: sharedf,\n    // shared formulae by address\n    arrayf: arrayf,\n    // array formulae array\n    rrtabid: [],\n    // RRTabId\n    lastuser: \"\",\n    // Last User from WriteAccess\n    biff: 8,\n    // BIFF version\n    codepage: 0,\n    // CP from CodePage record\n    winlocked: 0,\n    // fLockWn from WinProtect\n    cellStyles: !!options && !!options.cellStyles,\n    WTF: !!options && !!options.wtf\n  }\n  /*:any*/\n  ;\n  if (options.password) opts.password = options.password;\n  var themes;\n  var merges\n  /*:Array<Range>*/\n  = [];\n  var objects = [];\n  var colinfo\n  /*:Array<ColInfo>*/\n  = [],\n      rowinfo\n  /*:Array<RowInfo>*/\n  = [];\n  var seencol = false;\n  var supbooks = []\n  /*:any*/\n  ; // 1-indexed, will hold extern names\n\n  supbooks.SheetNames = opts.snames;\n  supbooks.sharedf = opts.sharedf;\n  supbooks.arrayf = opts.arrayf;\n  supbooks.names = [];\n  supbooks.XTI = [];\n  var last_RT = 0;\n  var file_depth = 0;\n  /* TODO: make a real stack */\n\n  var BIFF2Fmt = 0,\n      BIFF2FmtTable\n  /*:Array<string>*/\n  = [];\n  var FilterDatabases = [];\n  /* TODO: sort out supbooks and process elsewhere */\n\n  var last_lbl\n  /*:?DefinedName*/\n  ;\n  /* explicit override for some broken writers */\n\n  opts.codepage = 1200;\n  set_cp(1200);\n  var seen_codepage = false;\n\n  while (blob.l < blob.length - 1) {\n    var s = blob.l;\n    var RecordType = blob.read_shift(2);\n    if (RecordType === 0 && last_RT === 0x000a\n    /* EOF */\n    ) break;\n    var length = blob.l === blob.length ? 0 : blob.read_shift(2);\n    var R = XLSRecordEnum[RecordType]; //console.log(RecordType.toString(16), RecordType, R, blob.l, length, blob.length);\n    //if(!R) console.log(blob.slice(blob.l, blob.l + length));\n\n    if (R && R.f) {\n      if (options.bookSheets) {\n        if (last_RT === 0x0085\n        /* BoundSheet8 */\n        && RecordType !== 0x0085\n        /* R.n !== 'BoundSheet8' */\n        ) break;\n      }\n\n      last_RT = RecordType;\n\n      if (R.r === 2 || R.r == 12) {\n        var rt = blob.read_shift(2);\n        length -= 2;\n        if (!opts.enc && rt !== RecordType && ((rt & 0xFF) << 8 | rt >> 8) !== RecordType) throw new Error(\"rt mismatch: \" + rt + \"!=\" + RecordType);\n\n        if (R.r == 12) {\n          blob.l += 10;\n          length -= 10;\n        } // skip FRT\n\n      } //console.error(R,blob.l,length,blob.length);\n\n\n      var val\n      /*:any*/\n      = {}\n      /*:any*/\n      ;\n      if (RecordType === 0x000a\n      /* EOF */\n      ) val =\n      /*::(*/\n      R.f(blob, length, opts)\n      /*:: :any)*/\n      ;else val =\n      /*::(*/\n      slurp(RecordType, R, blob, length, opts)\n      /*:: :any)*/\n      ;\n      /*:: val = (val:any); */\n\n      if (file_depth == 0 && [0x0009, 0x0209, 0x0409, 0x0809].indexOf(last_RT) === -1\n      /* 'BOF' */\n      ) continue;\n\n      switch (RecordType) {\n        case 0x0022\n        /* Date1904 */\n        :\n          /*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n          wb.opts.Date1904 = Workbook.WBProps.date1904 = val;\n          break;\n\n        case 0x0086\n        /* WriteProtect */\n        :\n          wb.opts.WriteProtect = true;\n          break;\n\n        case 0x002f\n        /* FilePass */\n        :\n          if (!opts.enc) blob.l = 0;\n          opts.enc = val;\n          if (!options.password) throw new Error(\"File is password-protected\");\n          if (val.valid == null) throw new Error(\"Encryption scheme unsupported\");\n          if (!val.valid) throw new Error(\"Password is incorrect\");\n          break;\n\n        case 0x005c\n        /* WriteAccess */\n        :\n          opts.lastuser = val;\n          break;\n\n        case 0x0042\n        /* CodePage */\n        :\n          var cpval = Number(val);\n          /* overrides based on test cases */\n\n          switch (cpval) {\n            case 0x5212:\n              cpval = 1200;\n              break;\n\n            case 0x8000:\n              cpval = 10000;\n              break;\n\n            case 0x8001:\n              cpval = 1252;\n              break;\n          }\n\n          set_cp(opts.codepage = cpval);\n          seen_codepage = true;\n          break;\n\n        case 0x013d\n        /* RRTabId */\n        :\n          opts.rrtabid = val;\n          break;\n\n        case 0x0019\n        /* WinProtect */\n        :\n          opts.winlocked = val;\n          break;\n\n        case 0x01b7\n        /* RefreshAll */\n        :\n          wb.opts[\"RefreshAll\"] = val;\n          break;\n\n        case 0x000c\n        /* CalcCount */\n        :\n          wb.opts[\"CalcCount\"] = val;\n          break;\n\n        case 0x0010\n        /* CalcDelta */\n        :\n          wb.opts[\"CalcDelta\"] = val;\n          break;\n\n        case 0x0011\n        /* CalcIter */\n        :\n          wb.opts[\"CalcIter\"] = val;\n          break;\n\n        case 0x000d\n        /* CalcMode */\n        :\n          wb.opts[\"CalcMode\"] = val;\n          break;\n\n        case 0x000e\n        /* CalcPrecision */\n        :\n          wb.opts[\"CalcPrecision\"] = val;\n          break;\n\n        case 0x005f\n        /* CalcSaveRecalc */\n        :\n          wb.opts[\"CalcSaveRecalc\"] = val;\n          break;\n\n        case 0x000f\n        /* CalcRefMode */\n        :\n          opts.CalcRefMode = val;\n          break;\n        // TODO: implement R1C1\n\n        case 0x08a3\n        /* ForceFullCalculation */\n        :\n          wb.opts.FullCalc = val;\n          break;\n\n        case 0x0081\n        /* WsBool */\n        :\n          if (val.fDialog) out[\"!type\"] = \"dialog\";\n          if (!val.fBelow) (out[\"!outline\"] || (out[\"!outline\"] = {})).above = true;\n          if (!val.fRight) (out[\"!outline\"] || (out[\"!outline\"] = {})).left = true;\n          break;\n        // TODO\n\n        case 0x00e0\n        /* XF */\n        :\n          XFs.push(val);\n          break;\n\n        case 0x01ae\n        /* SupBook */\n        :\n          supbooks.push([val]);\n          supbooks[supbooks.length - 1].XTI = [];\n          break;\n\n        case 0x0023:\n        case 0x0223\n        /* ExternName */\n        :\n          supbooks[supbooks.length - 1].push(val);\n          break;\n\n        case 0x0018:\n        case 0x0218\n        /* Lbl */\n        :\n          last_lbl = {\n            Name: val.Name,\n            Ref: stringify_formula(val.rgce, range, null, supbooks, opts)\n          }\n          /*:DefinedName*/\n          ;\n          if (val.itab > 0) last_lbl.Sheet = val.itab - 1;\n          supbooks.names.push(last_lbl);\n\n          if (!supbooks[0]) {\n            supbooks[0] = [];\n            supbooks[0].XTI = [];\n          }\n\n          supbooks[supbooks.length - 1].push(val);\n          if (val.Name == \"_xlnm._FilterDatabase\" && val.itab > 0) if (val.rgce && val.rgce[0] && val.rgce[0][0] && val.rgce[0][0][0] == 'PtgArea3d') FilterDatabases[val.itab - 1] = {\n            ref: encode_range(val.rgce[0][0][1][2])\n          };\n          break;\n\n        case 0x0016\n        /* ExternCount */\n        :\n          opts.ExternCount = val;\n          break;\n\n        case 0x0017\n        /* ExternSheet */\n        :\n          if (supbooks.length == 0) {\n            supbooks[0] = [];\n            supbooks[0].XTI = [];\n          }\n\n          supbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n          supbooks.XTI = supbooks.XTI.concat(val);\n          break;\n\n        case 0x0894\n        /* NameCmt */\n        :\n          /* TODO: search for correct name */\n          if (opts.biff < 8) break;\n          if (last_lbl != null) last_lbl.Comment = val[1];\n          break;\n\n        case 0x0012\n        /* Protect */\n        :\n          out[\"!protect\"] = val;\n          break;\n\n        /* for sheet or book */\n\n        case 0x0013\n        /* Password */\n        :\n          if (val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val);\n          break;\n\n        case 0x0085\n        /* BoundSheet8 */\n        :\n          {\n            Directory[val.pos] = val;\n            opts.snames.push(val.name);\n          }\n          break;\n\n        case 0x000a\n        /* EOF */\n        :\n          {\n            if (--file_depth) break;\n\n            if (range.e) {\n              if (range.e.r > 0 && range.e.c > 0) {\n                range.e.r--;\n                range.e.c--;\n                out[\"!ref\"] = encode_range(range);\n\n                if (options.sheetRows && options.sheetRows <= range.e.r) {\n                  var tmpri = range.e.r;\n                  range.e.r = options.sheetRows - 1;\n                  out[\"!fullref\"] = out[\"!ref\"];\n                  out[\"!ref\"] = encode_range(range);\n                  range.e.r = tmpri;\n                }\n\n                range.e.r++;\n                range.e.c++;\n              }\n\n              if (merges.length > 0) out[\"!merges\"] = merges;\n              if (objects.length > 0) out[\"!objects\"] = objects;\n              if (colinfo.length > 0) out[\"!cols\"] = colinfo;\n              if (rowinfo.length > 0) out[\"!rows\"] = rowinfo;\n              Workbook.Sheets.push(wsprops);\n            }\n\n            if (cur_sheet === \"\") Preamble = out;else Sheets[cur_sheet] = out;\n            out = options.dense ? [] : {}\n            /*:any*/\n            ;\n          }\n          break;\n\n        case 0x0009:\n        case 0x0209:\n        case 0x0409:\n        case 0x0809\n        /* BOF */\n        :\n          {\n            if (opts.biff === 8) opts.biff = {\n              /*::[*/\n              0x0009\n              /*::]*/\n              : 2,\n\n              /*::[*/\n              0x0209\n              /*::]*/\n              : 3,\n\n              /*::[*/\n              0x0409\n              /*::]*/\n              : 4\n            }[RecordType] || {\n              /*::[*/\n              0x0200\n              /*::]*/\n              : 2,\n\n              /*::[*/\n              0x0300\n              /*::]*/\n              : 3,\n\n              /*::[*/\n              0x0400\n              /*::]*/\n              : 4,\n\n              /*::[*/\n              0x0500\n              /*::]*/\n              : 5,\n\n              /*::[*/\n              0x0600\n              /*::]*/\n              : 8,\n\n              /*::[*/\n              0x0002\n              /*::]*/\n              : 2,\n\n              /*::[*/\n              0x0007\n              /*::]*/\n              : 2\n            }[val.BIFFVer] || 8;\n            opts.biffguess = val.BIFFVer == 0;\n\n            if (val.BIFFVer == 0 && val.dt == 0x1000) {\n              opts.biff = 5;\n              seen_codepage = true;\n              set_cp(opts.codepage = 28591);\n            }\n\n            if (opts.biff == 8 && val.BIFFVer == 0 && val.dt == 16) opts.biff = 2;\n            if (file_depth++) break;\n            out = options.dense ? [] : {}\n            /*:any*/\n            ;\n\n            if (opts.biff < 8 && !seen_codepage) {\n              seen_codepage = true;\n              set_cp(opts.codepage = options.codepage || 1252);\n            }\n\n            if (opts.biff < 5 || val.BIFFVer == 0 && val.dt == 0x1000) {\n              if (cur_sheet === \"\") cur_sheet = \"Sheet1\";\n              range = {\n                s: {\n                  r: 0,\n                  c: 0\n                },\n                e: {\n                  r: 0,\n                  c: 0\n                }\n              };\n              /* fake BoundSheet8 */\n\n              var fakebs8 = {\n                pos: blob.l - length,\n                name: cur_sheet\n              };\n              Directory[fakebs8.pos] = fakebs8;\n              opts.snames.push(cur_sheet);\n            } else cur_sheet = (Directory[s] || {\n              name: \"\"\n            }).name;\n\n            if (val.dt == 0x20) out[\"!type\"] = \"chart\";\n            if (val.dt == 0x40) out[\"!type\"] = \"macro\";\n            merges = [];\n            objects = [];\n            opts.arrayf = arrayf = [];\n            colinfo = [];\n            rowinfo = [];\n            seencol = false;\n            wsprops = {\n              Hidden: (Directory[s] || {\n                hs: 0\n              }).hs,\n              name: cur_sheet\n            };\n          }\n          break;\n\n        case 0x0203\n        /* Number */\n        :\n        case 0x0003\n        /* BIFF2NUM */\n        :\n        case 0x0002\n        /* BIFF2INT */\n        :\n          {\n            if (out[\"!type\"] == \"chart\") if (options.dense ? (out[val.r] || [])[val.c] : out[encode_cell({\n              c: val.c,\n              r: val.r\n            })]) ++val.c;\n            temp_val = {\n              ixfe: val.ixfe,\n              XF: XFs[val.ixfe] || {},\n              v: val.val,\n              t: 'n'\n            }\n            /*:any*/\n            ;\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n          }\n          break;\n\n        case 0x0005:\n        case 0x0205\n        /* BoolErr */\n        :\n          {\n            temp_val = {\n              ixfe: val.ixfe,\n              XF: XFs[val.ixfe],\n              v: val.val,\n              t: val.t\n            }\n            /*:any*/\n            ;\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n          }\n          break;\n\n        case 0x027e\n        /* RK */\n        :\n          {\n            temp_val = {\n              ixfe: val.ixfe,\n              XF: XFs[val.ixfe],\n              v: val.rknum,\n              t: 'n'\n            }\n            /*:any*/\n            ;\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n          }\n          break;\n\n        case 0x00bd\n        /* MulRk */\n        :\n          {\n            for (var j = val.c; j <= val.C; ++j) {\n              var ixfe = val.rkrec[j - val.c][0];\n              temp_val = {\n                ixfe: ixfe,\n                XF: XFs[ixfe],\n                v: val.rkrec[j - val.c][1],\n                t: 'n'\n              }\n              /*:any*/\n              ;\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: j,\n                r: val.r\n              }, temp_val, options);\n            }\n          }\n          break;\n\n        case 0x0006:\n        case 0x0206:\n        case 0x0406\n        /* Formula */\n        :\n          {\n            if (val.val == 'String') {\n              last_formula = val;\n              break;\n            }\n\n            temp_val = make_cell(val.val, val.cell.ixfe, val.tt);\n            temp_val.XF = XFs[temp_val.ixfe];\n\n            if (options.cellFormula) {\n              var _f = val.formula;\n\n              if (_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\n                var _fr = _f[0][0][1][0],\n                    _fc = _f[0][0][1][1];\n\n                var _fe = encode_cell({\n                  r: _fr,\n                  c: _fc\n                });\n\n                if (sharedf[_fe]) temp_val.f = \"\" + stringify_formula(val.formula, range, val.cell, supbooks, opts);else temp_val.F = ((options.dense ? (out[_fr] || [])[_fc] : out[_fe]) || {}).F;\n              } else temp_val.f = \"\" + stringify_formula(val.formula, range, val.cell, supbooks, opts);\n            }\n\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell(val.cell, temp_val, options);\n            last_formula = val;\n          }\n          break;\n\n        case 0x0007:\n        case 0x0207\n        /* String */\n        :\n          {\n            if (last_formula) {\n              /* technically always true */\n              last_formula.val = val;\n              temp_val = make_cell(val, last_formula.cell.ixfe, 's');\n              temp_val.XF = XFs[temp_val.ixfe];\n\n              if (options.cellFormula) {\n                temp_val.f = \"\" + stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n              }\n\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell(last_formula.cell, temp_val, options);\n              last_formula = null;\n            } else throw new Error(\"String record expects Formula\");\n          }\n          break;\n\n        case 0x0021:\n        case 0x0221\n        /* Array */\n        :\n          {\n            arrayf.push(val);\n\n            var _arraystart = encode_cell(val[0].s);\n\n            cc = options.dense ? (out[val[0].s.r] || [])[val[0].s.c] : out[_arraystart];\n\n            if (options.cellFormula && cc) {\n              if (!last_formula) break;\n              /* technically unreachable */\n\n              if (!_arraystart || !cc) break;\n              cc.f = \"\" + stringify_formula(val[1], range, val[0], supbooks, opts);\n              cc.F = encode_range(val[0]);\n            }\n          }\n          break;\n\n        case 0x04bc\n        /* ShrFmla */\n        :\n          {\n            if (!options.cellFormula) break;\n\n            if (last_cell) {\n              /* TODO: capture range */\n              if (!last_formula) break;\n              /* technically unreachable */\n\n              sharedf[encode_cell(last_formula.cell)] = val[0];\n              cc = options.dense ? (out[last_formula.cell.r] || [])[last_formula.cell.c] : out[encode_cell(last_formula.cell)];\n              (cc || {}).f = \"\" + stringify_formula(val[0], range, lastcell, supbooks, opts);\n            }\n          }\n          break;\n\n        case 0x00fd\n        /* LabelSst */\n        :\n          temp_val = make_cell(sst[val.isst].t, val.ixfe, 's');\n          if (sst[val.isst].h) temp_val.h = sst[val.isst].h;\n          temp_val.XF = XFs[temp_val.ixfe];\n          if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n          safe_format_xf(temp_val, options, wb.opts.Date1904);\n          addcell({\n            c: val.c,\n            r: val.r\n          }, temp_val, options);\n          break;\n\n        case 0x0201\n        /* Blank */\n        :\n          if (options.sheetStubs) {\n            temp_val = {\n              ixfe: val.ixfe,\n              XF: XFs[val.ixfe],\n              t: 'z'\n            }\n            /*:any*/\n            ;\n            if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n          }\n\n          break;\n\n        case 0x00be\n        /* MulBlank */\n        :\n          if (options.sheetStubs) {\n            for (var _j = val.c; _j <= val.C; ++_j) {\n              var _ixfe = val.ixfe[_j - val.c];\n              temp_val = {\n                ixfe: _ixfe,\n                XF: XFs[_ixfe],\n                t: 'z'\n              }\n              /*:any*/\n              ;\n              if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: _j,\n                r: val.r\n              }, temp_val, options);\n            }\n          }\n\n          break;\n\n        case 0x00d6\n        /* RString */\n        :\n        case 0x0204\n        /* Label */\n        :\n        case 0x0004\n        /* BIFF2STR */\n        :\n          temp_val = make_cell(val.val, val.ixfe, 's');\n          temp_val.XF = XFs[temp_val.ixfe];\n          if (BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[temp_val.ixfe >> 8 & 0x3F];\n          safe_format_xf(temp_val, options, wb.opts.Date1904);\n          addcell({\n            c: val.c,\n            r: val.r\n          }, temp_val, options);\n          break;\n\n        case 0x0000:\n        case 0x0200\n        /* Dimensions */\n        :\n          {\n            if (file_depth === 1) range = val;\n            /* TODO: stack */\n          }\n          break;\n\n        case 0x00fc\n        /* SST */\n        :\n          {\n            sst = val;\n          }\n          break;\n\n        case 0x041e\n        /* Format */\n        :\n          {\n            /* val = [id, fmt] */\n            if (opts.biff == 4) {\n              BIFF2FmtTable[BIFF2Fmt++] = val[1];\n\n              for (var b4idx = 0; b4idx < BIFF2Fmt + 163; ++b4idx) if (table_fmt[b4idx] == val[1]) break;\n\n              if (b4idx >= 163) SSF_load(val[1], BIFF2Fmt + 163);\n            } else SSF_load(val[1], val[0]);\n          }\n          break;\n\n        case 0x001e\n        /* BIFF2FORMAT */\n        :\n          {\n            BIFF2FmtTable[BIFF2Fmt++] = val;\n\n            for (var b2idx = 0; b2idx < BIFF2Fmt + 163; ++b2idx) if (table_fmt[b2idx] == val) break;\n\n            if (b2idx >= 163) SSF_load(val, BIFF2Fmt + 163);\n          }\n          break;\n\n        case 0x00e5\n        /* MergeCells */\n        :\n          merges = merges.concat(val);\n          break;\n\n        case 0x005d\n        /* Obj */\n        :\n          objects[val.cmo[0]] = opts.lastobj = val;\n          break;\n\n        case 0x01b6\n        /* TxO */\n        :\n          opts.lastobj.TxO = val;\n          break;\n\n        case 0x007f\n        /* ImData */\n        :\n          opts.lastobj.ImData = val;\n          break;\n\n        case 0x01b8\n        /* HLink */\n        :\n          {\n            for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n              cc = options.dense ? (out[rngR] || [])[rngC] : out[encode_cell({\n                c: rngC,\n                r: rngR\n              })];\n              if (cc) cc.l = val[1];\n            }\n          }\n          break;\n\n        case 0x0800\n        /* HLinkTooltip */\n        :\n          {\n            for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n              cc = options.dense ? (out[rngR] || [])[rngC] : out[encode_cell({\n                c: rngC,\n                r: rngR\n              })];\n              if (cc && cc.l) cc.l.Tooltip = val[1];\n            }\n          }\n          break;\n\n        case 0x001c\n        /* Note */\n        :\n          {\n            if (opts.biff <= 5 && opts.biff >= 2) break;\n            /* TODO: BIFF5 */\n\n            cc = options.dense ? (out[val[0].r] || [])[val[0].c] : out[encode_cell(val[0])];\n            var noteobj = objects[val[2]];\n\n            if (!cc) {\n              if (options.dense) {\n                if (!out[val[0].r]) out[val[0].r] = [];\n                cc = out[val[0].r][val[0].c] = {\n                  t: \"z\"\n                }\n                /*:any*/\n                ;\n              } else {\n                cc = out[encode_cell(val[0])] = {\n                  t: \"z\"\n                }\n                /*:any*/\n                ;\n              }\n\n              range.e.r = Math.max(range.e.r, val[0].r);\n              range.s.r = Math.min(range.s.r, val[0].r);\n              range.e.c = Math.max(range.e.c, val[0].c);\n              range.s.c = Math.min(range.s.c, val[0].c);\n            }\n\n            if (!cc.c) cc.c = [];\n            cmnt = {\n              a: val[1],\n              t: noteobj.TxO.t\n            };\n            cc.c.push(cmnt);\n          }\n          break;\n\n        case 0x087d\n        /* XFExt */\n        :\n          update_xfext(XFs[val.ixfe], val.ext);\n          break;\n\n        case 0x007d\n        /* ColInfo */\n        :\n          {\n            if (!opts.cellStyles) break;\n\n            while (val.e >= val.s) {\n              colinfo[val.e--] = {\n                width: val.w / 256,\n                level: val.level || 0,\n                hidden: !!(val.flags & 1)\n              };\n\n              if (!seencol) {\n                seencol = true;\n                find_mdw_colw(val.w / 256);\n              }\n\n              process_col(colinfo[val.e + 1]);\n            }\n          }\n          break;\n\n        case 0x0208\n        /* Row */\n        :\n          {\n            var rowobj = {};\n\n            if (val.level != null) {\n              rowinfo[val.r] = rowobj;\n              rowobj.level = val.level;\n            }\n\n            if (val.hidden) {\n              rowinfo[val.r] = rowobj;\n              rowobj.hidden = true;\n            }\n\n            if (val.hpt) {\n              rowinfo[val.r] = rowobj;\n              rowobj.hpt = val.hpt;\n              rowobj.hpx = pt2px(val.hpt);\n            }\n          }\n          break;\n\n        case 0x0026\n        /* LeftMargin */\n        :\n        case 0x0027\n        /* RightMargin */\n        :\n        case 0x0028\n        /* TopMargin */\n        :\n        case 0x0029\n        /* BottomMargin */\n        :\n          if (!out['!margins']) default_margins(out['!margins'] = {});\n          out['!margins'][{\n            0x26: \"left\",\n            0x27: \"right\",\n            0x28: \"top\",\n            0x29: \"bottom\"\n          }[RecordType]] = val;\n          break;\n\n        case 0x00a1\n        /* Setup */\n        :\n          // TODO\n          if (!out['!margins']) default_margins(out['!margins'] = {});\n          out['!margins'].header = val.header;\n          out['!margins'].footer = val.footer;\n          break;\n\n        case 0x023e\n        /* Window2 */\n        :\n          // TODO\n          // $FlowIgnore\n          if (val.RTL) Workbook.Views[0].RTL = true;\n          break;\n\n        case 0x0092\n        /* Palette */\n        :\n          palette = val;\n          break;\n\n        case 0x0896\n        /* Theme */\n        :\n          themes = val;\n          break;\n\n        case 0x008c\n        /* Country */\n        :\n          country = val;\n          break;\n\n        case 0x01ba\n        /* CodeName */\n        :\n          {\n            /*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n            if (!cur_sheet) Workbook.WBProps.CodeName = val || \"ThisWorkbook\";else wsprops.CodeName = val || wsprops.name;\n          }\n          break;\n      }\n    } else {\n      if (!R) console.error(\"Missing Info for XLS Record 0x\" + RecordType.toString(16));\n      blob.l += length;\n    }\n  }\n\n  wb.SheetNames = keys(Directory).sort(function (a, b) {\n    return Number(a) - Number(b);\n  }).map(function (x) {\n    return Directory[x].name;\n  });\n  if (!options.bookSheets) wb.Sheets = Sheets;\n\n  if (!wb.SheetNames.length && Preamble[\"!ref\"]) {\n    wb.SheetNames.push(\"Sheet1\");\n    /*jshint -W069 */\n\n    if (wb.Sheets) wb.Sheets[\"Sheet1\"] = Preamble;\n    /*jshint +W069 */\n  } else wb.Preamble = Preamble;\n\n  if (wb.Sheets) FilterDatabases.forEach(function (r, i) {\n    wb.Sheets[wb.SheetNames[i]]['!autofilter'] = r;\n  });\n  wb.Strings = sst;\n  wb.SSF = dup(table_fmt);\n  if (opts.enc) wb.Encryption = opts.enc;\n  if (themes) wb.Themes = themes;\n  wb.Metadata = {};\n  if (country !== undefined) wb.Metadata.Country = country;\n  if (supbooks.names.length > 0) Workbook.Names = supbooks.names;\n  wb.Workbook = Workbook;\n  return wb;\n}\n/* TODO: split props*/\n\n\nvar PSCLSID = {\n  SI: \"e0859ff2f94f6810ab9108002b27b3d9\",\n  DSI: \"02d5cdd59c2e1b10939708002b2cf9ae\",\n  UDI: \"05d5cdd59c2e1b10939708002b2cf9ae\"\n};\n\nfunction parse_xls_props(cfb\n/*:CFBContainer*/\n, props, o) {\n  /* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n  var DSI = CFB.find(cfb, '/!DocumentSummaryInformation');\n  if (DSI && DSI.size > 0) try {\n    var DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI, PSCLSID.DSI);\n\n    for (var d in DocSummary) props[d] = DocSummary[d];\n  } catch (e) {\n    if (o.WTF) throw e;\n    /* empty */\n  }\n  /* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\n  var SI = CFB.find(cfb, '/!SummaryInformation');\n  if (SI && SI.size > 0) try {\n    var Summary = parse_PropertySetStream(SI, SummaryPIDSI, PSCLSID.SI);\n\n    for (var s in Summary) if (props[s] == null) props[s] = Summary[s];\n  } catch (e) {\n    if (o.WTF) throw e;\n    /* empty */\n  }\n\n  if (props.HeadingPairs && props.TitlesOfParts) {\n    load_props_pairs(props.HeadingPairs, props.TitlesOfParts, props, o);\n    delete props.HeadingPairs;\n    delete props.TitlesOfParts;\n  }\n}\n\nfunction write_xls_props(wb\n/*:Workbook*/\n, cfb\n/*:CFBContainer*/\n) {\n  var DSEntries = [],\n      SEntries = [],\n      CEntries = [];\n  var i = 0,\n      Keys;\n  var DocSummaryRE\n  /*:{[key:string]:string}*/\n  = evert_key(DocSummaryPIDDSI, \"n\");\n  var SummaryRE\n  /*:{[key:string]:string}*/\n  = evert_key(SummaryPIDSI, \"n\");\n\n  if (wb.Props) {\n    Keys = keys(wb.Props); // $FlowIgnore\n\n    for (i = 0; i < Keys.length; ++i) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Props[Keys[i]]]);\n  }\n\n  if (wb.Custprops) {\n    Keys = keys(wb.Custprops); // $FlowIgnore\n\n    for (i = 0; i < Keys.length; ++i) if (!Object.prototype.hasOwnProperty.call(wb.Props || {}, Keys[i])) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Custprops[Keys[i]]]);\n  }\n\n  var CEntries2 = [];\n\n  for (i = 0; i < CEntries.length; ++i) {\n    if (XLSPSSkip.indexOf(CEntries[i][0]) > -1 || PseudoPropsPairs.indexOf(CEntries[i][0]) > -1) continue;\n    if (CEntries[i][1] == null) continue;\n    CEntries2.push(CEntries[i]);\n  }\n\n  if (SEntries.length) CFB.utils.cfb_add(cfb, \"/\\u0005SummaryInformation\", write_PropertySetStream(SEntries, PSCLSID.SI, SummaryRE, SummaryPIDSI));\n  if (DSEntries.length || CEntries2.length) CFB.utils.cfb_add(cfb, \"/\\u0005DocumentSummaryInformation\", write_PropertySetStream(DSEntries, PSCLSID.DSI, DocSummaryRE, DocSummaryPIDDSI, CEntries2.length ? CEntries2 : null, PSCLSID.UDI));\n}\n\nfunction parse_xlscfb(cfb\n/*:any*/\n, options\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  if (!options) options = {};\n  fix_read_opts(options);\n  reset_cp();\n  if (options.codepage) set_ansi(options.codepage);\n  var CompObj\n  /*:?CFBEntry*/\n  , WB\n  /*:?any*/\n  ;\n\n  if (cfb.FullPaths) {\n    if (CFB.find(cfb, '/encryption')) throw new Error(\"File is password-protected\");\n    CompObj = CFB.find(cfb, '!CompObj');\n    WB = CFB.find(cfb, '/Workbook') || CFB.find(cfb, '/Book');\n  } else {\n    switch (options.type) {\n      case 'base64':\n        cfb = s2a(Base64_decode(cfb));\n        break;\n\n      case 'binary':\n        cfb = s2a(cfb);\n        break;\n\n      case 'buffer':\n        break;\n\n      case 'array':\n        if (!Array.isArray(cfb)) cfb = Array.prototype.slice.call(cfb);\n        break;\n    }\n\n    prep_blob(cfb, 0);\n    WB = {\n      content: cfb\n    }\n    /*:any*/\n    ;\n  }\n\n  var\n  /*::CompObjP, */\n  WorkbookP\n  /*:: :Workbook = XLSX.utils.book_new(); */\n  ;\n\n  var _data\n  /*:?any*/\n  ;\n\n  if (CompObj)\n    /*::CompObjP = */\n    parse_compobj(CompObj);\n  if (options.bookProps && !options.bookSheets) WorkbookP = {}\n  /*:any*/\n  ;else\n    /*:: if(cfb instanceof CFBContainer) */\n    {\n      var T = has_buf ? 'buffer' : 'array';\n      if (WB && WB.content) WorkbookP = parse_workbook(WB.content, options);\n      /* Quattro Pro 7-8 */\n      else if ((_data = CFB.find(cfb, 'PerfectOffice_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n      /* Quattro Pro 9 */\n      else if ((_data = CFB.find(cfb, 'NativeContent_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n      /* Works 4 for Mac */\n      else if ((_data = CFB.find(cfb, 'MN0')) && _data.content) throw new Error(\"Unsupported Works 4 for Mac file\");else throw new Error(\"Cannot find Workbook stream\");\n      if (options.bookVBA && cfb.FullPaths && CFB.find(cfb, '/_VBA_PROJECT_CUR/VBA/dir')) WorkbookP.vbaraw = make_vba_xls(cfb);\n    }\n  var props = {};\n  if (cfb.FullPaths) parse_xls_props(\n  /*::((*/\n  cfb\n  /*:: :any):CFBContainer)*/\n  , props, options);\n  WorkbookP.Props = WorkbookP.Custprops = props;\n  /* TODO: split up properties */\n\n  if (options.bookFiles) WorkbookP.cfb = cfb;\n  /*WorkbookP.CompObjP = CompObjP; // TODO: storage? */\n\n  return WorkbookP;\n}\n\nfunction write_xlscfb(wb\n/*:Workbook*/\n, opts\n/*:WriteOpts*/\n)\n/*:CFBContainer*/\n{\n  var o = opts || {};\n  var cfb = CFB.utils.cfb_new({\n    root: \"R\"\n  });\n  var wbpath = \"/Workbook\";\n\n  switch (o.bookType || \"xls\") {\n    case \"xls\":\n      o.bookType = \"biff8\";\n\n    /* falls through */\n\n    case \"xla\":\n      if (!o.bookType) o.bookType = \"xla\";\n\n    /* falls through */\n\n    case \"biff8\":\n      wbpath = \"/Workbook\";\n      o.biff = 8;\n      break;\n\n    case \"biff5\":\n      wbpath = \"/Book\";\n      o.biff = 5;\n      break;\n\n    default:\n      throw new Error(\"invalid type \" + o.bookType + \" for XLS CFB\");\n  }\n\n  CFB.utils.cfb_add(cfb, wbpath, write_biff_buf(wb, o));\n  if (o.biff == 8 && (wb.Props || wb.Custprops)) write_xls_props(wb, cfb); // TODO: SI, DSI, CO\n\n  if (o.biff == 8 && wb.vbaraw) fill_vba_xls(cfb, CFB.read(wb.vbaraw, {\n    type: typeof wb.vbaraw == \"string\" ? \"binary\" : \"buffer\"\n  }));\n  return cfb;\n}\n/* [MS-XLSB] 2.3 Record Enumeration */\n\n\nvar XLSBRecordEnum = {\n  /*::[*/\n  0x0000\n  /*::]*/\n  : {\n    /* n:\"BrtRowHdr\", */\n    f: parse_BrtRowHdr\n  },\n\n  /*::[*/\n  0x0001\n  /*::]*/\n  : {\n    /* n:\"BrtCellBlank\", */\n    f: parse_BrtCellBlank\n  },\n\n  /*::[*/\n  0x0002\n  /*::]*/\n  : {\n    /* n:\"BrtCellRk\", */\n    f: parse_BrtCellRk\n  },\n\n  /*::[*/\n  0x0003\n  /*::]*/\n  : {\n    /* n:\"BrtCellError\", */\n    f: parse_BrtCellError\n  },\n\n  /*::[*/\n  0x0004\n  /*::]*/\n  : {\n    /* n:\"BrtCellBool\", */\n    f: parse_BrtCellBool\n  },\n\n  /*::[*/\n  0x0005\n  /*::]*/\n  : {\n    /* n:\"BrtCellReal\", */\n    f: parse_BrtCellReal\n  },\n\n  /*::[*/\n  0x0006\n  /*::]*/\n  : {\n    /* n:\"BrtCellSt\", */\n    f: parse_BrtCellSt\n  },\n\n  /*::[*/\n  0x0007\n  /*::]*/\n  : {\n    /* n:\"BrtCellIsst\", */\n    f: parse_BrtCellIsst\n  },\n\n  /*::[*/\n  0x0008\n  /*::]*/\n  : {\n    /* n:\"BrtFmlaString\", */\n    f: parse_BrtFmlaString\n  },\n\n  /*::[*/\n  0x0009\n  /*::]*/\n  : {\n    /* n:\"BrtFmlaNum\", */\n    f: parse_BrtFmlaNum\n  },\n\n  /*::[*/\n  0x000A\n  /*::]*/\n  : {\n    /* n:\"BrtFmlaBool\", */\n    f: parse_BrtFmlaBool\n  },\n\n  /*::[*/\n  0x000B\n  /*::]*/\n  : {\n    /* n:\"BrtFmlaError\", */\n    f: parse_BrtFmlaError\n  },\n\n  /*::[*/\n  0x000C\n  /*::]*/\n  : {\n    /* n:\"BrtShortBlank\", */\n    f: parse_BrtShortBlank\n  },\n\n  /*::[*/\n  0x000D\n  /*::]*/\n  : {\n    /* n:\"BrtShortRk\", */\n    f: parse_BrtShortRk\n  },\n\n  /*::[*/\n  0x000E\n  /*::]*/\n  : {\n    /* n:\"BrtShortError\", */\n    f: parse_BrtShortError\n  },\n\n  /*::[*/\n  0x000F\n  /*::]*/\n  : {\n    /* n:\"BrtShortBool\", */\n    f: parse_BrtShortBool\n  },\n\n  /*::[*/\n  0x0010\n  /*::]*/\n  : {\n    /* n:\"BrtShortReal\", */\n    f: parse_BrtShortReal\n  },\n\n  /*::[*/\n  0x0011\n  /*::]*/\n  : {\n    /* n:\"BrtShortSt\", */\n    f: parse_BrtShortSt\n  },\n\n  /*::[*/\n  0x0012\n  /*::]*/\n  : {\n    /* n:\"BrtShortIsst\", */\n    f: parse_BrtShortIsst\n  },\n\n  /*::[*/\n  0x0013\n  /*::]*/\n  : {\n    /* n:\"BrtSSTItem\", */\n    f: parse_RichStr\n  },\n\n  /*::[*/\n  0x0014\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIMissing\" */\n  },\n\n  /*::[*/\n  0x0015\n  /*::]*/\n  : {\n    /* n:\"BrtPCDINumber\" */\n  },\n\n  /*::[*/\n  0x0016\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIBoolean\" */\n  },\n\n  /*::[*/\n  0x0017\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIError\" */\n  },\n\n  /*::[*/\n  0x0018\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIString\" */\n  },\n\n  /*::[*/\n  0x0019\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIDatetime\" */\n  },\n\n  /*::[*/\n  0x001A\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIIndex\" */\n  },\n\n  /*::[*/\n  0x001B\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIAMissing\" */\n  },\n\n  /*::[*/\n  0x001C\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIANumber\" */\n  },\n\n  /*::[*/\n  0x001D\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIABoolean\" */\n  },\n\n  /*::[*/\n  0x001E\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIAError\" */\n  },\n\n  /*::[*/\n  0x001F\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIAString\" */\n  },\n\n  /*::[*/\n  0x0020\n  /*::]*/\n  : {\n    /* n:\"BrtPCDIADatetime\" */\n  },\n\n  /*::[*/\n  0x0021\n  /*::]*/\n  : {\n    /* n:\"BrtPCRRecord\" */\n  },\n\n  /*::[*/\n  0x0022\n  /*::]*/\n  : {\n    /* n:\"BrtPCRRecordDt\" */\n  },\n\n  /*::[*/\n  0x0023\n  /*::]*/\n  : {\n    /* n:\"BrtFRTBegin\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0024\n  /*::]*/\n  : {\n    /* n:\"BrtFRTEnd\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0025\n  /*::]*/\n  : {\n    /* n:\"BrtACBegin\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0026\n  /*::]*/\n  : {\n    /* n:\"BrtACEnd\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0027\n  /*::]*/\n  : {\n    /* n:\"BrtName\", */\n    f: parse_BrtName\n  },\n\n  /*::[*/\n  0x0028\n  /*::]*/\n  : {\n    /* n:\"BrtIndexRowBlock\" */\n  },\n\n  /*::[*/\n  0x002A\n  /*::]*/\n  : {\n    /* n:\"BrtIndexBlock\" */\n  },\n\n  /*::[*/\n  0x002B\n  /*::]*/\n  : {\n    /* n:\"BrtFont\", */\n    f: parse_BrtFont\n  },\n\n  /*::[*/\n  0x002C\n  /*::]*/\n  : {\n    /* n:\"BrtFmt\", */\n    f: parse_BrtFmt\n  },\n\n  /*::[*/\n  0x002D\n  /*::]*/\n  : {\n    /* n:\"BrtFill\", */\n    f: parse_BrtFill\n  },\n\n  /*::[*/\n  0x002E\n  /*::]*/\n  : {\n    /* n:\"BrtBorder\", */\n    f: parse_BrtBorder\n  },\n\n  /*::[*/\n  0x002F\n  /*::]*/\n  : {\n    /* n:\"BrtXF\", */\n    f: parse_BrtXF\n  },\n\n  /*::[*/\n  0x0030\n  /*::]*/\n  : {\n    /* n:\"BrtStyle\" */\n  },\n\n  /*::[*/\n  0x0031\n  /*::]*/\n  : {\n    /* n:\"BrtCellMeta\", */\n    f: parse_Int32LE\n  },\n\n  /*::[*/\n  0x0032\n  /*::]*/\n  : {\n    /* n:\"BrtValueMeta\" */\n  },\n\n  /*::[*/\n  0x0033\n  /*::]*/\n  : {\n    /* n:\"BrtMdb\" */\n    f: parse_BrtMdb\n  },\n\n  /*::[*/\n  0x0034\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFmd\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0035\n  /*::]*/\n  : {\n    /* n:\"BrtEndFmd\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0036\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0037\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0038\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdxTuple\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0039\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdxTuple\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x003A\n  /*::]*/\n  : {\n    /* n:\"BrtMdxMbrIstr\" */\n  },\n\n  /*::[*/\n  0x003B\n  /*::]*/\n  : {\n    /* n:\"BrtStr\" */\n  },\n\n  /*::[*/\n  0x003C\n  /*::]*/\n  : {\n    /* n:\"BrtColInfo\", */\n    f: parse_ColInfo\n  },\n\n  /*::[*/\n  0x003E\n  /*::]*/\n  : {\n    /* n:\"BrtCellRString\", */\n    f: parse_BrtCellRString\n  },\n\n  /*::[*/\n  0x003F\n  /*::]*/\n  : {\n    /* n:\"BrtCalcChainItem$\", */\n    f: parse_BrtCalcChainItem$\n  },\n\n  /*::[*/\n  0x0040\n  /*::]*/\n  : {\n    /* n:\"BrtDVal\", */\n    f: parse_BrtDVal\n  },\n\n  /*::[*/\n  0x0041\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellNum\" */\n  },\n\n  /*::[*/\n  0x0042\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellStr\" */\n  },\n\n  /*::[*/\n  0x0043\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellBool\" */\n  },\n\n  /*::[*/\n  0x0044\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellErr\" */\n  },\n\n  /*::[*/\n  0x0045\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellDate\" */\n  },\n\n  /*::[*/\n  0x0046\n  /*::]*/\n  : {\n    /* n:\"BrtSxvcellNil\" */\n  },\n\n  /*::[*/\n  0x0080\n  /*::]*/\n  : {\n    /* n:\"BrtFileVersion\" */\n  },\n\n  /*::[*/\n  0x0081\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSheet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0082\n  /*::]*/\n  : {\n    /* n:\"BrtEndSheet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0083\n  /*::]*/\n  : {\n    /* n:\"BrtBeginBook\", */\n    T: 1,\n    f: parsenoop,\n    p: 0\n  },\n\n  /*::[*/\n  0x0084\n  /*::]*/\n  : {\n    /* n:\"BrtEndBook\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0085\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWsViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0086\n  /*::]*/\n  : {\n    /* n:\"BrtEndWsViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0087\n  /*::]*/\n  : {\n    /* n:\"BrtBeginBookViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0088\n  /*::]*/\n  : {\n    /* n:\"BrtEndBookViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0089\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWsView\", */\n    T: 1,\n    f: parse_BrtBeginWsView\n  },\n\n  /*::[*/\n  0x008A\n  /*::]*/\n  : {\n    /* n:\"BrtEndWsView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x008B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCsViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x008C\n  /*::]*/\n  : {\n    /* n:\"BrtEndCsViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x008D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCsView\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x008E\n  /*::]*/\n  : {\n    /* n:\"BrtEndCsView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x008F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginBundleShs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0090\n  /*::]*/\n  : {\n    /* n:\"BrtEndBundleShs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0091\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSheetData\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0092\n  /*::]*/\n  : {\n    /* n:\"BrtEndSheetData\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0093\n  /*::]*/\n  : {\n    /* n:\"BrtWsProp\", */\n    f: parse_BrtWsProp\n  },\n\n  /*::[*/\n  0x0094\n  /*::]*/\n  : {\n    /* n:\"BrtWsDim\", */\n    f: parse_BrtWsDim,\n    p: 16\n  },\n\n  /*::[*/\n  0x0097\n  /*::]*/\n  : {\n    /* n:\"BrtPane\", */\n    f: parse_BrtPane\n  },\n\n  /*::[*/\n  0x0098\n  /*::]*/\n  : {\n    /* n:\"BrtSel\" */\n  },\n\n  /*::[*/\n  0x0099\n  /*::]*/\n  : {\n    /* n:\"BrtWbProp\", */\n    f: parse_BrtWbProp\n  },\n\n  /*::[*/\n  0x009A\n  /*::]*/\n  : {\n    /* n:\"BrtWbFactoid\" */\n  },\n\n  /*::[*/\n  0x009B\n  /*::]*/\n  : {\n    /* n:\"BrtFileRecover\" */\n  },\n\n  /*::[*/\n  0x009C\n  /*::]*/\n  : {\n    /* n:\"BrtBundleSh\", */\n    f: parse_BrtBundleSh\n  },\n\n  /*::[*/\n  0x009D\n  /*::]*/\n  : {\n    /* n:\"BrtCalcProp\" */\n  },\n\n  /*::[*/\n  0x009E\n  /*::]*/\n  : {\n    /* n:\"BrtBookView\" */\n  },\n\n  /*::[*/\n  0x009F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSst\", */\n    T: 1,\n    f: parse_BrtBeginSst\n  },\n\n  /*::[*/\n  0x00A0\n  /*::]*/\n  : {\n    /* n:\"BrtEndSst\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00A1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginAFilter\", */\n    T: 1,\n    f: parse_UncheckedRfX\n  },\n\n  /*::[*/\n  0x00A2\n  /*::]*/\n  : {\n    /* n:\"BrtEndAFilter\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00A3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFilterColumn\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00A4\n  /*::]*/\n  : {\n    /* n:\"BrtEndFilterColumn\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00A5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00A6\n  /*::]*/\n  : {\n    /* n:\"BrtEndFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00A7\n  /*::]*/\n  : {\n    /* n:\"BrtFilter\" */\n  },\n\n  /*::[*/\n  0x00A8\n  /*::]*/\n  : {\n    /* n:\"BrtColorFilter\" */\n  },\n\n  /*::[*/\n  0x00A9\n  /*::]*/\n  : {\n    /* n:\"BrtIconFilter\" */\n  },\n\n  /*::[*/\n  0x00AA\n  /*::]*/\n  : {\n    /* n:\"BrtTop10Filter\" */\n  },\n\n  /*::[*/\n  0x00AB\n  /*::]*/\n  : {\n    /* n:\"BrtDynamicFilter\" */\n  },\n\n  /*::[*/\n  0x00AC\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCustomFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00AD\n  /*::]*/\n  : {\n    /* n:\"BrtEndCustomFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00AE\n  /*::]*/\n  : {\n    /* n:\"BrtCustomFilter\" */\n  },\n\n  /*::[*/\n  0x00AF\n  /*::]*/\n  : {\n    /* n:\"BrtAFilterDateGroupItem\" */\n  },\n\n  /*::[*/\n  0x00B0\n  /*::]*/\n  : {\n    /* n:\"BrtMergeCell\", */\n    f: parse_BrtMergeCell\n  },\n\n  /*::[*/\n  0x00B1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMergeCells\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00B2\n  /*::]*/\n  : {\n    /* n:\"BrtEndMergeCells\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00B3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotCacheDef\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00B4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotCacheDef\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00B5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFields\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00B6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFields\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00B7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDField\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00B8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDField\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00B9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSource\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00BA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSource\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00BB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSRange\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00BC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSRange\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00BD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFAtbl\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00BE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFAtbl\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00BF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDIRun\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDIRun\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotCacheRecords\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotCacheRecords\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHierarchies\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHierarchies\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHierarchy\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHierarchy\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHFieldsUsage\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00C8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHFieldsUsage\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00C9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExtConnection\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00CA\n  /*::]*/\n  : {\n    /* n:\"BrtEndExtConnection\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00CB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECDbProps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00CC\n  /*::]*/\n  : {\n    /* n:\"BrtEndECDbProps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00CD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECOlapProps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00CE\n  /*::]*/\n  : {\n    /* n:\"BrtEndECOlapProps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00CF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSConsol\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSConsol\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCPages\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCPages\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCPage\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCPage\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCPItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCPItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCSets\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00D8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCSets\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00D9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSCSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00DA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSCSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00DB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFGroup\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00DC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFGroup\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00DD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFGItems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00DE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFGItems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00DF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFGRange\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFGRange\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDFGDiscrete\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDFGDiscrete\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTupleCache\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTupleCache\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCEntries\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCEntries\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCEMembers\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00E8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCEMembers\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00E9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCEMember\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00EA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCEMember\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00EB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCQueries\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00EC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCQueries\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00ED\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCQuery\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00EE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCQuery\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00EF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCSets\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCSets\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSDTCSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcItems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcItems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRule\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00F8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRule\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00F9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00FA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00FB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFilter\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00FC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFilter\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00FD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPNames\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x00FE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPNames\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x00FF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPName\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0100\n  /*::]*/\n  : {\n    /* n:\"BrtEndPName\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0101\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPNPairs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0102\n  /*::]*/\n  : {\n    /* n:\"BrtEndPNPairs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0103\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPNPair\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0104\n  /*::]*/\n  : {\n    /* n:\"BrtEndPNPair\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0105\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECWebProps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0106\n  /*::]*/\n  : {\n    /* n:\"BrtEndECWebProps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0107\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEcWpTables\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0108\n  /*::]*/\n  : {\n    /* n:\"BrtEndECWPTables\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0109\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECParams\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x010A\n  /*::]*/\n  : {\n    /* n:\"BrtEndECParams\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x010B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECParam\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x010C\n  /*::]*/\n  : {\n    /* n:\"BrtEndECParam\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x010D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDKPIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x010E\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDKPIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x010F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDKPI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0110\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDKPI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0111\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDims\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0112\n  /*::]*/\n  : {\n    /* n:\"BrtEndDims\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0113\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDim\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0114\n  /*::]*/\n  : {\n    /* n:\"BrtEndDim\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0115\n  /*::]*/\n  : {\n    /* n:\"BrtIndexPartEnd\" */\n  },\n\n  /*::[*/\n  0x0116\n  /*::]*/\n  : {\n    /* n:\"BrtBeginStyleSheet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0117\n  /*::]*/\n  : {\n    /* n:\"BrtEndStyleSheet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0118\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXView\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0119\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXVI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x011A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXVI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x011B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXVIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x011C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXVIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x011D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXVD\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x011E\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXVD\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x011F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXVDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0120\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXVDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0121\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXPI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0122\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXPI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0123\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXPIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0124\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXPIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0125\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXDI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0126\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXDI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0127\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXDIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0128\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXDIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0129\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXLI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x012A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXLI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x012B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXLIRws\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x012C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXLIRws\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x012D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXLICols\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x012E\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXLICols\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x012F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXFormat\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0130\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXFormat\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0131\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXFormats\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0132\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxFormats\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0133\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxSelect\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0134\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxSelect\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0135\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXVDRws\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0136\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXVDRws\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0137\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXVDCols\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0138\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXVDCols\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0139\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXLocation\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x013A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXLocation\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x013B\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x013C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTHs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x013D\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTHs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x013E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTH\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x013F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTH\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0140\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXTHRws\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0141\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXTHRws\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0142\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXTHCols\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0143\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXTHCols\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0144\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTDMPS\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0145\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTDMPs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0146\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTDMP\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0147\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTDMP\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0148\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTHItems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0149\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTHItems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x014A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTHItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x014B\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTHItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x014C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMetadata\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x014D\n  /*::]*/\n  : {\n    /* n:\"BrtEndMetadata\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x014E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsmdtinfo\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x014F\n  /*::]*/\n  : {\n    /* n:\"BrtMdtinfo\", */\n    f: parse_BrtMdtinfo\n  },\n\n  /*::[*/\n  0x0150\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsmdtinfo\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0151\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsmdb\", */\n    f: parse_BrtBeginEsmdb,\n    T: 1\n  },\n\n  /*::[*/\n  0x0152\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsmdb\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0153\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsfmd\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0154\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsfmd\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0155\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSingleCells\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0156\n  /*::]*/\n  : {\n    /* n:\"BrtEndSingleCells\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0157\n  /*::]*/\n  : {\n    /* n:\"BrtBeginList\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0158\n  /*::]*/\n  : {\n    /* n:\"BrtEndList\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0159\n  /*::]*/\n  : {\n    /* n:\"BrtBeginListCols\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x015A\n  /*::]*/\n  : {\n    /* n:\"BrtEndListCols\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x015B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginListCol\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x015C\n  /*::]*/\n  : {\n    /* n:\"BrtEndListCol\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x015D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginListXmlCPr\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x015E\n  /*::]*/\n  : {\n    /* n:\"BrtEndListXmlCPr\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x015F\n  /*::]*/\n  : {\n    /* n:\"BrtListCCFmla\" */\n  },\n\n  /*::[*/\n  0x0160\n  /*::]*/\n  : {\n    /* n:\"BrtListTrFmla\" */\n  },\n\n  /*::[*/\n  0x0161\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExternals\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0162\n  /*::]*/\n  : {\n    /* n:\"BrtEndExternals\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0163\n  /*::]*/\n  : {\n    /* n:\"BrtSupBookSrc\", */\n    f: parse_RelID\n  },\n\n  /*::[*/\n  0x0165\n  /*::]*/\n  : {\n    /* n:\"BrtSupSelf\" */\n  },\n\n  /*::[*/\n  0x0166\n  /*::]*/\n  : {\n    /* n:\"BrtSupSame\" */\n  },\n\n  /*::[*/\n  0x0167\n  /*::]*/\n  : {\n    /* n:\"BrtSupTabs\" */\n  },\n\n  /*::[*/\n  0x0168\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSupBook\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0169\n  /*::]*/\n  : {\n    /* n:\"BrtPlaceholderName\" */\n  },\n\n  /*::[*/\n  0x016A\n  /*::]*/\n  : {\n    /* n:\"BrtExternSheet\", */\n    f: parse_ExternSheet\n  },\n\n  /*::[*/\n  0x016B\n  /*::]*/\n  : {\n    /* n:\"BrtExternTableStart\" */\n  },\n\n  /*::[*/\n  0x016C\n  /*::]*/\n  : {\n    /* n:\"BrtExternTableEnd\" */\n  },\n\n  /*::[*/\n  0x016E\n  /*::]*/\n  : {\n    /* n:\"BrtExternRowHdr\" */\n  },\n\n  /*::[*/\n  0x016F\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellBlank\" */\n  },\n\n  /*::[*/\n  0x0170\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellReal\" */\n  },\n\n  /*::[*/\n  0x0171\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellBool\" */\n  },\n\n  /*::[*/\n  0x0172\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellError\" */\n  },\n\n  /*::[*/\n  0x0173\n  /*::]*/\n  : {\n    /* n:\"BrtExternCellString\" */\n  },\n\n  /*::[*/\n  0x0174\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsmdx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0175\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsmdx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0176\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdxSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0177\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdxSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0178\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdxMbrProp\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0179\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdxMbrProp\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x017A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMdxKPI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x017B\n  /*::]*/\n  : {\n    /* n:\"BrtEndMdxKPI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x017C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginEsstr\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x017D\n  /*::]*/\n  : {\n    /* n:\"BrtEndEsstr\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x017E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x017F\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0180\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0181\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0182\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotCacheID\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0183\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotCacheID\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0184\n  /*::]*/\n  : {\n    /* n:\"BrtBeginISXVIs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0185\n  /*::]*/\n  : {\n    /* n:\"BrtEndISXVIs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0186\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColInfos\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0187\n  /*::]*/\n  : {\n    /* n:\"BrtEndColInfos\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0188\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRwBrk\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0189\n  /*::]*/\n  : {\n    /* n:\"BrtEndRwBrk\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x018A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColBrk\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x018B\n  /*::]*/\n  : {\n    /* n:\"BrtEndColBrk\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x018C\n  /*::]*/\n  : {\n    /* n:\"BrtBrk\" */\n  },\n\n  /*::[*/\n  0x018D\n  /*::]*/\n  : {\n    /* n:\"BrtUserBookView\" */\n  },\n\n  /*::[*/\n  0x018E\n  /*::]*/\n  : {\n    /* n:\"BrtInfo\" */\n  },\n\n  /*::[*/\n  0x018F\n  /*::]*/\n  : {\n    /* n:\"BrtCUsr\" */\n  },\n\n  /*::[*/\n  0x0190\n  /*::]*/\n  : {\n    /* n:\"BrtUsr\" */\n  },\n\n  /*::[*/\n  0x0191\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUsers\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0193\n  /*::]*/\n  : {\n    /* n:\"BrtEOF\" */\n  },\n\n  /*::[*/\n  0x0194\n  /*::]*/\n  : {\n    /* n:\"BrtUCR\" */\n  },\n\n  /*::[*/\n  0x0195\n  /*::]*/\n  : {\n    /* n:\"BrtRRInsDel\" */\n  },\n\n  /*::[*/\n  0x0196\n  /*::]*/\n  : {\n    /* n:\"BrtRREndInsDel\" */\n  },\n\n  /*::[*/\n  0x0197\n  /*::]*/\n  : {\n    /* n:\"BrtRRMove\" */\n  },\n\n  /*::[*/\n  0x0198\n  /*::]*/\n  : {\n    /* n:\"BrtRREndMove\" */\n  },\n\n  /*::[*/\n  0x0199\n  /*::]*/\n  : {\n    /* n:\"BrtRRChgCell\" */\n  },\n\n  /*::[*/\n  0x019A\n  /*::]*/\n  : {\n    /* n:\"BrtRREndChgCell\" */\n  },\n\n  /*::[*/\n  0x019B\n  /*::]*/\n  : {\n    /* n:\"BrtRRHeader\" */\n  },\n\n  /*::[*/\n  0x019C\n  /*::]*/\n  : {\n    /* n:\"BrtRRUserView\" */\n  },\n\n  /*::[*/\n  0x019D\n  /*::]*/\n  : {\n    /* n:\"BrtRRRenSheet\" */\n  },\n\n  /*::[*/\n  0x019E\n  /*::]*/\n  : {\n    /* n:\"BrtRRInsertSh\" */\n  },\n\n  /*::[*/\n  0x019F\n  /*::]*/\n  : {\n    /* n:\"BrtRRDefName\" */\n  },\n\n  /*::[*/\n  0x01A0\n  /*::]*/\n  : {\n    /* n:\"BrtRRNote\" */\n  },\n\n  /*::[*/\n  0x01A1\n  /*::]*/\n  : {\n    /* n:\"BrtRRConflict\" */\n  },\n\n  /*::[*/\n  0x01A2\n  /*::]*/\n  : {\n    /* n:\"BrtRRTQSIF\" */\n  },\n\n  /*::[*/\n  0x01A3\n  /*::]*/\n  : {\n    /* n:\"BrtRRFormat\" */\n  },\n\n  /*::[*/\n  0x01A4\n  /*::]*/\n  : {\n    /* n:\"BrtRREndFormat\" */\n  },\n\n  /*::[*/\n  0x01A5\n  /*::]*/\n  : {\n    /* n:\"BrtRRAutoFmt\" */\n  },\n\n  /*::[*/\n  0x01A6\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUserShViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01A7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUserShView\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01A8\n  /*::]*/\n  : {\n    /* n:\"BrtEndUserShView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01A9\n  /*::]*/\n  : {\n    /* n:\"BrtEndUserShViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01AA\n  /*::]*/\n  : {\n    /* n:\"BrtArrFmla\", */\n    f: parse_BrtArrFmla\n  },\n\n  /*::[*/\n  0x01AB\n  /*::]*/\n  : {\n    /* n:\"BrtShrFmla\", */\n    f: parse_BrtShrFmla\n  },\n\n  /*::[*/\n  0x01AC\n  /*::]*/\n  : {\n    /* n:\"BrtTable\" */\n  },\n\n  /*::[*/\n  0x01AD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExtConnections\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01AE\n  /*::]*/\n  : {\n    /* n:\"BrtEndExtConnections\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01AF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B0\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B2\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLevels\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B4\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLevels\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLevel\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B6\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLevel\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLGroups\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01B8\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLGroups\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01B9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLGroup\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01BA\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLGroup\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01BB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLGMembers\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01BC\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLGMembers\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01BD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDHGLGMember\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01BE\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDHGLGMember\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01BF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginQSI\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C0\n  /*::]*/\n  : {\n    /* n:\"BrtEndQSI\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginQSIR\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C2\n  /*::]*/\n  : {\n    /* n:\"BrtEndQSIR\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDeletedNames\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C4\n  /*::]*/\n  : {\n    /* n:\"BrtEndDeletedNames\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDeletedName\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C6\n  /*::]*/\n  : {\n    /* n:\"BrtEndDeletedName\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginQSIFs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01C8\n  /*::]*/\n  : {\n    /* n:\"BrtEndQSIFs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01C9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginQSIF\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01CA\n  /*::]*/\n  : {\n    /* n:\"BrtEndQSIF\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01CB\n  /*::]*/\n  : {\n    /* n:\"BrtBeginAutoSortScope\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01CC\n  /*::]*/\n  : {\n    /* n:\"BrtEndAutoSortScope\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01CD\n  /*::]*/\n  : {\n    /* n:\"BrtBeginConditionalFormatting\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01CE\n  /*::]*/\n  : {\n    /* n:\"BrtEndConditionalFormatting\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01CF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCFRule\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01D0\n  /*::]*/\n  : {\n    /* n:\"BrtEndCFRule\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01D1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginIconSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01D2\n  /*::]*/\n  : {\n    /* n:\"BrtEndIconSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01D3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDatabar\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01D4\n  /*::]*/\n  : {\n    /* n:\"BrtEndDatabar\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01D5\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColorScale\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01D6\n  /*::]*/\n  : {\n    /* n:\"BrtEndColorScale\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01D7\n  /*::]*/\n  : {\n    /* n:\"BrtCFVO\" */\n  },\n\n  /*::[*/\n  0x01D8\n  /*::]*/\n  : {\n    /* n:\"BrtExternValueMeta\" */\n  },\n\n  /*::[*/\n  0x01D9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColorPalette\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01DA\n  /*::]*/\n  : {\n    /* n:\"BrtEndColorPalette\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01DB\n  /*::]*/\n  : {\n    /* n:\"BrtIndexedColor\" */\n  },\n\n  /*::[*/\n  0x01DC\n  /*::]*/\n  : {\n    /* n:\"BrtMargins\", */\n    f: parse_BrtMargins\n  },\n\n  /*::[*/\n  0x01DD\n  /*::]*/\n  : {\n    /* n:\"BrtPrintOptions\" */\n  },\n\n  /*::[*/\n  0x01DE\n  /*::]*/\n  : {\n    /* n:\"BrtPageSetup\" */\n  },\n\n  /*::[*/\n  0x01DF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginHeaderFooter\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E0\n  /*::]*/\n  : {\n    /* n:\"BrtEndHeaderFooter\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01E1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCrtFormat\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E2\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCrtFormat\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01E3\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCrtFormats\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E4\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCrtFormats\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01E5\n  /*::]*/\n  : {\n    /* n:\"BrtWsFmtInfo\", */\n    f: parse_BrtWsFmtInfo\n  },\n\n  /*::[*/\n  0x01E6\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMgs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E7\n  /*::]*/\n  : {\n    /* n:\"BrtEndMGs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01E8\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMGMaps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01E9\n  /*::]*/\n  : {\n    /* n:\"BrtEndMGMaps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01EA\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMG\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01EB\n  /*::]*/\n  : {\n    /* n:\"BrtEndMG\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01EC\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMap\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01ED\n  /*::]*/\n  : {\n    /* n:\"BrtEndMap\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01EE\n  /*::]*/\n  : {\n    /* n:\"BrtHLink\", */\n    f: parse_BrtHLink\n  },\n\n  /*::[*/\n  0x01EF\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDCon\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01F0\n  /*::]*/\n  : {\n    /* n:\"BrtEndDCon\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01F1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDRefs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01F2\n  /*::]*/\n  : {\n    /* n:\"BrtEndDRefs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01F3\n  /*::]*/\n  : {\n    /* n:\"BrtDRef\" */\n  },\n\n  /*::[*/\n  0x01F4\n  /*::]*/\n  : {\n    /* n:\"BrtBeginScenMan\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01F5\n  /*::]*/\n  : {\n    /* n:\"BrtEndScenMan\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01F6\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSct\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01F7\n  /*::]*/\n  : {\n    /* n:\"BrtEndSct\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01F8\n  /*::]*/\n  : {\n    /* n:\"BrtSlc\" */\n  },\n\n  /*::[*/\n  0x01F9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDXFs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01FA\n  /*::]*/\n  : {\n    /* n:\"BrtEndDXFs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01FB\n  /*::]*/\n  : {\n    /* n:\"BrtDXF\" */\n  },\n\n  /*::[*/\n  0x01FC\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTableStyles\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01FD\n  /*::]*/\n  : {\n    /* n:\"BrtEndTableStyles\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x01FE\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTableStyle\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x01FF\n  /*::]*/\n  : {\n    /* n:\"BrtEndTableStyle\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0200\n  /*::]*/\n  : {\n    /* n:\"BrtTableStyleElement\" */\n  },\n\n  /*::[*/\n  0x0201\n  /*::]*/\n  : {\n    /* n:\"BrtTableStyleClient\" */\n  },\n\n  /*::[*/\n  0x0202\n  /*::]*/\n  : {\n    /* n:\"BrtBeginVolDeps\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0203\n  /*::]*/\n  : {\n    /* n:\"BrtEndVolDeps\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0204\n  /*::]*/\n  : {\n    /* n:\"BrtBeginVolType\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0205\n  /*::]*/\n  : {\n    /* n:\"BrtEndVolType\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0206\n  /*::]*/\n  : {\n    /* n:\"BrtBeginVolMain\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0207\n  /*::]*/\n  : {\n    /* n:\"BrtEndVolMain\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0208\n  /*::]*/\n  : {\n    /* n:\"BrtBeginVolTopic\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0209\n  /*::]*/\n  : {\n    /* n:\"BrtEndVolTopic\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x020A\n  /*::]*/\n  : {\n    /* n:\"BrtVolSubtopic\" */\n  },\n\n  /*::[*/\n  0x020B\n  /*::]*/\n  : {\n    /* n:\"BrtVolRef\" */\n  },\n\n  /*::[*/\n  0x020C\n  /*::]*/\n  : {\n    /* n:\"BrtVolNum\" */\n  },\n\n  /*::[*/\n  0x020D\n  /*::]*/\n  : {\n    /* n:\"BrtVolErr\" */\n  },\n\n  /*::[*/\n  0x020E\n  /*::]*/\n  : {\n    /* n:\"BrtVolStr\" */\n  },\n\n  /*::[*/\n  0x020F\n  /*::]*/\n  : {\n    /* n:\"BrtVolBool\" */\n  },\n\n  /*::[*/\n  0x0210\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCalcChain$\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0211\n  /*::]*/\n  : {\n    /* n:\"BrtEndCalcChain$\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0212\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSortState\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0213\n  /*::]*/\n  : {\n    /* n:\"BrtEndSortState\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0214\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSortCond\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0215\n  /*::]*/\n  : {\n    /* n:\"BrtEndSortCond\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0216\n  /*::]*/\n  : {\n    /* n:\"BrtBookProtection\" */\n  },\n\n  /*::[*/\n  0x0217\n  /*::]*/\n  : {\n    /* n:\"BrtSheetProtection\" */\n  },\n\n  /*::[*/\n  0x0218\n  /*::]*/\n  : {\n    /* n:\"BrtRangeProtection\" */\n  },\n\n  /*::[*/\n  0x0219\n  /*::]*/\n  : {\n    /* n:\"BrtPhoneticInfo\" */\n  },\n\n  /*::[*/\n  0x021A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTxtWiz\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x021B\n  /*::]*/\n  : {\n    /* n:\"BrtEndECTxtWiz\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x021C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTWFldInfoLst\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x021D\n  /*::]*/\n  : {\n    /* n:\"BrtEndECTWFldInfoLst\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x021E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTwFldInfo\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0224\n  /*::]*/\n  : {\n    /* n:\"BrtFileSharing\" */\n  },\n\n  /*::[*/\n  0x0225\n  /*::]*/\n  : {\n    /* n:\"BrtOleSize\" */\n  },\n\n  /*::[*/\n  0x0226\n  /*::]*/\n  : {\n    /* n:\"BrtDrawing\", */\n    f: parse_RelID\n  },\n\n  /*::[*/\n  0x0227\n  /*::]*/\n  : {\n    /* n:\"BrtLegacyDrawing\" */\n  },\n\n  /*::[*/\n  0x0228\n  /*::]*/\n  : {\n    /* n:\"BrtLegacyDrawingHF\" */\n  },\n\n  /*::[*/\n  0x0229\n  /*::]*/\n  : {\n    /* n:\"BrtWebOpt\" */\n  },\n\n  /*::[*/\n  0x022A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWebPubItems\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x022B\n  /*::]*/\n  : {\n    /* n:\"BrtEndWebPubItems\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x022C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWebPubItem\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x022D\n  /*::]*/\n  : {\n    /* n:\"BrtEndWebPubItem\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x022E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCondFmt\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x022F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCondFmt\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0230\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCondFmts\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0231\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCondFmts\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0232\n  /*::]*/\n  : {\n    /* n:\"BrtBkHim\" */\n  },\n\n  /*::[*/\n  0x0234\n  /*::]*/\n  : {\n    /* n:\"BrtColor\" */\n  },\n\n  /*::[*/\n  0x0235\n  /*::]*/\n  : {\n    /* n:\"BrtBeginIndexedColors\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0236\n  /*::]*/\n  : {\n    /* n:\"BrtEndIndexedColors\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0239\n  /*::]*/\n  : {\n    /* n:\"BrtBeginMRUColors\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x023A\n  /*::]*/\n  : {\n    /* n:\"BrtEndMRUColors\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x023C\n  /*::]*/\n  : {\n    /* n:\"BrtMRUColor\" */\n  },\n\n  /*::[*/\n  0x023D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDVals\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x023E\n  /*::]*/\n  : {\n    /* n:\"BrtEndDVals\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0241\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameStart\" */\n  },\n\n  /*::[*/\n  0x0242\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameValueStart\" */\n  },\n\n  /*::[*/\n  0x0243\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameValueEnd\" */\n  },\n\n  /*::[*/\n  0x0244\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameNum\" */\n  },\n\n  /*::[*/\n  0x0245\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameErr\" */\n  },\n\n  /*::[*/\n  0x0246\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameSt\" */\n  },\n\n  /*::[*/\n  0x0247\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameNil\" */\n  },\n\n  /*::[*/\n  0x0248\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameBool\" */\n  },\n\n  /*::[*/\n  0x0249\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameFmla\" */\n  },\n\n  /*::[*/\n  0x024A\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameBits\" */\n  },\n\n  /*::[*/\n  0x024B\n  /*::]*/\n  : {\n    /* n:\"BrtSupNameEnd\" */\n  },\n\n  /*::[*/\n  0x024C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSupBook\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x024D\n  /*::]*/\n  : {\n    /* n:\"BrtCellSmartTagProperty\" */\n  },\n\n  /*::[*/\n  0x024E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellSmartTag\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x024F\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellSmartTag\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0250\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellSmartTags\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0251\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellSmartTags\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0252\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSmartTags\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0253\n  /*::]*/\n  : {\n    /* n:\"BrtEndSmartTags\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0254\n  /*::]*/\n  : {\n    /* n:\"BrtSmartTagType\" */\n  },\n\n  /*::[*/\n  0x0255\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSmartTagTypes\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0256\n  /*::]*/\n  : {\n    /* n:\"BrtEndSmartTagTypes\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0257\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0258\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0259\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXFILTER\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x025A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXFilter\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x025B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFills\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x025C\n  /*::]*/\n  : {\n    /* n:\"BrtEndFills\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x025D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellWatches\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x025E\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellWatches\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x025F\n  /*::]*/\n  : {\n    /* n:\"BrtCellWatch\" */\n  },\n\n  /*::[*/\n  0x0260\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCRErrs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0261\n  /*::]*/\n  : {\n    /* n:\"BrtEndCRErrs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0262\n  /*::]*/\n  : {\n    /* n:\"BrtCrashRecErr\" */\n  },\n\n  /*::[*/\n  0x0263\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFonts\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0264\n  /*::]*/\n  : {\n    /* n:\"BrtEndFonts\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0265\n  /*::]*/\n  : {\n    /* n:\"BrtBeginBorders\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0266\n  /*::]*/\n  : {\n    /* n:\"BrtEndBorders\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0267\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFmts\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0268\n  /*::]*/\n  : {\n    /* n:\"BrtEndFmts\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0269\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellXFs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x026A\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellXFs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x026B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginStyles\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x026C\n  /*::]*/\n  : {\n    /* n:\"BrtEndStyles\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0271\n  /*::]*/\n  : {\n    /* n:\"BrtBigName\" */\n  },\n\n  /*::[*/\n  0x0272\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellStyleXFs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0273\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellStyleXFs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0274\n  /*::]*/\n  : {\n    /* n:\"BrtBeginComments\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0275\n  /*::]*/\n  : {\n    /* n:\"BrtEndComments\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0276\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCommentAuthors\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0277\n  /*::]*/\n  : {\n    /* n:\"BrtEndCommentAuthors\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0278\n  /*::]*/\n  : {\n    /* n:\"BrtCommentAuthor\", */\n    f: parse_BrtCommentAuthor\n  },\n\n  /*::[*/\n  0x0279\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCommentList\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x027A\n  /*::]*/\n  : {\n    /* n:\"BrtEndCommentList\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x027B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginComment\", */\n    T: 1,\n    f: parse_BrtBeginComment\n  },\n\n  /*::[*/\n  0x027C\n  /*::]*/\n  : {\n    /* n:\"BrtEndComment\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x027D\n  /*::]*/\n  : {\n    /* n:\"BrtCommentText\", */\n    f: parse_BrtCommentText\n  },\n\n  /*::[*/\n  0x027E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginOleObjects\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x027F\n  /*::]*/\n  : {\n    /* n:\"BrtOleObject\" */\n  },\n\n  /*::[*/\n  0x0280\n  /*::]*/\n  : {\n    /* n:\"BrtEndOleObjects\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0281\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxrules\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0282\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxRules\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0283\n  /*::]*/\n  : {\n    /* n:\"BrtBeginActiveXControls\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0284\n  /*::]*/\n  : {\n    /* n:\"BrtActiveX\" */\n  },\n\n  /*::[*/\n  0x0285\n  /*::]*/\n  : {\n    /* n:\"BrtEndActiveXControls\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0286\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDSDTCEMembersSortBy\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0288\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellIgnoreECs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0289\n  /*::]*/\n  : {\n    /* n:\"BrtCellIgnoreEC\" */\n  },\n\n  /*::[*/\n  0x028A\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellIgnoreECs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x028B\n  /*::]*/\n  : {\n    /* n:\"BrtCsProp\", */\n    f: parse_BrtCsProp\n  },\n\n  /*::[*/\n  0x028C\n  /*::]*/\n  : {\n    /* n:\"BrtCsPageSetup\" */\n  },\n\n  /*::[*/\n  0x028D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUserCsViews\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x028E\n  /*::]*/\n  : {\n    /* n:\"BrtEndUserCsViews\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x028F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginUserCsView\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0290\n  /*::]*/\n  : {\n    /* n:\"BrtEndUserCsView\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0291\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPcdSFCIEntries\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0292\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDSFCIEntries\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0293\n  /*::]*/\n  : {\n    /* n:\"BrtPCDSFCIEntry\" */\n  },\n\n  /*::[*/\n  0x0294\n  /*::]*/\n  : {\n    /* n:\"BrtBeginListParts\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0295\n  /*::]*/\n  : {\n    /* n:\"BrtListPart\" */\n  },\n\n  /*::[*/\n  0x0296\n  /*::]*/\n  : {\n    /* n:\"BrtEndListParts\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0297\n  /*::]*/\n  : {\n    /* n:\"BrtSheetCalcProp\" */\n  },\n\n  /*::[*/\n  0x0298\n  /*::]*/\n  : {\n    /* n:\"BrtBeginFnGroup\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0299\n  /*::]*/\n  : {\n    /* n:\"BrtFnGroup\" */\n  },\n\n  /*::[*/\n  0x029A\n  /*::]*/\n  : {\n    /* n:\"BrtEndFnGroup\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x029B\n  /*::]*/\n  : {\n    /* n:\"BrtSupAddin\" */\n  },\n\n  /*::[*/\n  0x029C\n  /*::]*/\n  : {\n    /* n:\"BrtSXTDMPOrder\" */\n  },\n\n  /*::[*/\n  0x029D\n  /*::]*/\n  : {\n    /* n:\"BrtCsProtection\" */\n  },\n\n  /*::[*/\n  0x029F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWsSortMap\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x02A0\n  /*::]*/\n  : {\n    /* n:\"BrtEndWsSortMap\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x02A1\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRRSort\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x02A2\n  /*::]*/\n  : {\n    /* n:\"BrtEndRRSort\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x02A3\n  /*::]*/\n  : {\n    /* n:\"BrtRRSortItem\" */\n  },\n\n  /*::[*/\n  0x02A4\n  /*::]*/\n  : {\n    /* n:\"BrtFileSharingIso\" */\n  },\n\n  /*::[*/\n  0x02A5\n  /*::]*/\n  : {\n    /* n:\"BrtBookProtectionIso\" */\n  },\n\n  /*::[*/\n  0x02A6\n  /*::]*/\n  : {\n    /* n:\"BrtSheetProtectionIso\" */\n  },\n\n  /*::[*/\n  0x02A7\n  /*::]*/\n  : {\n    /* n:\"BrtCsProtectionIso\" */\n  },\n\n  /*::[*/\n  0x02A8\n  /*::]*/\n  : {\n    /* n:\"BrtRangeProtectionIso\" */\n  },\n\n  /*::[*/\n  0x02A9\n  /*::]*/\n  : {\n    /* n:\"BrtDValList\" */\n  },\n\n  /*::[*/\n  0x0400\n  /*::]*/\n  : {\n    /* n:\"BrtRwDescent\" */\n  },\n\n  /*::[*/\n  0x0401\n  /*::]*/\n  : {\n    /* n:\"BrtKnownFonts\" */\n  },\n\n  /*::[*/\n  0x0402\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTupleSet\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0403\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTupleSet\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0404\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTupleSetHeader\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0405\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTupleSetHeader\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0406\n  /*::]*/\n  : {\n    /* n:\"BrtSXTupleSetHeaderItem\" */\n  },\n\n  /*::[*/\n  0x0407\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTupleSetData\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0408\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTupleSetData\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0409\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXTupleSetRow\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x040A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXTupleSetRow\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x040B\n  /*::]*/\n  : {\n    /* n:\"BrtSXTupleSetRowItem\" */\n  },\n\n  /*::[*/\n  0x040C\n  /*::]*/\n  : {\n    /* n:\"BrtNameExt\" */\n  },\n\n  /*::[*/\n  0x040D\n  /*::]*/\n  : {\n    /* n:\"BrtPCDH14\" */\n  },\n\n  /*::[*/\n  0x040E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMem14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x040F\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMem14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0410\n  /*::]*/\n  : {\n    /* n:\"BrtSXTH14\" */\n  },\n\n  /*::[*/\n  0x0411\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSparklineGroup\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0412\n  /*::]*/\n  : {\n    /* n:\"BrtEndSparklineGroup\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0413\n  /*::]*/\n  : {\n    /* n:\"BrtSparkline\" */\n  },\n\n  /*::[*/\n  0x0414\n  /*::]*/\n  : {\n    /* n:\"BrtSXDI14\" */\n  },\n\n  /*::[*/\n  0x0415\n  /*::]*/\n  : {\n    /* n:\"BrtWsFmtInfoEx14\" */\n  },\n\n  /*::[*/\n  0x0416\n  /*::]*/\n  : {\n    /* n:\"BrtBeginConditionalFormatting14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0417\n  /*::]*/\n  : {\n    /* n:\"BrtEndConditionalFormatting14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0418\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCFRule14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0419\n  /*::]*/\n  : {\n    /* n:\"BrtEndCFRule14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x041A\n  /*::]*/\n  : {\n    /* n:\"BrtCFVO14\" */\n  },\n\n  /*::[*/\n  0x041B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDatabar14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x041C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginIconSet14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x041D\n  /*::]*/\n  : {\n    /* n:\"BrtDVal14\", */\n    f: parse_BrtDVal14\n  },\n\n  /*::[*/\n  0x041E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDVals14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x041F\n  /*::]*/\n  : {\n    /* n:\"BrtColor14\" */\n  },\n\n  /*::[*/\n  0x0420\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSparklines\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0421\n  /*::]*/\n  : {\n    /* n:\"BrtEndSparklines\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0422\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSparklineGroups\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0423\n  /*::]*/\n  : {\n    /* n:\"BrtEndSparklineGroups\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0425\n  /*::]*/\n  : {\n    /* n:\"BrtSXVD14\" */\n  },\n\n  /*::[*/\n  0x0426\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXView14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0427\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXView14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0428\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXView16\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0429\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXView16\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x042A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCD14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x042B\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCD14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x042C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExtConn14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x042D\n  /*::]*/\n  : {\n    /* n:\"BrtEndExtConn14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x042E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x042F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0430\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheID\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0431\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheID\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0433\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCache\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0434\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCache\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0435\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheDef\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0436\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheDef\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0437\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicersEx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0438\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicersEx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0439\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerEx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x043A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerEx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x043B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicer\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x043C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicer\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x043D\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCachePivotTables\" */\n  },\n\n  /*::[*/\n  0x043E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheOlapImpl\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x043F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheOlapImpl\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0440\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheLevelsData\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0441\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheLevelsData\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0442\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheLevelData\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0443\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheLevelData\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0444\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheSiRanges\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0445\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheSiRanges\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0446\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheSiRange\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0447\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheSiRange\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0448\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheOlapItem\" */\n  },\n\n  /*::[*/\n  0x0449\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheSelections\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x044A\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheSelection\" */\n  },\n\n  /*::[*/\n  0x044B\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheSelections\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x044C\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCacheNative\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x044D\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCacheNative\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x044E\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheNativeItem\" */\n  },\n\n  /*::[*/\n  0x044F\n  /*::]*/\n  : {\n    /* n:\"BrtRangeProtection14\" */\n  },\n\n  /*::[*/\n  0x0450\n  /*::]*/\n  : {\n    /* n:\"BrtRangeProtectionIso14\" */\n  },\n\n  /*::[*/\n  0x0451\n  /*::]*/\n  : {\n    /* n:\"BrtCellIgnoreEC14\" */\n  },\n\n  /*::[*/\n  0x0457\n  /*::]*/\n  : {\n    /* n:\"BrtList14\" */\n  },\n\n  /*::[*/\n  0x0458\n  /*::]*/\n  : {\n    /* n:\"BrtCFIcon\" */\n  },\n\n  /*::[*/\n  0x0459\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCachesPivotCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x045A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCachesPivotCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x045B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicers\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x045C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicers\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x045D\n  /*::]*/\n  : {\n    /* n:\"BrtWbProp14\" */\n  },\n\n  /*::[*/\n  0x045E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXEdit\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x045F\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXEdit\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0460\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXEdits\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0461\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXEdits\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0462\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXChange\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0463\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXChange\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0464\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXChanges\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0465\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXChanges\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0466\n  /*::]*/\n  : {\n    /* n:\"BrtSXTupleItems\" */\n  },\n\n  /*::[*/\n  0x0468\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerStyle\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0469\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerStyle\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x046A\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerStyleElement\" */\n  },\n\n  /*::[*/\n  0x046B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginStyleSheetExt14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x046C\n  /*::]*/\n  : {\n    /* n:\"BrtEndStyleSheetExt14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x046D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerCachesPivotCacheID\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x046E\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerCachesPivotCacheID\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x046F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginConditionalFormattings\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0470\n  /*::]*/\n  : {\n    /* n:\"BrtEndConditionalFormattings\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0471\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMemExt\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0472\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMemExt\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0473\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPCDCalcMemsExt\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0474\n  /*::]*/\n  : {\n    /* n:\"BrtEndPCDCalcMemsExt\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0475\n  /*::]*/\n  : {\n    /* n:\"BrtPCDField14\" */\n  },\n\n  /*::[*/\n  0x0476\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerStyles\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0477\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerStyles\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0478\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSlicerStyleElements\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0479\n  /*::]*/\n  : {\n    /* n:\"BrtEndSlicerStyleElements\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x047A\n  /*::]*/\n  : {\n    /* n:\"BrtCFRuleExt\" */\n  },\n\n  /*::[*/\n  0x047B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCondFmt14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x047C\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCondFmt14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x047D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSXCondFmts14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x047E\n  /*::]*/\n  : {\n    /* n:\"BrtEndSXCondFmts14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0480\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSortCond14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0481\n  /*::]*/\n  : {\n    /* n:\"BrtEndSortCond14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0482\n  /*::]*/\n  : {\n    /* n:\"BrtEndDVals14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0483\n  /*::]*/\n  : {\n    /* n:\"BrtEndIconSet14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0484\n  /*::]*/\n  : {\n    /* n:\"BrtEndDatabar14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0485\n  /*::]*/\n  : {\n    /* n:\"BrtBeginColorScale14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0486\n  /*::]*/\n  : {\n    /* n:\"BrtEndColorScale14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0487\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxrules14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0488\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxrules14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0489\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRule14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x048A\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRule14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x048B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFilters14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x048C\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFilters14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x048D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFilter14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x048E\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFilter14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x048F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPRFItem14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0490\n  /*::]*/\n  : {\n    /* n:\"BrtEndPRFItem14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0491\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCellIgnoreECs14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0492\n  /*::]*/\n  : {\n    /* n:\"BrtEndCellIgnoreECs14\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0493\n  /*::]*/\n  : {\n    /* n:\"BrtDxf14\" */\n  },\n\n  /*::[*/\n  0x0494\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDxF14s\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0495\n  /*::]*/\n  : {\n    /* n:\"BrtEndDxf14s\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0499\n  /*::]*/\n  : {\n    /* n:\"BrtFilter14\" */\n  },\n\n  /*::[*/\n  0x049A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCustomFilters14\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x049C\n  /*::]*/\n  : {\n    /* n:\"BrtCustomFilter14\" */\n  },\n\n  /*::[*/\n  0x049D\n  /*::]*/\n  : {\n    /* n:\"BrtIconFilter14\" */\n  },\n\n  /*::[*/\n  0x049E\n  /*::]*/\n  : {\n    /* n:\"BrtPivotCacheConnectionName\" */\n  },\n\n  /*::[*/\n  0x0800\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDecoupledPivotCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0801\n  /*::]*/\n  : {\n    /* n:\"BrtEndDecoupledPivotCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0802\n  /*::]*/\n  : {\n    /* n:\"BrtDecoupledPivotCacheID\" */\n  },\n\n  /*::[*/\n  0x0803\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotTableRefs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0804\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotTableRefs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0805\n  /*::]*/\n  : {\n    /* n:\"BrtPivotTableRef\" */\n  },\n\n  /*::[*/\n  0x0806\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheBookPivotTables\" */\n  },\n\n  /*::[*/\n  0x0807\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxvcells\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0808\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxvcells\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0809\n  /*::]*/\n  : {\n    /* n:\"BrtBeginSxRow\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x080A\n  /*::]*/\n  : {\n    /* n:\"BrtEndSxRow\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x080C\n  /*::]*/\n  : {\n    /* n:\"BrtPcdCalcMem15\" */\n  },\n\n  /*::[*/\n  0x0813\n  /*::]*/\n  : {\n    /* n:\"BrtQsi15\" */\n  },\n\n  /*::[*/\n  0x0814\n  /*::]*/\n  : {\n    /* n:\"BrtBeginWebExtensions\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0815\n  /*::]*/\n  : {\n    /* n:\"BrtEndWebExtensions\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0816\n  /*::]*/\n  : {\n    /* n:\"BrtWebExtension\" */\n  },\n\n  /*::[*/\n  0x0817\n  /*::]*/\n  : {\n    /* n:\"BrtAbsPath15\" */\n  },\n\n  /*::[*/\n  0x0818\n  /*::]*/\n  : {\n    /* n:\"BrtBeginPivotTableUISettings\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0819\n  /*::]*/\n  : {\n    /* n:\"BrtEndPivotTableUISettings\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x081B\n  /*::]*/\n  : {\n    /* n:\"BrtTableSlicerCacheIDs\" */\n  },\n\n  /*::[*/\n  0x081C\n  /*::]*/\n  : {\n    /* n:\"BrtTableSlicerCacheID\" */\n  },\n\n  /*::[*/\n  0x081D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTableSlicerCache\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x081E\n  /*::]*/\n  : {\n    /* n:\"BrtEndTableSlicerCache\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x081F\n  /*::]*/\n  : {\n    /* n:\"BrtSxFilter15\" */\n  },\n\n  /*::[*/\n  0x0820\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineCachePivotCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0821\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineCachePivotCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0822\n  /*::]*/\n  : {\n    /* n:\"BrtTimelineCachePivotCacheID\" */\n  },\n\n  /*::[*/\n  0x0823\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineCacheIDs\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0824\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineCacheIDs\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0825\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineCacheID\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0826\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineCacheID\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0827\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelinesEx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0828\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelinesEx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0829\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineEx\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x082A\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineEx\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x082B\n  /*::]*/\n  : {\n    /* n:\"BrtWorkBookPr15\" */\n  },\n\n  /*::[*/\n  0x082C\n  /*::]*/\n  : {\n    /* n:\"BrtPCDH15\" */\n  },\n\n  /*::[*/\n  0x082D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineStyle\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x082E\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineStyle\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x082F\n  /*::]*/\n  : {\n    /* n:\"BrtTimelineStyleElement\" */\n  },\n\n  /*::[*/\n  0x0830\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineStylesheetExt15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0831\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineStylesheetExt15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0832\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineStyles\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0833\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineStyles\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0834\n  /*::]*/\n  : {\n    /* n:\"BrtBeginTimelineStyleElements\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0835\n  /*::]*/\n  : {\n    /* n:\"BrtEndTimelineStyleElements\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0836\n  /*::]*/\n  : {\n    /* n:\"BrtDxf15\" */\n  },\n\n  /*::[*/\n  0x0837\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDxfs15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0838\n  /*::]*/\n  : {\n    /* n:\"BrtEndDxfs15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0839\n  /*::]*/\n  : {\n    /* n:\"BrtSlicerCacheHideItemsWithNoData\" */\n  },\n\n  /*::[*/\n  0x083A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginItemUniqueNames\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x083B\n  /*::]*/\n  : {\n    /* n:\"BrtEndItemUniqueNames\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x083C\n  /*::]*/\n  : {\n    /* n:\"BrtItemUniqueName\" */\n  },\n\n  /*::[*/\n  0x083D\n  /*::]*/\n  : {\n    /* n:\"BrtBeginExtConn15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x083E\n  /*::]*/\n  : {\n    /* n:\"BrtEndExtConn15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x083F\n  /*::]*/\n  : {\n    /* n:\"BrtBeginOledbPr15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0840\n  /*::]*/\n  : {\n    /* n:\"BrtEndOledbPr15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0841\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDataFeedPr15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0842\n  /*::]*/\n  : {\n    /* n:\"BrtEndDataFeedPr15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0843\n  /*::]*/\n  : {\n    /* n:\"BrtTextPr15\" */\n  },\n\n  /*::[*/\n  0x0844\n  /*::]*/\n  : {\n    /* n:\"BrtRangePr15\" */\n  },\n\n  /*::[*/\n  0x0845\n  /*::]*/\n  : {\n    /* n:\"BrtDbCommand15\" */\n  },\n\n  /*::[*/\n  0x0846\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDbTables15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0847\n  /*::]*/\n  : {\n    /* n:\"BrtEndDbTables15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0848\n  /*::]*/\n  : {\n    /* n:\"BrtDbTable15\" */\n  },\n\n  /*::[*/\n  0x0849\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDataModel\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x084A\n  /*::]*/\n  : {\n    /* n:\"BrtEndDataModel\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x084B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginModelTables\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x084C\n  /*::]*/\n  : {\n    /* n:\"BrtEndModelTables\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x084D\n  /*::]*/\n  : {\n    /* n:\"BrtModelTable\" */\n  },\n\n  /*::[*/\n  0x084E\n  /*::]*/\n  : {\n    /* n:\"BrtBeginModelRelationships\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x084F\n  /*::]*/\n  : {\n    /* n:\"BrtEndModelRelationships\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0850\n  /*::]*/\n  : {\n    /* n:\"BrtModelRelationship\" */\n  },\n\n  /*::[*/\n  0x0851\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTxtWiz15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0852\n  /*::]*/\n  : {\n    /* n:\"BrtEndECTxtWiz15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0853\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTWFldInfoLst15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0854\n  /*::]*/\n  : {\n    /* n:\"BrtEndECTWFldInfoLst15\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x0855\n  /*::]*/\n  : {\n    /* n:\"BrtBeginECTWFldInfo15\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x0856\n  /*::]*/\n  : {\n    /* n:\"BrtFieldListActiveItem\" */\n  },\n\n  /*::[*/\n  0x0857\n  /*::]*/\n  : {\n    /* n:\"BrtPivotCacheIdVersion\" */\n  },\n\n  /*::[*/\n  0x0858\n  /*::]*/\n  : {\n    /* n:\"BrtSXDI15\" */\n  },\n\n  /*::[*/\n  0x0859\n  /*::]*/\n  : {\n    /* n:\"BrtBeginModelTimeGroupings\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x085A\n  /*::]*/\n  : {\n    /* n:\"BrtEndModelTimeGroupings\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x085B\n  /*::]*/\n  : {\n    /* n:\"BrtBeginModelTimeGrouping\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x085C\n  /*::]*/\n  : {\n    /* n:\"BrtEndModelTimeGrouping\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x085D\n  /*::]*/\n  : {\n    /* n:\"BrtModelTimeGroupingCalcCol\" */\n  },\n\n  /*::[*/\n  0x0C00\n  /*::]*/\n  : {\n    /* n:\"BrtUid\" */\n  },\n\n  /*::[*/\n  0x0C01\n  /*::]*/\n  : {\n    /* n:\"BrtRevisionPtr\" */\n  },\n\n  /*::[*/\n  0x1000\n  /*::]*/\n  : {\n    /* n:\"BrtBeginDynamicArrayPr\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x1001\n  /*::]*/\n  : {\n    /* n:\"BrtEndDynamicArrayPr\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x138A\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRichValueBlock\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x138B\n  /*::]*/\n  : {\n    /* n:\"BrtEndRichValueBlock\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13D9\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRichFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13DA\n  /*::]*/\n  : {\n    /* n:\"BrtEndRichFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13DB\n  /*::]*/\n  : {\n    /* n:\"BrtRichFilter\" */\n  },\n\n  /*::[*/\n  0x13DC\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRichFilterColumn\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13DD\n  /*::]*/\n  : {\n    /* n:\"BrtEndRichFilterColumn\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13DE\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCustomRichFilters\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13DF\n  /*::]*/\n  : {\n    /* n:\"BrtEndCustomRichFilters\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13E0\n  /*::]*/\n  : {\n    /* n:\"BrtCustomRichFilter\" */\n  },\n\n  /*::[*/\n  0x13E1\n  /*::]*/\n  : {\n    /* n:\"BrtTop10RichFilter\" */\n  },\n\n  /*::[*/\n  0x13E2\n  /*::]*/\n  : {\n    /* n:\"BrtDynamicRichFilter\" */\n  },\n\n  /*::[*/\n  0x13E4\n  /*::]*/\n  : {\n    /* n:\"BrtBeginRichSortCondition\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13E5\n  /*::]*/\n  : {\n    /* n:\"BrtEndRichSortCondition\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13E6\n  /*::]*/\n  : {\n    /* n:\"BrtRichFilterDateGroupItem\" */\n  },\n\n  /*::[*/\n  0x13E7\n  /*::]*/\n  : {\n    /* n:\"BrtBeginCalcFeatures\", */\n    T: 1\n  },\n\n  /*::[*/\n  0x13E8\n  /*::]*/\n  : {\n    /* n:\"BrtEndCalcFeatures\", */\n    T: -1\n  },\n\n  /*::[*/\n  0x13E9\n  /*::]*/\n  : {\n    /* n:\"BrtCalcFeature\" */\n  },\n\n  /*::[*/\n  0x13EB\n  /*::]*/\n  : {\n    /* n:\"BrtExternalLinksPr\" */\n  },\n\n  /*::[*/\n  0xFFFF\n  /*::]*/\n  : {\n    n: \"\"\n  }\n};\n/* [MS-XLS] 2.3 Record Enumeration (and other sources) */\n\nvar XLSRecordEnum = {\n  /* [MS-XLS] 2.3 Record Enumeration 2021-08-17 */\n\n  /*::[*/\n  0x0006\n  /*::]*/\n  : {\n    /* n:\"Formula\", */\n    f: parse_Formula\n  },\n\n  /*::[*/\n  0x000a\n  /*::]*/\n  : {\n    /* n:\"EOF\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x000c\n  /*::]*/\n  : {\n    /* n:\"CalcCount\", */\n    f: parseuint16\n  },\n  //\n\n  /*::[*/\n  0x000d\n  /*::]*/\n  : {\n    /* n:\"CalcMode\", */\n    f: parseuint16\n  },\n  //\n\n  /*::[*/\n  0x000e\n  /*::]*/\n  : {\n    /* n:\"CalcPrecision\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x000f\n  /*::]*/\n  : {\n    /* n:\"CalcRefMode\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x0010\n  /*::]*/\n  : {\n    /* n:\"CalcDelta\", */\n    f: parse_Xnum\n  },\n  //\n\n  /*::[*/\n  0x0011\n  /*::]*/\n  : {\n    /* n:\"CalcIter\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x0012\n  /*::]*/\n  : {\n    /* n:\"Protect\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0013\n  /*::]*/\n  : {\n    /* n:\"Password\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0014\n  /*::]*/\n  : {\n    /* n:\"Header\", */\n    f: parse_XLHeaderFooter\n  },\n\n  /*::[*/\n  0x0015\n  /*::]*/\n  : {\n    /* n:\"Footer\", */\n    f: parse_XLHeaderFooter\n  },\n\n  /*::[*/\n  0x0017\n  /*::]*/\n  : {\n    /* n:\"ExternSheet\", */\n    f: parse_ExternSheet\n  },\n\n  /*::[*/\n  0x0018\n  /*::]*/\n  : {\n    /* n:\"Lbl\", */\n    f: parse_Lbl\n  },\n\n  /*::[*/\n  0x0019\n  /*::]*/\n  : {\n    /* n:\"WinProtect\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x001a\n  /*::]*/\n  : {\n    /* n:\"VerticalPageBreaks\", */\n  },\n\n  /*::[*/\n  0x001b\n  /*::]*/\n  : {\n    /* n:\"HorizontalPageBreaks\", */\n  },\n\n  /*::[*/\n  0x001c\n  /*::]*/\n  : {\n    /* n:\"Note\", */\n    f: parse_Note\n  },\n\n  /*::[*/\n  0x001d\n  /*::]*/\n  : {\n    /* n:\"Selection\", */\n  },\n\n  /*::[*/\n  0x0022\n  /*::]*/\n  : {\n    /* n:\"Date1904\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0023\n  /*::]*/\n  : {\n    /* n:\"ExternName\", */\n    f: parse_ExternName\n  },\n\n  /*::[*/\n  0x0026\n  /*::]*/\n  : {\n    /* n:\"LeftMargin\", */\n    f: parse_Xnum\n  },\n  // *\n\n  /*::[*/\n  0x0027\n  /*::]*/\n  : {\n    /* n:\"RightMargin\", */\n    f: parse_Xnum\n  },\n  // *\n\n  /*::[*/\n  0x0028\n  /*::]*/\n  : {\n    /* n:\"TopMargin\", */\n    f: parse_Xnum\n  },\n  // *\n\n  /*::[*/\n  0x0029\n  /*::]*/\n  : {\n    /* n:\"BottomMargin\", */\n    f: parse_Xnum\n  },\n  // *\n\n  /*::[*/\n  0x002a\n  /*::]*/\n  : {\n    /* n:\"PrintRowCol\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x002b\n  /*::]*/\n  : {\n    /* n:\"PrintGrid\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x002f\n  /*::]*/\n  : {\n    /* n:\"FilePass\", */\n    f: parse_FilePass\n  },\n\n  /*::[*/\n  0x0031\n  /*::]*/\n  : {\n    /* n:\"Font\", */\n    f: parse_Font\n  },\n\n  /*::[*/\n  0x0033\n  /*::]*/\n  : {\n    /* n:\"PrintSize\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x003c\n  /*::]*/\n  : {\n    /* n:\"Continue\", */\n  },\n\n  /*::[*/\n  0x003d\n  /*::]*/\n  : {\n    /* n:\"Window1\", */\n    f: parse_Window1\n  },\n\n  /*::[*/\n  0x0040\n  /*::]*/\n  : {\n    /* n:\"Backup\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0041\n  /*::]*/\n  : {\n    /* n:\"Pane\", */\n    f: parse_Pane\n  },\n\n  /*::[*/\n  0x0042\n  /*::]*/\n  : {\n    /* n:\"CodePage\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x004d\n  /*::]*/\n  : {\n    /* n:\"Pls\", */\n  },\n\n  /*::[*/\n  0x0050\n  /*::]*/\n  : {\n    /* n:\"DCon\", */\n  },\n\n  /*::[*/\n  0x0051\n  /*::]*/\n  : {\n    /* n:\"DConRef\", */\n  },\n\n  /*::[*/\n  0x0052\n  /*::]*/\n  : {\n    /* n:\"DConName\", */\n  },\n\n  /*::[*/\n  0x0055\n  /*::]*/\n  : {\n    /* n:\"DefColWidth\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0059\n  /*::]*/\n  : {\n    /* n:\"XCT\", */\n  },\n\n  /*::[*/\n  0x005a\n  /*::]*/\n  : {\n    /* n:\"CRN\", */\n  },\n\n  /*::[*/\n  0x005b\n  /*::]*/\n  : {\n    /* n:\"FileSharing\", */\n  },\n\n  /*::[*/\n  0x005c\n  /*::]*/\n  : {\n    /* n:\"WriteAccess\", */\n    f: parse_WriteAccess\n  },\n\n  /*::[*/\n  0x005d\n  /*::]*/\n  : {\n    /* n:\"Obj\", */\n    f: parse_Obj\n  },\n\n  /*::[*/\n  0x005e\n  /*::]*/\n  : {\n    /* n:\"Uncalced\", */\n  },\n\n  /*::[*/\n  0x005f\n  /*::]*/\n  : {\n    /* n:\"CalcSaveRecalc\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x0060\n  /*::]*/\n  : {\n    /* n:\"Template\", */\n  },\n\n  /*::[*/\n  0x0061\n  /*::]*/\n  : {\n    /* n:\"Intl\", */\n  },\n\n  /*::[*/\n  0x0063\n  /*::]*/\n  : {\n    /* n:\"ObjProtect\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x007d\n  /*::]*/\n  : {\n    /* n:\"ColInfo\", */\n    f: parse_ColInfo\n  },\n\n  /*::[*/\n  0x0080\n  /*::]*/\n  : {\n    /* n:\"Guts\", */\n    f: parse_Guts\n  },\n\n  /*::[*/\n  0x0081\n  /*::]*/\n  : {\n    /* n:\"WsBool\", */\n    f: parse_WsBool\n  },\n\n  /*::[*/\n  0x0082\n  /*::]*/\n  : {\n    /* n:\"GridSet\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0083\n  /*::]*/\n  : {\n    /* n:\"HCenter\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0084\n  /*::]*/\n  : {\n    /* n:\"VCenter\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0085\n  /*::]*/\n  : {\n    /* n:\"BoundSheet8\", */\n    f: parse_BoundSheet8\n  },\n\n  /*::[*/\n  0x0086\n  /*::]*/\n  : {\n    /* n:\"WriteProtect\", */\n  },\n\n  /*::[*/\n  0x008c\n  /*::]*/\n  : {\n    /* n:\"Country\", */\n    f: parse_Country\n  },\n\n  /*::[*/\n  0x008d\n  /*::]*/\n  : {\n    /* n:\"HideObj\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0090\n  /*::]*/\n  : {\n    /* n:\"Sort\", */\n  },\n\n  /*::[*/\n  0x0092\n  /*::]*/\n  : {\n    /* n:\"Palette\", */\n    f: parse_Palette\n  },\n\n  /*::[*/\n  0x0097\n  /*::]*/\n  : {\n    /* n:\"Sync\", */\n  },\n\n  /*::[*/\n  0x0098\n  /*::]*/\n  : {\n    /* n:\"LPr\", */\n  },\n\n  /*::[*/\n  0x0099\n  /*::]*/\n  : {\n    /* n:\"DxGCol\", */\n  },\n\n  /*::[*/\n  0x009a\n  /*::]*/\n  : {\n    /* n:\"FnGroupName\", */\n  },\n\n  /*::[*/\n  0x009b\n  /*::]*/\n  : {\n    /* n:\"FilterMode\", */\n  },\n\n  /*::[*/\n  0x009c\n  /*::]*/\n  : {\n    /* n:\"BuiltInFnGroupCount\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x009d\n  /*::]*/\n  : {\n    /* n:\"AutoFilterInfo\", */\n  },\n\n  /*::[*/\n  0x009e\n  /*::]*/\n  : {\n    /* n:\"AutoFilter\", */\n  },\n\n  /*::[*/\n  0x00a0\n  /*::]*/\n  : {\n    /* n:\"Scl\", */\n    f: parse_Scl\n  },\n\n  /*::[*/\n  0x00a1\n  /*::]*/\n  : {\n    /* n:\"Setup\", */\n    f: parse_Setup\n  },\n\n  /*::[*/\n  0x00ae\n  /*::]*/\n  : {\n    /* n:\"ScenMan\", */\n  },\n\n  /*::[*/\n  0x00af\n  /*::]*/\n  : {\n    /* n:\"SCENARIO\", */\n  },\n\n  /*::[*/\n  0x00b0\n  /*::]*/\n  : {\n    /* n:\"SxView\", */\n  },\n\n  /*::[*/\n  0x00b1\n  /*::]*/\n  : {\n    /* n:\"Sxvd\", */\n  },\n\n  /*::[*/\n  0x00b2\n  /*::]*/\n  : {\n    /* n:\"SXVI\", */\n  },\n\n  /*::[*/\n  0x00b4\n  /*::]*/\n  : {\n    /* n:\"SxIvd\", */\n  },\n\n  /*::[*/\n  0x00b5\n  /*::]*/\n  : {\n    /* n:\"SXLI\", */\n  },\n\n  /*::[*/\n  0x00b6\n  /*::]*/\n  : {\n    /* n:\"SXPI\", */\n  },\n\n  /*::[*/\n  0x00b8\n  /*::]*/\n  : {\n    /* n:\"DocRoute\", */\n  },\n\n  /*::[*/\n  0x00b9\n  /*::]*/\n  : {\n    /* n:\"RecipName\", */\n  },\n\n  /*::[*/\n  0x00bd\n  /*::]*/\n  : {\n    /* n:\"MulRk\", */\n    f: parse_MulRk\n  },\n\n  /*::[*/\n  0x00be\n  /*::]*/\n  : {\n    /* n:\"MulBlank\", */\n    f: parse_MulBlank\n  },\n\n  /*::[*/\n  0x00c1\n  /*::]*/\n  : {\n    /* n:\"Mms\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x00c5\n  /*::]*/\n  : {\n    /* n:\"SXDI\", */\n  },\n\n  /*::[*/\n  0x00c6\n  /*::]*/\n  : {\n    /* n:\"SXDB\", */\n  },\n\n  /*::[*/\n  0x00c7\n  /*::]*/\n  : {\n    /* n:\"SXFDB\", */\n  },\n\n  /*::[*/\n  0x00c8\n  /*::]*/\n  : {\n    /* n:\"SXDBB\", */\n  },\n\n  /*::[*/\n  0x00c9\n  /*::]*/\n  : {\n    /* n:\"SXNum\", */\n  },\n\n  /*::[*/\n  0x00ca\n  /*::]*/\n  : {\n    /* n:\"SxBool\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x00cb\n  /*::]*/\n  : {\n    /* n:\"SxErr\", */\n  },\n\n  /*::[*/\n  0x00cc\n  /*::]*/\n  : {\n    /* n:\"SXInt\", */\n  },\n\n  /*::[*/\n  0x00cd\n  /*::]*/\n  : {\n    /* n:\"SXString\", */\n  },\n\n  /*::[*/\n  0x00ce\n  /*::]*/\n  : {\n    /* n:\"SXDtr\", */\n  },\n\n  /*::[*/\n  0x00cf\n  /*::]*/\n  : {\n    /* n:\"SxNil\", */\n  },\n\n  /*::[*/\n  0x00d0\n  /*::]*/\n  : {\n    /* n:\"SXTbl\", */\n  },\n\n  /*::[*/\n  0x00d1\n  /*::]*/\n  : {\n    /* n:\"SXTBRGIITM\", */\n  },\n\n  /*::[*/\n  0x00d2\n  /*::]*/\n  : {\n    /* n:\"SxTbpg\", */\n  },\n\n  /*::[*/\n  0x00d3\n  /*::]*/\n  : {\n    /* n:\"ObProj\", */\n  },\n\n  /*::[*/\n  0x00d5\n  /*::]*/\n  : {\n    /* n:\"SXStreamID\", */\n  },\n\n  /*::[*/\n  0x00d7\n  /*::]*/\n  : {\n    /* n:\"DBCell\", */\n  },\n\n  /*::[*/\n  0x00d8\n  /*::]*/\n  : {\n    /* n:\"SXRng\", */\n  },\n\n  /*::[*/\n  0x00d9\n  /*::]*/\n  : {\n    /* n:\"SxIsxoper\", */\n  },\n\n  /*::[*/\n  0x00da\n  /*::]*/\n  : {\n    /* n:\"BookBool\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x00dc\n  /*::]*/\n  : {\n    /* n:\"DbOrParamQry\", */\n  },\n\n  /*::[*/\n  0x00dd\n  /*::]*/\n  : {\n    /* n:\"ScenarioProtect\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x00de\n  /*::]*/\n  : {\n    /* n:\"OleObjectSize\", */\n  },\n\n  /*::[*/\n  0x00e0\n  /*::]*/\n  : {\n    /* n:\"XF\", */\n    f: parse_XF\n  },\n\n  /*::[*/\n  0x00e1\n  /*::]*/\n  : {\n    /* n:\"InterfaceHdr\", */\n    f: parse_InterfaceHdr\n  },\n\n  /*::[*/\n  0x00e2\n  /*::]*/\n  : {\n    /* n:\"InterfaceEnd\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x00e3\n  /*::]*/\n  : {\n    /* n:\"SXVS\", */\n  },\n\n  /*::[*/\n  0x00e5\n  /*::]*/\n  : {\n    /* n:\"MergeCells\", */\n    f: parse_MergeCells\n  },\n\n  /*::[*/\n  0x00e9\n  /*::]*/\n  : {\n    /* n:\"BkHim\", */\n  },\n\n  /*::[*/\n  0x00eb\n  /*::]*/\n  : {\n    /* n:\"MsoDrawingGroup\", */\n  },\n\n  /*::[*/\n  0x00ec\n  /*::]*/\n  : {\n    /* n:\"MsoDrawing\", */\n  },\n\n  /*::[*/\n  0x00ed\n  /*::]*/\n  : {\n    /* n:\"MsoDrawingSelection\", */\n  },\n\n  /*::[*/\n  0x00ef\n  /*::]*/\n  : {\n    /* n:\"PhoneticInfo\", */\n  },\n\n  /*::[*/\n  0x00f0\n  /*::]*/\n  : {\n    /* n:\"SxRule\", */\n  },\n\n  /*::[*/\n  0x00f1\n  /*::]*/\n  : {\n    /* n:\"SXEx\", */\n  },\n\n  /*::[*/\n  0x00f2\n  /*::]*/\n  : {\n    /* n:\"SxFilt\", */\n  },\n\n  /*::[*/\n  0x00f4\n  /*::]*/\n  : {\n    /* n:\"SxDXF\", */\n  },\n\n  /*::[*/\n  0x00f5\n  /*::]*/\n  : {\n    /* n:\"SxItm\", */\n  },\n\n  /*::[*/\n  0x00f6\n  /*::]*/\n  : {\n    /* n:\"SxName\", */\n  },\n\n  /*::[*/\n  0x00f7\n  /*::]*/\n  : {\n    /* n:\"SxSelect\", */\n  },\n\n  /*::[*/\n  0x00f8\n  /*::]*/\n  : {\n    /* n:\"SXPair\", */\n  },\n\n  /*::[*/\n  0x00f9\n  /*::]*/\n  : {\n    /* n:\"SxFmla\", */\n  },\n\n  /*::[*/\n  0x00fb\n  /*::]*/\n  : {\n    /* n:\"SxFormat\", */\n  },\n\n  /*::[*/\n  0x00fc\n  /*::]*/\n  : {\n    /* n:\"SST\", */\n    f: parse_SST\n  },\n\n  /*::[*/\n  0x00fd\n  /*::]*/\n  : {\n    /* n:\"LabelSst\", */\n    f: parse_LabelSst\n  },\n\n  /*::[*/\n  0x00ff\n  /*::]*/\n  : {\n    /* n:\"ExtSST\", */\n    f: parse_ExtSST\n  },\n\n  /*::[*/\n  0x0100\n  /*::]*/\n  : {\n    /* n:\"SXVDEx\", */\n  },\n\n  /*::[*/\n  0x0103\n  /*::]*/\n  : {\n    /* n:\"SXFormula\", */\n  },\n\n  /*::[*/\n  0x0122\n  /*::]*/\n  : {\n    /* n:\"SXDBEx\", */\n  },\n\n  /*::[*/\n  0x0137\n  /*::]*/\n  : {\n    /* n:\"RRDInsDel\", */\n  },\n\n  /*::[*/\n  0x0138\n  /*::]*/\n  : {\n    /* n:\"RRDHead\", */\n  },\n\n  /*::[*/\n  0x013b\n  /*::]*/\n  : {\n    /* n:\"RRDChgCell\", */\n  },\n\n  /*::[*/\n  0x013d\n  /*::]*/\n  : {\n    /* n:\"RRTabId\", */\n    f: parseuint16a\n  },\n\n  /*::[*/\n  0x013e\n  /*::]*/\n  : {\n    /* n:\"RRDRenSheet\", */\n  },\n\n  /*::[*/\n  0x013f\n  /*::]*/\n  : {\n    /* n:\"RRSort\", */\n  },\n\n  /*::[*/\n  0x0140\n  /*::]*/\n  : {\n    /* n:\"RRDMove\", */\n  },\n\n  /*::[*/\n  0x014a\n  /*::]*/\n  : {\n    /* n:\"RRFormat\", */\n  },\n\n  /*::[*/\n  0x014b\n  /*::]*/\n  : {\n    /* n:\"RRAutoFmt\", */\n  },\n\n  /*::[*/\n  0x014d\n  /*::]*/\n  : {\n    /* n:\"RRInsertSh\", */\n  },\n\n  /*::[*/\n  0x014e\n  /*::]*/\n  : {\n    /* n:\"RRDMoveBegin\", */\n  },\n\n  /*::[*/\n  0x014f\n  /*::]*/\n  : {\n    /* n:\"RRDMoveEnd\", */\n  },\n\n  /*::[*/\n  0x0150\n  /*::]*/\n  : {\n    /* n:\"RRDInsDelBegin\", */\n  },\n\n  /*::[*/\n  0x0151\n  /*::]*/\n  : {\n    /* n:\"RRDInsDelEnd\", */\n  },\n\n  /*::[*/\n  0x0152\n  /*::]*/\n  : {\n    /* n:\"RRDConflict\", */\n  },\n\n  /*::[*/\n  0x0153\n  /*::]*/\n  : {\n    /* n:\"RRDDefName\", */\n  },\n\n  /*::[*/\n  0x0154\n  /*::]*/\n  : {\n    /* n:\"RRDRstEtxp\", */\n  },\n\n  /*::[*/\n  0x015f\n  /*::]*/\n  : {\n    /* n:\"LRng\", */\n  },\n\n  /*::[*/\n  0x0160\n  /*::]*/\n  : {\n    /* n:\"UsesELFs\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x0161\n  /*::]*/\n  : {\n    /* n:\"DSF\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x0191\n  /*::]*/\n  : {\n    /* n:\"CUsr\", */\n  },\n\n  /*::[*/\n  0x0192\n  /*::]*/\n  : {\n    /* n:\"CbUsr\", */\n  },\n\n  /*::[*/\n  0x0193\n  /*::]*/\n  : {\n    /* n:\"UsrInfo\", */\n  },\n\n  /*::[*/\n  0x0194\n  /*::]*/\n  : {\n    /* n:\"UsrExcl\", */\n  },\n\n  /*::[*/\n  0x0195\n  /*::]*/\n  : {\n    /* n:\"FileLock\", */\n  },\n\n  /*::[*/\n  0x0196\n  /*::]*/\n  : {\n    /* n:\"RRDInfo\", */\n  },\n\n  /*::[*/\n  0x0197\n  /*::]*/\n  : {\n    /* n:\"BCUsrs\", */\n  },\n\n  /*::[*/\n  0x0198\n  /*::]*/\n  : {\n    /* n:\"UsrChk\", */\n  },\n\n  /*::[*/\n  0x01a9\n  /*::]*/\n  : {\n    /* n:\"UserBView\", */\n  },\n\n  /*::[*/\n  0x01aa\n  /*::]*/\n  : {\n    /* n:\"UserSViewBegin\", */\n  },\n\n  /*::[*/\n  0x01ab\n  /*::]*/\n  : {\n    /* n:\"UserSViewEnd\", */\n  },\n\n  /*::[*/\n  0x01ac\n  /*::]*/\n  : {\n    /* n:\"RRDUserView\", */\n  },\n\n  /*::[*/\n  0x01ad\n  /*::]*/\n  : {\n    /* n:\"Qsi\", */\n  },\n\n  /*::[*/\n  0x01ae\n  /*::]*/\n  : {\n    /* n:\"SupBook\", */\n    f: parse_SupBook\n  },\n\n  /*::[*/\n  0x01af\n  /*::]*/\n  : {\n    /* n:\"Prot4Rev\", */\n    f: parsebool\n  },\n\n  /*::[*/\n  0x01b0\n  /*::]*/\n  : {\n    /* n:\"CondFmt\", */\n  },\n\n  /*::[*/\n  0x01b1\n  /*::]*/\n  : {\n    /* n:\"CF\", */\n  },\n\n  /*::[*/\n  0x01b2\n  /*::]*/\n  : {\n    /* n:\"DVal\", */\n  },\n\n  /*::[*/\n  0x01b5\n  /*::]*/\n  : {\n    /* n:\"DConBin\", */\n  },\n\n  /*::[*/\n  0x01b6\n  /*::]*/\n  : {\n    /* n:\"TxO\", */\n    f: parse_TxO\n  },\n\n  /*::[*/\n  0x01b7\n  /*::]*/\n  : {\n    /* n:\"RefreshAll\", */\n    f: parsebool\n  },\n  //\n\n  /*::[*/\n  0x01b8\n  /*::]*/\n  : {\n    /* n:\"HLink\", */\n    f: parse_HLink\n  },\n\n  /*::[*/\n  0x01b9\n  /*::]*/\n  : {\n    /* n:\"Lel\", */\n  },\n\n  /*::[*/\n  0x01ba\n  /*::]*/\n  : {\n    /* n:\"CodeName\", */\n    f: parse_XLUnicodeString\n  },\n\n  /*::[*/\n  0x01bb\n  /*::]*/\n  : {\n    /* n:\"SXFDBType\", */\n  },\n\n  /*::[*/\n  0x01bc\n  /*::]*/\n  : {\n    /* n:\"Prot4RevPass\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x01bd\n  /*::]*/\n  : {\n    /* n:\"ObNoMacros\", */\n  },\n\n  /*::[*/\n  0x01be\n  /*::]*/\n  : {\n    /* n:\"Dv\", */\n  },\n\n  /*::[*/\n  0x01c0\n  /*::]*/\n  : {\n    /* n:\"Excel9File\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x01c1\n  /*::]*/\n  : {\n    /* n:\"RecalcId\", */\n    f: parse_RecalcId,\n    r: 2\n  },\n\n  /*::[*/\n  0x01c2\n  /*::]*/\n  : {\n    /* n:\"EntExU2\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x0200\n  /*::]*/\n  : {\n    /* n:\"Dimensions\", */\n    f: parse_Dimensions\n  },\n\n  /*::[*/\n  0x0201\n  /*::]*/\n  : {\n    /* n:\"Blank\", */\n    f: parse_Blank\n  },\n\n  /*::[*/\n  0x0203\n  /*::]*/\n  : {\n    /* n:\"Number\", */\n    f: parse_Number\n  },\n\n  /*::[*/\n  0x0204\n  /*::]*/\n  : {\n    /* n:\"Label\", */\n    f: parse_Label\n  },\n\n  /*::[*/\n  0x0205\n  /*::]*/\n  : {\n    /* n:\"BoolErr\", */\n    f: parse_BoolErr\n  },\n\n  /*::[*/\n  0x0207\n  /*::]*/\n  : {\n    /* n:\"String\", */\n    f: parse_String\n  },\n\n  /*::[*/\n  0x0208\n  /*::]*/\n  : {\n    /* n:\"Row\", */\n    f: parse_Row\n  },\n\n  /*::[*/\n  0x020b\n  /*::]*/\n  : {\n    /* n:\"Index\", */\n  },\n\n  /*::[*/\n  0x0221\n  /*::]*/\n  : {\n    /* n:\"Array\", */\n    f: parse_Array\n  },\n\n  /*::[*/\n  0x0225\n  /*::]*/\n  : {\n    /* n:\"DefaultRowHeight\", */\n    f: parse_DefaultRowHeight\n  },\n\n  /*::[*/\n  0x0236\n  /*::]*/\n  : {\n    /* n:\"Table\", */\n  },\n\n  /*::[*/\n  0x023e\n  /*::]*/\n  : {\n    /* n:\"Window2\", */\n    f: parse_Window2\n  },\n\n  /*::[*/\n  0x027e\n  /*::]*/\n  : {\n    /* n:\"RK\", */\n    f: parse_RK\n  },\n\n  /*::[*/\n  0x0293\n  /*::]*/\n  : {\n    /* n:\"Style\", */\n  },\n\n  /*::[*/\n  0x0418\n  /*::]*/\n  : {\n    /* n:\"BigName\", */\n  },\n\n  /*::[*/\n  0x041e\n  /*::]*/\n  : {\n    /* n:\"Format\", */\n    f: parse_Format\n  },\n\n  /*::[*/\n  0x043c\n  /*::]*/\n  : {\n    /* n:\"ContinueBigName\", */\n  },\n\n  /*::[*/\n  0x04bc\n  /*::]*/\n  : {\n    /* n:\"ShrFmla\", */\n    f: parse_ShrFmla\n  },\n\n  /*::[*/\n  0x0800\n  /*::]*/\n  : {\n    /* n:\"HLinkTooltip\", */\n    f: parse_HLinkTooltip\n  },\n\n  /*::[*/\n  0x0801\n  /*::]*/\n  : {\n    /* n:\"WebPub\", */\n  },\n\n  /*::[*/\n  0x0802\n  /*::]*/\n  : {\n    /* n:\"QsiSXTag\", */\n  },\n\n  /*::[*/\n  0x0803\n  /*::]*/\n  : {\n    /* n:\"DBQueryExt\", */\n  },\n\n  /*::[*/\n  0x0804\n  /*::]*/\n  : {\n    /* n:\"ExtString\", */\n  },\n\n  /*::[*/\n  0x0805\n  /*::]*/\n  : {\n    /* n:\"TxtQry\", */\n  },\n\n  /*::[*/\n  0x0806\n  /*::]*/\n  : {\n    /* n:\"Qsir\", */\n  },\n\n  /*::[*/\n  0x0807\n  /*::]*/\n  : {\n    /* n:\"Qsif\", */\n  },\n\n  /*::[*/\n  0x0808\n  /*::]*/\n  : {\n    /* n:\"RRDTQSIF\", */\n  },\n\n  /*::[*/\n  0x0809\n  /*::]*/\n  : {\n    /* n:\"BOF\", */\n    f: parse_BOF\n  },\n\n  /*::[*/\n  0x080a\n  /*::]*/\n  : {\n    /* n:\"OleDbConn\", */\n  },\n\n  /*::[*/\n  0x080b\n  /*::]*/\n  : {\n    /* n:\"WOpt\", */\n  },\n\n  /*::[*/\n  0x080c\n  /*::]*/\n  : {\n    /* n:\"SXViewEx\", */\n  },\n\n  /*::[*/\n  0x080d\n  /*::]*/\n  : {\n    /* n:\"SXTH\", */\n  },\n\n  /*::[*/\n  0x080e\n  /*::]*/\n  : {\n    /* n:\"SXPIEx\", */\n  },\n\n  /*::[*/\n  0x080f\n  /*::]*/\n  : {\n    /* n:\"SXVDTEx\", */\n  },\n\n  /*::[*/\n  0x0810\n  /*::]*/\n  : {\n    /* n:\"SXViewEx9\", */\n  },\n\n  /*::[*/\n  0x0812\n  /*::]*/\n  : {\n    /* n:\"ContinueFrt\", */\n  },\n\n  /*::[*/\n  0x0813\n  /*::]*/\n  : {\n    /* n:\"RealTimeData\", */\n  },\n\n  /*::[*/\n  0x0850\n  /*::]*/\n  : {\n    /* n:\"ChartFrtInfo\", */\n  },\n\n  /*::[*/\n  0x0851\n  /*::]*/\n  : {\n    /* n:\"FrtWrapper\", */\n  },\n\n  /*::[*/\n  0x0852\n  /*::]*/\n  : {\n    /* n:\"StartBlock\", */\n  },\n\n  /*::[*/\n  0x0853\n  /*::]*/\n  : {\n    /* n:\"EndBlock\", */\n  },\n\n  /*::[*/\n  0x0854\n  /*::]*/\n  : {\n    /* n:\"StartObject\", */\n  },\n\n  /*::[*/\n  0x0855\n  /*::]*/\n  : {\n    /* n:\"EndObject\", */\n  },\n\n  /*::[*/\n  0x0856\n  /*::]*/\n  : {\n    /* n:\"CatLab\", */\n  },\n\n  /*::[*/\n  0x0857\n  /*::]*/\n  : {\n    /* n:\"YMult\", */\n  },\n\n  /*::[*/\n  0x0858\n  /*::]*/\n  : {\n    /* n:\"SXViewLink\", */\n  },\n\n  /*::[*/\n  0x0859\n  /*::]*/\n  : {\n    /* n:\"PivotChartBits\", */\n  },\n\n  /*::[*/\n  0x085a\n  /*::]*/\n  : {\n    /* n:\"FrtFontList\", */\n  },\n\n  /*::[*/\n  0x0862\n  /*::]*/\n  : {\n    /* n:\"SheetExt\", */\n  },\n\n  /*::[*/\n  0x0863\n  /*::]*/\n  : {\n    /* n:\"BookExt\", */\n    r: 12\n  },\n\n  /*::[*/\n  0x0864\n  /*::]*/\n  : {\n    /* n:\"SXAddl\", */\n  },\n\n  /*::[*/\n  0x0865\n  /*::]*/\n  : {\n    /* n:\"CrErr\", */\n  },\n\n  /*::[*/\n  0x0866\n  /*::]*/\n  : {\n    /* n:\"HFPicture\", */\n  },\n\n  /*::[*/\n  0x0867\n  /*::]*/\n  : {\n    /* n:\"FeatHdr\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x0868\n  /*::]*/\n  : {\n    /* n:\"Feat\", */\n  },\n\n  /*::[*/\n  0x086a\n  /*::]*/\n  : {\n    /* n:\"DataLabExt\", */\n  },\n\n  /*::[*/\n  0x086b\n  /*::]*/\n  : {\n    /* n:\"DataLabExtContents\", */\n  },\n\n  /*::[*/\n  0x086c\n  /*::]*/\n  : {\n    /* n:\"CellWatch\", */\n  },\n\n  /*::[*/\n  0x0871\n  /*::]*/\n  : {\n    /* n:\"FeatHdr11\", */\n  },\n\n  /*::[*/\n  0x0872\n  /*::]*/\n  : {\n    /* n:\"Feature11\", */\n  },\n\n  /*::[*/\n  0x0874\n  /*::]*/\n  : {\n    /* n:\"DropDownObjIds\", */\n  },\n\n  /*::[*/\n  0x0875\n  /*::]*/\n  : {\n    /* n:\"ContinueFrt11\", */\n  },\n\n  /*::[*/\n  0x0876\n  /*::]*/\n  : {\n    /* n:\"DConn\", */\n  },\n\n  /*::[*/\n  0x0877\n  /*::]*/\n  : {\n    /* n:\"List12\", */\n  },\n\n  /*::[*/\n  0x0878\n  /*::]*/\n  : {\n    /* n:\"Feature12\", */\n  },\n\n  /*::[*/\n  0x0879\n  /*::]*/\n  : {\n    /* n:\"CondFmt12\", */\n  },\n\n  /*::[*/\n  0x087a\n  /*::]*/\n  : {\n    /* n:\"CF12\", */\n  },\n\n  /*::[*/\n  0x087b\n  /*::]*/\n  : {\n    /* n:\"CFEx\", */\n  },\n\n  /*::[*/\n  0x087c\n  /*::]*/\n  : {\n    /* n:\"XFCRC\", */\n    f: parse_XFCRC,\n    r: 12\n  },\n\n  /*::[*/\n  0x087d\n  /*::]*/\n  : {\n    /* n:\"XFExt\", */\n    f: parse_XFExt,\n    r: 12\n  },\n\n  /*::[*/\n  0x087e\n  /*::]*/\n  : {\n    /* n:\"AutoFilter12\", */\n  },\n\n  /*::[*/\n  0x087f\n  /*::]*/\n  : {\n    /* n:\"ContinueFrt12\", */\n  },\n\n  /*::[*/\n  0x0884\n  /*::]*/\n  : {\n    /* n:\"MDTInfo\", */\n  },\n\n  /*::[*/\n  0x0885\n  /*::]*/\n  : {\n    /* n:\"MDXStr\", */\n  },\n\n  /*::[*/\n  0x0886\n  /*::]*/\n  : {\n    /* n:\"MDXTuple\", */\n  },\n\n  /*::[*/\n  0x0887\n  /*::]*/\n  : {\n    /* n:\"MDXSet\", */\n  },\n\n  /*::[*/\n  0x0888\n  /*::]*/\n  : {\n    /* n:\"MDXProp\", */\n  },\n\n  /*::[*/\n  0x0889\n  /*::]*/\n  : {\n    /* n:\"MDXKPI\", */\n  },\n\n  /*::[*/\n  0x088a\n  /*::]*/\n  : {\n    /* n:\"MDB\", */\n  },\n\n  /*::[*/\n  0x088b\n  /*::]*/\n  : {\n    /* n:\"PLV\", */\n  },\n\n  /*::[*/\n  0x088c\n  /*::]*/\n  : {\n    /* n:\"Compat12\", */\n    f: parsebool,\n    r: 12\n  },\n\n  /*::[*/\n  0x088d\n  /*::]*/\n  : {\n    /* n:\"DXF\", */\n  },\n\n  /*::[*/\n  0x088e\n  /*::]*/\n  : {\n    /* n:\"TableStyles\", */\n    r: 12\n  },\n\n  /*::[*/\n  0x088f\n  /*::]*/\n  : {\n    /* n:\"TableStyle\", */\n  },\n\n  /*::[*/\n  0x0890\n  /*::]*/\n  : {\n    /* n:\"TableStyleElement\", */\n  },\n\n  /*::[*/\n  0x0892\n  /*::]*/\n  : {\n    /* n:\"StyleExt\", */\n  },\n\n  /*::[*/\n  0x0893\n  /*::]*/\n  : {\n    /* n:\"NamePublish\", */\n  },\n\n  /*::[*/\n  0x0894\n  /*::]*/\n  : {\n    /* n:\"NameCmt\", */\n    f: parse_NameCmt,\n    r: 12\n  },\n\n  /*::[*/\n  0x0895\n  /*::]*/\n  : {\n    /* n:\"SortData\", */\n  },\n\n  /*::[*/\n  0x0896\n  /*::]*/\n  : {\n    /* n:\"Theme\", */\n    f: parse_Theme,\n    r: 12\n  },\n\n  /*::[*/\n  0x0897\n  /*::]*/\n  : {\n    /* n:\"GUIDTypeLib\", */\n  },\n\n  /*::[*/\n  0x0898\n  /*::]*/\n  : {\n    /* n:\"FnGrp12\", */\n  },\n\n  /*::[*/\n  0x0899\n  /*::]*/\n  : {\n    /* n:\"NameFnGrp12\", */\n  },\n\n  /*::[*/\n  0x089a\n  /*::]*/\n  : {\n    /* n:\"MTRSettings\", */\n    f: parse_MTRSettings,\n    r: 12\n  },\n\n  /*::[*/\n  0x089b\n  /*::]*/\n  : {\n    /* n:\"CompressPictures\", */\n    f: parsenoop2\n  },\n\n  /*::[*/\n  0x089c\n  /*::]*/\n  : {\n    /* n:\"HeaderFooter\", */\n  },\n\n  /*::[*/\n  0x089d\n  /*::]*/\n  : {\n    /* n:\"CrtLayout12\", */\n  },\n\n  /*::[*/\n  0x089e\n  /*::]*/\n  : {\n    /* n:\"CrtMlFrt\", */\n  },\n\n  /*::[*/\n  0x089f\n  /*::]*/\n  : {\n    /* n:\"CrtMlFrtContinue\", */\n  },\n\n  /*::[*/\n  0x08a3\n  /*::]*/\n  : {\n    /* n:\"ForceFullCalculation\", */\n    f: parse_ForceFullCalculation\n  },\n\n  /*::[*/\n  0x08a4\n  /*::]*/\n  : {\n    /* n:\"ShapePropsStream\", */\n  },\n\n  /*::[*/\n  0x08a5\n  /*::]*/\n  : {\n    /* n:\"TextPropsStream\", */\n  },\n\n  /*::[*/\n  0x08a6\n  /*::]*/\n  : {\n    /* n:\"RichTextStream\", */\n  },\n\n  /*::[*/\n  0x08a7\n  /*::]*/\n  : {\n    /* n:\"CrtLayout12A\", */\n  },\n\n  /*::[*/\n  0x1001\n  /*::]*/\n  : {\n    /* n:\"Units\", */\n  },\n\n  /*::[*/\n  0x1002\n  /*::]*/\n  : {\n    /* n:\"Chart\", */\n  },\n\n  /*::[*/\n  0x1003\n  /*::]*/\n  : {\n    /* n:\"Series\", */\n  },\n\n  /*::[*/\n  0x1006\n  /*::]*/\n  : {\n    /* n:\"DataFormat\", */\n  },\n\n  /*::[*/\n  0x1007\n  /*::]*/\n  : {\n    /* n:\"LineFormat\", */\n  },\n\n  /*::[*/\n  0x1009\n  /*::]*/\n  : {\n    /* n:\"MarkerFormat\", */\n  },\n\n  /*::[*/\n  0x100a\n  /*::]*/\n  : {\n    /* n:\"AreaFormat\", */\n  },\n\n  /*::[*/\n  0x100b\n  /*::]*/\n  : {\n    /* n:\"PieFormat\", */\n  },\n\n  /*::[*/\n  0x100c\n  /*::]*/\n  : {\n    /* n:\"AttachedLabel\", */\n  },\n\n  /*::[*/\n  0x100d\n  /*::]*/\n  : {\n    /* n:\"SeriesText\", */\n  },\n\n  /*::[*/\n  0x1014\n  /*::]*/\n  : {\n    /* n:\"ChartFormat\", */\n  },\n\n  /*::[*/\n  0x1015\n  /*::]*/\n  : {\n    /* n:\"Legend\", */\n  },\n\n  /*::[*/\n  0x1016\n  /*::]*/\n  : {\n    /* n:\"SeriesList\", */\n  },\n\n  /*::[*/\n  0x1017\n  /*::]*/\n  : {\n    /* n:\"Bar\", */\n  },\n\n  /*::[*/\n  0x1018\n  /*::]*/\n  : {\n    /* n:\"Line\", */\n  },\n\n  /*::[*/\n  0x1019\n  /*::]*/\n  : {\n    /* n:\"Pie\", */\n  },\n\n  /*::[*/\n  0x101a\n  /*::]*/\n  : {\n    /* n:\"Area\", */\n  },\n\n  /*::[*/\n  0x101b\n  /*::]*/\n  : {\n    /* n:\"Scatter\", */\n  },\n\n  /*::[*/\n  0x101c\n  /*::]*/\n  : {\n    /* n:\"CrtLine\", */\n  },\n\n  /*::[*/\n  0x101d\n  /*::]*/\n  : {\n    /* n:\"Axis\", */\n  },\n\n  /*::[*/\n  0x101e\n  /*::]*/\n  : {\n    /* n:\"Tick\", */\n  },\n\n  /*::[*/\n  0x101f\n  /*::]*/\n  : {\n    /* n:\"ValueRange\", */\n  },\n\n  /*::[*/\n  0x1020\n  /*::]*/\n  : {\n    /* n:\"CatSerRange\", */\n  },\n\n  /*::[*/\n  0x1021\n  /*::]*/\n  : {\n    /* n:\"AxisLine\", */\n  },\n\n  /*::[*/\n  0x1022\n  /*::]*/\n  : {\n    /* n:\"CrtLink\", */\n  },\n\n  /*::[*/\n  0x1024\n  /*::]*/\n  : {\n    /* n:\"DefaultText\", */\n  },\n\n  /*::[*/\n  0x1025\n  /*::]*/\n  : {\n    /* n:\"Text\", */\n  },\n\n  /*::[*/\n  0x1026\n  /*::]*/\n  : {\n    /* n:\"FontX\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x1027\n  /*::]*/\n  : {\n    /* n:\"ObjectLink\", */\n  },\n\n  /*::[*/\n  0x1032\n  /*::]*/\n  : {\n    /* n:\"Frame\", */\n  },\n\n  /*::[*/\n  0x1033\n  /*::]*/\n  : {\n    /* n:\"Begin\", */\n  },\n\n  /*::[*/\n  0x1034\n  /*::]*/\n  : {\n    /* n:\"End\", */\n  },\n\n  /*::[*/\n  0x1035\n  /*::]*/\n  : {\n    /* n:\"PlotArea\", */\n  },\n\n  /*::[*/\n  0x103a\n  /*::]*/\n  : {\n    /* n:\"Chart3d\", */\n  },\n\n  /*::[*/\n  0x103c\n  /*::]*/\n  : {\n    /* n:\"PicF\", */\n  },\n\n  /*::[*/\n  0x103d\n  /*::]*/\n  : {\n    /* n:\"DropBar\", */\n  },\n\n  /*::[*/\n  0x103e\n  /*::]*/\n  : {\n    /* n:\"Radar\", */\n  },\n\n  /*::[*/\n  0x103f\n  /*::]*/\n  : {\n    /* n:\"Surf\", */\n  },\n\n  /*::[*/\n  0x1040\n  /*::]*/\n  : {\n    /* n:\"RadarArea\", */\n  },\n\n  /*::[*/\n  0x1041\n  /*::]*/\n  : {\n    /* n:\"AxisParent\", */\n  },\n\n  /*::[*/\n  0x1043\n  /*::]*/\n  : {\n    /* n:\"LegendException\", */\n  },\n\n  /*::[*/\n  0x1044\n  /*::]*/\n  : {\n    /* n:\"ShtProps\", */\n    f: parse_ShtProps\n  },\n\n  /*::[*/\n  0x1045\n  /*::]*/\n  : {\n    /* n:\"SerToCrt\", */\n  },\n\n  /*::[*/\n  0x1046\n  /*::]*/\n  : {\n    /* n:\"AxesUsed\", */\n  },\n\n  /*::[*/\n  0x1048\n  /*::]*/\n  : {\n    /* n:\"SBaseRef\", */\n  },\n\n  /*::[*/\n  0x104a\n  /*::]*/\n  : {\n    /* n:\"SerParent\", */\n  },\n\n  /*::[*/\n  0x104b\n  /*::]*/\n  : {\n    /* n:\"SerAuxTrend\", */\n  },\n\n  /*::[*/\n  0x104e\n  /*::]*/\n  : {\n    /* n:\"IFmtRecord\", */\n  },\n\n  /*::[*/\n  0x104f\n  /*::]*/\n  : {\n    /* n:\"Pos\", */\n  },\n\n  /*::[*/\n  0x1050\n  /*::]*/\n  : {\n    /* n:\"AlRuns\", */\n  },\n\n  /*::[*/\n  0x1051\n  /*::]*/\n  : {\n    /* n:\"BRAI\", */\n  },\n\n  /*::[*/\n  0x105b\n  /*::]*/\n  : {\n    /* n:\"SerAuxErrBar\", */\n  },\n\n  /*::[*/\n  0x105c\n  /*::]*/\n  : {\n    /* n:\"ClrtClient\", */\n    f: parse_ClrtClient\n  },\n\n  /*::[*/\n  0x105d\n  /*::]*/\n  : {\n    /* n:\"SerFmt\", */\n  },\n\n  /*::[*/\n  0x105f\n  /*::]*/\n  : {\n    /* n:\"Chart3DBarShape\", */\n  },\n\n  /*::[*/\n  0x1060\n  /*::]*/\n  : {\n    /* n:\"Fbi\", */\n  },\n\n  /*::[*/\n  0x1061\n  /*::]*/\n  : {\n    /* n:\"BopPop\", */\n  },\n\n  /*::[*/\n  0x1062\n  /*::]*/\n  : {\n    /* n:\"AxcExt\", */\n  },\n\n  /*::[*/\n  0x1063\n  /*::]*/\n  : {\n    /* n:\"Dat\", */\n  },\n\n  /*::[*/\n  0x1064\n  /*::]*/\n  : {\n    /* n:\"PlotGrowth\", */\n  },\n\n  /*::[*/\n  0x1065\n  /*::]*/\n  : {\n    /* n:\"SIIndex\", */\n  },\n\n  /*::[*/\n  0x1066\n  /*::]*/\n  : {\n    /* n:\"GelFrame\", */\n  },\n\n  /*::[*/\n  0x1067\n  /*::]*/\n  : {\n    /* n:\"BopPopCustom\", */\n  },\n\n  /*::[*/\n  0x1068\n  /*::]*/\n  : {\n    /* n:\"Fbi2\", */\n  },\n\n  /*::[*/\n  0x0000\n  /*::]*/\n  : {\n    /* n:\"Dimensions\", */\n    f: parse_Dimensions\n  },\n\n  /*::[*/\n  0x0001\n  /*::]*/\n  : {\n    /* n:\"BIFF2BLANK\", */\n  },\n\n  /*::[*/\n  0x0002\n  /*::]*/\n  : {\n    /* n:\"BIFF2INT\", */\n    f: parse_BIFF2INT\n  },\n\n  /*::[*/\n  0x0003\n  /*::]*/\n  : {\n    /* n:\"BIFF2NUM\", */\n    f: parse_BIFF2NUM\n  },\n\n  /*::[*/\n  0x0004\n  /*::]*/\n  : {\n    /* n:\"BIFF2STR\", */\n    f: parse_BIFF2STR\n  },\n\n  /*::[*/\n  0x0005\n  /*::]*/\n  : {\n    /* n:\"BoolErr\", */\n    f: parse_BoolErr\n  },\n\n  /*::[*/\n  0x0007\n  /*::]*/\n  : {\n    /* n:\"String\", */\n    f: parse_BIFF2STRING\n  },\n\n  /*::[*/\n  0x0008\n  /*::]*/\n  : {\n    /* n:\"BIFF2ROW\", */\n  },\n\n  /*::[*/\n  0x0009\n  /*::]*/\n  : {\n    /* n:\"BOF\", */\n    f: parse_BOF\n  },\n\n  /*::[*/\n  0x000b\n  /*::]*/\n  : {\n    /* n:\"Index\", */\n  },\n\n  /*::[*/\n  0x0016\n  /*::]*/\n  : {\n    /* n:\"ExternCount\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x001e\n  /*::]*/\n  : {\n    /* n:\"BIFF2FORMAT\", */\n    f: parse_BIFF2Format\n  },\n\n  /*::[*/\n  0x001f\n  /*::]*/\n  : {\n    /* n:\"BIFF2FMTCNT\", */\n  },\n\n  /* 16-bit cnt of BIFF2FORMAT records */\n\n  /*::[*/\n  0x0020\n  /*::]*/\n  : {\n    /* n:\"BIFF2COLINFO\", */\n  },\n\n  /*::[*/\n  0x0021\n  /*::]*/\n  : {\n    /* n:\"Array\", */\n    f: parse_Array\n  },\n\n  /*::[*/\n  0x0024\n  /*::]*/\n  : {\n    /* n:\"COLWIDTH\", */\n  },\n\n  /*::[*/\n  0x0025\n  /*::]*/\n  : {\n    /* n:\"DefaultRowHeight\", */\n    f: parse_DefaultRowHeight\n  },\n  // 0x2c ??\n  // 0x2d ??\n  // 0x2e ??\n  // 0x30 FONTCOUNT: number of fonts\n\n  /*::[*/\n  0x0032\n  /*::]*/\n  : {\n    /* n:\"BIFF2FONTXTRA\", */\n    f: parse_BIFF2FONTXTRA\n  },\n  // 0x35: INFOOPTS\n  // 0x36: TABLE (BIFF2 only)\n  // 0x37: TABLE2 (BIFF2 only)\n  // 0x38: WNDESK\n  // 0x39 ??\n  // 0x3a: BEGINPREF\n  // 0x3b: ENDPREF\n\n  /*::[*/\n  0x003e\n  /*::]*/\n  : {\n    /* n:\"BIFF2WINDOW2\", */\n  },\n  // 0x3f ??\n  // 0x46: SHOWSCROLL\n  // 0x47: SHOWFORMULA\n  // 0x48: STATUSBAR\n  // 0x49: SHORTMENUS\n  // 0x4A:\n  // 0x4B:\n  // 0x4C:\n  // 0x4E:\n  // 0x4F:\n  // 0x58: TOOLBAR (BIFF3)\n\n  /* - - - */\n\n  /*::[*/\n  0x0034\n  /*::]*/\n  : {\n    /* n:\"DDEObjName\", */\n  },\n\n  /*::[*/\n  0x0043\n  /*::]*/\n  : {\n    /* n:\"BIFF2XF\", */\n  },\n\n  /*::[*/\n  0x0044\n  /*::]*/\n  : {\n    /* n:\"BIFF2XFINDEX\", */\n    f: parseuint16\n  },\n\n  /*::[*/\n  0x0045\n  /*::]*/\n  : {\n    /* n:\"BIFF2FONTCLR\", */\n  },\n\n  /*::[*/\n  0x0056\n  /*::]*/\n  : {\n    /* n:\"BIFF4FMTCNT\", */\n  },\n\n  /* 16-bit cnt, similar to BIFF2 */\n\n  /*::[*/\n  0x007e\n  /*::]*/\n  : {\n    /* n:\"RK\", */\n  },\n\n  /* Not necessarily same as 0x027e */\n\n  /*::[*/\n  0x007f\n  /*::]*/\n  : {\n    /* n:\"ImData\", */\n    f: parse_ImData\n  },\n\n  /*::[*/\n  0x0087\n  /*::]*/\n  : {\n    /* n:\"Addin\", */\n  },\n\n  /*::[*/\n  0x0088\n  /*::]*/\n  : {\n    /* n:\"Edg\", */\n  },\n\n  /*::[*/\n  0x0089\n  /*::]*/\n  : {\n    /* n:\"Pub\", */\n  },\n  // 0x8A\n  // 0x8B LH: alternate menu key flag (BIFF3/4)\n  // 0x8E\n  // 0x8F\n\n  /*::[*/\n  0x0091\n  /*::]*/\n  : {\n    /* n:\"Sub\", */\n  },\n  // 0x93 STYLE\n\n  /*::[*/\n  0x0094\n  /*::]*/\n  : {\n    /* n:\"LHRecord\", */\n  },\n\n  /*::[*/\n  0x0095\n  /*::]*/\n  : {\n    /* n:\"LHNGraph\", */\n  },\n\n  /*::[*/\n  0x0096\n  /*::]*/\n  : {\n    /* n:\"Sound\", */\n  },\n  // 0xA2 FNPROTO: function prototypes (BIFF4)\n  // 0xA3\n  // 0xA8\n\n  /*::[*/\n  0x00a9\n  /*::]*/\n  : {\n    /* n:\"CoordList\", */\n  },\n\n  /*::[*/\n  0x00ab\n  /*::]*/\n  : {\n    /* n:\"GCW\", */\n  },\n\n  /*::[*/\n  0x00bc\n  /*::]*/\n  : {\n    /* n:\"ShrFmla\", */\n  },\n\n  /* Not necessarily same as 0x04bc */\n\n  /*::[*/\n  0x00bf\n  /*::]*/\n  : {\n    /* n:\"ToolbarHdr\", */\n  },\n\n  /*::[*/\n  0x00c0\n  /*::]*/\n  : {\n    /* n:\"ToolbarEnd\", */\n  },\n\n  /*::[*/\n  0x00c2\n  /*::]*/\n  : {\n    /* n:\"AddMenu\", */\n  },\n\n  /*::[*/\n  0x00c3\n  /*::]*/\n  : {\n    /* n:\"DelMenu\", */\n  },\n\n  /*::[*/\n  0x00d6\n  /*::]*/\n  : {\n    /* n:\"RString\", */\n    f: parse_RString\n  },\n\n  /*::[*/\n  0x00df\n  /*::]*/\n  : {\n    /* n:\"UDDesc\", */\n  },\n\n  /*::[*/\n  0x00ea\n  /*::]*/\n  : {\n    /* n:\"TabIdConf\", */\n  },\n\n  /*::[*/\n  0x0162\n  /*::]*/\n  : {\n    /* n:\"XL5Modify\", */\n  },\n\n  /*::[*/\n  0x01a5\n  /*::]*/\n  : {\n    /* n:\"FileSharing2\", */\n  },\n\n  /*::[*/\n  0x0206\n  /*::]*/\n  : {\n    /* n:\"Formula\", */\n    f: parse_Formula\n  },\n\n  /*::[*/\n  0x0209\n  /*::]*/\n  : {\n    /* n:\"BOF\", */\n    f: parse_BOF\n  },\n\n  /*::[*/\n  0x0218\n  /*::]*/\n  : {\n    /* n:\"Lbl\", */\n    f: parse_Lbl\n  },\n\n  /*::[*/\n  0x0223\n  /*::]*/\n  : {\n    /* n:\"ExternName\", */\n    f: parse_ExternName\n  },\n\n  /*::[*/\n  0x0231\n  /*::]*/\n  : {\n    /* n:\"Font\", */\n  },\n\n  /*::[*/\n  0x0243\n  /*::]*/\n  : {\n    /* n:\"BIFF3XF\", */\n  },\n\n  /*::[*/\n  0x0406\n  /*::]*/\n  : {\n    /* n:\"Formula\", */\n    f: parse_Formula\n  },\n\n  /*::[*/\n  0x0409\n  /*::]*/\n  : {\n    /* n:\"BOF\", */\n    f: parse_BOF\n  },\n\n  /*::[*/\n  0x0443\n  /*::]*/\n  : {\n    /* n:\"BIFF4XF\", */\n  },\n\n  /*::[*/\n  0x086d\n  /*::]*/\n  : {\n    /* n:\"FeatInfo\", */\n  },\n\n  /*::[*/\n  0x0873\n  /*::]*/\n  : {\n    /* n:\"FeatInfo11\", */\n  },\n\n  /*::[*/\n  0x0881\n  /*::]*/\n  : {\n    /* n:\"SXAddl12\", */\n  },\n\n  /*::[*/\n  0x08c0\n  /*::]*/\n  : {\n    /* n:\"AutoWebPub\", */\n  },\n\n  /*::[*/\n  0x08c1\n  /*::]*/\n  : {\n    /* n:\"ListObj\", */\n  },\n\n  /*::[*/\n  0x08c2\n  /*::]*/\n  : {\n    /* n:\"ListField\", */\n  },\n\n  /*::[*/\n  0x08c3\n  /*::]*/\n  : {\n    /* n:\"ListDV\", */\n  },\n\n  /*::[*/\n  0x08c4\n  /*::]*/\n  : {\n    /* n:\"ListCondFmt\", */\n  },\n\n  /*::[*/\n  0x08c5\n  /*::]*/\n  : {\n    /* n:\"ListCF\", */\n  },\n\n  /*::[*/\n  0x08c6\n  /*::]*/\n  : {\n    /* n:\"FMQry\", */\n  },\n\n  /*::[*/\n  0x08c7\n  /*::]*/\n  : {\n    /* n:\"FMSQry\", */\n  },\n\n  /*::[*/\n  0x08c8\n  /*::]*/\n  : {\n    /* n:\"PLV\", */\n  },\n\n  /*::[*/\n  0x08c9\n  /*::]*/\n  : {\n    /* n:\"LnExt\", */\n  },\n\n  /*::[*/\n  0x08ca\n  /*::]*/\n  : {\n    /* n:\"MkrExt\", */\n  },\n\n  /*::[*/\n  0x08cb\n  /*::]*/\n  : {\n    /* n:\"CrtCoopt\", */\n  },\n\n  /*::[*/\n  0x08d6\n  /*::]*/\n  : {\n    /* n:\"FRTArchId$\", */\n    r: 12\n  },\n\n  /*::[*/\n  0x7262\n  /*::]*/\n  : {}\n};\n\nfunction write_biff_rec(ba\n/*:BufArray*/\n, type\n/*:number*/\n, payload, length\n/*:?number*/\n)\n/*:void*/\n{\n  var t\n  /*:number*/\n  = type;\n  if (isNaN(t)) return;\n  var len = length || (payload || []).length || 0;\n  var o = ba.next(4);\n  o.write_shift(2, t);\n  o.write_shift(2, len);\n  if (\n  /*:: len != null &&*/\n  len > 0 && is_buf(payload)) ba.push(payload);\n}\n\nfunction write_biff_continue(ba\n/*:BufArray*/\n, type\n/*:number*/\n, payload, length\n/*:?number*/\n)\n/*:void*/\n{\n  var len = length || (payload || []).length || 0;\n  if (len <= 8224) return write_biff_rec(ba, type, payload, len);\n  var t = type;\n  if (isNaN(t)) return;\n  var parts = payload.parts || [],\n      sidx = 0;\n  var i = 0,\n      w = 0;\n\n  while (w + (parts[sidx] || 8224) <= 8224) {\n    w += parts[sidx] || 8224;\n    sidx++;\n  }\n\n  var o = ba.next(4);\n  o.write_shift(2, t);\n  o.write_shift(2, w);\n  ba.push(payload.slice(i, i + w));\n  i += w;\n\n  while (i < len) {\n    o = ba.next(4);\n    o.write_shift(2, 0x3c); // TODO: figure out correct continue type\n\n    w = 0;\n\n    while (w + (parts[sidx] || 8224) <= 8224) {\n      w += parts[sidx] || 8224;\n      sidx++;\n    }\n\n    o.write_shift(2, w);\n    ba.push(payload.slice(i, i + w));\n    i += w;\n  }\n}\n\nfunction write_BIFF2Cell(out, r\n/*:number*/\n, c\n/*:number*/\n) {\n  if (!out) out = new_buf(7);\n  out.write_shift(2, r);\n  out.write_shift(2, c);\n  out.write_shift(2, 0);\n  out.write_shift(1, 0);\n  return out;\n}\n\nfunction write_BIFF2BERR(r\n/*:number*/\n, c\n/*:number*/\n, val, t\n/*:?string*/\n) {\n  var out = new_buf(9);\n  write_BIFF2Cell(out, r, c);\n  write_Bes(val, t || 'b', out);\n  return out;\n}\n/* TODO: codepage, large strings */\n\n\nfunction write_BIFF2LABEL(r\n/*:number*/\n, c\n/*:number*/\n, val) {\n  var out = new_buf(8 + 2 * val.length);\n  write_BIFF2Cell(out, r, c);\n  out.write_shift(1, val.length);\n  out.write_shift(val.length, val, 'sbcs');\n  return out.l < out.length ? out.slice(0, out.l) : out;\n}\n\nfunction write_ws_biff2_cell(ba\n/*:BufArray*/\n, cell\n/*:Cell*/\n, R\n/*:number*/\n, C\n/*:number*/\n\n/*::, opts*/\n) {\n  if (cell.v != null) switch (cell.t) {\n    case 'd':\n    case 'n':\n      var v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\n      if (v == (v | 0) && v >= 0 && v < 65536) write_biff_rec(ba, 0x0002, write_BIFF2INT(R, C, v));else write_biff_rec(ba, 0x0003, write_BIFF2NUM(R, C, v));\n      return;\n\n    case 'b':\n    case 'e':\n      write_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, cell.v, cell.t));\n      return;\n\n    /* TODO: codepage, sst */\n\n    case 's':\n    case 'str':\n      write_biff_rec(ba, 0x0004, write_BIFF2LABEL(R, C, (cell.v || \"\").slice(0, 255)));\n      return;\n  }\n  write_biff_rec(ba, 0x0001, write_BIFF2Cell(null, R, C));\n}\n\nfunction write_ws_biff2(ba\n/*:BufArray*/\n, ws\n/*:Worksheet*/\n, idx\n/*:number*/\n, opts\n/*::, wb:Workbook*/\n) {\n  var dense = Array.isArray(ws);\n  var range = safe_decode_range(ws['!ref'] || \"A1\"),\n      ref\n  /*:string*/\n  ,\n      rr = \"\",\n      cols\n  /*:Array<string>*/\n  = [];\n\n  if (range.e.c > 0xFF || range.e.r > 0x3FFF) {\n    if (opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n    range.e.c = Math.min(range.e.c, 0xFF);\n    range.e.r = Math.min(range.e.c, 0x3FFF);\n    ref = encode_range(range);\n  }\n\n  for (var R = range.s.r; R <= range.e.r; ++R) {\n    rr = encode_row(R);\n\n    for (var C = range.s.c; C <= range.e.c; ++C) {\n      if (R === range.s.r) cols[C] = encode_col(C);\n      ref = cols[C] + rr;\n      var cell = dense ? (ws[R] || [])[C] : ws[ref];\n      if (!cell) continue;\n      /* write cell */\n\n      write_ws_biff2_cell(ba, cell, R, C, opts);\n    }\n  }\n}\n/* Based on test files */\n\n\nfunction write_biff2_buf(wb\n/*:Workbook*/\n, opts\n/*:WriteOpts*/\n) {\n  var o = opts || {};\n  if (DENSE != null && o.dense == null) o.dense = DENSE;\n  var ba = buf_array();\n  var idx = 0;\n\n  for (var i = 0; i < wb.SheetNames.length; ++i) if (wb.SheetNames[i] == o.sheet) idx = i;\n\n  if (idx == 0 && !!o.sheet && wb.SheetNames[0] != o.sheet) throw new Error(\"Sheet not found: \" + o.sheet);\n  write_biff_rec(ba, o.biff == 4 ? 0x0409 : o.biff == 3 ? 0x0209 : 0x0009, write_BOF(wb, 0x10, o));\n  /* ... */\n\n  write_ws_biff2(ba, wb.Sheets[wb.SheetNames[idx]], idx, o, wb);\n  /* ... */\n\n  write_biff_rec(ba, 0x000A);\n  return ba.end();\n}\n\nfunction write_FONTS_biff8(ba, data, opts) {\n  write_biff_rec(ba, 0x0031\n  /* Font */\n  , write_Font({\n    sz: 12,\n    color: {\n      theme: 1\n    },\n    name: \"Arial\",\n    family: 2,\n    scheme: \"minor\"\n  }, opts));\n}\n\nfunction write_FMTS_biff8(ba, NF\n/*:?SSFTable*/\n, opts) {\n  if (!NF) return;\n  [[5, 8], [23, 26], [41, 44], [\n  /*63*/\n  50,\n  /*66],[164,*/\n  392]].forEach(function (r) {\n    /*:: if(!NF) return; */\n    for (var i = r[0]; i <= r[1]; ++i) if (NF[i] != null) write_biff_rec(ba, 0x041E\n    /* Format */\n    , write_Format(i, NF[i], opts));\n  });\n}\n\nfunction write_FEAT(ba, ws) {\n  /* [MS-XLS] 2.4.112 */\n  var o = new_buf(19);\n  o.write_shift(4, 0x867);\n  o.write_shift(4, 0);\n  o.write_shift(4, 0);\n  o.write_shift(2, 3);\n  o.write_shift(1, 1);\n  o.write_shift(4, 0);\n  write_biff_rec(ba, 0x0867\n  /* FeatHdr */\n  , o);\n  /* [MS-XLS] 2.4.111 */\n\n  o = new_buf(39);\n  o.write_shift(4, 0x868);\n  o.write_shift(4, 0);\n  o.write_shift(4, 0);\n  o.write_shift(2, 3);\n  o.write_shift(1, 0);\n  o.write_shift(4, 0);\n  o.write_shift(2, 1);\n  o.write_shift(4, 4);\n  o.write_shift(2, 0);\n  write_Ref8U(safe_decode_range(ws['!ref'] || \"A1\"), o);\n  o.write_shift(4, 4);\n  write_biff_rec(ba, 0x0868\n  /* Feat */\n  , o);\n}\n\nfunction write_CELLXFS_biff8(ba, opts) {\n  for (var i = 0; i < 16; ++i) write_biff_rec(ba, 0x00e0\n  /* XF */\n  , write_XF({\n    numFmtId: 0,\n    style: true\n  }, 0, opts));\n\n  opts.cellXfs.forEach(function (c) {\n    write_biff_rec(ba, 0x00e0\n    /* XF */\n    , write_XF(c, 0, opts));\n  });\n}\n\nfunction write_ws_biff8_hlinks(ba\n/*:BufArray*/\n, ws) {\n  for (var R = 0; R < ws['!links'].length; ++R) {\n    var HL = ws['!links'][R];\n    write_biff_rec(ba, 0x01b8\n    /* HLink */\n    , write_HLink(HL));\n    if (HL[1].Tooltip) write_biff_rec(ba, 0x0800\n    /* HLinkTooltip */\n    , write_HLinkTooltip(HL));\n  }\n\n  delete ws['!links'];\n}\n\nfunction write_ws_cols_biff8(ba, cols) {\n  if (!cols) return;\n  var cnt = 0;\n  cols.forEach(function (col, idx) {\n    if (++cnt <= 256 && col) {\n      write_biff_rec(ba, 0x007d\n      /* ColInfo */\n      , write_ColInfo(col_obj_w(idx, col), idx));\n    }\n  });\n}\n\nfunction write_ws_biff8_cell(ba\n/*:BufArray*/\n, cell\n/*:Cell*/\n, R\n/*:number*/\n, C\n/*:number*/\n, opts) {\n  var os = 16 + get_cell_style(opts.cellXfs, cell, opts);\n\n  if (cell.v == null && !cell.bf) {\n    write_biff_rec(ba, 0x0201\n    /* Blank */\n    , write_XLSCell(R, C, os));\n    return;\n  }\n\n  if (cell.bf) write_biff_rec(ba, 0x0006\n  /* Formula */\n  , write_Formula(cell, R, C, opts, os));else switch (cell.t) {\n    case 'd':\n    case 'n':\n      var v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\n      /* TODO: emit RK as appropriate */\n\n      write_biff_rec(ba, 0x0203\n      /* Number */\n      , write_Number(R, C, v, os, opts));\n      break;\n\n    case 'b':\n    case 'e':\n      write_biff_rec(ba, 0x0205\n      /* BoolErr */\n      , write_BoolErr(R, C, cell.v, os, opts, cell.t));\n      break;\n\n    /* TODO: codepage, sst */\n\n    case 's':\n    case 'str':\n      if (opts.bookSST) {\n        var isst = get_sst_id(opts.Strings, cell.v, opts.revStrings);\n        write_biff_rec(ba, 0x00fd\n        /* LabelSst */\n        , write_LabelSst(R, C, isst, os, opts));\n      } else write_biff_rec(ba, 0x0204\n      /* Label */\n      , write_Label(R, C, (cell.v || \"\").slice(0, 255), os, opts));\n\n      break;\n\n    default:\n      write_biff_rec(ba, 0x0201\n      /* Blank */\n      , write_XLSCell(R, C, os));\n  }\n}\n/* [MS-XLS] 2.1.7.20.5 */\n\n\nfunction write_ws_biff8(idx\n/*:number*/\n, opts, wb\n/*:Workbook*/\n) {\n  var ba = buf_array();\n  var s = wb.SheetNames[idx],\n      ws = wb.Sheets[s] || {};\n\n  var _WB\n  /*:WBWBProps*/\n  = (wb || {}).Workbook || {}\n  /*:any*/\n  ;\n\n  var _sheet\n  /*:WBWSProp*/\n  = (_WB.Sheets || [])[idx] || {}\n  /*:any*/\n  ;\n\n  var dense = Array.isArray(ws);\n  var b8 = opts.biff == 8;\n  var ref\n  /*:string*/\n  ,\n      rr = \"\",\n      cols\n  /*:Array<string>*/\n  = [];\n  var range = safe_decode_range(ws['!ref'] || \"A1\");\n  var MAX_ROWS = b8 ? 65536 : 16384;\n\n  if (range.e.c > 0xFF || range.e.r >= MAX_ROWS) {\n    if (opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n    range.e.c = Math.min(range.e.c, 0xFF);\n    range.e.r = Math.min(range.e.c, MAX_ROWS - 1);\n  }\n\n  write_biff_rec(ba, 0x0809, write_BOF(wb, 0x10, opts));\n  /* [Uncalced] Index */\n\n  write_biff_rec(ba, 0x000d\n  /* CalcMode */\n  , writeuint16(1));\n  write_biff_rec(ba, 0x000c\n  /* CalcCount */\n  , writeuint16(100));\n  write_biff_rec(ba, 0x000f\n  /* CalcRefMode */\n  , writebool(true));\n  write_biff_rec(ba, 0x0011\n  /* CalcIter */\n  , writebool(false));\n  write_biff_rec(ba, 0x0010\n  /* CalcDelta */\n  , write_Xnum(0.001));\n  write_biff_rec(ba, 0x005f\n  /* CalcSaveRecalc */\n  , writebool(true));\n  write_biff_rec(ba, 0x002a\n  /* PrintRowCol */\n  , writebool(false));\n  write_biff_rec(ba, 0x002b\n  /* PrintGrid */\n  , writebool(false));\n  write_biff_rec(ba, 0x0082\n  /* GridSet */\n  , writeuint16(1));\n  write_biff_rec(ba, 0x0080\n  /* Guts */\n  , write_Guts([0, 0]));\n  /* DefaultRowHeight WsBool [Sync] [LPr] [HorizontalPageBreaks] [VerticalPageBreaks] */\n\n  /* Header (string) */\n\n  /* Footer (string) */\n\n  write_biff_rec(ba, 0x0083\n  /* HCenter */\n  , writebool(false));\n  write_biff_rec(ba, 0x0084\n  /* VCenter */\n  , writebool(false));\n  /* ... */\n\n  if (b8) write_ws_cols_biff8(ba, ws[\"!cols\"]);\n  /* ... */\n\n  write_biff_rec(ba, 0x200, write_Dimensions(range, opts));\n  /* ... */\n\n  if (b8) ws['!links'] = [];\n\n  for (var R = range.s.r; R <= range.e.r; ++R) {\n    rr = encode_row(R);\n\n    for (var C = range.s.c; C <= range.e.c; ++C) {\n      if (R === range.s.r) cols[C] = encode_col(C);\n      ref = cols[C] + rr;\n      var cell = dense ? (ws[R] || [])[C] : ws[ref];\n      if (!cell) continue;\n      /* write cell */\n\n      write_ws_biff8_cell(ba, cell, R, C, opts);\n      if (b8 && cell.l) ws['!links'].push([ref, cell.l]);\n    }\n  }\n\n  var cname\n  /*:string*/\n  = _sheet.CodeName || _sheet.name || s;\n  /* ... */\n\n  if (b8) write_biff_rec(ba, 0x023e\n  /* Window2 */\n  , write_Window2((_WB.Views || [])[0]));\n  /* ... */\n\n  if (b8 && (ws['!merges'] || []).length) write_biff_rec(ba, 0x00e5\n  /* MergeCells */\n  , write_MergeCells(ws['!merges']));\n  /* [LRng] *QUERYTABLE [PHONETICINFO] CONDFMTS */\n\n  if (b8) write_ws_biff8_hlinks(ba, ws);\n  /* [DVAL] */\n\n  write_biff_rec(ba, 0x01ba\n  /* CodeName */\n  , write_XLUnicodeString(cname, opts));\n  /* *WebPub *CellWatch [SheetExt] */\n\n  if (b8) write_FEAT(ba, ws);\n  /* *FEAT11 *RECORD12 */\n\n  write_biff_rec(ba, 0x000a\n  /* EOF */\n  );\n  return ba.end();\n}\n/* [MS-XLS] 2.1.7.20.3 */\n\n\nfunction write_biff8_global(wb\n/*:Workbook*/\n, bufs, opts\n/*:WriteOpts*/\n) {\n  var A = buf_array();\n\n  var _WB\n  /*:WBWBProps*/\n  = (wb || {}).Workbook || {}\n  /*:any*/\n  ;\n\n  var _sheets\n  /*:Array<WBWSProp>*/\n  = _WB.Sheets || [];\n\n  var _wb\n  /*:WBProps*/\n  =\n  /*::((*/\n  _WB.WBProps || {\n    /*::CodeName:\"ThisWorkbook\"*/\n  }\n  /*:: ):any)*/\n  ;\n\n  var b8 = opts.biff == 8,\n      b5 = opts.biff == 5;\n  write_biff_rec(A, 0x0809, write_BOF(wb, 0x05, opts));\n  if (opts.bookType == \"xla\") write_biff_rec(A, 0x0087\n  /* Addin */\n  );\n  write_biff_rec(A, 0x00e1\n  /* InterfaceHdr */\n  , b8 ? writeuint16(0x04b0) : null);\n  write_biff_rec(A, 0x00c1\n  /* Mms */\n  , writezeroes(2));\n  if (b5) write_biff_rec(A, 0x00bf\n  /* ToolbarHdr */\n  );\n  if (b5) write_biff_rec(A, 0x00c0\n  /* ToolbarEnd */\n  );\n  write_biff_rec(A, 0x00e2\n  /* InterfaceEnd */\n  );\n  write_biff_rec(A, 0x005c\n  /* WriteAccess */\n  , write_WriteAccess(\"SheetJS\", opts));\n  /* [FileSharing] */\n\n  write_biff_rec(A, 0x0042\n  /* CodePage */\n  , writeuint16(b8 ? 0x04b0 : 0x04E4));\n  /* *2047 Lel */\n\n  if (b8) write_biff_rec(A, 0x0161\n  /* DSF */\n  , writeuint16(0));\n  if (b8) write_biff_rec(A, 0x01c0\n  /* Excel9File */\n  );\n  write_biff_rec(A, 0x013d\n  /* RRTabId */\n  , write_RRTabId(wb.SheetNames.length));\n  if (b8 && wb.vbaraw) write_biff_rec(A, 0x00d3\n  /* ObProj */\n  );\n  /* [ObNoMacros] */\n\n  if (b8 && wb.vbaraw) {\n    var cname\n    /*:string*/\n    = _wb.CodeName || \"ThisWorkbook\";\n    write_biff_rec(A, 0x01ba\n    /* CodeName */\n    , write_XLUnicodeString(cname, opts));\n  }\n\n  write_biff_rec(A, 0x009c\n  /* BuiltInFnGroupCount */\n  , writeuint16(0x11));\n  /* *FnGroupName *FnGrp12 */\n\n  /* *Lbl */\n\n  /* [OleObjectSize] */\n\n  write_biff_rec(A, 0x0019\n  /* WinProtect */\n  , writebool(false));\n  write_biff_rec(A, 0x0012\n  /* Protect */\n  , writebool(false));\n  write_biff_rec(A, 0x0013\n  /* Password */\n  , writeuint16(0));\n  if (b8) write_biff_rec(A, 0x01af\n  /* Prot4Rev */\n  , writebool(false));\n  if (b8) write_biff_rec(A, 0x01bc\n  /* Prot4RevPass */\n  , writeuint16(0));\n  write_biff_rec(A, 0x003d\n  /* Window1 */\n  , write_Window1(opts));\n  write_biff_rec(A, 0x0040\n  /* Backup */\n  , writebool(false));\n  write_biff_rec(A, 0x008d\n  /* HideObj */\n  , writeuint16(0));\n  write_biff_rec(A, 0x0022\n  /* Date1904 */\n  , writebool(safe1904(wb) == \"true\"));\n  write_biff_rec(A, 0x000e\n  /* CalcPrecision */\n  , writebool(true));\n  if (b8) write_biff_rec(A, 0x01b7\n  /* RefreshAll */\n  , writebool(false));\n  write_biff_rec(A, 0x00DA\n  /* BookBool */\n  , writeuint16(0));\n  /* ... */\n\n  write_FONTS_biff8(A, wb, opts);\n  write_FMTS_biff8(A, wb.SSF, opts);\n  write_CELLXFS_biff8(A, opts);\n  /* ... */\n\n  if (b8) write_biff_rec(A, 0x0160\n  /* UsesELFs */\n  , writebool(false));\n  var a = A.end();\n  var C = buf_array();\n  /* METADATA [MTRSettings] [ForceFullCalculation] */\n\n  if (b8) write_biff_rec(C, 0x008C, write_Country());\n  /* *SUPBOOK *LBL *RTD [RecalcId] *HFPicture *MSODRAWINGGROUP */\n\n  /* BIFF8: [SST *Continue] ExtSST */\n\n  if (b8 && opts.Strings) write_biff_continue(C, 0x00FC, write_SST(opts.Strings, opts));\n  /* *WebPub [WOpt] [CrErr] [BookExt] *FeatHdr *DConn [THEME] [CompressPictures] [Compat12] [GUIDTypeLib] */\n\n  write_biff_rec(C, 0x000A\n  /* EOF */\n  );\n  var c = C.end();\n  var B = buf_array();\n  var blen = 0,\n      j = 0;\n\n  for (j = 0; j < wb.SheetNames.length; ++j) blen += (b8 ? 12 : 11) + (b8 ? 2 : 1) * wb.SheetNames[j].length;\n\n  var start = a.length + blen + c.length;\n\n  for (j = 0; j < wb.SheetNames.length; ++j) {\n    var _sheet\n    /*:WBWSProp*/\n    = _sheets[j] || {}\n    /*:any*/\n    ;\n\n    write_biff_rec(B, 0x0085\n    /* BoundSheet8 */\n    , write_BoundSheet8({\n      pos: start,\n      hs: _sheet.Hidden || 0,\n      dt: 0,\n      name: wb.SheetNames[j]\n    }, opts));\n    start += bufs[j].length;\n  }\n  /* 1*BoundSheet8 */\n\n\n  var b = B.end();\n  if (blen != b.length) throw new Error(\"BS8 \" + blen + \" != \" + b.length);\n  var out = [];\n  if (a.length) out.push(a);\n  if (b.length) out.push(b);\n  if (c.length) out.push(c);\n  return bconcat(out);\n}\n/* [MS-XLS] 2.1.7.20 Workbook Stream */\n\n\nfunction write_biff8_buf(wb\n/*:Workbook*/\n, opts\n/*:WriteOpts*/\n) {\n  var o = opts || {};\n  var bufs = [];\n\n  if (wb && !wb.SSF) {\n    wb.SSF = dup(table_fmt);\n  }\n\n  if (wb && wb.SSF) {\n    make_ssf();\n    SSF_load_table(wb.SSF); // $FlowIgnore\n\n    o.revssf = evert_num(wb.SSF);\n    o.revssf[wb.SSF[65535]] = 0;\n    o.ssf = wb.SSF;\n  }\n\n  o.Strings =\n  /*::((*/\n  []\n  /*:: :any):SST)*/\n  ;\n  o.Strings.Count = 0;\n  o.Strings.Unique = 0;\n  fix_write_opts(o);\n  o.cellXfs = [];\n  get_cell_style(o.cellXfs, {}, {\n    revssf: {\n      \"General\": 0\n    }\n  });\n  if (!wb.Props) wb.Props = {};\n\n  for (var i = 0; i < wb.SheetNames.length; ++i) bufs[bufs.length] = write_ws_biff8(i, o, wb);\n\n  bufs.unshift(write_biff8_global(wb, bufs, o));\n  return bconcat(bufs);\n}\n\nfunction write_biff_buf(wb\n/*:Workbook*/\n, opts\n/*:WriteOpts*/\n) {\n  for (var i = 0; i <= wb.SheetNames.length; ++i) {\n    var ws = wb.Sheets[wb.SheetNames[i]];\n    if (!ws || !ws[\"!ref\"]) continue;\n    var range = decode_range(ws[\"!ref\"]);\n\n    if (range.e.c > 255) {\n      // note: 255 is IV\n      if (typeof console != \"undefined\" && console.error) console.error(\"Worksheet '\" + wb.SheetNames[i] + \"' extends beyond column IV (255).  Data may be lost.\");\n    }\n  }\n\n  var o = opts || {};\n\n  switch (o.biff || 2) {\n    case 8:\n    case 5:\n      return write_biff8_buf(wb, opts);\n\n    case 4:\n    case 3:\n    case 2:\n      return write_biff2_buf(wb, opts);\n  }\n\n  throw new Error(\"invalid type \" + o.bookType + \" for BIFF\");\n}\n/* note: browser DOM element cannot see mso- style attrs, must parse */\n\n\nfunction html_to_sheet(str\n/*:string*/\n, _opts)\n/*:Workbook*/\n{\n  var opts = _opts || {};\n  if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n  var ws\n  /*:Worksheet*/\n  = opts.dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  ;\n  str = str.replace(/<!--.*?-->/g, \"\");\n  var mtch\n  /*:any*/\n  = str.match(/<table/i);\n  if (!mtch) throw new Error(\"Invalid HTML: could not find <table>\");\n  var mtch2\n  /*:any*/\n  = str.match(/<\\/table/i);\n  var i\n  /*:number*/\n  = mtch.index,\n      j\n  /*:number*/\n  = mtch2 && mtch2.index || str.length;\n  var rows = split_regex(str.slice(i, j), /(:?<tr[^>]*>)/i, \"<tr>\");\n  var R = -1,\n      C = 0,\n      RS = 0,\n      CS = 0;\n  var range\n  /*:Range*/\n  = {\n    s: {\n      r: 10000000,\n      c: 10000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var merges\n  /*:Array<Range>*/\n  = [];\n\n  for (i = 0; i < rows.length; ++i) {\n    var row = rows[i].trim();\n    var hd = row.slice(0, 3).toLowerCase();\n\n    if (hd == \"<tr\") {\n      ++R;\n\n      if (opts.sheetRows && opts.sheetRows <= R) {\n        --R;\n        break;\n      }\n\n      C = 0;\n      continue;\n    }\n\n    if (hd != \"<td\" && hd != \"<th\") continue;\n    var cells = row.split(/<\\/t[dh]>/i);\n\n    for (j = 0; j < cells.length; ++j) {\n      var cell = cells[j].trim();\n      if (!cell.match(/<t[dh]/i)) continue;\n      var m = cell,\n          cc = 0;\n      /* TODO: parse styles etc */\n\n      while (m.charAt(0) == \"<\" && (cc = m.indexOf(\">\")) > -1) m = m.slice(cc + 1);\n\n      for (var midx = 0; midx < merges.length; ++midx) {\n        var _merge\n        /*:Range*/\n        = merges[midx];\n\n        if (_merge.s.c == C && _merge.s.r < R && R <= _merge.e.r) {\n          C = _merge.e.c + 1;\n          midx = -1;\n        }\n      }\n\n      var tag = parsexmltag(cell.slice(0, cell.indexOf(\">\")));\n      CS = tag.colspan ? +tag.colspan : 1;\n      if ((RS = +tag.rowspan) > 1 || CS > 1) merges.push({\n        s: {\n          r: R,\n          c: C\n        },\n        e: {\n          r: R + (RS || 1) - 1,\n          c: C + CS - 1\n        }\n      });\n\n      var _t\n      /*:string*/\n      = tag.t || tag[\"data-t\"] || \"\";\n      /* TODO: generate stub cells */\n\n\n      if (!m.length) {\n        C += CS;\n        continue;\n      }\n\n      m = htmldecode(m);\n      if (range.s.r > R) range.s.r = R;\n      if (range.e.r < R) range.e.r = R;\n      if (range.s.c > C) range.s.c = C;\n      if (range.e.c < C) range.e.c = C;\n\n      if (!m.length) {\n        C += CS;\n        continue;\n      }\n\n      var o\n      /*:Cell*/\n      = {\n        t: 's',\n        v: m\n      };\n\n      if (opts.raw || !m.trim().length || _t == 's') {} else if (m === 'TRUE') o = {\n        t: 'b',\n        v: true\n      };else if (m === 'FALSE') o = {\n        t: 'b',\n        v: false\n      };else if (!isNaN(fuzzynum(m))) o = {\n        t: 'n',\n        v: fuzzynum(m)\n      };else if (!isNaN(fuzzydate(m).getDate())) {\n        o = {\n          t: 'd',\n          v: parseDate(m)\n        }\n        /*:any*/\n        ;\n        if (!opts.cellDates) o = {\n          t: 'n',\n          v: datenum(o.v)\n        }\n        /*:any*/\n        ;\n        o.z = opts.dateNF || table_fmt[14];\n      }\n\n      if (opts.dense) {\n        if (!ws[R]) ws[R] = [];\n        ws[R][C] = o;\n      } else ws[encode_cell({\n        r: R,\n        c: C\n      })] = o;\n\n      C += CS;\n    }\n  }\n\n  ws['!ref'] = encode_range(range);\n  if (merges.length) ws[\"!merges\"] = merges;\n  return ws;\n}\n\nfunction make_html_row(ws\n/*:Worksheet*/\n, r\n/*:Range*/\n, R\n/*:number*/\n, o\n/*:Sheet2HTMLOpts*/\n)\n/*:string*/\n{\n  var M\n  /*:Array<Range>*/\n  = ws['!merges'] || [];\n  var oo\n  /*:Array<string>*/\n  = [];\n\n  for (var C = r.s.c; C <= r.e.c; ++C) {\n    var RS = 0,\n        CS = 0;\n\n    for (var j = 0; j < M.length; ++j) {\n      if (M[j].s.r > R || M[j].s.c > C) continue;\n      if (M[j].e.r < R || M[j].e.c < C) continue;\n\n      if (M[j].s.r < R || M[j].s.c < C) {\n        RS = -1;\n        break;\n      }\n\n      RS = M[j].e.r - M[j].s.r + 1;\n      CS = M[j].e.c - M[j].s.c + 1;\n      break;\n    }\n\n    if (RS < 0) continue;\n    var coord = encode_cell({\n      r: R,\n      c: C\n    });\n    var cell = o.dense ? (ws[R] || [])[C] : ws[coord];\n    /* TODO: html entities */\n\n    var w = cell && cell.v != null && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || \"\")) || \"\";\n    var sp = {}\n    /*:any*/\n    ;\n    if (RS > 1) sp.rowspan = RS;\n    if (CS > 1) sp.colspan = CS;\n    if (o.editable) w = '<span contenteditable=\"true\">' + w + '</span>';else if (cell) {\n      sp[\"data-t\"] = cell && cell.t || 'z';\n      if (cell.v != null) sp[\"data-v\"] = cell.v;\n      if (cell.z != null) sp[\"data-z\"] = cell.z;\n      if (cell.l && (cell.l.Target || \"#\").charAt(0) != \"#\") w = '<a href=\"' + cell.l.Target + '\">' + w + '</a>';\n    }\n    sp.id = (o.id || \"sjs\") + \"-\" + coord;\n    oo.push(writextag('td', w, sp));\n  }\n\n  var preamble = \"<tr>\";\n  return preamble + oo.join(\"\") + \"</tr>\";\n}\n\nvar HTML_BEGIN = '<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';\nvar HTML_END = '</body></html>';\n\nfunction html_to_workbook(str\n/*:string*/\n, opts)\n/*:Workbook*/\n{\n  var mtch = str.match(/<table[\\s\\S]*?>[\\s\\S]*?<\\/table>/gi);\n  if (!mtch || mtch.length == 0) throw new Error(\"Invalid HTML: could not find <table>\");\n  if (mtch.length == 1) return sheet_to_workbook(html_to_sheet(mtch[0], opts), opts);\n  var wb = book_new();\n  mtch.forEach(function (s, idx) {\n    book_append_sheet(wb, html_to_sheet(s, opts), \"Sheet\" + (idx + 1));\n  });\n  return wb;\n}\n\nfunction make_html_preamble(ws\n/*:Worksheet*/\n, R\n/*:Range*/\n, o\n/*:Sheet2HTMLOpts*/\n)\n/*:string*/\n{\n  var out\n  /*:Array<string>*/\n  = [];\n  return out.join(\"\") + '<table' + (o && o.id ? ' id=\"' + o.id + '\"' : \"\") + '>';\n}\n\nfunction sheet_to_html(ws\n/*:Worksheet*/\n, opts\n/*:?Sheet2HTMLOpts*/\n\n/*, wb:?Workbook*/\n)\n/*:string*/\n{\n  var o = opts || {};\n  var header = o.header != null ? o.header : HTML_BEGIN;\n  var footer = o.footer != null ? o.footer : HTML_END;\n  var out\n  /*:Array<string>*/\n  = [header];\n  var r = decode_range(ws['!ref']);\n  o.dense = Array.isArray(ws);\n  out.push(make_html_preamble(ws, r, o));\n\n  for (var R = r.s.r; R <= r.e.r; ++R) out.push(make_html_row(ws, r, R, o));\n\n  out.push(\"</table>\" + footer);\n  return out.join(\"\");\n}\n\nfunction sheet_add_dom(ws\n/*:Worksheet*/\n, table\n/*:HTMLElement*/\n, _opts\n/*:?any*/\n)\n/*:Worksheet*/\n{\n  var opts = _opts || {};\n  if (DENSE != null) opts.dense = DENSE;\n  var or_R = 0,\n      or_C = 0;\n\n  if (opts.origin != null) {\n    if (typeof opts.origin == 'number') or_R = opts.origin;else {\n      var _origin\n      /*:CellAddress*/\n      = typeof opts.origin == \"string\" ? decode_cell(opts.origin) : opts.origin;\n\n      or_R = _origin.r;\n      or_C = _origin.c;\n    }\n  }\n\n  var rows\n  /*:HTMLCollection<HTMLTableRowElement>*/\n  = table.getElementsByTagName('tr');\n  var sheetRows = Math.min(opts.sheetRows || 10000000, rows.length);\n  var range\n  /*:Range*/\n  = {\n    s: {\n      r: 0,\n      c: 0\n    },\n    e: {\n      r: or_R,\n      c: or_C\n    }\n  };\n\n  if (ws[\"!ref\"]) {\n    var _range\n    /*:Range*/\n    = decode_range(ws[\"!ref\"]);\n\n    range.s.r = Math.min(range.s.r, _range.s.r);\n    range.s.c = Math.min(range.s.c, _range.s.c);\n    range.e.r = Math.max(range.e.r, _range.e.r);\n    range.e.c = Math.max(range.e.c, _range.e.c);\n    if (or_R == -1) range.e.r = or_R = _range.e.r + 1;\n  }\n\n  var merges\n  /*:Array<Range>*/\n  = [],\n      midx = 0;\n  var rowinfo\n  /*:Array<RowInfo>*/\n  = ws[\"!rows\"] || (ws[\"!rows\"] = []);\n  var _R = 0,\n      R = 0,\n      _C = 0,\n      C = 0,\n      RS = 0,\n      CS = 0;\n  if (!ws[\"!cols\"]) ws['!cols'] = [];\n\n  for (; _R < rows.length && R < sheetRows; ++_R) {\n    var row\n    /*:HTMLTableRowElement*/\n    = rows[_R];\n\n    if (is_dom_element_hidden(row)) {\n      if (opts.display) continue;\n      rowinfo[R] = {\n        hidden: true\n      };\n    }\n\n    var elts\n    /*:HTMLCollection<HTMLTableCellElement>*/\n    = row.children\n    /*:any*/\n    ;\n\n    for (_C = C = 0; _C < elts.length; ++_C) {\n      var elt\n      /*:HTMLTableCellElement*/\n      = elts[_C];\n      if (opts.display && is_dom_element_hidden(elt)) continue;\n      var v\n      /*:?string*/\n      = elt.hasAttribute('data-v') ? elt.getAttribute('data-v') : elt.hasAttribute('v') ? elt.getAttribute('v') : htmldecode(elt.innerHTML);\n      var z\n      /*:?string*/\n      = elt.getAttribute('data-z') || elt.getAttribute('z');\n\n      for (midx = 0; midx < merges.length; ++midx) {\n        var m\n        /*:Range*/\n        = merges[midx];\n\n        if (m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) {\n          C = m.e.c + 1 - or_C;\n          midx = -1;\n        }\n      }\n      /* TODO: figure out how to extract nonstandard mso- style */\n\n\n      CS = +elt.getAttribute(\"colspan\") || 1;\n      if ((RS = +elt.getAttribute(\"rowspan\") || 1) > 1 || CS > 1) merges.push({\n        s: {\n          r: R + or_R,\n          c: C + or_C\n        },\n        e: {\n          r: R + or_R + (RS || 1) - 1,\n          c: C + or_C + (CS || 1) - 1\n        }\n      });\n      var o\n      /*:Cell*/\n      = {\n        t: 's',\n        v: v\n      };\n\n      var _t\n      /*:string*/\n      = elt.getAttribute(\"data-t\") || elt.getAttribute(\"t\") || \"\";\n\n      if (v != null) {\n        if (v.length == 0) o.t = _t || 'z';else if (opts.raw || v.trim().length == 0 || _t == \"s\") {} else if (v === 'TRUE') o = {\n          t: 'b',\n          v: true\n        };else if (v === 'FALSE') o = {\n          t: 'b',\n          v: false\n        };else if (!isNaN(fuzzynum(v))) o = {\n          t: 'n',\n          v: fuzzynum(v)\n        };else if (!isNaN(fuzzydate(v).getDate())) {\n          o = {\n            t: 'd',\n            v: parseDate(v)\n          }\n          /*:any*/\n          ;\n          if (!opts.cellDates) o = {\n            t: 'n',\n            v: datenum(o.v)\n          }\n          /*:any*/\n          ;\n          o.z = opts.dateNF || table_fmt[14];\n        }\n      }\n\n      if (o.z === undefined && z != null) o.z = z;\n      /* The first link is used.  Links are assumed to be fully specified.\n       * TODO: The right way to process relative links is to make a new <a> */\n\n      var l = \"\",\n          Aelts = elt.getElementsByTagName(\"A\");\n      if (Aelts && Aelts.length) for (var Aelti = 0; Aelti < Aelts.length; ++Aelti) if (Aelts[Aelti].hasAttribute(\"href\")) {\n        l = Aelts[Aelti].getAttribute(\"href\");\n        if (l.charAt(0) != \"#\") break;\n      }\n      if (l && l.charAt(0) != \"#\") o.l = {\n        Target: l\n      };\n\n      if (opts.dense) {\n        if (!ws[R + or_R]) ws[R + or_R] = [];\n        ws[R + or_R][C + or_C] = o;\n      } else ws[encode_cell({\n        c: C + or_C,\n        r: R + or_R\n      })] = o;\n\n      if (range.e.c < C + or_C) range.e.c = C + or_C;\n      C += CS;\n    }\n\n    ++R;\n  }\n\n  if (merges.length) ws['!merges'] = (ws[\"!merges\"] || []).concat(merges);\n  range.e.r = Math.max(range.e.r, R - 1 + or_R);\n  ws['!ref'] = encode_range(range);\n  if (R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length - _R + R - 1 + or_R, range)); // We can count the real number of rows to parse but we don't to improve the performance\n\n  return ws;\n}\n\nfunction parse_dom_table(table\n/*:HTMLElement*/\n, _opts\n/*:?any*/\n)\n/*:Worksheet*/\n{\n  var opts = _opts || {};\n  var ws\n  /*:Worksheet*/\n  = opts.dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  ;\n  return sheet_add_dom(ws, table, _opts);\n}\n\nfunction table_to_book(table\n/*:HTMLElement*/\n, opts\n/*:?any*/\n)\n/*:Workbook*/\n{\n  return sheet_to_workbook(parse_dom_table(table, opts), opts);\n}\n\nfunction is_dom_element_hidden(element\n/*:HTMLElement*/\n)\n/*:boolean*/\n{\n  var display\n  /*:string*/\n  = '';\n  var get_computed_style\n  /*:?function*/\n  = get_get_computed_style_function(element);\n  if (get_computed_style) display = get_computed_style(element).getPropertyValue('display');\n  if (!display) display = element.style && element.style.display;\n  return display === 'none';\n}\n/* global getComputedStyle */\n\n\nfunction get_get_computed_style_function(element\n/*:HTMLElement*/\n)\n/*:?function*/\n{\n  // The proper getComputedStyle implementation is the one defined in the element window\n  if (element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle; // If it is not available, try to get one from the global namespace\n\n  if (typeof getComputedStyle === 'function') return getComputedStyle;\n  return null;\n}\n/* OpenDocument */\n\n\nfunction parse_text_p(text\n/*:string*/\n\n/*::, tag*/\n)\n/*:Array<any>*/\n{\n  /* 6.1.2 White Space Characters */\n  var fixed = text.replace(/[\\t\\r\\n]/g, \" \").trim().replace(/ +/g, \" \").replace(/<text:s\\/>/g, \" \").replace(/<text:s text:c=\"(\\d+)\"\\/>/g, function ($$, $1) {\n    return Array(parseInt($1, 10) + 1).join(\" \");\n  }).replace(/<text:tab[^>]*\\/>/g, \"\\t\").replace(/<text:line-break\\/>/g, \"\\n\");\n  var v = unescapexml(fixed.replace(/<[^>]*>/g, \"\"));\n  return [v];\n}\n\nvar number_formats_ods = {\n  /* ods name: [short ssf fmt, long ssf fmt] */\n  day: [\"d\", \"dd\"],\n  month: [\"m\", \"mm\"],\n  year: [\"y\", \"yy\"],\n  hours: [\"h\", \"hh\"],\n  minutes: [\"m\", \"mm\"],\n  seconds: [\"s\", \"ss\"],\n  \"am-pm\": [\"A/P\", \"AM/PM\"],\n  \"day-of-week\": [\"ddd\", \"dddd\"],\n  era: [\"e\", \"ee\"],\n\n  /* there is no native representation of LO \"Q\" format */\n  quarter: [\"\\\\Qm\", \"m\\\\\\\"th quarter\\\"\"]\n};\n\nfunction parse_content_xml(d\n/*:string*/\n, _opts)\n/*:Workbook*/\n{\n  var opts = _opts || {};\n  if (DENSE != null && opts.dense == null) opts.dense = DENSE;\n  var str = xlml_normalize(d);\n  var state\n  /*:Array<any>*/\n  = [],\n      tmp;\n  var tag\n  /*:: = {}*/\n  ;\n  var NFtag = {\n    name: \"\"\n  },\n      NF = \"\",\n      pidx = 0;\n  var sheetag\n  /*:: = {name:\"\", '':\"\"}*/\n  ;\n  var rowtag\n  /*:: = {'':\"\"}*/\n  ;\n  var Sheets = {},\n      SheetNames\n  /*:Array<string>*/\n  = [];\n  var ws = opts.dense ? []\n  /*:any*/\n  : {}\n  /*:any*/\n  ;\n  var Rn, q\n  /*:: :any = ({t:\"\", v:null, z:null, w:\"\",c:[],}:any)*/\n  ;\n  var ctag = {\n    value: \"\"\n  }\n  /*:any*/\n  ;\n  var textp = \"\",\n      textpidx = 0,\n      textptag\n  /*:: = {}*/\n  ;\n  var textR = [];\n  var R = -1,\n      C = -1,\n      range = {\n    s: {\n      r: 1000000,\n      c: 10000000\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var row_ol = 0;\n  var number_format_map = {};\n  var merges\n  /*:Array<Range>*/\n  = [],\n      mrange = {},\n      mR = 0,\n      mC = 0;\n  var rowinfo\n  /*:Array<RowInfo>*/\n  = [],\n      rowpeat = 1,\n      colpeat = 1;\n  var arrayf\n  /*:Array<[Range, string]>*/\n  = [];\n  var WB = {\n    Names: []\n  };\n  var atag = {}\n  /*:any*/\n  ;\n  var _Ref\n  /*:[string, string]*/\n  = [\"\", \"\"];\n  var comments\n  /*:Array<Comment>*/\n  = [],\n      comment\n  /*:Comment*/\n  = {}\n  /*:any*/\n  ;\n  var creator = \"\",\n      creatoridx = 0;\n  var isstub = false,\n      intable = false;\n  var i = 0;\n  xlmlregex.lastIndex = 0;\n  str = str.replace(/<!--([\\s\\S]*?)-->/mg, \"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm, \"\");\n\n  while (Rn = xlmlregex.exec(str)) switch (Rn[3] = Rn[3].replace(/_.*$/, \"\")) {\n    case 'table':\n    case '':\n      // 9.1.2 <table:table>\n      if (Rn[1] === '/') {\n        if (range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = encode_range(range);else ws['!ref'] = \"A1:A1\";\n\n        if (opts.sheetRows > 0 && opts.sheetRows <= range.e.r) {\n          ws['!fullref'] = ws['!ref'];\n          range.e.r = opts.sheetRows - 1;\n          ws['!ref'] = encode_range(range);\n        }\n\n        if (merges.length) ws['!merges'] = merges;\n        if (rowinfo.length) ws[\"!rows\"] = rowinfo;\n        sheetag.name = sheetag[''] || sheetag.name;\n        if (typeof JSON !== 'undefined') JSON.stringify(sheetag);\n        SheetNames.push(sheetag.name);\n        Sheets[sheetag.name] = ws;\n        intable = false;\n      } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n        sheetag = parsexmltag(Rn[0], false);\n        R = C = -1;\n        range.s.r = range.s.c = 10000000;\n        range.e.r = range.e.c = 0;\n        ws = opts.dense ? []\n        /*:any*/\n        : {}\n        /*:any*/\n        ;\n        merges = [];\n        rowinfo = [];\n        intable = true;\n      }\n\n      break;\n\n    case 'table-row-group':\n      // 9.1.9 <table:table-row-group>\n      if (Rn[1] === \"/\") --row_ol;else ++row_ol;\n      break;\n\n    case 'table-row':\n    case '':\n      // 9.1.3 <table:table-row>\n      if (Rn[1] === '/') {\n        R += rowpeat;\n        rowpeat = 1;\n        break;\n      }\n\n      rowtag = parsexmltag(Rn[0], false);\n      if (rowtag['']) R = rowtag[''] - 1;else if (R == -1) R = 0;\n      rowpeat = +rowtag['number-rows-repeated'] || 1;\n      /* TODO: remove magic */\n\n      if (rowpeat < 10) for (i = 0; i < rowpeat; ++i) if (row_ol > 0) rowinfo[R + i] = {\n        level: row_ol\n      };\n      C = -1;\n      break;\n\n    case 'covered-table-cell':\n      // 9.1.5 <table:covered-table-cell>\n      if (Rn[1] !== '/') ++C;\n\n      if (opts.sheetStubs) {\n        if (opts.dense) {\n          if (!ws[R]) ws[R] = [];\n          ws[R][C] = {\n            t: 'z'\n          };\n        } else ws[encode_cell({\n          r: R,\n          c: C\n        })] = {\n          t: 'z'\n        };\n      }\n\n      textp = \"\";\n      textR = [];\n      break;\n\n    /* stub */\n\n    case 'table-cell':\n    case '':\n      if (Rn[0].charAt(Rn[0].length - 2) === '/') {\n        ++C;\n        ctag = parsexmltag(Rn[0], false);\n        colpeat = parseInt(ctag['number-columns-repeated'] || \"1\", 10);\n        q = {\n          t: 'z',\n          v: null\n          /*:: , z:null, w:\"\",c:[]*/\n\n        }\n        /*:any*/\n        ;\n        if (ctag.formula && opts.cellFormula != false) q.f = ods_to_csf_formula(unescapexml(ctag.formula));\n\n        if ((ctag[''] || ctag['value-type']) == \"string\") {\n          q.t = \"s\";\n          q.v = unescapexml(ctag['string-value'] || \"\");\n\n          if (opts.dense) {\n            if (!ws[R]) ws[R] = [];\n            ws[R][C] = q;\n          } else {\n            ws[encode_cell({\n              r: R,\n              c: C\n            })] = q;\n          }\n        }\n\n        C += colpeat - 1;\n      } else if (Rn[1] !== '/') {\n        ++C;\n        textp = \"\";\n        textpidx = 0;\n        textR = [];\n        colpeat = 1;\n        var rptR = rowpeat ? R + rowpeat - 1 : R;\n        if (C > range.e.c) range.e.c = C;\n        if (C < range.s.c) range.s.c = C;\n        if (R < range.s.r) range.s.r = R;\n        if (rptR > range.e.r) range.e.r = rptR;\n        ctag = parsexmltag(Rn[0], false);\n        comments = [];\n        comment = {}\n        /*:any*/\n        ;\n        q = {\n          t: ctag[''] || ctag['value-type'],\n          v: null\n          /*:: , z:null, w:\"\",c:[]*/\n\n        }\n        /*:any*/\n        ;\n\n        if (opts.cellFormula) {\n          if (ctag.formula) ctag.formula = unescapexml(ctag.formula);\n\n          if (ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\n            mR = parseInt(ctag['number-matrix-rows-spanned'], 10) || 0;\n            mC = parseInt(ctag['number-matrix-columns-spanned'], 10) || 0;\n            mrange = {\n              s: {\n                r: R,\n                c: C\n              },\n              e: {\n                r: R + mR - 1,\n                c: C + mC - 1\n              }\n            };\n            q.F = encode_range(mrange);\n            arrayf.push([mrange, q.F]);\n          }\n\n          if (ctag.formula) q.f = ods_to_csf_formula(ctag.formula);else for (i = 0; i < arrayf.length; ++i) if (R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r) if (C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c) q.F = arrayf[i][1];\n        }\n\n        if (ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\n          mR = parseInt(ctag['number-rows-spanned'], 10) || 0;\n          mC = parseInt(ctag['number-columns-spanned'], 10) || 0;\n          mrange = {\n            s: {\n              r: R,\n              c: C\n            },\n            e: {\n              r: R + mR - 1,\n              c: C + mC - 1\n            }\n          };\n          merges.push(mrange);\n        }\n        /* 19.675.2 table:number-columns-repeated */\n\n\n        if (ctag['number-columns-repeated']) colpeat = parseInt(ctag['number-columns-repeated'], 10);\n        /* 19.385 office:value-type */\n\n        switch (q.t) {\n          case 'boolean':\n            q.t = 'b';\n            q.v = parsexmlbool(ctag['boolean-value']);\n            break;\n\n          case 'float':\n            q.t = 'n';\n            q.v = parseFloat(ctag.value);\n            break;\n\n          case 'percentage':\n            q.t = 'n';\n            q.v = parseFloat(ctag.value);\n            break;\n\n          case 'currency':\n            q.t = 'n';\n            q.v = parseFloat(ctag.value);\n            break;\n\n          case 'date':\n            q.t = 'd';\n            q.v = parseDate(ctag['date-value']);\n\n            if (!opts.cellDates) {\n              q.t = 'n';\n              q.v = datenum(q.v);\n            }\n\n            q.z = 'm/d/yy';\n            break;\n\n          case 'time':\n            q.t = 'n';\n            q.v = parse_isodur(ctag['time-value']) / 86400;\n\n            if (opts.cellDates) {\n              q.t = 'd';\n              q.v = numdate(q.v);\n            }\n\n            q.z = 'HH:MM:SS';\n            break;\n\n          case 'number':\n            q.t = 'n';\n            q.v = parseFloat(ctag['']);\n            break;\n\n          default:\n            if (q.t === 'string' || q.t === 'text' || !q.t) {\n              q.t = 's';\n\n              if (ctag['string-value'] != null) {\n                textp = unescapexml(ctag['string-value']);\n                textR = [];\n              }\n            } else throw new Error('Unsupported value type ' + q.t);\n\n        }\n      } else {\n        isstub = false;\n\n        if (q.t === 's') {\n          q.v = textp || '';\n          if (textR.length) q.R = textR;\n          isstub = textpidx == 0;\n        }\n\n        if (atag.Target) q.l = atag;\n\n        if (comments.length > 0) {\n          q.c = comments;\n          comments = [];\n        }\n\n        if (textp && opts.cellText !== false) q.w = textp;\n\n        if (isstub) {\n          q.t = \"z\";\n          delete q.v;\n        }\n\n        if (!isstub || opts.sheetStubs) {\n          if (!(opts.sheetRows && opts.sheetRows <= R)) {\n            for (var rpt = 0; rpt < rowpeat; ++rpt) {\n              colpeat = parseInt(ctag['number-columns-repeated'] || \"1\", 10);\n\n              if (opts.dense) {\n                if (!ws[R + rpt]) ws[R + rpt] = [];\n                ws[R + rpt][C] = rpt == 0 ? q : dup(q);\n\n                while (--colpeat > 0) ws[R + rpt][C + colpeat] = dup(q);\n              } else {\n                ws[encode_cell({\n                  r: R + rpt,\n                  c: C\n                })] = q;\n\n                while (--colpeat > 0) ws[encode_cell({\n                  r: R + rpt,\n                  c: C + colpeat\n                })] = dup(q);\n              }\n\n              if (range.e.c <= C) range.e.c = C;\n            }\n          }\n        }\n\n        colpeat = parseInt(ctag['number-columns-repeated'] || \"1\", 10);\n        C += colpeat - 1;\n        colpeat = 0;\n        q = {\n          /*:: t:\"\", v:null, z:null, w:\"\",c:[]*/\n        };\n        textp = \"\";\n        textR = [];\n      }\n\n      atag = {}\n      /*:any*/\n      ;\n      break;\n    // 9.1.4 <table:table-cell>\n\n    /* pure state */\n\n    case 'document': // TODO: <office:document> is the root for FODS\n\n    case 'document-content':\n    case '': // 3.1.3.2 <office:document-content>\n\n    case 'spreadsheet':\n    case '': // 3.7 <office:spreadsheet>\n\n    case 'scripts': // 3.12 <office:scripts>\n\n    case 'styles': // TODO <office:styles>\n\n    case 'font-face-decls': // 3.14 <office:font-face-decls>\n\n    case 'master-styles':\n      // 3.15.4 <office:master-styles> -- relevant for FODS\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n      } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n\n      break;\n\n    case 'annotation':\n      // 14.1 <office:annotation>\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        comment.t = textp;\n        if (textR.length)\n          /*::(*/\n          comment\n          /*:: :any)*/\n          .R = textR;\n        comment.a = creator;\n        comments.push(comment);\n      } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n        state.push([Rn[3], false]);\n      }\n\n      creator = \"\";\n      creatoridx = 0;\n      textp = \"\";\n      textpidx = 0;\n      textR = [];\n      break;\n\n    case 'creator':\n      // 4.3.2.7 <dc:creator>\n      if (Rn[1] === '/') {\n        creator = str.slice(creatoridx, Rn.index);\n      } else creatoridx = Rn.index + Rn[0].length;\n\n      break;\n\n    /* ignore state */\n\n    case 'meta':\n    case '': // TODO: <office:meta> <uof:> FODS/UOF\n\n    case 'settings': // TODO: <office:settings>\n\n    case 'config-item-set': // TODO: <office:config-item-set>\n\n    case 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\n\n    case 'config-item-map-entry': // TODO: <office:config-item-map-entry>\n\n    case 'config-item-map-named': // TODO: <office:config-item-map-entry>\n\n    case 'shapes': // 9.2.8 <table:shapes>\n\n    case 'frame': // 10.4.2 <draw:frame>\n\n    case 'text-box': // 10.4.3 <draw:text-box>\n\n    case 'image': // 10.4.4 <draw:image>\n\n    case 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\n\n    case 'list-style': // 16.30 <text:list-style>\n\n    case 'form': // 13.13 <form:form>\n\n    case 'dde-links': // 9.8 <table:dde-links>\n\n    case 'event-listeners': // TODO\n\n    case 'chart':\n      // TODO\n      if (Rn[1] === '/') {\n        if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n      } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], false]);\n\n      textp = \"\";\n      textpidx = 0;\n      textR = [];\n      break;\n\n    case 'scientific-number':\n      // TODO: <number:scientific-number>\n      break;\n\n    case 'currency-symbol':\n      // TODO: <number:currency-symbol>\n      break;\n\n    case 'currency-style':\n      // TODO: <number:currency-style>\n      break;\n\n    case 'number-style': // 16.27.2 <number:number-style>\n\n    case 'percentage-style': // 16.27.9 <number:percentage-style>\n\n    case 'date-style': // 16.27.10 <number:date-style>\n\n    case 'time-style':\n      // 16.27.18 <number:time-style>\n      if (Rn[1] === '/') {\n        number_format_map[NFtag.name] = NF;\n        if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n      } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n        NF = \"\";\n        NFtag = parsexmltag(Rn[0], false);\n        state.push([Rn[3], true]);\n      }\n\n      break;\n\n    case 'script':\n      break;\n    // 3.13 <office:script>\n\n    case 'libraries':\n      break;\n    // TODO: <ooo:libraries>\n\n    case 'automatic-styles':\n      break;\n    // 3.15.3 <office:automatic-styles>\n\n    case 'default-style': // TODO: <style:default-style>\n\n    case 'page-layout':\n      break;\n    // TODO: <style:page-layout>\n\n    case 'style':\n      // 16.2 <style:style>\n      break;\n\n    case 'map':\n      break;\n    // 16.3 <style:map>\n\n    case 'font-face':\n      break;\n    // 16.21 <style:font-face>\n\n    case 'paragraph-properties':\n      break;\n    // 17.6 <style:paragraph-properties>\n\n    case 'table-properties':\n      break;\n    // 17.15 <style:table-properties>\n\n    case 'table-column-properties':\n      break;\n    // 17.16 <style:table-column-properties>\n\n    case 'table-row-properties':\n      break;\n    // 17.17 <style:table-row-properties>\n\n    case 'table-cell-properties':\n      break;\n    // 17.18 <style:table-cell-properties>\n\n    case 'number':\n      // 16.27.3 <number:number>\n      switch (state[state.length - 1][0]) {\n        case 'time-style':\n        case 'date-style':\n          tag = parsexmltag(Rn[0], false);\n          NF += number_formats_ods[Rn[3]][tag.style === 'long' ? 1 : 0];\n          break;\n      }\n\n      break;\n\n    case 'fraction':\n      break;\n    // TODO 16.27.6 <number:fraction>\n\n    case 'day': // 16.27.11 <number:day>\n\n    case 'month': // 16.27.12 <number:month>\n\n    case 'year': // 16.27.13 <number:year>\n\n    case 'era': // 16.27.14 <number:era>\n\n    case 'day-of-week': // 16.27.15 <number:day-of-week>\n\n    case 'week-of-year': // 16.27.16 <number:week-of-year>\n\n    case 'quarter': // 16.27.17 <number:quarter>\n\n    case 'hours': // 16.27.19 <number:hours>\n\n    case 'minutes': // 16.27.20 <number:minutes>\n\n    case 'seconds': // 16.27.21 <number:seconds>\n\n    case 'am-pm':\n      // 16.27.22 <number:am-pm>\n      switch (state[state.length - 1][0]) {\n        case 'time-style':\n        case 'date-style':\n          tag = parsexmltag(Rn[0], false);\n          NF += number_formats_ods[Rn[3]][tag.style === 'long' ? 1 : 0];\n          break;\n      }\n\n      break;\n\n    case 'boolean-style':\n      break;\n    // 16.27.23 <number:boolean-style>\n\n    case 'boolean':\n      break;\n    // 16.27.24 <number:boolean>\n\n    case 'text-style':\n      break;\n    // 16.27.25 <number:text-style>\n\n    case 'text':\n      // 16.27.26 <number:text>\n      if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") switch (state[state.length - 1][0]) {\n        case 'number-style':\n        case 'date-style':\n        case 'time-style':\n          NF += str.slice(pidx, Rn.index);\n          break;\n      } else pidx = Rn.index + Rn[0].length;\n      break;\n\n    case 'named-range':\n      // 9.4.12 <table:named-range>\n      tag = parsexmltag(Rn[0], false);\n      _Ref = ods_to_csf_3D(tag['cell-range-address']);\n      var nrange = {\n        Name: tag.name,\n        Ref: _Ref[0] + '!' + _Ref[1]\n      }\n      /*:any*/\n      ;\n      if (intable) nrange.Sheet = SheetNames.length;\n      WB.Names.push(nrange);\n      break;\n\n    case 'text-content':\n      break;\n    // 16.27.27 <number:text-content>\n\n    case 'text-properties':\n      break;\n    // 16.27.27 <style:text-properties>\n\n    case 'embedded-text':\n      break;\n    // 16.27.4 <number:embedded-text>\n\n    case 'body':\n    case '':\n      break;\n    // 3.3 16.9.6 19.726.3\n\n    case 'forms':\n      break;\n    // 12.25.2 13.2\n\n    case 'table-column':\n      break;\n    // 9.1.6 <table:table-column>\n\n    case 'table-header-rows':\n      break;\n    // 9.1.7 <table:table-header-rows>\n\n    case 'table-rows':\n      break;\n    // 9.1.12 <table:table-rows>\n\n    /* TODO: outline levels */\n\n    case 'table-column-group':\n      break;\n    // 9.1.10 <table:table-column-group>\n\n    case 'table-header-columns':\n      break;\n    // 9.1.11 <table:table-header-columns>\n\n    case 'table-columns':\n      break;\n    // 9.1.12 <table:table-columns>\n\n    case 'null-date':\n      break;\n    // 9.4.2 <table:null-date> TODO: date1904\n\n    case 'graphic-properties':\n      break;\n    // 17.21 <style:graphic-properties>\n\n    case 'calculation-settings':\n      break;\n    // 9.4.1 <table:calculation-settings>\n\n    case 'named-expressions':\n      break;\n    // 9.4.11 <table:named-expressions>\n\n    case 'label-range':\n      break;\n    // 9.4.9 <table:label-range>\n\n    case 'label-ranges':\n      break;\n    // 9.4.10 <table:label-ranges>\n\n    case 'named-expression':\n      break;\n    // 9.4.13 <table:named-expression>\n\n    case 'sort':\n      break;\n    // 9.4.19 <table:sort>\n\n    case 'sort-by':\n      break;\n    // 9.4.20 <table:sort-by>\n\n    case 'sort-groups':\n      break;\n    // 9.4.22 <table:sort-groups>\n\n    case 'tab':\n      break;\n    // 6.1.4 <text:tab>\n\n    case 'line-break':\n      break;\n    // 6.1.5 <text:line-break>\n\n    case 'span':\n      break;\n    // 6.1.7 <text:span>\n\n    case 'p':\n    case '':\n      // 5.1.3 <text:p>\n      if (['master-styles'].indexOf(state[state.length - 1][0]) > -1) break;\n\n      if (Rn[1] === '/' && (!ctag || !ctag['string-value'])) {\n        var ptp = parse_text_p(str.slice(textpidx, Rn.index), textptag);\n        textp = (textp.length > 0 ? textp + \"\\n\" : \"\") + ptp[0];\n      } else {\n        textptag = parsexmltag(Rn[0], false);\n        textpidx = Rn.index + Rn[0].length;\n      }\n\n      break;\n    // <text:p>\n\n    case 's':\n      break;\n    // <text:s>\n\n    case 'database-range':\n      // 9.4.15 <table:database-range>\n      if (Rn[1] === '/') break;\n\n      try {\n        _Ref = ods_to_csf_3D(parsexmltag(Rn[0])['target-range-address']);\n        Sheets[_Ref[0]]['!autofilter'] = {\n          ref: _Ref[1]\n        };\n      } catch (e) {\n        /* empty */\n      }\n\n      break;\n\n    case 'date':\n      break;\n    // <*:date>\n\n    case 'object':\n      break;\n    // 10.4.6.2 <draw:object>\n\n    case 'title':\n    case '':\n      break;\n    // <*:title> OR <uof:>\n\n    case 'desc':\n      break;\n    // <*:desc>\n\n    case 'binary-data':\n      break;\n    // 10.4.5 TODO: b64 blob\n\n    /* 9.2 Advanced Tables */\n\n    case 'table-source':\n      break;\n    // 9.2.6\n\n    case 'scenario':\n      break;\n    // 9.2.6\n\n    case 'iteration':\n      break;\n    // 9.4.3 <table:iteration>\n\n    case 'content-validations':\n      break;\n    // 9.4.4 <table:\n\n    case 'content-validation':\n      break;\n    // 9.4.5 <table:\n\n    case 'help-message':\n      break;\n    // 9.4.6 <table:\n\n    case 'error-message':\n      break;\n    // 9.4.7 <table:\n\n    case 'database-ranges':\n      break;\n    // 9.4.14 <table:database-ranges>\n\n    case 'filter':\n      break;\n    // 9.5.2 <table:filter>\n\n    case 'filter-and':\n      break;\n    // 9.5.3 <table:filter-and>\n\n    case 'filter-or':\n      break;\n    // 9.5.4 <table:filter-or>\n\n    case 'filter-condition':\n      break;\n    // 9.5.5 <table:filter-condition>\n\n    case 'list-level-style-bullet':\n      break;\n    // 16.31 <text:\n\n    case 'list-level-style-number':\n      break;\n    // 16.32 <text:\n\n    case 'list-level-properties':\n      break;\n    // 17.19 <style:\n\n    /* 7.3 Document Fields */\n\n    case 'sender-firstname': // 7.3.6.2\n\n    case 'sender-lastname': // 7.3.6.3\n\n    case 'sender-initials': // 7.3.6.4\n\n    case 'sender-title': // 7.3.6.5\n\n    case 'sender-position': // 7.3.6.6\n\n    case 'sender-email': // 7.3.6.7\n\n    case 'sender-phone-private': // 7.3.6.8\n\n    case 'sender-fax': // 7.3.6.9\n\n    case 'sender-company': // 7.3.6.10\n\n    case 'sender-phone-work': // 7.3.6.11\n\n    case 'sender-street': // 7.3.6.12\n\n    case 'sender-city': // 7.3.6.13\n\n    case 'sender-postal-code': // 7.3.6.14\n\n    case 'sender-country': // 7.3.6.15\n\n    case 'sender-state-or-province': // 7.3.6.16\n\n    case 'author-name': // 7.3.7.1\n\n    case 'author-initials': // 7.3.7.2\n\n    case 'chapter': // 7.3.8\n\n    case 'file-name': // 7.3.9\n\n    case 'template-name': // 7.3.9\n\n    case 'sheet-name':\n      // 7.3.9\n      break;\n\n    case 'event-listener':\n      break;\n\n    /* TODO: FODS Properties */\n\n    case 'initial-creator':\n    case 'creation-date':\n    case 'print-date':\n    case 'generator':\n    case 'document-statistic':\n    case 'user-defined':\n    case 'editing-duration':\n    case 'editing-cycles':\n      break;\n\n    /* TODO: FODS Config */\n\n    case 'config-item':\n      break;\n\n    /* TODO: style tokens */\n\n    case 'page-number':\n      break;\n    // TODO <text:page-number>\n\n    case 'page-count':\n      break;\n    // TODO <text:page-count>\n\n    case 'time':\n      break;\n    // TODO <text:time>\n\n    /* 9.3 Advanced Table Cells */\n\n    case 'cell-range-source':\n      break;\n    // 9.3.1 <table:\n\n    case 'detective':\n      break;\n    // 9.3.2 <table:\n\n    case 'operation':\n      break;\n    // 9.3.3 <table:\n\n    case 'highlighted-range':\n      break;\n    // 9.3.4 <table:\n\n    /* 9.6 Data Pilot Tables <table: */\n\n    case 'data-pilot-table': // 9.6.3\n\n    case 'source-cell-range': // 9.6.5\n\n    case 'source-service': // 9.6.6\n\n    case 'data-pilot-field': // 9.6.7\n\n    case 'data-pilot-level': // 9.6.8\n\n    case 'data-pilot-subtotals': // 9.6.9\n\n    case 'data-pilot-subtotal': // 9.6.10\n\n    case 'data-pilot-members': // 9.6.11\n\n    case 'data-pilot-member': // 9.6.12\n\n    case 'data-pilot-display-info': // 9.6.13\n\n    case 'data-pilot-sort-info': // 9.6.14\n\n    case 'data-pilot-layout-info': // 9.6.15\n\n    case 'data-pilot-field-reference': // 9.6.16\n\n    case 'data-pilot-groups': // 9.6.17\n\n    case 'data-pilot-group': // 9.6.18\n\n    case 'data-pilot-group-member':\n      // 9.6.19\n      break;\n\n    /* 10.3 Drawing Shapes */\n\n    case 'rect':\n      // 10.3.2\n      break;\n\n    /* 14.6 DDE Connections */\n\n    case 'dde-connection-decls': // 14.6.2 <text:\n\n    case 'dde-connection-decl': // 14.6.3 <text:\n\n    case 'dde-link': // 14.6.4 <table:\n\n    case 'dde-source':\n      // 14.6.5 <office:\n      break;\n\n    case 'properties':\n      break;\n    // 13.7 <form:properties>\n\n    case 'property':\n      break;\n    // 13.8 <form:property>\n\n    case 'a':\n      // 6.1.8 hyperlink\n      if (Rn[1] !== '/') {\n        atag = parsexmltag(Rn[0], false);\n        if (!atag.href) break;\n        atag.Target = unescapexml(atag.href);\n        delete atag.href;\n\n        if (atag.Target.charAt(0) == \"#\" && atag.Target.indexOf(\".\") > -1) {\n          _Ref = ods_to_csf_3D(atag.Target.slice(1));\n          atag.Target = \"#\" + _Ref[0] + \"!\" + _Ref[1];\n        } else if (atag.Target.match(/^\\.\\.[\\\\\\/]/)) atag.Target = atag.Target.slice(3);\n      }\n\n      break;\n\n    /* non-standard */\n\n    case 'table-protection':\n      break;\n\n    case 'data-pilot-grand-total':\n      break;\n    // <table:\n\n    case 'office-document-common-attrs':\n      break;\n    // bare\n\n    default:\n      switch (Rn[2]) {\n        case 'dc:': // TODO: properties\n\n        case 'calcext:': // ignore undocumented extensions\n\n        case 'loext:': // ignore undocumented extensions\n\n        case 'ooo:': // ignore undocumented extensions\n\n        case 'chartooo:': // ignore undocumented extensions\n\n        case 'draw:': // TODO: drawing\n\n        case 'style:': // TODO: styles\n\n        case 'chart:': // TODO: charts\n\n        case 'form:': // TODO: forms\n\n        case 'uof:': // TODO: uof\n\n        case ':': // TODO: uof\n\n        case ':':\n          // TODO: uof\n          break;\n\n        default:\n          if (opts.WTF) throw new Error(Rn);\n      }\n\n  }\n\n  var out\n  /*:Workbook*/\n  = {\n    Sheets: Sheets,\n    SheetNames: SheetNames,\n    Workbook: WB\n  }\n  /*:any*/\n  ;\n  if (opts.bookSheets) delete\n  /*::(*/\n  out\n  /*:: :any)*/\n  .Sheets;\n  return out;\n}\n\nfunction parse_ods(zip\n/*:ZIPFile*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  opts = opts || {}\n  /*:any*/\n  ;\n  if (safegetzipfile(zip, 'META-INF/manifest.xml')) parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\n  var content = getzipstr(zip, 'content.xml');\n  if (!content) throw new Error(\"Missing content.xml in ODS / UOF file\");\n  var wb = parse_content_xml(utf8read(content), opts);\n  if (safegetzipfile(zip, 'meta.xml')) wb.Props = parse_core_props(getzipdata(zip, 'meta.xml'));\n  return wb;\n}\n\nfunction parse_fods(data\n/*:string*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  return parse_content_xml(data, opts);\n}\n/* OpenDocument */\n\n\nvar write_styles_ods\n/*:{(wb:any, opts:any):string}*/\n= /* @__PURE__ */function () {\n  var master_styles = ['<office:master-styles>', '<style:master-page style:name=\"mp1\" style:page-layout-name=\"mp1\">', '<style:header/>', '<style:header-left style:display=\"false\"/>', '<style:footer/>', '<style:footer-left style:display=\"false\"/>', '</style:master-page>', '</office:master-styles>'].join(\"\");\n  var payload = '<office:document-styles ' + wxt_helper({\n    'xmlns:office': \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n    'xmlns:table': \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n    'xmlns:style': \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n    'xmlns:text': \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n    'xmlns:draw': \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n    'xmlns:fo': \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n    'xmlns:xlink': \"http://www.w3.org/1999/xlink\",\n    'xmlns:dc': \"http://purl.org/dc/elements/1.1/\",\n    'xmlns:number': \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n    'xmlns:svg': \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n    'xmlns:of': \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n    'office:version': \"1.2\"\n  }) + '>' + master_styles + '</office:document-styles>';\n  return function\n    /*::wb, opts*/\n  wso() {\n    return XML_HEADER + payload;\n  };\n}();\n\nvar write_content_ods\n/*:{(wb:any, opts:any):string}*/\n= /* @__PURE__ */function () {\n  /* 6.1.2 White Space Characters */\n  var write_text_p = function (text\n  /*:string*/\n  )\n  /*:string*/\n  {\n    return escapexml(text).replace(/  +/g, function ($$) {\n      return '<text:s text:c=\"' + $$.length + '\"/>';\n    }).replace(/\\t/g, \"<text:tab/>\").replace(/\\n/g, \"</text:p><text:p>\").replace(/^ /, \"<text:s/>\").replace(/ $/, \"<text:s/>\");\n  };\n\n  var null_cell_xml = '          <table:table-cell />\\n';\n  var covered_cell_xml = '          <table:covered-table-cell/>\\n';\n\n  var write_ws = function (ws, wb\n  /*:Workbook*/\n  , i\n  /*:number*/\n\n  /*::, opts*/\n  )\n  /*:string*/\n  {\n    /* Section 9 Tables */\n    var o\n    /*:Array<string>*/\n    = [];\n    o.push('      <table:table table:name=\"' + escapexml(wb.SheetNames[i]) + '\" table:style-name=\"ta1\">\\n');\n    var R = 0,\n        C = 0,\n        range = decode_range(ws['!ref'] || \"A1\");\n    var marr\n    /*:Array<Range>*/\n    = ws['!merges'] || [],\n        mi = 0;\n    var dense = Array.isArray(ws);\n\n    if (ws[\"!cols\"]) {\n      for (C = 0; C <= range.e.c; ++C) o.push('        <table:table-column' + (ws[\"!cols\"][C] ? ' table:style-name=\"co' + ws[\"!cols\"][C].ods + '\"' : '') + '></table:table-column>\\n');\n    }\n\n    var H = \"\",\n        ROWS = ws[\"!rows\"] || [];\n\n    for (R = 0; R < range.s.r; ++R) {\n      H = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n      o.push('        <table:table-row' + H + '></table:table-row>\\n');\n    }\n\n    for (; R <= range.e.r; ++R) {\n      H = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n      o.push('        <table:table-row' + H + '>\\n');\n\n      for (C = 0; C < range.s.c; ++C) o.push(null_cell_xml);\n\n      for (; C <= range.e.c; ++C) {\n        var skip = false,\n            ct = {},\n            textp = \"\";\n\n        for (mi = 0; mi != marr.length; ++mi) {\n          if (marr[mi].s.c > C) continue;\n          if (marr[mi].s.r > R) continue;\n          if (marr[mi].e.c < C) continue;\n          if (marr[mi].e.r < R) continue;\n          if (marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n          ct['table:number-columns-spanned'] = marr[mi].e.c - marr[mi].s.c + 1;\n          ct['table:number-rows-spanned'] = marr[mi].e.r - marr[mi].s.r + 1;\n          break;\n        }\n\n        if (skip) {\n          o.push(covered_cell_xml);\n          continue;\n        }\n\n        var ref = encode_cell({\n          r: R,\n          c: C\n        }),\n            cell = dense ? (ws[R] || [])[C] : ws[ref];\n\n        if (cell && cell.f) {\n          ct['table:formula'] = escapexml(csf_to_ods_formula(cell.f));\n\n          if (cell.F) {\n            if (cell.F.slice(0, ref.length) == ref) {\n              var _Fref = decode_range(cell.F);\n\n              ct['table:number-matrix-columns-spanned'] = _Fref.e.c - _Fref.s.c + 1;\n              ct['table:number-matrix-rows-spanned'] = _Fref.e.r - _Fref.s.r + 1;\n            }\n          }\n        }\n\n        if (!cell) {\n          o.push(null_cell_xml);\n          continue;\n        }\n\n        switch (cell.t) {\n          case 'b':\n            textp = cell.v ? 'TRUE' : 'FALSE';\n            ct['office:value-type'] = \"boolean\";\n            ct['office:boolean-value'] = cell.v ? 'true' : 'false';\n            break;\n\n          case 'n':\n            textp = cell.w || String(cell.v || 0);\n            ct['office:value-type'] = \"float\";\n            ct['office:value'] = cell.v || 0;\n            break;\n\n          case 's':\n          case 'str':\n            textp = cell.v == null ? \"\" : cell.v;\n            ct['office:value-type'] = \"string\";\n            break;\n\n          case 'd':\n            textp = cell.w || parseDate(cell.v).toISOString();\n            ct['office:value-type'] = \"date\";\n            ct['office:date-value'] = parseDate(cell.v).toISOString();\n            ct['table:style-name'] = \"ce1\";\n            break;\n          //case 'e':\n\n          default:\n            o.push(null_cell_xml);\n            continue;\n        }\n\n        var text_p = write_text_p(textp);\n\n        if (cell.l && cell.l.Target) {\n          var _tgt = cell.l.Target;\n          _tgt = _tgt.charAt(0) == \"#\" ? \"#\" + csf_to_ods_3D(_tgt.slice(1)) : _tgt; // TODO: choose correct parent path format based on link delimiters\n\n          if (_tgt.charAt(0) != \"#\" && !_tgt.match(/^\\w+:/)) _tgt = '../' + _tgt;\n          text_p = writextag('text:a', text_p, {\n            'xlink:href': _tgt.replace(/&/g, \"&amp;\")\n          });\n        }\n\n        o.push('          ' + writextag('table:table-cell', writextag('text:p', text_p, {}), ct) + '\\n');\n      }\n\n      o.push('        </table:table-row>\\n');\n    }\n\n    o.push('      </table:table>\\n');\n    return o.join(\"\");\n  };\n\n  var write_automatic_styles_ods = function (o\n  /*:Array<string>*/\n  , wb) {\n    o.push(' <office:automatic-styles>\\n');\n    o.push('  <number:date-style style:name=\"N37\" number:automatic-order=\"true\">\\n');\n    o.push('   <number:month number:style=\"long\"/>\\n');\n    o.push('   <number:text>/</number:text>\\n');\n    o.push('   <number:day number:style=\"long\"/>\\n');\n    o.push('   <number:text>/</number:text>\\n');\n    o.push('   <number:year/>\\n');\n    o.push('  </number:date-style>\\n');\n    /* column styles */\n\n    var cidx = 0;\n    wb.SheetNames.map(function (n) {\n      return wb.Sheets[n];\n    }).forEach(function (ws) {\n      if (!ws) return;\n\n      if (ws[\"!cols\"]) {\n        for (var C = 0; C < ws[\"!cols\"].length; ++C) if (ws[\"!cols\"][C]) {\n          var colobj = ws[\"!cols\"][C];\n          if (colobj.width == null && colobj.wpx == null && colobj.wch == null) continue;\n          process_col(colobj);\n          colobj.ods = cidx;\n          var w = ws[\"!cols\"][C].wpx + \"px\";\n          o.push('  <style:style style:name=\"co' + cidx + '\" style:family=\"table-column\">\\n');\n          o.push('   <style:table-column-properties fo:break-before=\"auto\" style:column-width=\"' + w + '\"/>\\n');\n          o.push('  </style:style>\\n');\n          ++cidx;\n        }\n      }\n    });\n    /* row styles */\n\n    var ridx = 0;\n    wb.SheetNames.map(function (n) {\n      return wb.Sheets[n];\n    }).forEach(function (ws) {\n      if (!ws) return;\n\n      if (ws[\"!rows\"]) {\n        for (var R = 0; R < ws[\"!rows\"].length; ++R) if (ws[\"!rows\"][R]) {\n          ws[\"!rows\"][R].ods = ridx;\n          var h = ws[\"!rows\"][R].hpx + \"px\";\n          o.push('  <style:style style:name=\"ro' + ridx + '\" style:family=\"table-row\">\\n');\n          o.push('   <style:table-row-properties fo:break-before=\"auto\" style:row-height=\"' + h + '\"/>\\n');\n          o.push('  </style:style>\\n');\n          ++ridx;\n        }\n      }\n    });\n    /* table */\n\n    o.push('  <style:style style:name=\"ta1\" style:family=\"table\" style:master-page-name=\"mp1\">\\n');\n    o.push('   <style:table-properties table:display=\"true\" style:writing-mode=\"lr-tb\"/>\\n');\n    o.push('  </style:style>\\n');\n    /* table cells, text */\n\n    o.push('  <style:style style:name=\"ce1\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N37\"/>\\n');\n    /* page-layout */\n\n    o.push(' </office:automatic-styles>\\n');\n  };\n\n  return function wcx(wb, opts) {\n    var o = [XML_HEADER];\n    /* 3.1.3.2 */\n\n    var attr = wxt_helper({\n      'xmlns:office': \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n      'xmlns:table': \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n      'xmlns:style': \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n      'xmlns:text': \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n      'xmlns:draw': \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n      'xmlns:fo': \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n      'xmlns:xlink': \"http://www.w3.org/1999/xlink\",\n      'xmlns:dc': \"http://purl.org/dc/elements/1.1/\",\n      'xmlns:meta': \"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\",\n      'xmlns:number': \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n      'xmlns:presentation': \"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\",\n      'xmlns:svg': \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n      'xmlns:chart': \"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\",\n      'xmlns:dr3d': \"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\",\n      'xmlns:math': \"http://www.w3.org/1998/Math/MathML\",\n      'xmlns:form': \"urn:oasis:names:tc:opendocument:xmlns:form:1.0\",\n      'xmlns:script': \"urn:oasis:names:tc:opendocument:xmlns:script:1.0\",\n      'xmlns:ooo': \"http://openoffice.org/2004/office\",\n      'xmlns:ooow': \"http://openoffice.org/2004/writer\",\n      'xmlns:oooc': \"http://openoffice.org/2004/calc\",\n      'xmlns:dom': \"http://www.w3.org/2001/xml-events\",\n      'xmlns:xforms': \"http://www.w3.org/2002/xforms\",\n      'xmlns:xsd': \"http://www.w3.org/2001/XMLSchema\",\n      'xmlns:xsi': \"http://www.w3.org/2001/XMLSchema-instance\",\n      'xmlns:sheet': \"urn:oasis:names:tc:opendocument:sh33tjs:1.0\",\n      'xmlns:rpt': \"http://openoffice.org/2005/report\",\n      'xmlns:of': \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n      'xmlns:xhtml': \"http://www.w3.org/1999/xhtml\",\n      'xmlns:grddl': \"http://www.w3.org/2003/g/data-view#\",\n      'xmlns:tableooo': \"http://openoffice.org/2009/table\",\n      'xmlns:drawooo': \"http://openoffice.org/2010/draw\",\n      'xmlns:calcext': \"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\",\n      'xmlns:loext': \"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\",\n      'xmlns:field': \"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\",\n      'xmlns:formx': \"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\",\n      'xmlns:css3t': \"http://www.w3.org/TR/css3-text/\",\n      'office:version': \"1.2\"\n    });\n    var fods = wxt_helper({\n      'xmlns:config': \"urn:oasis:names:tc:opendocument:xmlns:config:1.0\",\n      'office:mimetype': \"application/vnd.oasis.opendocument.spreadsheet\"\n    });\n\n    if (opts.bookType == \"fods\") {\n      o.push('<office:document' + attr + fods + '>\\n');\n      o.push(write_meta_ods().replace(/office:document-meta/g, \"office:meta\")); // TODO: settings (equiv of settings.xml for ODS)\n    } else o.push('<office:document-content' + attr + '>\\n'); // o.push('  <office:scripts/>\\n');\n\n\n    write_automatic_styles_ods(o, wb);\n    o.push('  <office:body>\\n');\n    o.push('    <office:spreadsheet>\\n');\n\n    for (var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws(wb.Sheets[wb.SheetNames[i]], wb, i, opts));\n\n    o.push('    </office:spreadsheet>\\n');\n    o.push('  </office:body>\\n');\n    if (opts.bookType == \"fods\") o.push('</office:document>');else o.push('</office:document-content>');\n    return o.join(\"\");\n  };\n}();\n\nfunction write_ods(wb\n/*:any*/\n, opts\n/*:any*/\n) {\n  if (opts.bookType == \"fods\") return write_content_ods(wb, opts);\n  var zip = zip_new();\n  var f = \"\";\n  var manifest\n  /*:Array<Array<string> >*/\n  = [];\n  var rdf\n  /*:Array<[string, string]>*/\n  = [];\n  /* Part 3 Section 3.3 MIME Media Type */\n\n  f = \"mimetype\";\n  zip_add_file(zip, f, \"application/vnd.oasis.opendocument.spreadsheet\");\n  /* Part 1 Section 2.2 Documents */\n\n  f = \"content.xml\";\n  zip_add_file(zip, f, write_content_ods(wb, opts));\n  manifest.push([f, \"text/xml\"]);\n  rdf.push([f, \"ContentFile\"]);\n  /* TODO: these are hard-coded styles to satiate excel */\n\n  f = \"styles.xml\";\n  zip_add_file(zip, f, write_styles_ods(wb, opts));\n  manifest.push([f, \"text/xml\"]);\n  rdf.push([f, \"StylesFile\"]);\n  /* TODO: this is hard-coded to satiate excel */\n\n  f = \"meta.xml\";\n  zip_add_file(zip, f, XML_HEADER + write_meta_ods());\n  manifest.push([f, \"text/xml\"]);\n  rdf.push([f, \"MetadataFile\"]);\n  /* Part 3 Section 6 Metadata Manifest File */\n\n  f = \"manifest.rdf\";\n  zip_add_file(zip, f, write_rdf(rdf\n  /*, opts*/\n  ));\n  manifest.push([f, \"application/rdf+xml\"]);\n  /* Part 3 Section 4 Manifest File */\n\n  f = \"META-INF/manifest.xml\";\n  zip_add_file(zip, f, write_manifest(manifest\n  /*, opts*/\n  ));\n  return zip;\n}\n/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */\n\n\nfunction u8_to_dataview(array) {\n  return new DataView(array.buffer, array.byteOffset, array.byteLength);\n}\n\nfunction u8str(u8) {\n  return typeof TextDecoder != \"undefined\" ? new TextDecoder().decode(u8) : utf8read(a2s(u8));\n}\n\nfunction stru8(str) {\n  return typeof TextEncoder != \"undefined\" ? new TextEncoder().encode(str) : s2a(utf8write(str));\n}\n\nfunction u8contains(body, search) {\n  outer: for (var L = 0; L <= body.length - search.length; ++L) {\n    for (var j = 0; j < search.length; ++j) if (body[L + j] != search[j]) continue outer;\n\n    return true;\n  }\n\n  return false;\n}\n\nfunction u8concat(u8a) {\n  var len = u8a.reduce(function (acc, x) {\n    return acc + x.length;\n  }, 0);\n  var out = new Uint8Array(len);\n  var off = 0;\n  u8a.forEach(function (u8) {\n    out.set(u8, off);\n    off += u8.length;\n  });\n  return out;\n}\n\nfunction popcnt(x) {\n  x -= x >> 1 & 1431655765;\n  x = (x & 858993459) + (x >> 2 & 858993459);\n  return (x + (x >> 4) & 252645135) * 16843009 >>> 24;\n}\n\nfunction readDecimal128LE(buf, offset) {\n  var exp = (buf[offset + 15] & 127) << 7 | buf[offset + 14] >> 1;\n  var mantissa = buf[offset + 14] & 1;\n\n  for (var j = offset + 13; j >= offset; --j) mantissa = mantissa * 256 + buf[j];\n\n  return (buf[offset + 15] & 128 ? -mantissa : mantissa) * Math.pow(10, exp - 6176);\n}\n\nfunction writeDecimal128LE(buf, offset, value) {\n  var exp = Math.floor(value == 0 ? 0 : Math.LOG10E * Math.log(Math.abs(value))) + 6176 - 20;\n  var mantissa = value / Math.pow(10, exp - 6176);\n  buf[offset + 15] |= exp >> 7;\n  buf[offset + 14] |= (exp & 127) << 1;\n\n  for (var i = 0; mantissa >= 1; ++i, mantissa /= 256) buf[offset + i] = mantissa & 255;\n\n  buf[offset + 15] |= value >= 0 ? 0 : 128;\n}\n\nfunction parse_varint49(buf, ptr) {\n  var l = ptr ? ptr[0] : 0;\n  var usz = buf[l] & 127;\n\n  varint: if (buf[l++] >= 128) {\n    usz |= (buf[l] & 127) << 7;\n    if (buf[l++] < 128) break varint;\n    usz |= (buf[l] & 127) << 14;\n    if (buf[l++] < 128) break varint;\n    usz |= (buf[l] & 127) << 21;\n    if (buf[l++] < 128) break varint;\n    usz += (buf[l] & 127) * Math.pow(2, 28);\n    ++l;\n    if (buf[l++] < 128) break varint;\n    usz += (buf[l] & 127) * Math.pow(2, 35);\n    ++l;\n    if (buf[l++] < 128) break varint;\n    usz += (buf[l] & 127) * Math.pow(2, 42);\n    ++l;\n    if (buf[l++] < 128) break varint;\n  }\n\n  if (ptr) ptr[0] = l;\n  return usz;\n}\n\nfunction write_varint49(v) {\n  var usz = new Uint8Array(7);\n  usz[0] = v & 127;\n  var L = 1;\n\n  sz: if (v > 127) {\n    usz[L - 1] |= 128;\n    usz[L] = v >> 7 & 127;\n    ++L;\n    if (v <= 16383) break sz;\n    usz[L - 1] |= 128;\n    usz[L] = v >> 14 & 127;\n    ++L;\n    if (v <= 2097151) break sz;\n    usz[L - 1] |= 128;\n    usz[L] = v >> 21 & 127;\n    ++L;\n    if (v <= 268435455) break sz;\n    usz[L - 1] |= 128;\n    usz[L] = v / 256 >>> 21 & 127;\n    ++L;\n    if (v <= 34359738367) break sz;\n    usz[L - 1] |= 128;\n    usz[L] = v / 65536 >>> 21 & 127;\n    ++L;\n    if (v <= 4398046511103) break sz;\n    usz[L - 1] |= 128;\n    usz[L] = v / 16777216 >>> 21 & 127;\n    ++L;\n  }\n\n  return usz.slice(0, L);\n}\n\nfunction varint_to_i32(buf) {\n  var l = 0,\n      i32 = buf[l] & 127;\n\n  varint: if (buf[l++] >= 128) {\n    i32 |= (buf[l] & 127) << 7;\n    if (buf[l++] < 128) break varint;\n    i32 |= (buf[l] & 127) << 14;\n    if (buf[l++] < 128) break varint;\n    i32 |= (buf[l] & 127) << 21;\n    if (buf[l++] < 128) break varint;\n    i32 |= (buf[l] & 127) << 28;\n  }\n\n  return i32;\n}\n\nfunction parse_shallow(buf) {\n  var out = [],\n      ptr = [0];\n\n  while (ptr[0] < buf.length) {\n    var off = ptr[0];\n    var num = parse_varint49(buf, ptr);\n    var type = num & 7;\n    num = Math.floor(num / 8);\n    var len = 0;\n    var res;\n    if (num == 0) break;\n\n    switch (type) {\n      case 0:\n        {\n          var l = ptr[0];\n\n          while (buf[ptr[0]++] >= 128);\n\n          res = buf.slice(l, ptr[0]);\n        }\n        break;\n\n      case 5:\n        len = 4;\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n\n      case 1:\n        len = 8;\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n\n      case 2:\n        len = parse_varint49(buf, ptr);\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n\n      case 3:\n      case 4:\n      default:\n        throw new Error(\"PB Type \".concat(type, \" for Field \").concat(num, \" at offset \").concat(off));\n    }\n\n    var v = {\n      data: res,\n      type: type\n    };\n    if (out[num] == null) out[num] = [v];else out[num].push(v);\n  }\n\n  return out;\n}\n\nfunction write_shallow(proto) {\n  var out = [];\n  proto.forEach(function (field, idx) {\n    field.forEach(function (item) {\n      if (!item.data) return;\n      out.push(write_varint49(idx * 8 + item.type));\n      if (item.type == 2) out.push(write_varint49(item.data.length));\n      out.push(item.data);\n    });\n  });\n  return u8concat(out);\n}\n\nfunction mappa(data, cb) {\n  return (data == null ? void 0 : data.map(function (d) {\n    return cb(d.data);\n  })) || [];\n}\n\nfunction parse_iwa_file(buf) {\n  var _a;\n\n  var out = [],\n      ptr = [0];\n\n  while (ptr[0] < buf.length) {\n    var len = parse_varint49(buf, ptr);\n    var ai = parse_shallow(buf.slice(ptr[0], ptr[0] + len));\n    ptr[0] += len;\n    var res = {\n      id: varint_to_i32(ai[1][0].data),\n      messages: []\n    };\n    ai[2].forEach(function (b) {\n      var mi = parse_shallow(b.data);\n      var fl = varint_to_i32(mi[3][0].data);\n      res.messages.push({\n        meta: mi,\n        data: buf.slice(ptr[0], ptr[0] + fl)\n      });\n      ptr[0] += fl;\n    });\n    if ((_a = ai[3]) == null ? void 0 : _a[0]) res.merge = varint_to_i32(ai[3][0].data) >>> 0 > 0;\n    out.push(res);\n  }\n\n  return out;\n}\n\nfunction write_iwa_file(ias) {\n  var bufs = [];\n  ias.forEach(function (ia) {\n    var ai = [];\n    ai[1] = [{\n      data: write_varint49(ia.id),\n      type: 0\n    }];\n    ai[2] = [];\n    if (ia.merge != null) ai[3] = [{\n      data: write_varint49(+!!ia.merge),\n      type: 0\n    }];\n    var midata = [];\n    ia.messages.forEach(function (mi) {\n      midata.push(mi.data);\n      mi.meta[3] = [{\n        type: 0,\n        data: write_varint49(mi.data.length)\n      }];\n      ai[2].push({\n        data: write_shallow(mi.meta),\n        type: 2\n      });\n    });\n    var aipayload = write_shallow(ai);\n    bufs.push(write_varint49(aipayload.length));\n    bufs.push(aipayload);\n    midata.forEach(function (mid) {\n      return bufs.push(mid);\n    });\n  });\n  return u8concat(bufs);\n}\n\nfunction parse_snappy_chunk(type, buf) {\n  if (type != 0) throw new Error(\"Unexpected Snappy chunk type \".concat(type));\n  var ptr = [0];\n  var usz = parse_varint49(buf, ptr);\n  var chunks = [];\n\n  while (ptr[0] < buf.length) {\n    var tag = buf[ptr[0]] & 3;\n\n    if (tag == 0) {\n      var len = buf[ptr[0]++] >> 2;\n      if (len < 60) ++len;else {\n        var c = len - 59;\n        len = buf[ptr[0]];\n        if (c > 1) len |= buf[ptr[0] + 1] << 8;\n        if (c > 2) len |= buf[ptr[0] + 2] << 16;\n        if (c > 3) len |= buf[ptr[0] + 3] << 24;\n        len >>>= 0;\n        len++;\n        ptr[0] += c;\n      }\n      chunks.push(buf.slice(ptr[0], ptr[0] + len));\n      ptr[0] += len;\n      continue;\n    } else {\n      var offset = 0,\n          length = 0;\n\n      if (tag == 1) {\n        length = (buf[ptr[0]] >> 2 & 7) + 4;\n        offset = (buf[ptr[0]++] & 224) << 3;\n        offset |= buf[ptr[0]++];\n      } else {\n        length = (buf[ptr[0]++] >> 2) + 1;\n\n        if (tag == 2) {\n          offset = buf[ptr[0]] | buf[ptr[0] + 1] << 8;\n          ptr[0] += 2;\n        } else {\n          offset = (buf[ptr[0]] | buf[ptr[0] + 1] << 8 | buf[ptr[0] + 2] << 16 | buf[ptr[0] + 3] << 24) >>> 0;\n          ptr[0] += 4;\n        }\n      }\n\n      chunks = [u8concat(chunks)];\n      if (offset == 0) throw new Error(\"Invalid offset 0\");\n      if (offset > chunks[0].length) throw new Error(\"Invalid offset beyond length\");\n\n      if (length >= offset) {\n        chunks.push(chunks[0].slice(-offset));\n        length -= offset;\n\n        while (length >= chunks[chunks.length - 1].length) {\n          chunks.push(chunks[chunks.length - 1]);\n          length -= chunks[chunks.length - 1].length;\n        }\n      }\n\n      chunks.push(chunks[0].slice(-offset, -offset + length));\n    }\n  }\n\n  var o = u8concat(chunks);\n  if (o.length != usz) throw new Error(\"Unexpected length: \".concat(o.length, \" != \").concat(usz));\n  return o;\n}\n\nfunction decompress_iwa_file(buf) {\n  var out = [];\n  var l = 0;\n\n  while (l < buf.length) {\n    var t = buf[l++];\n    var len = buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16;\n    l += 3;\n    out.push(parse_snappy_chunk(t, buf.slice(l, l + len)));\n    l += len;\n  }\n\n  if (l !== buf.length) throw new Error(\"data is not a valid framed stream!\");\n  return u8concat(out);\n}\n\nfunction compress_iwa_file(buf) {\n  var out = [];\n  var l = 0;\n\n  while (l < buf.length) {\n    var c = Math.min(buf.length - l, 268435455);\n    var frame = new Uint8Array(4);\n    out.push(frame);\n    var usz = write_varint49(c);\n    var L = usz.length;\n    out.push(usz);\n\n    if (c <= 60) {\n      L++;\n      out.push(new Uint8Array([c - 1 << 2]));\n    } else if (c <= 256) {\n      L += 2;\n      out.push(new Uint8Array([240, c - 1 & 255]));\n    } else if (c <= 65536) {\n      L += 3;\n      out.push(new Uint8Array([244, c - 1 & 255, c - 1 >> 8 & 255]));\n    } else if (c <= 16777216) {\n      L += 4;\n      out.push(new Uint8Array([248, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255]));\n    } else if (c <= 4294967296) {\n      L += 5;\n      out.push(new Uint8Array([252, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255, c - 1 >>> 24 & 255]));\n    }\n\n    out.push(buf.slice(l, l + c));\n    L += c;\n    frame[0] = 0;\n    frame[1] = L & 255;\n    frame[2] = L >> 8 & 255;\n    frame[3] = L >> 16 & 255;\n    l += c;\n  }\n\n  return u8concat(out);\n}\n\nfunction parse_old_storage(buf, sst, rsst, v) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(4, true);\n  var data_offset = (v > 1 ? 12 : 8) + popcnt(flags & (v > 1 ? 3470 : 398)) * 4;\n  var ridx = -1,\n      sidx = -1,\n      ieee = NaN,\n      dt = new Date(2001, 0, 1);\n\n  if (flags & 512) {\n    ridx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n\n  data_offset += popcnt(flags & (v > 1 ? 12288 : 4096)) * 4;\n\n  if (flags & 16) {\n    sidx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n\n  if (flags & 32) {\n    ieee = dv.getFloat64(data_offset, true);\n    data_offset += 8;\n  }\n\n  if (flags & 64) {\n    dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n    data_offset += 8;\n  }\n\n  var ret;\n\n  switch (buf[2]) {\n    case 0:\n      break;\n\n    case 2:\n      ret = {\n        t: \"n\",\n        v: ieee\n      };\n      break;\n\n    case 3:\n      ret = {\n        t: \"s\",\n        v: sst[sidx]\n      };\n      break;\n\n    case 5:\n      ret = {\n        t: \"d\",\n        v: dt\n      };\n      break;\n\n    case 6:\n      ret = {\n        t: \"b\",\n        v: ieee > 0\n      };\n      break;\n\n    case 7:\n      ret = {\n        t: \"n\",\n        v: ieee / 86400\n      };\n      break;\n\n    case 8:\n      ret = {\n        t: \"e\",\n        v: 0\n      };\n      break;\n\n    case 9:\n      {\n        if (ridx > -1) ret = {\n          t: \"s\",\n          v: rsst[ridx]\n        };else if (sidx > -1) ret = {\n          t: \"s\",\n          v: sst[sidx]\n        };else if (!isNaN(ieee)) ret = {\n          t: \"n\",\n          v: ieee\n        };else throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n      }\n      break;\n\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n  }\n\n  return ret;\n}\n\nfunction parse_new_storage(buf, sst, rsst) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(8, true);\n  var data_offset = 12;\n  var ridx = -1,\n      sidx = -1,\n      d128 = NaN,\n      ieee = NaN,\n      dt = new Date(2001, 0, 1);\n\n  if (flags & 1) {\n    d128 = readDecimal128LE(buf, data_offset);\n    data_offset += 16;\n  }\n\n  if (flags & 2) {\n    ieee = dv.getFloat64(data_offset, true);\n    data_offset += 8;\n  }\n\n  if (flags & 4) {\n    dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n    data_offset += 8;\n  }\n\n  if (flags & 8) {\n    sidx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n\n  if (flags & 16) {\n    ridx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n\n  var ret;\n\n  switch (buf[1]) {\n    case 0:\n      break;\n\n    case 2:\n      ret = {\n        t: \"n\",\n        v: d128\n      };\n      break;\n\n    case 3:\n      ret = {\n        t: \"s\",\n        v: sst[sidx]\n      };\n      break;\n\n    case 5:\n      ret = {\n        t: \"d\",\n        v: dt\n      };\n      break;\n\n    case 6:\n      ret = {\n        t: \"b\",\n        v: ieee > 0\n      };\n      break;\n\n    case 7:\n      ret = {\n        t: \"n\",\n        v: ieee / 86400\n      };\n      break;\n\n    case 8:\n      ret = {\n        t: \"e\",\n        v: 0\n      };\n      break;\n\n    case 9:\n      {\n        if (ridx > -1) ret = {\n          t: \"s\",\n          v: rsst[ridx]\n        };else throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n      }\n      break;\n\n    case 10:\n      ret = {\n        t: \"n\",\n        v: d128\n      };\n      break;\n\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n  }\n\n  return ret;\n}\n\nfunction write_new_storage(cell, sst) {\n  var out = new Uint8Array(32),\n      dv = u8_to_dataview(out),\n      l = 12,\n      flags = 0;\n  out[0] = 5;\n\n  switch (cell.t) {\n    case \"n\":\n      out[1] = 2;\n      writeDecimal128LE(out, l, cell.v);\n      flags |= 1;\n      l += 16;\n      break;\n\n    case \"b\":\n      out[1] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      flags |= 2;\n      l += 8;\n      break;\n\n    case \"s\":\n      if (sst.indexOf(cell.v) == -1) throw new Error(\"Value \".concat(cell.v, \" missing from SST!\"));\n      out[1] = 3;\n      dv.setUint32(l, sst.indexOf(cell.v), true);\n      flags |= 8;\n      l += 4;\n      break;\n\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n\n  dv.setUint32(8, flags, true);\n  return out.slice(0, l);\n}\n\nfunction write_old_storage(cell, sst) {\n  var out = new Uint8Array(32),\n      dv = u8_to_dataview(out),\n      l = 12,\n      flags = 0;\n  out[0] = 3;\n\n  switch (cell.t) {\n    case \"n\":\n      out[2] = 2;\n      dv.setFloat64(l, cell.v, true);\n      flags |= 32;\n      l += 8;\n      break;\n\n    case \"b\":\n      out[2] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      flags |= 32;\n      l += 8;\n      break;\n\n    case \"s\":\n      if (sst.indexOf(cell.v) == -1) throw new Error(\"Value \".concat(cell.v, \" missing from SST!\"));\n      out[2] = 3;\n      dv.setUint32(l, sst.indexOf(cell.v), true);\n      flags |= 16;\n      l += 4;\n      break;\n\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n\n  dv.setUint32(4, flags, true);\n  return out.slice(0, l);\n}\n\nfunction parse_cell_storage(buf, sst, rsst) {\n  switch (buf[0]) {\n    case 0:\n    case 1:\n    case 2:\n    case 3:\n      return parse_old_storage(buf, sst, rsst, buf[0]);\n\n    case 5:\n      return parse_new_storage(buf, sst, rsst);\n\n    default:\n      throw new Error(\"Unsupported payload version \".concat(buf[0]));\n  }\n}\n\nfunction parse_TSP_Reference(buf) {\n  var pb = parse_shallow(buf);\n  return parse_varint49(pb[1][0].data);\n}\n\nfunction write_TSP_Reference(idx) {\n  var out = [];\n  out[1] = [{\n    type: 0,\n    data: write_varint49(idx)\n  }];\n  return write_shallow(out);\n}\n\nfunction parse_TST_TableDataList(M, root) {\n  var pb = parse_shallow(root.data);\n  var type = varint_to_i32(pb[1][0].data);\n  var entries = pb[3];\n  var data = [];\n  (entries || []).forEach(function (entry) {\n    var le = parse_shallow(entry.data);\n    var key = varint_to_i32(le[1][0].data) >>> 0;\n\n    switch (type) {\n      case 1:\n        data[key] = u8str(le[3][0].data);\n        break;\n\n      case 8:\n        {\n          var rt = M[parse_TSP_Reference(le[9][0].data)][0];\n          var rtp = parse_shallow(rt.data);\n          var rtpref = M[parse_TSP_Reference(rtp[1][0].data)][0];\n          var mtype = varint_to_i32(rtpref.meta[1][0].data);\n          if (mtype != 2001) throw new Error(\"2000 unexpected reference to \".concat(mtype));\n          var tswpsa = parse_shallow(rtpref.data);\n          data[key] = tswpsa[3].map(function (x) {\n            return u8str(x.data);\n          }).join(\"\");\n        }\n        break;\n    }\n  });\n  return data;\n}\n\nfunction parse_TST_TileRowInfo(u8, type) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n;\n\n  var pb = parse_shallow(u8);\n  var R = varint_to_i32(pb[1][0].data) >>> 0;\n  var cnt = varint_to_i32(pb[2][0].data) >>> 0;\n  var wide_offsets = ((_b = (_a = pb[8]) == null ? void 0 : _a[0]) == null ? void 0 : _b.data) && varint_to_i32(pb[8][0].data) > 0 || false;\n  var used_storage_u8, used_storage;\n\n  if (((_d = (_c = pb[7]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && type != 0) {\n    used_storage_u8 = (_f = (_e = pb[7]) == null ? void 0 : _e[0]) == null ? void 0 : _f.data;\n    used_storage = (_h = (_g = pb[6]) == null ? void 0 : _g[0]) == null ? void 0 : _h.data;\n  } else if (((_j = (_i = pb[4]) == null ? void 0 : _i[0]) == null ? void 0 : _j.data) && type != 1) {\n    used_storage_u8 = (_l = (_k = pb[4]) == null ? void 0 : _k[0]) == null ? void 0 : _l.data;\n    used_storage = (_n = (_m = pb[3]) == null ? void 0 : _m[0]) == null ? void 0 : _n.data;\n  } else throw \"NUMBERS Tile missing \".concat(type, \" cell storage\");\n\n  var width = wide_offsets ? 4 : 1;\n  var used_storage_offsets = u8_to_dataview(used_storage_u8);\n  var offsets = [];\n\n  for (var C = 0; C < used_storage_u8.length / 2; ++C) {\n    var off = used_storage_offsets.getUint16(C * 2, true);\n    if (off < 65535) offsets.push([C, off]);\n  }\n\n  if (offsets.length != cnt) throw \"Expected \".concat(cnt, \" cells, found \").concat(offsets.length);\n  var cells = [];\n\n  for (C = 0; C < offsets.length - 1; ++C) cells[offsets[C][0]] = used_storage.subarray(offsets[C][1] * width, offsets[C + 1][1] * width);\n\n  if (offsets.length >= 1) cells[offsets[offsets.length - 1][0]] = used_storage.subarray(offsets[offsets.length - 1][1] * width);\n  return {\n    R: R,\n    cells: cells\n  };\n}\n\nfunction parse_TST_Tile(M, root) {\n  var _a;\n\n  var pb = parse_shallow(root.data);\n  var storage = ((_a = pb == null ? void 0 : pb[7]) == null ? void 0 : _a[0]) ? varint_to_i32(pb[7][0].data) >>> 0 > 0 ? 1 : 0 : -1;\n  var ri = mappa(pb[5], function (u8) {\n    return parse_TST_TileRowInfo(u8, storage);\n  });\n  return {\n    nrows: varint_to_i32(pb[4][0].data) >>> 0,\n    data: ri.reduce(function (acc, x) {\n      if (!acc[x.R]) acc[x.R] = [];\n      x.cells.forEach(function (cell, C) {\n        if (acc[x.R][C]) throw new Error(\"Duplicate cell r=\".concat(x.R, \" c=\").concat(C));\n        acc[x.R][C] = cell;\n      });\n      return acc;\n    }, [])\n  };\n}\n\nfunction parse_TST_TableModelArchive(M, root, ws) {\n  var _a;\n\n  var pb = parse_shallow(root.data);\n  var range = {\n    s: {\n      r: 0,\n      c: 0\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  range.e.r = (varint_to_i32(pb[6][0].data) >>> 0) - 1;\n  if (range.e.r < 0) throw new Error(\"Invalid row varint \".concat(pb[6][0].data));\n  range.e.c = (varint_to_i32(pb[7][0].data) >>> 0) - 1;\n  if (range.e.c < 0) throw new Error(\"Invalid col varint \".concat(pb[7][0].data));\n  ws[\"!ref\"] = encode_range(range);\n  var store = parse_shallow(pb[4][0].data);\n  var sst = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[4][0].data)][0]);\n  var rsst = ((_a = store[17]) == null ? void 0 : _a[0]) ? parse_TST_TableDataList(M, M[parse_TSP_Reference(store[17][0].data)][0]) : [];\n  var tile = parse_shallow(store[3][0].data);\n  var _R = 0;\n  tile[1].forEach(function (t) {\n    var tl = parse_shallow(t.data);\n    var ref = M[parse_TSP_Reference(tl[2][0].data)][0];\n    var mtype = varint_to_i32(ref.meta[1][0].data);\n    if (mtype != 6002) throw new Error(\"6001 unexpected reference to \".concat(mtype));\n\n    var _tile = parse_TST_Tile(M, ref);\n\n    _tile.data.forEach(function (row, R) {\n      row.forEach(function (buf, C) {\n        var addr = encode_cell({\n          r: _R + R,\n          c: C\n        });\n        var res = parse_cell_storage(buf, sst, rsst);\n        if (res) ws[addr] = res;\n      });\n    });\n\n    _R += _tile.nrows;\n  });\n}\n\nfunction parse_TST_TableInfoArchive(M, root) {\n  var pb = parse_shallow(root.data);\n  var out = {\n    \"!ref\": \"A1\"\n  };\n  var tableref = M[parse_TSP_Reference(pb[2][0].data)];\n  var mtype = varint_to_i32(tableref[0].meta[1][0].data);\n  if (mtype != 6001) throw new Error(\"6000 unexpected reference to \".concat(mtype));\n  parse_TST_TableModelArchive(M, tableref[0], out);\n  return out;\n}\n\nfunction parse_TN_SheetArchive(M, root) {\n  var _a;\n\n  var pb = parse_shallow(root.data);\n  var out = {\n    name: ((_a = pb[1]) == null ? void 0 : _a[0]) ? u8str(pb[1][0].data) : \"\",\n    sheets: []\n  };\n  var shapeoffs = mappa(pb[2], parse_TSP_Reference);\n  shapeoffs.forEach(function (off) {\n    M[off].forEach(function (m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 6e3) out.sheets.push(parse_TST_TableInfoArchive(M, m));\n    });\n  });\n  return out;\n}\n\nfunction parse_TN_DocumentArchive(M, root) {\n  var out = book_new();\n  var pb = parse_shallow(root.data);\n  var sheetoffs = mappa(pb[1], parse_TSP_Reference);\n  sheetoffs.forEach(function (off) {\n    M[off].forEach(function (m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n\n      if (mtype == 2) {\n        var root2 = parse_TN_SheetArchive(M, m);\n        root2.sheets.forEach(function (sheet, idx) {\n          book_append_sheet(out, sheet, idx == 0 ? root2.name : root2.name + \"_\" + idx, true);\n        });\n      }\n    });\n  });\n  if (out.SheetNames.length == 0) throw new Error(\"Empty NUMBERS file\");\n  return out;\n}\n\nfunction parse_numbers_iwa(cfb) {\n  var _a, _b, _c, _d;\n\n  var M = {},\n      indices = [];\n  cfb.FullPaths.forEach(function (p) {\n    if (p.match(/\\.iwpv2/)) throw new Error(\"Unsupported password protection\");\n  });\n  cfb.FileIndex.forEach(function (s) {\n    if (!s.name.match(/\\.iwa$/)) return;\n    var o;\n\n    try {\n      o = decompress_iwa_file(s.content);\n    } catch (e) {\n      return console.log(\"?? \" + s.content.length + \" \" + (e.message || e));\n    }\n\n    var packets;\n\n    try {\n      packets = parse_iwa_file(o);\n    } catch (e) {\n      return console.log(\"## \" + (e.message || e));\n    }\n\n    packets.forEach(function (packet) {\n      M[packet.id] = packet.messages;\n      indices.push(packet.id);\n    });\n  });\n  if (!indices.length) throw new Error(\"File has no messages\");\n  var docroot = ((_d = (_c = (_b = (_a = M == null ? void 0 : M[1]) == null ? void 0 : _a[0]) == null ? void 0 : _b.meta) == null ? void 0 : _c[1]) == null ? void 0 : _d[0].data) && varint_to_i32(M[1][0].meta[1][0].data) == 1 && M[1][0];\n  if (!docroot) indices.forEach(function (idx) {\n    M[idx].forEach(function (iwam) {\n      var mtype = varint_to_i32(iwam.meta[1][0].data) >>> 0;\n\n      if (mtype == 1) {\n        if (!docroot) docroot = iwam;else throw new Error(\"Document has multiple roots\");\n      }\n    });\n  });\n  if (!docroot) throw new Error(\"Cannot find Document root\");\n  return parse_TN_DocumentArchive(M, docroot);\n}\n\nfunction write_tile_row(tri, data, SST) {\n  var _a, _b, _c, _d;\n\n  if (!((_a = tri[6]) == null ? void 0 : _a[0]) || !((_b = tri[7]) == null ? void 0 : _b[0])) throw \"Mutation only works on post-BNC storages!\";\n  var wide_offsets = ((_d = (_c = tri[8]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && varint_to_i32(tri[8][0].data) > 0 || false;\n  if (wide_offsets) throw \"Math only works with normal offsets\";\n  var cnt = 0;\n  var dv = u8_to_dataview(tri[7][0].data),\n      last_offset = 0,\n      cell_storage = [];\n\n  var _dv = u8_to_dataview(tri[4][0].data),\n      _last_offset = 0,\n      _cell_storage = [];\n\n  for (var C = 0; C < data.length; ++C) {\n    if (data[C] == null) {\n      dv.setUint16(C * 2, 65535, true);\n\n      _dv.setUint16(C * 2, 65535);\n\n      continue;\n    }\n\n    dv.setUint16(C * 2, last_offset, true);\n\n    _dv.setUint16(C * 2, _last_offset, true);\n\n    var celload, _celload;\n\n    switch (typeof data[C]) {\n      case \"string\":\n        celload = write_new_storage({\n          t: \"s\",\n          v: data[C]\n        }, SST);\n        _celload = write_old_storage({\n          t: \"s\",\n          v: data[C]\n        }, SST);\n        break;\n\n      case \"number\":\n        celload = write_new_storage({\n          t: \"n\",\n          v: data[C]\n        }, SST);\n        _celload = write_old_storage({\n          t: \"n\",\n          v: data[C]\n        }, SST);\n        break;\n\n      case \"boolean\":\n        celload = write_new_storage({\n          t: \"b\",\n          v: data[C]\n        }, SST);\n        _celload = write_old_storage({\n          t: \"b\",\n          v: data[C]\n        }, SST);\n        break;\n\n      default:\n        throw new Error(\"Unsupported value \" + data[C]);\n    }\n\n    cell_storage.push(celload);\n    last_offset += celload.length;\n\n    _cell_storage.push(_celload);\n\n    _last_offset += _celload.length;\n    ++cnt;\n  }\n\n  tri[2][0].data = write_varint49(cnt);\n\n  for (; C < tri[7][0].data.length / 2; ++C) {\n    dv.setUint16(C * 2, 65535, true);\n\n    _dv.setUint16(C * 2, 65535, true);\n  }\n\n  tri[6][0].data = u8concat(cell_storage);\n  tri[3][0].data = u8concat(_cell_storage);\n  return cnt;\n}\n\nfunction write_numbers_iwa(wb, opts) {\n  if (!opts || !opts.numbers) throw new Error(\"Must pass a `numbers` option -- check the README\");\n  var ws = wb.Sheets[wb.SheetNames[0]];\n  if (wb.SheetNames.length > 1) console.error(\"The Numbers writer currently writes only the first table\");\n  var range = decode_range(ws[\"!ref\"]);\n  range.s.r = range.s.c = 0;\n  var trunc = false;\n\n  if (range.e.c > 9) {\n    trunc = true;\n    range.e.c = 9;\n  }\n\n  if (range.e.r > 49) {\n    trunc = true;\n    range.e.r = 49;\n  }\n\n  if (trunc) console.error(\"The Numbers writer is currently limited to \".concat(encode_range(range)));\n  var data = sheet_to_json(ws, {\n    range: range,\n    header: 1\n  });\n  var SST = [\"~Sh33tJ5~\"];\n  data.forEach(function (row) {\n    return row.forEach(function (cell) {\n      if (typeof cell == \"string\") SST.push(cell);\n    });\n  });\n  var dependents = {};\n  var indices = [];\n  var cfb = CFB.read(opts.numbers, {\n    type: \"base64\"\n  });\n  cfb.FileIndex.map(function (fi, idx) {\n    return [fi, cfb.FullPaths[idx]];\n  }).forEach(function (row) {\n    var fi = row[0],\n        fp = row[1];\n    if (fi.type != 2) return;\n    if (!fi.name.match(/\\.iwa/)) return;\n    var old_content = fi.content;\n    var raw1 = decompress_iwa_file(old_content);\n    var x2 = parse_iwa_file(raw1);\n    x2.forEach(function (packet2) {\n      indices.push(packet2.id);\n      dependents[packet2.id] = {\n        deps: [],\n        location: fp,\n        type: varint_to_i32(packet2.messages[0].meta[1][0].data)\n      };\n    });\n  });\n  indices.sort(function (x2, y2) {\n    return x2 - y2;\n  });\n  var indices_varint = indices.filter(function (x2) {\n    return x2 > 1;\n  }).map(function (x2) {\n    return [x2, write_varint49(x2)];\n  });\n  cfb.FileIndex.map(function (fi, idx) {\n    return [fi, cfb.FullPaths[idx]];\n  }).forEach(function (row) {\n    var fi = row[0],\n        fp = row[1];\n    if (!fi.name.match(/\\.iwa/)) return;\n    var x2 = parse_iwa_file(decompress_iwa_file(fi.content));\n    x2.forEach(function (ia) {\n      ia.messages.forEach(function (m) {\n        indices_varint.forEach(function (ivi) {\n          if (ia.messages.some(function (mess) {\n            return varint_to_i32(mess.meta[1][0].data) != 11006 && u8contains(mess.data, ivi[1]);\n          })) {\n            dependents[ivi[0]].deps.push(ia.id);\n          }\n        });\n      });\n    });\n  });\n\n  function get_unique_msgid() {\n    for (var i = 927262; i < 2e6; ++i) if (!dependents[i]) return i;\n\n    throw new Error(\"Too many messages\");\n  }\n\n  var entry = CFB.find(cfb, dependents[1].location);\n  var x = parse_iwa_file(decompress_iwa_file(entry.content));\n  var docroot;\n\n  for (var xi = 0; xi < x.length; ++xi) {\n    var packet = x[xi];\n    if (packet.id == 1) docroot = packet;\n  }\n\n  var sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[1][0].data);\n  entry = CFB.find(cfb, dependents[sheetrootref].location);\n  x = parse_iwa_file(decompress_iwa_file(entry.content));\n\n  for (xi = 0; xi < x.length; ++xi) {\n    packet = x[xi];\n    if (packet.id == sheetrootref) docroot = packet;\n  }\n\n  sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);\n  entry = CFB.find(cfb, dependents[sheetrootref].location);\n  x = parse_iwa_file(decompress_iwa_file(entry.content));\n\n  for (xi = 0; xi < x.length; ++xi) {\n    packet = x[xi];\n    if (packet.id == sheetrootref) docroot = packet;\n  }\n\n  sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);\n  entry = CFB.find(cfb, dependents[sheetrootref].location);\n  x = parse_iwa_file(decompress_iwa_file(entry.content));\n\n  for (xi = 0; xi < x.length; ++xi) {\n    packet = x[xi];\n    if (packet.id == sheetrootref) docroot = packet;\n  }\n\n  var pb = parse_shallow(docroot.messages[0].data);\n  {\n    pb[6][0].data = write_varint49(range.e.r + 1);\n    pb[7][0].data = write_varint49(range.e.c + 1);\n    var cruidsref = parse_TSP_Reference(pb[46][0].data);\n    var oldbucket = CFB.find(cfb, dependents[cruidsref].location);\n\n    var _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n\n    {\n      for (var j = 0; j < _x.length; ++j) {\n        if (_x[j].id == cruidsref) break;\n      }\n\n      if (_x[j].id != cruidsref) throw \"Bad ColumnRowUIDMapArchive\";\n      var cruids = parse_shallow(_x[j].messages[0].data);\n      cruids[1] = [];\n      cruids[2] = [], cruids[3] = [];\n\n      for (var C = 0; C <= range.e.c; ++C) {\n        var uuid = [];\n        uuid[1] = uuid[2] = [{\n          type: 0,\n          data: write_varint49(C + 420690)\n        }];\n        cruids[1].push({\n          type: 2,\n          data: write_shallow(uuid)\n        });\n        cruids[2].push({\n          type: 0,\n          data: write_varint49(C)\n        });\n        cruids[3].push({\n          type: 0,\n          data: write_varint49(C)\n        });\n      }\n\n      cruids[4] = [];\n      cruids[5] = [], cruids[6] = [];\n\n      for (var R = 0; R <= range.e.r; ++R) {\n        uuid = [];\n        uuid[1] = uuid[2] = [{\n          type: 0,\n          data: write_varint49(R + 726270)\n        }];\n        cruids[4].push({\n          type: 2,\n          data: write_shallow(uuid)\n        });\n        cruids[5].push({\n          type: 0,\n          data: write_varint49(R)\n        });\n        cruids[6].push({\n          type: 0,\n          data: write_varint49(R)\n        });\n      }\n\n      _x[j].messages[0].data = write_shallow(cruids);\n    }\n    oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n    oldbucket.size = oldbucket.content.length;\n    delete pb[46];\n    var store = parse_shallow(pb[4][0].data);\n    {\n      store[7][0].data = write_varint49(range.e.r + 1);\n      var row_headers = parse_shallow(store[1][0].data);\n      var row_header_ref = parse_TSP_Reference(row_headers[2][0].data);\n      oldbucket = CFB.find(cfb, dependents[row_header_ref].location);\n      _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n      {\n        if (_x[0].id != row_header_ref) throw \"Bad HeaderStorageBucket\";\n        var base_bucket = parse_shallow(_x[0].messages[0].data);\n\n        for (R = 0; R < data.length; ++R) {\n          var _bucket = parse_shallow(base_bucket[2][0].data);\n\n          _bucket[1][0].data = write_varint49(R);\n          _bucket[4][0].data = write_varint49(data[R].length);\n          base_bucket[2][R] = {\n            type: base_bucket[2][0].type,\n            data: write_shallow(_bucket)\n          };\n        }\n\n        _x[0].messages[0].data = write_shallow(base_bucket);\n      }\n      oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n      oldbucket.size = oldbucket.content.length;\n      var col_header_ref = parse_TSP_Reference(store[2][0].data);\n      oldbucket = CFB.find(cfb, dependents[col_header_ref].location);\n      _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n      {\n        if (_x[0].id != col_header_ref) throw \"Bad HeaderStorageBucket\";\n        base_bucket = parse_shallow(_x[0].messages[0].data);\n\n        for (C = 0; C <= range.e.c; ++C) {\n          _bucket = parse_shallow(base_bucket[2][0].data);\n          _bucket[1][0].data = write_varint49(C);\n          _bucket[4][0].data = write_varint49(range.e.r + 1);\n          base_bucket[2][C] = {\n            type: base_bucket[2][0].type,\n            data: write_shallow(_bucket)\n          };\n        }\n\n        _x[0].messages[0].data = write_shallow(base_bucket);\n      }\n      oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n      oldbucket.size = oldbucket.content.length;\n      var sstref = parse_TSP_Reference(store[4][0].data);\n\n      (function () {\n        var sentry = CFB.find(cfb, dependents[sstref].location);\n        var sx = parse_iwa_file(decompress_iwa_file(sentry.content));\n        var sstroot;\n\n        for (var sxi = 0; sxi < sx.length; ++sxi) {\n          var packet2 = sx[sxi];\n          if (packet2.id == sstref) sstroot = packet2;\n        }\n\n        var sstdata = parse_shallow(sstroot.messages[0].data);\n        {\n          sstdata[3] = [];\n          var newsst = [];\n          SST.forEach(function (str, i) {\n            newsst[1] = [{\n              type: 0,\n              data: write_varint49(i)\n            }];\n            newsst[2] = [{\n              type: 0,\n              data: write_varint49(1)\n            }];\n            newsst[3] = [{\n              type: 2,\n              data: stru8(str)\n            }];\n            sstdata[3].push({\n              type: 2,\n              data: write_shallow(newsst)\n            });\n          });\n        }\n        sstroot.messages[0].data = write_shallow(sstdata);\n        var sy = write_iwa_file(sx);\n        var raw32 = compress_iwa_file(sy);\n        sentry.content = raw32;\n        sentry.size = sentry.content.length;\n      })();\n\n      var tile = parse_shallow(store[3][0].data);\n      {\n        var t = tile[1][0];\n        delete tile[2];\n        var tl = parse_shallow(t.data);\n        {\n          var tileref = parse_TSP_Reference(tl[2][0].data);\n\n          (function () {\n            var tentry = CFB.find(cfb, dependents[tileref].location);\n            var tx = parse_iwa_file(decompress_iwa_file(tentry.content));\n            var tileroot;\n\n            for (var sxi = 0; sxi < tx.length; ++sxi) {\n              var packet2 = tx[sxi];\n              if (packet2.id == tileref) tileroot = packet2;\n            }\n\n            var tiledata = parse_shallow(tileroot.messages[0].data);\n            {\n              delete tiledata[6];\n              delete tile[7];\n              var rowload = new Uint8Array(tiledata[5][0].data);\n              tiledata[5] = [];\n              var cnt = 0;\n\n              for (var R2 = 0; R2 <= range.e.r; ++R2) {\n                var tilerow = parse_shallow(rowload);\n                cnt += write_tile_row(tilerow, data[R2], SST);\n                tilerow[1][0].data = write_varint49(R2);\n                tiledata[5].push({\n                  data: write_shallow(tilerow),\n                  type: 2\n                });\n              }\n\n              tiledata[1] = [{\n                type: 0,\n                data: write_varint49(range.e.c + 1)\n              }];\n              tiledata[2] = [{\n                type: 0,\n                data: write_varint49(range.e.r + 1)\n              }];\n              tiledata[3] = [{\n                type: 0,\n                data: write_varint49(cnt)\n              }];\n              tiledata[4] = [{\n                type: 0,\n                data: write_varint49(range.e.r + 1)\n              }];\n            }\n            tileroot.messages[0].data = write_shallow(tiledata);\n            var ty = write_iwa_file(tx);\n            var raw32 = compress_iwa_file(ty);\n            tentry.content = raw32;\n            tentry.size = tentry.content.length;\n          })();\n        }\n        t.data = write_shallow(tl);\n      }\n      store[3][0].data = write_shallow(tile);\n    }\n    pb[4][0].data = write_shallow(store);\n  }\n  docroot.messages[0].data = write_shallow(pb);\n  var y = write_iwa_file(x);\n  var raw3 = compress_iwa_file(y);\n  entry.content = raw3;\n  entry.size = entry.content.length;\n  return cfb;\n}\n\nfunction fix_opts_func(defaults\n/*:Array<Array<any> >*/\n)\n/*:{(o:any):void}*/\n{\n  return function fix_opts(opts) {\n    for (var i = 0; i != defaults.length; ++i) {\n      var d = defaults[i];\n      if (opts[d[0]] === undefined) opts[d[0]] = d[1];\n      if (d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n    }\n  };\n}\n\nfunction fix_read_opts(opts) {\n  fix_opts_func([['cellNF', false],\n  /* emit cell number format string as .z */\n  ['cellHTML', true],\n  /* emit html string as .h */\n  ['cellFormula', true],\n  /* emit formulae as .f */\n  ['cellStyles', false],\n  /* emits style/theme as .s */\n  ['cellText', true],\n  /* emit formatted text as .w */\n  ['cellDates', false],\n  /* emit date cells with type `d` */\n  ['sheetStubs', false],\n  /* emit empty cells */\n  ['sheetRows', 0, 'n'],\n  /* read n rows (0 = read all rows) */\n  ['bookDeps', false],\n  /* parse calculation chains */\n  ['bookSheets', false],\n  /* only try to get sheet names (no Sheets) */\n  ['bookProps', false],\n  /* only try to get properties (no Sheets) */\n  ['bookFiles', false],\n  /* include raw file structure (keys, files, cfb) */\n  ['bookVBA', false],\n  /* include vba raw data (vbaraw) */\n  ['password', ''],\n  /* password */\n  ['WTF', false]\n  /* WTF mode (throws errors) */\n  ])(opts);\n}\n\nfunction fix_write_opts(opts) {\n  fix_opts_func([['cellDates', false],\n  /* write date cells with type `d` */\n  ['bookSST', false],\n  /* Generate Shared String Table */\n  ['bookType', 'xlsx'],\n  /* Type of workbook (xlsx/m/b) */\n  ['compression', false],\n  /* Use file compression */\n  ['WTF', false]\n  /* WTF mode (throws errors) */\n  ])(opts);\n}\n\nfunction get_sheet_type(n\n/*:string*/\n)\n/*:string*/\n{\n  if (RELS.WS.indexOf(n) > -1) return \"sheet\";\n  if (RELS.CS && n == RELS.CS) return \"chart\";\n  if (RELS.DS && n == RELS.DS) return \"dialog\";\n  if (RELS.MS && n == RELS.MS) return \"macro\";\n  return n && n.length ? n : \"sheet\";\n}\n\nfunction safe_parse_wbrels(wbrels, sheets) {\n  if (!wbrels) return 0;\n\n  try {\n    wbrels = sheets.map(function pwbr(w) {\n      if (!w.id) w.id = w.strRelID;\n      return [w.name, wbrels['!id'][w.id].Target, get_sheet_type(wbrels['!id'][w.id].Type)];\n    });\n  } catch (e) {\n    return null;\n  }\n\n  return !wbrels || wbrels.length === 0 ? null : wbrels;\n}\n\nfunction safe_parse_sheet(zip, path\n/*:string*/\n, relsPath\n/*:string*/\n, sheet, idx\n/*:number*/\n, sheetRels, sheets, stype\n/*:string*/\n, opts, wb, themes, styles) {\n  try {\n    sheetRels[sheet] = parse_rels(getzipstr(zip, relsPath, true), path);\n    var data = getzipdata(zip, path);\n\n    var _ws;\n\n    switch (stype) {\n      case 'sheet':\n        _ws = parse_ws(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n        break;\n\n      case 'chart':\n        _ws = parse_cs(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n        if (!_ws || !_ws['!drawel']) break;\n        var dfile = resolve_path(_ws['!drawel'].Target, path);\n        var drelsp = get_rels_path(dfile);\n        var draw = parse_drawing(getzipstr(zip, dfile, true), parse_rels(getzipstr(zip, drelsp, true), dfile));\n        var chartp = resolve_path(draw, dfile);\n        var crelsp = get_rels_path(chartp);\n        _ws = parse_chart(getzipstr(zip, chartp, true), chartp, opts, parse_rels(getzipstr(zip, crelsp, true), chartp), wb, _ws);\n        break;\n\n      case 'macro':\n        _ws = parse_ms(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n        break;\n\n      case 'dialog':\n        _ws = parse_ds(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n        break;\n\n      default:\n        throw new Error(\"Unrecognized sheet type \" + stype);\n    }\n\n    sheets[sheet] = _ws;\n    /* scan rels for comments and threaded comments */\n\n    var tcomments = [];\n    if (sheetRels && sheetRels[sheet]) keys(sheetRels[sheet]).forEach(function (n) {\n      var dfile = \"\";\n\n      if (sheetRels[sheet][n].Type == RELS.CMNT) {\n        dfile = resolve_path(sheetRels[sheet][n].Target, path);\n        var comments = parse_cmnt(getzipdata(zip, dfile, true), dfile, opts);\n        if (!comments || !comments.length) return;\n        sheet_insert_comments(_ws, comments, false);\n      }\n\n      if (sheetRels[sheet][n].Type == RELS.TCMNT) {\n        dfile = resolve_path(sheetRels[sheet][n].Target, path);\n        tcomments = tcomments.concat(parse_tcmnt_xml(getzipdata(zip, dfile, true), opts));\n      }\n    });\n    if (tcomments && tcomments.length) sheet_insert_comments(_ws, tcomments, true, opts.people || []);\n  } catch (e) {\n    if (opts.WTF) throw e;\n  }\n}\n\nfunction strip_front_slash(x\n/*:string*/\n)\n/*:string*/\n{\n  return x.charAt(0) == '/' ? x.slice(1) : x;\n}\n\nfunction parse_zip(zip\n/*:ZIP*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  make_ssf();\n  opts = opts || {};\n  fix_read_opts(opts);\n  /* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n\n  if (safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n  /* UOC */\n\n  if (safegetzipfile(zip, 'objectdata.xml')) return parse_ods(zip, opts);\n  /* Numbers */\n\n  if (safegetzipfile(zip, 'Index/Document.iwa')) {\n    if (typeof Uint8Array == \"undefined\") throw new Error('NUMBERS file parsing requires Uint8Array support');\n\n    if (typeof parse_numbers_iwa != \"undefined\") {\n      if (zip.FileIndex) return parse_numbers_iwa(zip);\n\n      var _zip = CFB.utils.cfb_new();\n\n      zipentries(zip).forEach(function (e) {\n        zip_add_file(_zip, e, getzipbin(zip, e));\n      });\n      return parse_numbers_iwa(_zip);\n    }\n\n    throw new Error('Unsupported NUMBERS file');\n  }\n\n  if (!safegetzipfile(zip, '[Content_Types].xml')) {\n    if (safegetzipfile(zip, 'index.xml.gz')) throw new Error('Unsupported NUMBERS 08 file');\n    if (safegetzipfile(zip, 'index.xml')) throw new Error('Unsupported NUMBERS 09 file');\n    throw new Error('Unsupported ZIP file');\n  }\n\n  var entries = zipentries(zip);\n  var dir = parse_ct(getzipstr(zip, '[Content_Types].xml')\n  /*:?any*/\n  );\n  var xlsb = false;\n  var sheets, binname;\n\n  if (dir.workbooks.length === 0) {\n    binname = \"xl/workbook.xml\";\n    if (getzipdata(zip, binname, true)) dir.workbooks.push(binname);\n  }\n\n  if (dir.workbooks.length === 0) {\n    binname = \"xl/workbook.bin\";\n    if (!getzipdata(zip, binname, true)) throw new Error(\"Could not find workbook\");\n    dir.workbooks.push(binname);\n    xlsb = true;\n  }\n\n  if (dir.workbooks[0].slice(-3) == \"bin\") xlsb = true;\n  var themes = {}\n  /*:any*/\n  ;\n  var styles = {}\n  /*:any*/\n  ;\n\n  if (!opts.bookSheets && !opts.bookProps) {\n    strs = [];\n    if (dir.sst) try {\n      strs = parse_sst(getzipdata(zip, strip_front_slash(dir.sst)), dir.sst, opts);\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n    if (opts.cellStyles && dir.themes.length) themes = parse_theme(getzipstr(zip, dir.themes[0].replace(/^\\//, ''), true) || \"\", dir.themes[0], opts);\n    if (dir.style) styles = parse_sty(getzipdata(zip, strip_front_slash(dir.style)), dir.style, themes, opts);\n  }\n  /*var externbooks = */\n\n\n  dir.links.map(function (link) {\n    try {\n      var rels = parse_rels(getzipstr(zip, get_rels_path(strip_front_slash(link))), link);\n      return parse_xlink(getzipdata(zip, strip_front_slash(link)), rels, link, opts);\n    } catch (e) {}\n  });\n  var wb = parse_wb(getzipdata(zip, strip_front_slash(dir.workbooks[0])), dir.workbooks[0], opts);\n  var props = {},\n      propdata = \"\";\n\n  if (dir.coreprops.length) {\n    propdata = getzipdata(zip, strip_front_slash(dir.coreprops[0]), true);\n    if (propdata) props = parse_core_props(propdata);\n\n    if (dir.extprops.length !== 0) {\n      propdata = getzipdata(zip, strip_front_slash(dir.extprops[0]), true);\n      if (propdata) parse_ext_props(propdata, props, opts);\n    }\n  }\n\n  var custprops = {};\n\n  if (!opts.bookSheets || opts.bookProps) {\n    if (dir.custprops.length !== 0) {\n      propdata = getzipstr(zip, strip_front_slash(dir.custprops[0]), true);\n      if (propdata) custprops = parse_cust_props(propdata, opts);\n    }\n  }\n\n  var out = {}\n  /*:any*/\n  ;\n\n  if (opts.bookSheets || opts.bookProps) {\n    if (wb.Sheets) sheets = wb.Sheets.map(function pluck(x) {\n      return x.name;\n    });else if (props.Worksheets && props.SheetNames.length > 0) sheets = props.SheetNames;\n\n    if (opts.bookProps) {\n      out.Props = props;\n      out.Custprops = custprops;\n    }\n\n    if (opts.bookSheets && typeof sheets !== 'undefined') out.SheetNames = sheets;\n    if (opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n  }\n\n  sheets = {};\n  var deps = {};\n  if (opts.bookDeps && dir.calcchain) deps = parse_cc(getzipdata(zip, strip_front_slash(dir.calcchain)), dir.calcchain, opts);\n  var i = 0;\n  var sheetRels = {}\n  /*:any*/\n  ;\n  var path, relsPath;\n  {\n    var wbsheets = wb.Sheets;\n    props.Worksheets = wbsheets.length;\n    props.SheetNames = [];\n\n    for (var j = 0; j != wbsheets.length; ++j) {\n      props.SheetNames[j] = wbsheets[j].name;\n    }\n  }\n  var wbext = xlsb ? \"bin\" : \"xml\";\n  var wbrelsi = dir.workbooks[0].lastIndexOf(\"/\");\n  var wbrelsfile = (dir.workbooks[0].slice(0, wbrelsi + 1) + \"_rels/\" + dir.workbooks[0].slice(wbrelsi + 1) + \".rels\").replace(/^\\//, \"\");\n  if (!safegetzipfile(zip, wbrelsfile)) wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n  var wbrels = parse_rels(getzipstr(zip, wbrelsfile, true), wbrelsfile.replace(/_rels.*/, \"s5s\"));\n\n  if ((dir.metadata || []).length >= 1) {\n    /* TODO: MDX and other types of metadata */\n    opts.xlmeta = parse_xlmeta(getzipdata(zip, strip_front_slash(dir.metadata[0])), dir.metadata[0], opts);\n  }\n\n  if ((dir.people || []).length >= 1) {\n    opts.people = parse_people_xml(getzipdata(zip, strip_front_slash(dir.people[0])), opts);\n  }\n\n  if (wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n  /* Numbers iOS hack */\n\n  var nmode = getzipdata(zip, \"xl/worksheets/sheet.xml\", true) ? 1 : 0;\n\n  wsloop: for (i = 0; i != props.Worksheets; ++i) {\n    var stype = \"sheet\";\n\n    if (wbrels && wbrels[i]) {\n      path = 'xl/' + wbrels[i][1].replace(/[\\/]?xl\\//, \"\");\n      if (!safegetzipfile(zip, path)) path = wbrels[i][1];\n      if (!safegetzipfile(zip, path)) path = wbrelsfile.replace(/_rels\\/.*$/, \"\") + wbrels[i][1];\n      stype = wbrels[i][2];\n    } else {\n      path = 'xl/worksheets/sheet' + (i + 1 - nmode) + \".\" + wbext;\n      path = path.replace(/sheet0\\./, \"sheet.\");\n    }\n\n    relsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n    if (opts && opts.sheets != null) switch (typeof opts.sheets) {\n      case \"number\":\n        if (i != opts.sheets) continue wsloop;\n        break;\n\n      case \"string\":\n        if (props.SheetNames[i].toLowerCase() != opts.sheets.toLowerCase()) continue wsloop;\n        break;\n\n      default:\n        if (Array.isArray && Array.isArray(opts.sheets)) {\n          var snjseen = false;\n\n          for (var snj = 0; snj != opts.sheets.length; ++snj) {\n            if (typeof opts.sheets[snj] == \"number\" && opts.sheets[snj] == i) snjseen = 1;\n            if (typeof opts.sheets[snj] == \"string\" && opts.sheets[snj].toLowerCase() == props.SheetNames[i].toLowerCase()) snjseen = 1;\n          }\n\n          if (!snjseen) continue wsloop;\n        }\n\n    }\n    safe_parse_sheet(zip, path, relsPath, props.SheetNames[i], i, sheetRels, sheets, stype, opts, wb, themes, styles);\n  }\n\n  out = {\n    Directory: dir,\n    Workbook: wb,\n    Props: props,\n    Custprops: custprops,\n    Deps: deps,\n    Sheets: sheets,\n    SheetNames: props.SheetNames,\n    Strings: strs,\n    Styles: styles,\n    Themes: themes,\n    SSF: dup(table_fmt)\n  }\n  /*:any*/\n  ;\n\n  if (opts && opts.bookFiles) {\n    if (zip.files) {\n      out.keys = entries;\n      out.files = zip.files;\n    } else {\n      out.keys = [];\n      out.files = {};\n      zip.FullPaths.forEach(function (p, idx) {\n        p = p.replace(/^Root Entry[\\/]/, \"\");\n        out.keys.push(p);\n        out.files[p] = zip.FileIndex[idx];\n      });\n    }\n  }\n\n  if (opts && opts.bookVBA) {\n    if (dir.vba.length > 0) out.vbaraw = getzipdata(zip, strip_front_slash(dir.vba[0]), true);else if (dir.defaults && dir.defaults.bin === CT_VBA) out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin', true);\n  }\n\n  return out;\n}\n/* [MS-OFFCRYPTO] 2.1.1 */\n\n\nfunction parse_xlsxcfb(cfb, _opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  var opts = _opts || {};\n  var f = 'Workbook',\n      data = CFB.find(cfb, f);\n\n  try {\n    f = '/!DataSpaces/Version';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n    /*var version = */\n\n    parse_DataSpaceVersionInfo(data.content);\n    /* 2.3.4.1 */\n\n    f = '/!DataSpaces/DataSpaceMap';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n    var dsm = parse_DataSpaceMap(data.content);\n    if (dsm.length !== 1 || dsm[0].comps.length !== 1 || dsm[0].comps[0].t !== 0 || dsm[0].name !== \"StrongEncryptionDataSpace\" || dsm[0].comps[0].v !== \"EncryptedPackage\") throw new Error(\"ECMA-376 Encrypted file bad \" + f);\n    /* 2.3.4.2 */\n\n    f = '/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n    var seds = parse_DataSpaceDefinition(data.content);\n    if (seds.length != 1 || seds[0] != \"StrongEncryptionTransform\") throw new Error(\"ECMA-376 Encrypted file bad \" + f);\n    /* 2.3.4.3 */\n\n    f = '/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary';\n    data = CFB.find(cfb, f);\n    if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n    /*var hdr = */\n\n    parse_Primary(data.content);\n  } catch (e) {}\n\n  f = '/EncryptionInfo';\n  data = CFB.find(cfb, f);\n  if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n  var einfo = parse_EncryptionInfo(data.content);\n  /* 2.3.4.4 */\n\n  f = '/EncryptedPackage';\n  data = CFB.find(cfb, f);\n  if (!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n  /*global decrypt_agile */\n\n  /*:: declare var decrypt_agile:any; */\n\n  if (einfo[0] == 0x04 && typeof decrypt_agile !== 'undefined') return decrypt_agile(einfo[1], data.content, opts.password || \"\", opts);\n  /*global decrypt_std76 */\n\n  /*:: declare var decrypt_std76:any; */\n\n  if (einfo[0] == 0x02 && typeof decrypt_std76 !== 'undefined') return decrypt_std76(einfo[1], data.content, opts.password || \"\", opts);\n  throw new Error(\"File is password-protected\");\n}\n\nfunction write_zip(wb\n/*:Workbook*/\n, opts\n/*:WriteOpts*/\n)\n/*:ZIP*/\n{\n  if (opts.bookType == \"ods\") return write_ods(wb, opts);\n  if (opts.bookType == \"numbers\") return write_numbers_iwa(wb, opts);\n  if (opts.bookType == \"xlsb\") return write_zip_xlsxb(wb, opts);\n  return write_zip_xlsx(wb, opts);\n}\n/* XLSX and XLSB writing are very similar.  Originally they were unified in one\n   export function.  This is horrible for tree shaking in the common case (most\n   applications need to export files in one format) so this function supports\n   both formats while write_zip_xlsx only handles XLSX */\n\n\nfunction write_zip_xlsxb(wb\n/*:Workbook*/\n, opts\n/*:WriteOpts*/\n)\n/*:ZIP*/\n{\n  _shapeid = 1024;\n\n  if (wb && !wb.SSF) {\n    wb.SSF = dup(table_fmt);\n  }\n\n  if (wb && wb.SSF) {\n    make_ssf();\n    SSF_load_table(wb.SSF); // $FlowIgnore\n\n    opts.revssf = evert_num(wb.SSF);\n    opts.revssf[wb.SSF[65535]] = 0;\n    opts.ssf = wb.SSF;\n  }\n\n  opts.rels = {};\n  opts.wbrels = {};\n  opts.Strings =\n  /*::((*/\n  []\n  /*:: :any):SST)*/\n  ;\n  opts.Strings.Count = 0;\n  opts.Strings.Unique = 0;\n  if (browser_has_Map) opts.revStrings = new Map();else {\n    opts.revStrings = {};\n    opts.revStrings.foo = [];\n    delete opts.revStrings.foo;\n  }\n  var wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\n  var vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n  var ct = new_ct();\n  fix_write_opts(opts = opts || {});\n  var zip = zip_new();\n  var f = \"\",\n      rId = 0;\n  opts.cellXfs = [];\n  get_cell_style(opts.cellXfs, {}, {\n    revssf: {\n      \"General\": 0\n    }\n  });\n  if (!wb.Props) wb.Props = {};\n  f = \"docProps/core.xml\";\n  zip_add_file(zip, f, write_core_props(wb.Props, opts));\n  ct.coreprops.push(f);\n  add_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n  /*::if(!wb.Props) throw \"unreachable\"; */\n\n  f = \"docProps/app.xml\";\n\n  if (wb.Props && wb.Props.SheetNames) {\n    /* empty */\n  } else if (!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;else {\n    var _sn = [];\n\n    for (var _i = 0; _i < wb.SheetNames.length; ++_i) if ((wb.Workbook.Sheets[_i] || {}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\n    wb.Props.SheetNames = _sn;\n  }\n\n  wb.Props.Worksheets = wb.Props.SheetNames.length;\n  zip_add_file(zip, f, write_ext_props(wb.Props, opts));\n  ct.extprops.push(f);\n  add_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n  if (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {\n    f = \"docProps/custom.xml\";\n    zip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n    ct.custprops.push(f);\n    add_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n  }\n\n  for (rId = 1; rId <= wb.SheetNames.length; ++rId) {\n    var wsrels = {\n      '!id': {}\n    };\n    var ws = wb.Sheets[wb.SheetNames[rId - 1]];\n\n    var _type = (ws || {})[\"!type\"] || \"sheet\";\n\n    switch (_type) {\n      case \"chart\":\n      /* falls through */\n\n      default:\n        f = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n        zip_add_file(zip, f, write_ws(rId - 1, f, opts, wb, wsrels));\n        ct.sheets.push(f);\n        add_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n    }\n\n    if (ws) {\n      var comments = ws['!comments'];\n      var need_vml = false;\n      var cf = \"\";\n\n      if (comments && comments.length > 0) {\n        cf = \"xl/comments\" + rId + \".\" + wbext;\n        zip_add_file(zip, cf, write_cmnt(comments, cf, opts));\n        ct.comments.push(cf);\n        add_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n        need_vml = true;\n      }\n\n      if (ws['!legacy']) {\n        if (need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + rId + \".vml\", write_comments_vml(rId, ws['!comments']));\n      }\n\n      delete ws['!comments'];\n      delete ws['!legacy'];\n    }\n\n    if (wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n  }\n\n  if (opts.Strings != null && opts.Strings.length > 0) {\n    f = \"xl/sharedStrings.\" + wbext;\n    zip_add_file(zip, f, write_sst(opts.Strings, f, opts));\n    ct.strs.push(f);\n    add_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n  }\n\n  f = \"xl/workbook.\" + wbext;\n  zip_add_file(zip, f, write_wb(wb, f, opts));\n  ct.workbooks.push(f);\n  add_rels(opts.rels, 1, f, RELS.WB);\n  /* TODO: something more intelligent with themes */\n\n  f = \"xl/theme/theme1.xml\";\n  zip_add_file(zip, f, write_theme(wb.Themes, opts));\n  ct.themes.push(f);\n  add_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n  /* TODO: something more intelligent with styles */\n\n  f = \"xl/styles.\" + wbext;\n  zip_add_file(zip, f, write_sty(wb, f, opts));\n  ct.styles.push(f);\n  add_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n  if (wb.vbaraw && vbafmt) {\n    f = \"xl/vbaProject.bin\";\n    zip_add_file(zip, f, wb.vbaraw);\n    ct.vba.push(f);\n    add_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n  }\n\n  f = \"xl/metadata.\" + wbext;\n  zip_add_file(zip, f, write_xlmeta(f));\n  ct.metadata.push(f);\n  add_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n  zip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n  zip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n  zip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n  delete opts.revssf;\n  delete opts.ssf;\n  return zip;\n}\n\nfunction write_zip_xlsx(wb\n/*:Workbook*/\n, opts\n/*:WriteOpts*/\n)\n/*:ZIP*/\n{\n  _shapeid = 1024;\n\n  if (wb && !wb.SSF) {\n    wb.SSF = dup(table_fmt);\n  }\n\n  if (wb && wb.SSF) {\n    make_ssf();\n    SSF_load_table(wb.SSF); // $FlowIgnore\n\n    opts.revssf = evert_num(wb.SSF);\n    opts.revssf[wb.SSF[65535]] = 0;\n    opts.ssf = wb.SSF;\n  }\n\n  opts.rels = {};\n  opts.wbrels = {};\n  opts.Strings =\n  /*::((*/\n  []\n  /*:: :any):SST)*/\n  ;\n  opts.Strings.Count = 0;\n  opts.Strings.Unique = 0;\n  if (browser_has_Map) opts.revStrings = new Map();else {\n    opts.revStrings = {};\n    opts.revStrings.foo = [];\n    delete opts.revStrings.foo;\n  }\n  var wbext = \"xml\";\n  var vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n  var ct = new_ct();\n  fix_write_opts(opts = opts || {});\n  var zip = zip_new();\n  var f = \"\",\n      rId = 0;\n  opts.cellXfs = [];\n  get_cell_style(opts.cellXfs, {}, {\n    revssf: {\n      \"General\": 0\n    }\n  });\n  if (!wb.Props) wb.Props = {};\n  f = \"docProps/core.xml\";\n  zip_add_file(zip, f, write_core_props(wb.Props, opts));\n  ct.coreprops.push(f);\n  add_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n  /*::if(!wb.Props) throw \"unreachable\"; */\n\n  f = \"docProps/app.xml\";\n\n  if (wb.Props && wb.Props.SheetNames) {\n    /* empty */\n  } else if (!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;else {\n    var _sn = [];\n\n    for (var _i = 0; _i < wb.SheetNames.length; ++_i) if ((wb.Workbook.Sheets[_i] || {}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\n    wb.Props.SheetNames = _sn;\n  }\n\n  wb.Props.Worksheets = wb.Props.SheetNames.length;\n  zip_add_file(zip, f, write_ext_props(wb.Props, opts));\n  ct.extprops.push(f);\n  add_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n  if (wb.Custprops !== wb.Props && keys(wb.Custprops || {}).length > 0) {\n    f = \"docProps/custom.xml\";\n    zip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n    ct.custprops.push(f);\n    add_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n  }\n\n  var people = [\"SheetJ5\"];\n  opts.tcid = 0;\n\n  for (rId = 1; rId <= wb.SheetNames.length; ++rId) {\n    var wsrels = {\n      '!id': {}\n    };\n    var ws = wb.Sheets[wb.SheetNames[rId - 1]];\n\n    var _type = (ws || {})[\"!type\"] || \"sheet\";\n\n    switch (_type) {\n      case \"chart\":\n      /* falls through */\n\n      default:\n        f = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n        zip_add_file(zip, f, write_ws_xml(rId - 1, opts, wb, wsrels));\n        ct.sheets.push(f);\n        add_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n    }\n\n    if (ws) {\n      var comments = ws['!comments'];\n      var need_vml = false;\n      var cf = \"\";\n\n      if (comments && comments.length > 0) {\n        var needtc = false;\n        comments.forEach(function (carr) {\n          carr[1].forEach(function (c) {\n            if (c.T == true) needtc = true;\n          });\n        });\n\n        if (needtc) {\n          cf = \"xl/threadedComments/threadedComment\" + rId + \".\" + wbext;\n          zip_add_file(zip, cf, write_tcmnt_xml(comments, people, opts));\n          ct.threadedcomments.push(cf);\n          add_rels(wsrels, -1, \"../threadedComments/threadedComment\" + rId + \".\" + wbext, RELS.TCMNT);\n        }\n\n        cf = \"xl/comments\" + rId + \".\" + wbext;\n        zip_add_file(zip, cf, write_comments_xml(comments, opts));\n        ct.comments.push(cf);\n        add_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n        need_vml = true;\n      }\n\n      if (ws['!legacy']) {\n        if (need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + rId + \".vml\", write_comments_vml(rId, ws['!comments']));\n      }\n\n      delete ws['!comments'];\n      delete ws['!legacy'];\n    }\n\n    if (wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n  }\n\n  if (opts.Strings != null && opts.Strings.length > 0) {\n    f = \"xl/sharedStrings.\" + wbext;\n    zip_add_file(zip, f, write_sst_xml(opts.Strings, opts));\n    ct.strs.push(f);\n    add_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n  }\n\n  f = \"xl/workbook.\" + wbext;\n  zip_add_file(zip, f, write_wb_xml(wb, opts));\n  ct.workbooks.push(f);\n  add_rels(opts.rels, 1, f, RELS.WB);\n  /* TODO: something more intelligent with themes */\n\n  f = \"xl/theme/theme1.xml\";\n  zip_add_file(zip, f, write_theme(wb.Themes, opts));\n  ct.themes.push(f);\n  add_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n  /* TODO: something more intelligent with styles */\n\n  f = \"xl/styles.\" + wbext;\n  zip_add_file(zip, f, write_sty_xml(wb, opts));\n  ct.styles.push(f);\n  add_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n  if (wb.vbaraw && vbafmt) {\n    f = \"xl/vbaProject.bin\";\n    zip_add_file(zip, f, wb.vbaraw);\n    ct.vba.push(f);\n    add_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n  }\n\n  f = \"xl/metadata.\" + wbext;\n  zip_add_file(zip, f, write_xlmeta_xml());\n  ct.metadata.push(f);\n  add_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n\n  if (people.length > 1) {\n    f = \"xl/persons/person.xml\";\n    zip_add_file(zip, f, write_people_xml(people, opts));\n    ct.people.push(f);\n    add_rels(opts.wbrels, -1, \"persons/person.xml\", RELS.PEOPLE);\n  }\n\n  zip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n  zip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n  zip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n  delete opts.revssf;\n  delete opts.ssf;\n  return zip;\n}\n\nfunction firstbyte(f\n/*:RawData*/\n, o\n/*:?TypeOpts*/\n)\n/*:Array<number>*/\n{\n  var x = \"\";\n\n  switch ((o || {}).type || \"base64\") {\n    case 'buffer':\n      return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\n    case 'base64':\n      x = Base64_decode(f.slice(0, 12));\n      break;\n\n    case 'binary':\n      x = f;\n      break;\n\n    case 'array':\n      return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\n    default:\n      throw new Error(\"Unrecognized type \" + (o && o.type || \"undefined\"));\n  }\n\n  return [x.charCodeAt(0), x.charCodeAt(1), x.charCodeAt(2), x.charCodeAt(3), x.charCodeAt(4), x.charCodeAt(5), x.charCodeAt(6), x.charCodeAt(7)];\n}\n\nfunction read_cfb(cfb\n/*:CFBContainer*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  if (CFB.find(cfb, \"EncryptedPackage\")) return parse_xlsxcfb(cfb, opts);\n  return parse_xlscfb(cfb, opts);\n}\n\nfunction read_zip(data\n/*:RawData*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  var zip,\n      d = data;\n  var o = opts || {};\n  if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n  zip = zip_read(d, o);\n  return parse_zip(zip, o);\n}\n\nfunction read_plaintext(data\n/*:string*/\n, o\n/*:ParseOpts*/\n)\n/*:Workbook*/\n{\n  var i = 0;\n\n  main: while (i < data.length) switch (data.charCodeAt(i)) {\n    case 0x0A:\n    case 0x0D:\n    case 0x20:\n      ++i;\n      break;\n\n    case 0x3C:\n      return parse_xlml(data.slice(i), o);\n\n    default:\n      break main;\n  }\n\n  return PRN.to_workbook(data, o);\n}\n\nfunction read_plaintext_raw(data\n/*:RawData*/\n, o\n/*:ParseOpts*/\n)\n/*:Workbook*/\n{\n  var str = \"\",\n      bytes = firstbyte(data, o);\n\n  switch (o.type) {\n    case 'base64':\n      str = Base64_decode(data);\n      break;\n\n    case 'binary':\n      str = data;\n      break;\n\n    case 'buffer':\n      str = data.toString('binary');\n      break;\n\n    case 'array':\n      str = cc2str(data);\n      break;\n\n    default:\n      throw new Error(\"Unrecognized type \" + o.type);\n  }\n\n  if (bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str);\n  o.type = \"binary\";\n  return read_plaintext(str, o);\n}\n\nfunction read_utf16(data\n/*:RawData*/\n, o\n/*:ParseOpts*/\n)\n/*:Workbook*/\n{\n  var d = data;\n  if (o.type == 'base64') d = Base64_decode(d);\n  d = $cptable.utils.decode(1200, d.slice(2), 'str');\n  o.type = \"binary\";\n  return read_plaintext(d, o);\n}\n\nfunction bstrify(data\n/*:string*/\n)\n/*:string*/\n{\n  return !data.match(/[^\\x00-\\x7F]/) ? data : utf8write(data);\n}\n\nfunction read_prn(data, d, o, str) {\n  if (str) {\n    o.type = \"string\";\n    return PRN.to_workbook(data, o);\n  }\n\n  return PRN.to_workbook(d, o);\n}\n\nfunction readSync(data\n/*:RawData*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  reset_cp();\n  var o = opts || {};\n  if (typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) return readSync(new Uint8Array(data), (o = dup(o), o.type = \"array\", o));\n  if (typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && !o.type) o.type = typeof Deno !== \"undefined\" ? \"buffer\" : \"array\";\n  var d = data,\n      n = [0, 0, 0, 0],\n      str = false;\n\n  if (o.cellStyles) {\n    o.cellNF = true;\n    o.sheetStubs = true;\n  }\n\n  _ssfopts = {};\n  if (o.dateNF) _ssfopts.dateNF = o.dateNF;\n  if (!o.type) o.type = has_buf && Buffer.isBuffer(data) ? \"buffer\" : \"base64\";\n\n  if (o.type == \"file\") {\n    o.type = has_buf ? \"buffer\" : \"binary\";\n    d = read_binary(data);\n    if (typeof Uint8Array !== 'undefined' && !has_buf) o.type = \"array\";\n  }\n\n  if (o.type == \"string\") {\n    str = true;\n    o.type = \"binary\";\n    o.codepage = 65001;\n    d = bstrify(data);\n  }\n\n  if (o.type == 'array' && typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && typeof ArrayBuffer !== 'undefined') {\n    // $FlowIgnore\n    var ab = new ArrayBuffer(3),\n        vu = new Uint8Array(ab);\n    vu.foo = \"bar\"; // $FlowIgnore\n\n    if (!vu.foo) {\n      o = dup(o);\n      o.type = 'array';\n      return readSync(ab2a(d), o);\n    }\n  }\n\n  switch ((n = firstbyte(d, o))[0]) {\n    case 0xD0:\n      if (n[1] === 0xCF && n[2] === 0x11 && n[3] === 0xE0 && n[4] === 0xA1 && n[5] === 0xB1 && n[6] === 0x1A && n[7] === 0xE1) return read_cfb(CFB.read(d, o), o);\n      break;\n\n    case 0x09:\n      if (n[1] <= 0x08) return parse_xlscfb(d, o);\n      break;\n\n    case 0x3C:\n      return parse_xlml(d, o);\n\n    case 0x49:\n      if (n[1] === 0x49 && n[2] === 0x2a && n[3] === 0x00) throw new Error(\"TIFF Image File is not a spreadsheet\");\n      if (n[1] === 0x44) return read_wb_ID(d, o);\n      break;\n\n    case 0x54:\n      if (n[1] === 0x41 && n[2] === 0x42 && n[3] === 0x4C) return DIF.to_workbook(d, o);\n      break;\n\n    case 0x50:\n      return n[1] === 0x4B && n[2] < 0x09 && n[3] < 0x09 ? read_zip(d, o) : read_prn(data, d, o, str);\n\n    case 0xEF:\n      return n[3] === 0x3C ? parse_xlml(d, o) : read_prn(data, d, o, str);\n\n    case 0xFF:\n      if (n[1] === 0xFE) {\n        return read_utf16(d, o);\n      } else if (n[1] === 0x00 && n[2] === 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\n      break;\n\n    case 0x00:\n      if (n[1] === 0x00) {\n        if (n[2] >= 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n        if (n[2] === 0x00 && (n[3] === 0x08 || n[3] === 0x09)) return WK_.to_workbook(d, o);\n      }\n\n      break;\n\n    case 0x03:\n    case 0x83:\n    case 0x8B:\n    case 0x8C:\n      return DBF.to_workbook(d, o);\n\n    case 0x7B:\n      if (n[1] === 0x5C && n[2] === 0x72 && n[3] === 0x74) return RTF.to_workbook(d, o);\n      break;\n\n    case 0x0A:\n    case 0x0D:\n    case 0x20:\n      return read_plaintext_raw(d, o);\n\n    case 0x89:\n      if (n[1] === 0x50 && n[2] === 0x4E && n[3] === 0x47) throw new Error(\"PNG Image File is not a spreadsheet\");\n      break;\n  }\n\n  if (DBF_SUPPORTED_VERSIONS.indexOf(n[0]) > -1 && n[2] <= 12 && n[3] <= 31) return DBF.to_workbook(d, o);\n  return read_prn(data, d, o, str);\n}\n\nfunction readFileSync(filename\n/*:string*/\n, opts\n/*:?ParseOpts*/\n)\n/*:Workbook*/\n{\n  var o = opts || {};\n  o.type = 'file';\n  return readSync(filename, o);\n}\n\nfunction write_cfb_ctr(cfb\n/*:CFBContainer*/\n, o\n/*:WriteOpts*/\n)\n/*:any*/\n{\n  switch (o.type) {\n    case \"base64\":\n    case \"binary\":\n      break;\n\n    case \"buffer\":\n    case \"array\":\n      o.type = \"\";\n      break;\n\n    case \"file\":\n      return write_dl(o.file, CFB.write(cfb, {\n        type: has_buf ? 'buffer' : \"\"\n      }));\n\n    case \"string\":\n      throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\n    default:\n      throw new Error(\"Unrecognized type \" + o.type);\n  }\n\n  return CFB.write(cfb, o);\n}\n/*:: declare var encrypt_agile:any; */\n\n\nfunction write_zip_type(wb\n/*:Workbook*/\n, opts\n/*:?WriteOpts*/\n)\n/*:any*/\n{\n  var o = dup(opts || {});\n  var z = write_zip(wb, o);\n  return write_zip_denouement(z, o);\n}\n\nfunction write_zip_typeXLSX(wb\n/*:Workbook*/\n, opts\n/*:?WriteOpts*/\n)\n/*:any*/\n{\n  var o = dup(opts || {});\n  var z = write_zip_xlsx(wb, o);\n  return write_zip_denouement(z, o);\n}\n\nfunction write_zip_denouement(z\n/*:any*/\n, o\n/*:?WriteOpts*/\n)\n/*:any*/\n{\n  var oopts = {};\n  var ftype = has_buf ? \"nodebuffer\" : typeof Uint8Array !== \"undefined\" ? \"array\" : \"string\";\n  if (o.compression) oopts.compression = 'DEFLATE';\n  if (o.password) oopts.type = ftype;else switch (o.type) {\n    case \"base64\":\n      oopts.type = \"base64\";\n      break;\n\n    case \"binary\":\n      oopts.type = \"string\";\n      break;\n\n    case \"string\":\n      throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\n    case \"buffer\":\n    case \"file\":\n      oopts.type = ftype;\n      break;\n\n    default:\n      throw new Error(\"Unrecognized type \" + o.type);\n  }\n  var out = z.FullPaths ? CFB.write(z, {\n    fileType: \"zip\",\n    type:\n    /*::(*/\n    {\n      \"nodebuffer\": \"buffer\",\n      \"string\": \"binary\"\n    }\n    /*:: :any)*/\n    [oopts.type] || oopts.type,\n    compression: !!o.compression\n  }) : z.generate(oopts);\n\n  if (typeof Deno !== \"undefined\") {\n    if (typeof out == \"string\") {\n      if (o.type == \"binary\" || o.type == \"base64\") return out;\n      out = new Uint8Array(s2ab(out));\n    }\n  }\n  /*jshint -W083 */\n\n\n  if (o.password && typeof encrypt_agile !== 'undefined') return write_cfb_ctr(encrypt_agile(out, o.password), o); // eslint-disable-line no-undef\n\n  /*jshint +W083 */\n\n  if (o.type === \"file\") return write_dl(o.file, out);\n  return o.type == \"string\" ? utf8read(\n  /*::(*/\n  out\n  /*:: :any)*/\n  ) : out;\n}\n\nfunction write_cfb_type(wb\n/*:Workbook*/\n, opts\n/*:?WriteOpts*/\n)\n/*:any*/\n{\n  var o = opts || {};\n  var cfb\n  /*:CFBContainer*/\n  = write_xlscfb(wb, o);\n  return write_cfb_ctr(cfb, o);\n}\n\nfunction write_string_type(out\n/*:string*/\n, opts\n/*:WriteOpts*/\n, bom\n/*:?string*/\n)\n/*:any*/\n{\n  if (!bom) bom = \"\";\n  var o = bom + out;\n\n  switch (opts.type) {\n    case \"base64\":\n      return Base64_encode(utf8write(o));\n\n    case \"binary\":\n      return utf8write(o);\n\n    case \"string\":\n      return out;\n\n    case \"file\":\n      return write_dl(opts.file, o, 'utf8');\n\n    case \"buffer\":\n      {\n        if (has_buf) return Buffer_from(o, 'utf8');else if (typeof TextEncoder !== \"undefined\") return new TextEncoder().encode(o);else return write_string_type(o, {\n          type: 'binary'\n        }).split(\"\").map(function (c) {\n          return c.charCodeAt(0);\n        });\n      }\n  }\n\n  throw new Error(\"Unrecognized type \" + opts.type);\n}\n\nfunction write_stxt_type(out\n/*:string*/\n, opts\n/*:WriteOpts*/\n)\n/*:any*/\n{\n  switch (opts.type) {\n    case \"base64\":\n      return Base64_encode(out);\n\n    case \"binary\":\n      return out;\n\n    case \"string\":\n      return out;\n\n    /* override in sheet_to_txt */\n\n    case \"file\":\n      return write_dl(opts.file, out, 'binary');\n\n    case \"buffer\":\n      {\n        if (has_buf) return Buffer_from(out, 'binary');else return out.split(\"\").map(function (c) {\n          return c.charCodeAt(0);\n        });\n      }\n  }\n\n  throw new Error(\"Unrecognized type \" + opts.type);\n}\n/* TODO: test consistency */\n\n\nfunction write_binary_type(out, opts\n/*:WriteOpts*/\n)\n/*:any*/\n{\n  switch (opts.type) {\n    case \"string\":\n    case \"base64\":\n    case \"binary\":\n      var bstr = \"\"; // $FlowIgnore\n\n      for (var i = 0; i < out.length; ++i) bstr += String.fromCharCode(out[i]);\n\n      return opts.type == 'base64' ? Base64_encode(bstr) : opts.type == 'string' ? utf8read(bstr) : bstr;\n\n    case \"file\":\n      return write_dl(opts.file, out);\n\n    case \"buffer\":\n      return out;\n\n    default:\n      throw new Error(\"Unrecognized type \" + opts.type);\n  }\n}\n\nfunction writeSyncXLSX(wb\n/*:Workbook*/\n, opts\n/*:?WriteOpts*/\n) {\n  reset_cp();\n  check_wb(wb);\n  var o = dup(opts || {});\n\n  if (o.cellStyles) {\n    o.cellNF = true;\n    o.sheetStubs = true;\n  }\n\n  if (o.type == \"array\") {\n    o.type = \"binary\";\n    var out\n    /*:string*/\n    = writeSyncXLSX(wb, o)\n    /*:any*/\n    ;\n    o.type = \"array\";\n    return s2ab(out);\n  }\n\n  return write_zip_typeXLSX(wb, o);\n}\n\nfunction writeSync(wb\n/*:Workbook*/\n, opts\n/*:?WriteOpts*/\n) {\n  reset_cp();\n  check_wb(wb);\n  var o = dup(opts || {});\n\n  if (o.cellStyles) {\n    o.cellNF = true;\n    o.sheetStubs = true;\n  }\n\n  if (o.type == \"array\") {\n    o.type = \"binary\";\n    var out\n    /*:string*/\n    = writeSync(wb, o)\n    /*:any*/\n    ;\n    o.type = \"array\";\n    return s2ab(out);\n  }\n\n  var idx = 0;\n\n  if (o.sheet) {\n    if (typeof o.sheet == \"number\") idx = o.sheet;else idx = wb.SheetNames.indexOf(o.sheet);\n    if (!wb.SheetNames[idx]) throw new Error(\"Sheet not found: \" + o.sheet + \" : \" + typeof o.sheet);\n  }\n\n  switch (o.bookType || 'xlsb') {\n    case 'xml':\n    case 'xlml':\n      return write_string_type(write_xlml(wb, o), o);\n\n    case 'slk':\n    case 'sylk':\n      return write_string_type(SYLK.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\n    case 'htm':\n    case 'html':\n      return write_string_type(sheet_to_html(wb.Sheets[wb.SheetNames[idx]], o), o);\n\n    case 'txt':\n      return write_stxt_type(sheet_to_txt(wb.Sheets[wb.SheetNames[idx]], o), o);\n\n    case 'csv':\n      return write_string_type(sheet_to_csv(wb.Sheets[wb.SheetNames[idx]], o), o, \"\\ufeff\");\n\n    case 'dif':\n      return write_string_type(DIF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\n    case 'dbf':\n      return write_binary_type(DBF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\n    case 'prn':\n      return write_string_type(PRN.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\n    case 'rtf':\n      return write_string_type(RTF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\n    case 'eth':\n      return write_string_type(ETH.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\n    case 'fods':\n      return write_string_type(write_ods(wb, o), o);\n\n    case 'wk1':\n      return write_binary_type(WK_.sheet_to_wk1(wb.Sheets[wb.SheetNames[idx]], o), o);\n\n    case 'wk3':\n      return write_binary_type(WK_.book_to_wk3(wb, o), o);\n\n    case 'biff2':\n      if (!o.biff) o.biff = 2;\n\n    /* falls through */\n\n    case 'biff3':\n      if (!o.biff) o.biff = 3;\n\n    /* falls through */\n\n    case 'biff4':\n      if (!o.biff) o.biff = 4;\n      return write_binary_type(write_biff_buf(wb, o), o);\n\n    case 'biff5':\n      if (!o.biff) o.biff = 5;\n\n    /* falls through */\n\n    case 'biff8':\n    case 'xla':\n    case 'xls':\n      if (!o.biff) o.biff = 8;\n      return write_cfb_type(wb, o);\n\n    case 'xlsx':\n    case 'xlsm':\n    case 'xlam':\n    case 'xlsb':\n    case 'numbers':\n    case 'ods':\n      return write_zip_type(wb, o);\n\n    default:\n      throw new Error(\"Unrecognized bookType |\" + o.bookType + \"|\");\n  }\n}\n\nfunction resolve_book_type(o\n/*:WriteFileOpts*/\n) {\n  if (o.bookType) return;\n  var _BT = {\n    \"xls\": \"biff8\",\n    \"htm\": \"html\",\n    \"slk\": \"sylk\",\n    \"socialcalc\": \"eth\",\n    \"Sh33tJS\": \"WTF\"\n  };\n  var ext = o.file.slice(o.file.lastIndexOf(\".\")).toLowerCase();\n  if (ext.match(/^\\.[a-z]+$/)) o.bookType = ext.slice(1);\n  o.bookType = _BT[o.bookType] || o.bookType;\n}\n\nfunction writeFileSync(wb\n/*:Workbook*/\n, filename\n/*:string*/\n, opts\n/*:?WriteFileOpts*/\n) {\n  var o = opts || {};\n  o.type = 'file';\n  o.file = filename;\n  resolve_book_type(o);\n  return writeSync(wb, o);\n}\n\nfunction writeFileSyncXLSX(wb\n/*:Workbook*/\n, filename\n/*:string*/\n, opts\n/*:?WriteFileOpts*/\n) {\n  var o = opts || {};\n  o.type = 'file';\n  o.file = filename;\n  resolve_book_type(o);\n  return writeSyncXLSX(wb, o);\n}\n\nfunction writeFileAsync(filename\n/*:string*/\n, wb\n/*:Workbook*/\n, opts\n/*:?WriteFileOpts*/\n, cb\n/*:?(e?:ErrnoError)=>void*/\n) {\n  var o = opts || {};\n  o.type = 'file';\n  o.file = filename;\n  resolve_book_type(o);\n  o.type = 'buffer';\n  var _cb = cb;\n  if (!(_cb instanceof Function)) _cb = opts\n  /*:any*/\n  ;\n  return _fs.writeFile(filename, writeSync(wb, o), _cb);\n}\n/*::\ntype MJRObject = {\n\trow: any;\n\tisempty: boolean;\n};\n*/\n\n\nfunction make_json_row(sheet\n/*:Worksheet*/\n, r\n/*:Range*/\n, R\n/*:number*/\n, cols\n/*:Array<string>*/\n, header\n/*:number*/\n, hdr\n/*:Array<any>*/\n, dense\n/*:boolean*/\n, o\n/*:Sheet2JSONOpts*/\n)\n/*:MJRObject*/\n{\n  var rr = encode_row(R);\n  var defval = o.defval,\n      raw = o.raw || !Object.prototype.hasOwnProperty.call(o, \"raw\");\n  var isempty = true;\n  var row\n  /*:any*/\n  = header === 1 ? [] : {};\n\n  if (header !== 1) {\n    if (Object.defineProperty) try {\n      Object.defineProperty(row, '__rowNum__', {\n        value: R,\n        enumerable: false\n      });\n    } catch (e) {\n      row.__rowNum__ = R;\n    } else row.__rowNum__ = R;\n  }\n\n  if (!dense || sheet[R]) for (var C = r.s.c; C <= r.e.c; ++C) {\n    var val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\n    if (val === undefined || val.t === undefined) {\n      if (defval === undefined) continue;\n\n      if (hdr[C] != null) {\n        row[hdr[C]] = defval;\n      }\n\n      continue;\n    }\n\n    var v = val.v;\n\n    switch (val.t) {\n      case 'z':\n        if (v == null) break;\n        continue;\n\n      case 'e':\n        v = v == 0 ? null : void 0;\n        break;\n\n      case 's':\n      case 'd':\n      case 'b':\n      case 'n':\n        break;\n\n      default:\n        throw new Error('unrecognized type ' + val.t);\n    }\n\n    if (hdr[C] != null) {\n      if (v == null) {\n        if (val.t == \"e\" && v === null) row[hdr[C]] = null;else if (defval !== undefined) row[hdr[C]] = defval;else if (raw && v === null) row[hdr[C]] = null;else continue;\n      } else {\n        row[hdr[C]] = raw && (val.t !== \"n\" || val.t === \"n\" && o.rawNumbers !== false) ? v : format_cell(val, v, o);\n      }\n\n      if (v != null) isempty = false;\n    }\n  }\n  return {\n    row: row,\n    isempty: isempty\n  };\n}\n\nfunction sheet_to_json(sheet\n/*:Worksheet*/\n, opts\n/*:?Sheet2JSONOpts*/\n) {\n  if (sheet == null || sheet[\"!ref\"] == null) return [];\n  var val = {\n    t: 'n',\n    v: 0\n  },\n      header = 0,\n      offset = 1,\n      hdr\n  /*:Array<any>*/\n  = [],\n      v = 0,\n      vv = \"\";\n  var r = {\n    s: {\n      r: 0,\n      c: 0\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var o = opts || {};\n  var range = o.range != null ? o.range : sheet[\"!ref\"];\n  if (o.header === 1) header = 1;else if (o.header === \"A\") header = 2;else if (Array.isArray(o.header)) header = 3;else if (o.header == null) header = 0;\n\n  switch (typeof range) {\n    case 'string':\n      r = safe_decode_range(range);\n      break;\n\n    case 'number':\n      r = safe_decode_range(sheet[\"!ref\"]);\n      r.s.r = range;\n      break;\n\n    default:\n      r = range;\n  }\n\n  if (header > 0) offset = 0;\n  var rr = encode_row(r.s.r);\n  var cols\n  /*:Array<string>*/\n  = [];\n  var out\n  /*:Array<any>*/\n  = [];\n  var outi = 0,\n      counter = 0;\n  var dense = Array.isArray(sheet);\n  var R = r.s.r,\n      C = 0;\n  var header_cnt = {};\n  if (dense && !sheet[R]) sheet[R] = [];\n  var colinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!cols\"] || [];\n  var rowinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!rows\"] || [];\n\n  for (C = r.s.c; C <= r.e.c; ++C) {\n    if ((colinfo[C] || {}).hidden) continue;\n    cols[C] = encode_col(C);\n    val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\n    switch (header) {\n      case 1:\n        hdr[C] = C - r.s.c;\n        break;\n\n      case 2:\n        hdr[C] = cols[C];\n        break;\n\n      case 3:\n        hdr[C] = o.header[C - r.s.c];\n        break;\n\n      default:\n        if (val == null) val = {\n          w: \"__EMPTY\",\n          t: \"s\"\n        };\n        vv = v = format_cell(val, null, o);\n        counter = header_cnt[v] || 0;\n        if (!counter) header_cnt[v] = 1;else {\n          do {\n            vv = v + \"_\" + counter++;\n          } while (header_cnt[vv]);\n\n          header_cnt[v] = counter;\n          header_cnt[vv] = 1;\n        }\n        hdr[C] = vv;\n    }\n  }\n\n  for (R = r.s.r + offset; R <= r.e.r; ++R) {\n    if ((rowinfo[R] || {}).hidden) continue;\n    var row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\n    if (row.isempty === false || (header === 1 ? o.blankrows !== false : !!o.blankrows)) out[outi++] = row.row;\n  }\n\n  out.length = outi;\n  return out;\n}\n\nvar qreg = /\"/g;\n\nfunction make_csv_row(sheet\n/*:Worksheet*/\n, r\n/*:Range*/\n, R\n/*:number*/\n, cols\n/*:Array<string>*/\n, fs\n/*:number*/\n, rs\n/*:number*/\n, FS\n/*:string*/\n, o\n/*:Sheet2CSVOpts*/\n)\n/*:?string*/\n{\n  var isempty = true;\n  var row\n  /*:Array<string>*/\n  = [],\n      txt = \"\",\n      rr = encode_row(R);\n\n  for (var C = r.s.c; C <= r.e.c; ++C) {\n    if (!cols[C]) continue;\n    var val = o.dense ? (sheet[R] || [])[C] : sheet[cols[C] + rr];\n    if (val == null) txt = \"\";else if (val.v != null) {\n      isempty = false;\n      txt = '' + (o.rawNumbers && val.t == \"n\" ? val.v : format_cell(val, null, o));\n\n      for (var i = 0, cc = 0; i !== txt.length; ++i) if ((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34 || o.forceQuotes) {\n        txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\";\n        break;\n      }\n\n      if (txt == \"ID\") txt = '\"ID\"';\n    } else if (val.f != null && !val.F) {\n      isempty = false;\n      txt = '=' + val.f;\n      if (txt.indexOf(\",\") >= 0) txt = '\"' + txt.replace(qreg, '\"\"') + '\"';\n    } else txt = \"\";\n    /* NOTE: Excel CSV does not support array formulae */\n\n    row.push(txt);\n  }\n\n  if (o.blankrows === false && isempty) return null;\n  return row.join(FS);\n}\n\nfunction sheet_to_csv(sheet\n/*:Worksheet*/\n, opts\n/*:?Sheet2CSVOpts*/\n)\n/*:string*/\n{\n  var out\n  /*:Array<string>*/\n  = [];\n  var o = opts == null ? {} : opts;\n  if (sheet == null || sheet[\"!ref\"] == null) return \"\";\n  var r = safe_decode_range(sheet[\"!ref\"]);\n  var FS = o.FS !== undefined ? o.FS : \",\",\n      fs = FS.charCodeAt(0);\n  var RS = o.RS !== undefined ? o.RS : \"\\n\",\n      rs = RS.charCodeAt(0);\n  var endregex = new RegExp((FS == \"|\" ? \"\\\\|\" : FS) + \"+$\");\n  var row = \"\",\n      cols\n  /*:Array<string>*/\n  = [];\n  o.dense = Array.isArray(sheet);\n  var colinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!cols\"] || [];\n  var rowinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!rows\"] || [];\n\n  for (var C = r.s.c; C <= r.e.c; ++C) if (!(colinfo[C] || {}).hidden) cols[C] = encode_col(C);\n\n  var w = 0;\n\n  for (var R = r.s.r; R <= r.e.r; ++R) {\n    if ((rowinfo[R] || {}).hidden) continue;\n    row = make_csv_row(sheet, r, R, cols, fs, rs, FS, o);\n\n    if (row == null) {\n      continue;\n    }\n\n    if (o.strip) row = row.replace(endregex, \"\");\n    if (row || o.blankrows !== false) out.push((w++ ? RS : \"\") + row);\n  }\n\n  delete o.dense;\n  return out.join(\"\");\n}\n\nfunction sheet_to_txt(sheet\n/*:Worksheet*/\n, opts\n/*:?Sheet2CSVOpts*/\n) {\n  if (!opts) opts = {};\n  opts.FS = \"\\t\";\n  opts.RS = \"\\n\";\n  var s = sheet_to_csv(sheet, opts);\n  if (typeof $cptable == 'undefined' || opts.type == 'string') return s;\n  var o = $cptable.utils.encode(1200, s, 'str');\n  return String.fromCharCode(255) + String.fromCharCode(254) + o;\n}\n\nfunction sheet_to_formulae(sheet\n/*:Worksheet*/\n)\n/*:Array<string>*/\n{\n  var y = \"\",\n      x,\n      val = \"\";\n  if (sheet == null || sheet[\"!ref\"] == null) return [];\n  var r = safe_decode_range(sheet['!ref']),\n      rr = \"\",\n      cols\n  /*:Array<string>*/\n  = [],\n      C;\n  var cmds\n  /*:Array<string>*/\n  = [];\n  var dense = Array.isArray(sheet);\n\n  for (C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\n  for (var R = r.s.r; R <= r.e.r; ++R) {\n    rr = encode_row(R);\n\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      y = cols[C] + rr;\n      x = dense ? (sheet[R] || [])[C] : sheet[y];\n      val = \"\";\n      if (x === undefined) continue;else if (x.F != null) {\n        y = x.F;\n        if (!x.f) continue;\n        val = x.f;\n        if (y.indexOf(\":\") == -1) y = y + \":\" + y;\n      }\n      if (x.f != null) val = x.f;else if (x.t == 'z') continue;else if (x.t == 'n' && x.v != null) val = \"\" + x.v;else if (x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";else if (x.w !== undefined) val = \"'\" + x.w;else if (x.v === undefined) continue;else if (x.t == 's') val = \"'\" + x.v;else val = \"\" + x.v;\n      cmds[cmds.length] = y + \"=\" + val;\n    }\n  }\n\n  return cmds;\n}\n\nfunction sheet_add_json(_ws\n/*:?Worksheet*/\n, js\n/*:Array<any>*/\n, opts)\n/*:Worksheet*/\n{\n  var o = opts || {};\n  var offset = +!o.skipHeader;\n  var ws\n  /*:Worksheet*/\n  = _ws || {}\n  /*:any*/\n  ;\n  var _R = 0,\n      _C = 0;\n\n  if (ws && o.origin != null) {\n    if (typeof o.origin == 'number') _R = o.origin;else {\n      var _origin\n      /*:CellAddress*/\n      = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\n      _R = _origin.r;\n      _C = _origin.c;\n    }\n  }\n\n  var cell\n  /*:Cell*/\n  ;\n  var range\n  /*:Range*/\n  = {\n    s: {\n      c: 0,\n      r: 0\n    },\n    e: {\n      c: _C,\n      r: _R + js.length - 1 + offset\n    }\n  }\n  /*:any*/\n  ;\n\n  if (ws['!ref']) {\n    var _range = safe_decode_range(ws['!ref']);\n\n    range.e.c = Math.max(range.e.c, _range.e.c);\n    range.e.r = Math.max(range.e.r, _range.e.r);\n\n    if (_R == -1) {\n      _R = _range.e.r + 1;\n      range.e.r = _R + js.length - 1 + offset;\n    }\n  } else {\n    if (_R == -1) {\n      _R = 0;\n      range.e.r = js.length - 1 + offset;\n    }\n  }\n\n  var hdr\n  /*:Array<string>*/\n  = o.header || [],\n      C = 0;\n  js.forEach(function (JS, R\n  /*:number*/\n  ) {\n    keys(JS).forEach(function (k) {\n      if ((C = hdr.indexOf(k)) == -1) hdr[C = hdr.length] = k;\n      var v = JS[k];\n      var t = 'z';\n      var z = \"\";\n      var ref = encode_cell({\n        c: _C + C,\n        r: _R + R + offset\n      });\n      cell = ws_get_cell_stub(ws, ref);\n\n      if (v && typeof v === 'object' && !(v instanceof Date)) {\n        ws[ref] = v;\n      } else {\n        if (typeof v == 'number') t = 'n';else if (typeof v == 'boolean') t = 'b';else if (typeof v == 'string') t = 's';else if (v instanceof Date) {\n          t = 'd';\n\n          if (!o.cellDates) {\n            t = 'n';\n            v = datenum(v);\n          }\n\n          z = o.dateNF || table_fmt[14];\n        } else if (v === null && o.nullError) {\n          t = 'e';\n          v = 0;\n        }\n        if (!cell) ws[ref] = cell = {\n          t: t,\n          v: v\n        }\n        /*:any*/\n        ;else {\n          cell.t = t;\n          cell.v = v;\n          delete cell.w;\n          delete cell.R;\n          if (z) cell.z = z;\n        }\n        if (z) cell.z = z;\n      }\n    });\n  });\n  range.e.c = Math.max(range.e.c, _C + hdr.length - 1);\n\n  var __R = encode_row(_R);\n\n  if (offset) for (C = 0; C < hdr.length; ++C) ws[encode_col(C + _C) + __R] = {\n    t: 's',\n    v: hdr[C]\n  };\n  ws['!ref'] = encode_range(range);\n  return ws;\n}\n\nfunction json_to_sheet(js\n/*:Array<any>*/\n, opts)\n/*:Worksheet*/\n{\n  return sheet_add_json(null, js, opts);\n}\n/* get cell, creating a stub if necessary */\n\n\nfunction ws_get_cell_stub(ws\n/*:Worksheet*/\n, R, C\n/*:?number*/\n)\n/*:Cell*/\n{\n  /* A1 cell address */\n  if (typeof R == \"string\") {\n    /* dense */\n    if (Array.isArray(ws)) {\n      var RC = decode_cell(R);\n      if (!ws[RC.r]) ws[RC.r] = [];\n      return ws[RC.r][RC.c] || (ws[RC.r][RC.c] = {\n        t: 'z'\n      });\n    }\n\n    return ws[R] || (ws[R] = {\n      t: 'z'\n    });\n  }\n  /* cell address object */\n\n\n  if (typeof R != \"number\") return ws_get_cell_stub(ws, encode_cell(R));\n  /* R and C are 0-based indices */\n\n  return ws_get_cell_stub(ws, encode_cell({\n    r: R,\n    c: C || 0\n  }));\n}\n/* find sheet index for given name / validate index */\n\n\nfunction wb_sheet_idx(wb\n/*:Workbook*/\n, sh\n/*:number|string*/\n) {\n  if (typeof sh == \"number\") {\n    if (sh >= 0 && wb.SheetNames.length > sh) return sh;\n    throw new Error(\"Cannot find sheet # \" + sh);\n  } else if (typeof sh == \"string\") {\n    var idx = wb.SheetNames.indexOf(sh);\n    if (idx > -1) return idx;\n    throw new Error(\"Cannot find sheet name |\" + sh + \"|\");\n  } else throw new Error(\"Cannot find sheet |\" + sh + \"|\");\n}\n/* simple blank workbook object */\n\n\nfunction book_new()\n/*:Workbook*/\n{\n  return {\n    SheetNames: [],\n    Sheets: {}\n  };\n}\n/* add a worksheet to the end of a given workbook */\n\n\nfunction book_append_sheet(wb\n/*:Workbook*/\n, ws\n/*:Worksheet*/\n, name\n/*:?string*/\n, roll\n/*:?boolean*/\n)\n/*:string*/\n{\n  var i = 1;\n  if (!name) for (; i <= 0xFFFF; ++i, name = undefined) if (wb.SheetNames.indexOf(name = \"Sheet\" + i) == -1) break;\n  if (!name || wb.SheetNames.length >= 0xFFFF) throw new Error(\"Too many worksheets\");\n\n  if (roll && wb.SheetNames.indexOf(name) >= 0) {\n    var m = name.match(/(^.*?)(\\d+)$/);\n    i = m && +m[2] || 0;\n    var root = m && m[1] || name;\n\n    for (++i; i <= 0xFFFF; ++i) if (wb.SheetNames.indexOf(name = root + i) == -1) break;\n  }\n\n  check_ws_name(name);\n  if (wb.SheetNames.indexOf(name) >= 0) throw new Error(\"Worksheet with name |\" + name + \"| already exists!\");\n  wb.SheetNames.push(name);\n  wb.Sheets[name] = ws;\n  return name;\n}\n/* set sheet visibility (visible/hidden/very hidden) */\n\n\nfunction book_set_sheet_visibility(wb\n/*:Workbook*/\n, sh\n/*:number|string*/\n, vis\n/*:number*/\n) {\n  if (!wb.Workbook) wb.Workbook = {};\n  if (!wb.Workbook.Sheets) wb.Workbook.Sheets = [];\n  var idx = wb_sheet_idx(wb, sh); // $FlowIgnore\n\n  if (!wb.Workbook.Sheets[idx]) wb.Workbook.Sheets[idx] = {};\n\n  switch (vis) {\n    case 0:\n    case 1:\n    case 2:\n      break;\n\n    default:\n      throw new Error(\"Bad sheet visibility setting \" + vis);\n  } // $FlowIgnore\n\n\n  wb.Workbook.Sheets[idx].Hidden = vis;\n}\n/* set number format */\n\n\nfunction cell_set_number_format(cell\n/*:Cell*/\n, fmt\n/*:string|number*/\n) {\n  cell.z = fmt;\n  return cell;\n}\n/* set cell hyperlink */\n\n\nfunction cell_set_hyperlink(cell\n/*:Cell*/\n, target\n/*:string*/\n, tooltip\n/*:?string*/\n) {\n  if (!target) {\n    delete cell.l;\n  } else {\n    cell.l = {\n      Target: target\n    }\n    /*:Hyperlink*/\n    ;\n    if (tooltip) cell.l.Tooltip = tooltip;\n  }\n\n  return cell;\n}\n\nfunction cell_set_internal_link(cell\n/*:Cell*/\n, range\n/*:string*/\n, tooltip\n/*:?string*/\n) {\n  return cell_set_hyperlink(cell, \"#\" + range, tooltip);\n}\n/* add to cell comments */\n\n\nfunction cell_add_comment(cell\n/*:Cell*/\n, text\n/*:string*/\n, author\n/*:?string*/\n) {\n  if (!cell.c) cell.c = [];\n  cell.c.push({\n    t: text,\n    a: author || \"SheetJS\"\n  });\n}\n/* set array formula and flush related cells */\n\n\nfunction sheet_set_array_formula(ws\n/*:Worksheet*/\n, range, formula\n/*:string*/\n, dynamic\n/*:boolean*/\n) {\n  var rng = typeof range != \"string\" ? range : safe_decode_range(range);\n  var rngstr = typeof range == \"string\" ? range : encode_range(range);\n\n  for (var R = rng.s.r; R <= rng.e.r; ++R) for (var C = rng.s.c; C <= rng.e.c; ++C) {\n    var cell = ws_get_cell_stub(ws, R, C);\n    cell.t = 'n';\n    cell.F = rngstr;\n    delete cell.v;\n\n    if (R == rng.s.r && C == rng.s.c) {\n      cell.f = formula;\n      if (dynamic) cell.D = true;\n    }\n  }\n\n  return ws;\n}\n\nvar utils\n/*:any*/\n= {\n  encode_col: encode_col,\n  encode_row: encode_row,\n  encode_cell: encode_cell,\n  encode_range: encode_range,\n  decode_col: decode_col,\n  decode_row: decode_row,\n  split_cell: split_cell,\n  decode_cell: decode_cell,\n  decode_range: decode_range,\n  format_cell: format_cell,\n  sheet_add_aoa: sheet_add_aoa,\n  sheet_add_json: sheet_add_json,\n  sheet_add_dom: sheet_add_dom,\n  aoa_to_sheet: aoa_to_sheet,\n  json_to_sheet: json_to_sheet,\n  table_to_sheet: parse_dom_table,\n  table_to_book: table_to_book,\n  sheet_to_csv: sheet_to_csv,\n  sheet_to_txt: sheet_to_txt,\n  sheet_to_json: sheet_to_json,\n  sheet_to_html: sheet_to_html,\n  sheet_to_formulae: sheet_to_formulae,\n  sheet_to_row_object_array: sheet_to_json,\n  sheet_get_cell: ws_get_cell_stub,\n  book_new: book_new,\n  book_append_sheet: book_append_sheet,\n  book_set_sheet_visibility: book_set_sheet_visibility,\n  cell_set_number_format: cell_set_number_format,\n  cell_set_hyperlink: cell_set_hyperlink,\n  cell_set_internal_link: cell_set_internal_link,\n  cell_add_comment: cell_add_comment,\n  sheet_set_array_formula: sheet_set_array_formula,\n  consts: {\n    SHEET_VISIBLE: 0,\n    SHEET_HIDDEN: 1,\n    SHEET_VERY_HIDDEN: 2\n  }\n};\n\nvar _Readable;\n\nfunction set_readable(R) {\n  _Readable = R;\n}\n\nfunction write_csv_stream(sheet\n/*:Worksheet*/\n, opts\n/*:?Sheet2CSVOpts*/\n) {\n  var stream = _Readable();\n\n  var o = opts == null ? {} : opts;\n\n  if (sheet == null || sheet[\"!ref\"] == null) {\n    stream.push(null);\n    return stream;\n  }\n\n  var r = safe_decode_range(sheet[\"!ref\"]);\n  var FS = o.FS !== undefined ? o.FS : \",\",\n      fs = FS.charCodeAt(0);\n  var RS = o.RS !== undefined ? o.RS : \"\\n\",\n      rs = RS.charCodeAt(0);\n  var endregex = new RegExp((FS == \"|\" ? \"\\\\|\" : FS) + \"+$\");\n  var row\n  /*:?string*/\n  = \"\",\n      cols\n  /*:Array<string>*/\n  = [];\n  o.dense = Array.isArray(sheet);\n  var colinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!cols\"] || [];\n  var rowinfo\n  /*:Array<RowInfo>*/\n  = o.skipHidden && sheet[\"!rows\"] || [];\n\n  for (var C = r.s.c; C <= r.e.c; ++C) if (!(colinfo[C] || {}).hidden) cols[C] = encode_col(C);\n\n  var R = r.s.r;\n  var BOM = false,\n      w = 0;\n\n  stream._read = function () {\n    if (!BOM) {\n      BOM = true;\n      return stream.push(\"\\uFEFF\");\n    }\n\n    while (R <= r.e.r) {\n      ++R;\n      if ((rowinfo[R - 1] || {}).hidden) continue;\n      row = make_csv_row(sheet, r, R - 1, cols, fs, rs, FS, o);\n\n      if (row != null) {\n        if (o.strip) row = row.replace(endregex, \"\");\n        if (row || o.blankrows !== false) return stream.push((w++ ? RS : \"\") + row);\n      }\n    }\n\n    return stream.push(null);\n  };\n\n  return stream;\n}\n\nfunction write_html_stream(ws\n/*:Worksheet*/\n, opts\n/*:?Sheet2HTMLOpts*/\n) {\n  var stream = _Readable();\n\n  var o = opts || {};\n  var header = o.header != null ? o.header : HTML_BEGIN;\n  var footer = o.footer != null ? o.footer : HTML_END;\n  stream.push(header);\n  var r = decode_range(ws['!ref']);\n  o.dense = Array.isArray(ws);\n  stream.push(make_html_preamble(ws, r, o));\n  var R = r.s.r;\n  var end = false;\n\n  stream._read = function () {\n    if (R > r.e.r) {\n      if (!end) {\n        end = true;\n        stream.push(\"</table>\" + footer);\n      }\n\n      return stream.push(null);\n    }\n\n    while (R <= r.e.r) {\n      stream.push(make_html_row(ws, r, R, o));\n      ++R;\n      break;\n    }\n  };\n\n  return stream;\n}\n\nfunction write_json_stream(sheet\n/*:Worksheet*/\n, opts\n/*:?Sheet2CSVOpts*/\n) {\n  var stream = _Readable({\n    objectMode: true\n  });\n\n  if (sheet == null || sheet[\"!ref\"] == null) {\n    stream.push(null);\n    return stream;\n  }\n\n  var val = {\n    t: 'n',\n    v: 0\n  },\n      header = 0,\n      offset = 1,\n      hdr\n  /*:Array<any>*/\n  = [],\n      v = 0,\n      vv = \"\";\n  var r = {\n    s: {\n      r: 0,\n      c: 0\n    },\n    e: {\n      r: 0,\n      c: 0\n    }\n  };\n  var o = opts || {};\n  var range = o.range != null ? o.range : sheet[\"!ref\"];\n  if (o.header === 1) header = 1;else if (o.header === \"A\") header = 2;else if (Array.isArray(o.header)) header = 3;\n\n  switch (typeof range) {\n    case 'string':\n      r = safe_decode_range(range);\n      break;\n\n    case 'number':\n      r = safe_decode_range(sheet[\"!ref\"]);\n      r.s.r = range;\n      break;\n\n    default:\n      r = range;\n  }\n\n  if (header > 0) offset = 0;\n  var rr = encode_row(r.s.r);\n  var cols\n  /*:Array<string>*/\n  = [];\n  var counter = 0;\n  var dense = Array.isArray(sheet);\n  var R = r.s.r,\n      C = 0;\n  var header_cnt = {};\n  if (dense && !sheet[R]) sheet[R] = [];\n  var colinfo\n  /*:Array<ColInfo>*/\n  = o.skipHidden && sheet[\"!cols\"] || [];\n  var rowinfo\n  /*:Array<RowInfo>*/\n  = o.skipHidden && sheet[\"!rows\"] || [];\n\n  for (C = r.s.c; C <= r.e.c; ++C) {\n    if ((colinfo[C] || {}).hidden) continue;\n    cols[C] = encode_col(C);\n    val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\n    switch (header) {\n      case 1:\n        hdr[C] = C - r.s.c;\n        break;\n\n      case 2:\n        hdr[C] = cols[C];\n        break;\n\n      case 3:\n        hdr[C] = o.header[C - r.s.c];\n        break;\n\n      default:\n        if (val == null) val = {\n          w: \"__EMPTY\",\n          t: \"s\"\n        };\n        vv = v = format_cell(val, null, o);\n        counter = header_cnt[v] || 0;\n        if (!counter) header_cnt[v] = 1;else {\n          do {\n            vv = v + \"_\" + counter++;\n          } while (header_cnt[vv]);\n\n          header_cnt[v] = counter;\n          header_cnt[vv] = 1;\n        }\n        hdr[C] = vv;\n    }\n  }\n\n  R = r.s.r + offset;\n\n  stream._read = function () {\n    while (R <= r.e.r) {\n      if ((rowinfo[R - 1] || {}).hidden) continue;\n      var row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\n      ++R;\n\n      if (row.isempty === false || (header === 1 ? o.blankrows !== false : !!o.blankrows)) {\n        stream.push(row.row);\n        return;\n      }\n    }\n\n    return stream.push(null);\n  };\n\n  return stream;\n}\n\nvar __stream = {\n  to_json: write_json_stream,\n  to_html: write_html_stream,\n  to_csv: write_csv_stream,\n  set_readable: set_readable\n};\nexport const version = XLSX.version;\nexport { parse_xlscfb, parse_zip, readSync as read, readFileSync as readFile, readFileSync, writeSync as write, writeFileSync as writeFile, writeFileSync, writeFileAsync, writeSyncXLSX as writeXLSX, writeFileSyncXLSX as writeFileXLSX, utils, __stream as stream, SSF, CFB };"],"sourceRoot":""}